(self.webpackChunkapp_studio_enterprise_omnichannel_messaging=self.webpackChunkapp_studio_enterprise_omnichannel_messaging||[]).push([[7159],{27159:(_,H,n)=>{n.r(H),n.d(H,{AcademyHelpApiModule:()=>d,AcademyHelpLinkRequest:()=>u,AcademyHelpLinkRequestHandler:()=>c,AcademyService:()=>s});var a=n(5960),y=n(40297),r=n(38495),A=n(73308),C=n(96590),i=n(59131),x=n(21018),f=n(10850),v=n(62278),p=n(36486),l=n(29957);class s{get contextService(){return this._contextService===void 0&&(this._contextService=this._injector.get(x.CONTEXT_SERVICE_TOKEN,null)),this._contextService}constructor(e,t,o){this._modelGenerator=e,this._window=t,this._injector=o,this._schemaName="AcademyUrlData"}_createAcademyHelpUrlDataItem(e){return{configurationVersion:e.ConfigurationVersion,contextHelpCode:e.Code,contextHelpId:e.ContextHelpId,enableContextHelp:e.EnableContextHelp,lmsUrl:e.LMSUrl,productEdition:e.ProductEdition,useLmsDocumentation:e.UseLmsDocumentation}}_getSchemaColumns(){return["ContextHelpId","EnableContextHelp","Code","ProductEdition","ConfigurationVersion","UseLmsDocumentation","LMSUrl"]}_createDataSourceParameters(e){return[{type:r.ModelParameterType.Filter,value:this._getContextHelpCodeFilter(e)}]}_getContextHelpCodeFilter(e){return new r.CompareFilter(r.ComparisonType.Equal,new r.ColumnExpression({columnPath:"Code"}),new r.ParameterExpression({value:e}))}_getAcademyHelpUrlData(e){return this._modelGenerator.generateOne({type:"crt.EntityDataSource",config:{entitySchemaName:this._schemaName}},"").pipe((0,p.switchMap)(t=>t.load({attributes:this._getSchemaColumns(),parameters:e})),(0,p.map)(t=>t.length===1?this._createAcademyHelpUrlDataItem(t[0]):null))}_buildUrl(e){let t="#";return e&&(t=e.useLmsDocumentation?this._getLmsDocumentationUrl(e):l.String.empty),t}_getLmsDocumentationUrl(e){const t=[],o=e.productEdition;o&&t.push("product="+encodeURIComponent(o));const m=e.configurationVersion;m&&t.push("ver="+encodeURIComponent(m));const S=e.enableContextHelp,g=e.contextHelpId;return S&&g&&t.push("id="+encodeURIComponent(g)),`${e.lmsUrl}?${t.join("&")}`}getAcademyHelpUrl(e){if(e===l.String.empty)return(0,v.of)(l.String.empty);const t=this._createDataSourceParameters(e);return this._getAcademyHelpUrlData(t).pipe((0,p.map)(o=>o?this._buildUrl(o):l.String.empty))}openContextHelp(){const e=this.contextService;if(!e)throw new Error(`${x.CONTEXT_SERVICE_TOKEN.toString()} was not provided`);const t=e.getContextCode();this.getAcademyHelpUrl(t).subscribe(o=>{this._window.open(o)})}static{this.\u0275fac=function(t){return new(t||s)(i.\u0275\u0275inject(f.ModelGenerator),i.\u0275\u0275inject(C.WINDOW_TOKEN),i.\u0275\u0275inject(i.Injector))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:s,factory:s.\u0275fac,providedIn:"root"})}}let u=class extends r.BaseRequest{};u=(0,a.__decorate)([(0,r.CrtRequest)({type:"crt.AcademyHelpLinkRequest"})],u);let c=class extends r.BaseRequestHandler{constructor(e,t){super(),this._window=e,this._academyHelpUrlService=t}_getAcademyHelpUrl(e){return this._academyHelpUrlService.getAcademyHelpUrl(e)}_openUrl(e){e&&this._window.open(e,"_blank")}handle(e){var t=this;return(0,A.A)(function*(){const o=e.contextHelpCode;return o&&t._getAcademyHelpUrl(o).subscribe(m=>t._openUrl(m)),t.next?.handle(e)})()}};c=(0,a.__decorate)([(0,r.CrtRequestHandler)({type:"crt.AcademyHelpLinkRequestHandler",requestType:"crt.AcademyHelpLinkRequest"}),(0,a.__param)(0,(0,r.CrtInject)(C.WINDOW_TOKEN)),(0,a.__metadata)("design:paramtypes",[Window,s])],c);let d=class h{static{this.\u0275fac=function(t){return new(t||h)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:h})}static{this.\u0275inj=i.\u0275\u0275defineInjector({imports:[y.CommonModule]})}};d=(0,a.__decorate)([(0,r.CrtModule)({requestHandlers:[c]})],d),function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(d,{imports:[y.CommonModule]})}()}}]);
