(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[69307],{57900:(T,Q,u)=>{var c={"./clip-filled.svg":86142,"./close-link.svg":32258,"./info-icon.svg":29759,"./open-link.svg":37480,"./richtext-toggle.svg":54373,"./save-link.svg":42085,"./select-template-icon.svg":56148,"./unlink-link.svg":52655};function E(L){var S=w(L);return u(S)}function w(L){if(!u.o(c,L)){var S=new Error("Cannot find module '"+L+"'");throw S.code="MODULE_NOT_FOUND",S}return c[L]}E.keys=function(){return Object.keys(c)},E.resolve=w,T.exports=E,E.id=57900},30268:(T,Q,u)=>{u.d(Q,{$:()=>P});/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */function c(v,f,s){var C=document.head||document.getElementsByTagName("head")[0],k=document.createElement("script");typeof f=="function"&&(s=f,f={}),f=f||{},s=s||function(){},k.type=f.type||"text/javascript",k.charset=f.charset||"utf8",k.async="async"in f?!!f.async:!0,k.src=v,f.attrs&&E(k,f.attrs),f.text&&(k.text=String(f.text));var A="onload"in k?w:L;A(k,s),k.onload||w(k,s),C.appendChild(k)}function E(v,f){for(var s in f)v.setAttribute(s,f[s])}function w(v,f){v.onload=function(){this.onerror=this.onload=null,f(null,v)},v.onerror=function(){this.onerror=this.onload=null,f(new Error("Failed to load "+this.src),v)}}function L(v,f){v.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(this.onreadystatechange=null,f(null,v))}}var S;function P(v,f){return"CKEDITOR"in window?Promise.resolve(CKEDITOR):typeof v!="string"||v.length<1?Promise.reject(new TypeError("CKEditor URL must be a non-empty string.")):(S||(S=P.scriptLoader(v).then(function(s){return f&&f(s),s})),S)}P.scriptLoader=function(v){return new Promise(function(f,s){c(v,function(C){if(S=void 0,C)return s(C);if(!window.CKEDITOR)return s(new Error("Script loaded from editorUrl doesn't provide CKEDITOR namespace."));f(CKEDITOR)})})};function re(v,f){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},C;return function(){clearTimeout(C);for(var k=arguments.length,A=new Array(k),g=0;g<k;g++)A[g]=arguments[g];C=setTimeout(v.bind.apply(v,[s].concat(A)),f)}}},69307:(T,Q,u)=>{u.r(Q),u.d(Q,{CKEDITOR_THEME_STYLE_URL:()=>se,CrtRichTextEditorComponent:()=>x,CrtRichTextEditorModule:()=>ie,CrtRichTextLinkComponent:()=>D,CrtRichTextVideoComponent:()=>N,CrtRichTextVideoEmbedComponent:()=>V,CrtRichTextVideoLocalComponent:()=>$,CrtRichTextVideoTab:()=>F,CrtRichTextVideoUrlComponent:()=>z,RichTextEditorCancelHandler:()=>ne,RichTextEditorPreprocessor:()=>Z,RichTextEditorSaveHandler:()=>te,RichTextEditorUploadService:()=>M,SelectionActionRequest:()=>pe,SelectionActionsMetadataService:()=>j,SelectionActionsPositionService:()=>H,TabType:()=>G});var c=u(5960),E=u(40297),w=u(56711),L=u(17331),S=u(52989),P=u(4091),re=u(70987),v=u(62521),f=u(71252),s=u(38495),C=u(59564),k=u(96590),A=u(50456),g=u(20822),ge=u(47742),m=u(21018),ae=u(10990);const be={"hu-HU":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"V\xE1lassza ki a mell\xE9kleteket","SelectTemplate":"Sablon besz\xFAr\xE1sa","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Hivatalos","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Ment\xE9s","OpenLinkButtonCaption":"Megnyit\xE1s \xFAj lapon","CloseLinkButtonCaption":"Bez\xE1r\xE1s","UnlinkLinkButtonCaption":"Link T\xF6rl\xE9se","LinkLabelCaption":"Link c\xEDme","TextLabelCaption":"Megjelen\xEDtend\u0151 sz\xF6veg"}}'),"zh-CN":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Select attachments","SelectTemplate":"Insert template","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Formal","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"\u4FDD\u5B58","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"\u5173\u95ED","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"sq-AL":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Select attachments","SelectTemplate":"Insert template","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Formale","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Ruaj","OpenLinkButtonCaption":"Hape n\xEB dritare t\xEB re","CloseLinkButtonCaption":"Mbyll","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"en-GB":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Display toolbar","UploadAttachments":"Select attachments"},"RichTextEditorLink":{"SaveLinkButtonCaption":"Save","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"Close","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"bg-BG":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"\u041E\u043F\u0446\u0438\u0438 \u0437\u0430 \u0444\u043E\u0440\u043C\u0430\u0442\u0438\u0440\u0430\u043D\u0435 (Alt+F10)","UploadAttachments":"\u0418\u0437\u0431\u0435\u0440\u0438 \u043F\u0440\u0438\u043A\u0430\u0447\u0435\u043D\u0438 \u0444\u0430\u0439\u043B\u043E\u0432\u0435","SelectTemplate":"\u0412\u043C\u044A\u043A\u043D\u0438 \u0448\u0430\u0431\u043B\u043E\u043D\u0430","SelectionActions":{"AskCopilot":"\u041F\u043E\u043F\u0438\u0442\u0430\u0439 Creatio AI","Friendly":"\u041F\u0440\u0438\u044F\u0442\u0435\u043B\u0441\u043A\u0438","Formal":"\u041E\u0444\u0438\u0446\u0438\u0430\u043B\u043D\u0430","Shorten":"\u0421\u044A\u043A\u0440\u0430\u0442\u0438","Extend":"\u0420\u0430\u0437\u0448\u0438\u0440\u0438","Rephrase":"\u041F\u0440\u0435\u0444\u043E\u0440\u043C\u0443\u043B\u0438\u0440\u0430\u0439","RewriteCaption":"\u041F\u0440\u0435\u043D\u0430\u043F\u0438\u0448\u0438 \u0442\u0435\u043A\u0441\u0442\u0430"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"\u0417\u0430\u043F\u0430\u0437\u0438","OpenLinkButtonCaption":"\u041E\u0442\u0432\u043E\u0440\u0438 \u0432 \u043D\u043E\u0432 \u0440\u0430\u0437\u0434\u0435\u043B","CloseLinkButtonCaption":"\u0417\u0430\u0442\u0432\u043E\u0440\u0438","UnlinkLinkButtonCaption":"\u041F\u0440\u0435\u043A\u0440\u0430\u0442\u0438 \u0432\u0440\u044A\u0437\u043A\u0430\u0442\u0430","LinkLabelCaption":"\u0410\u0434\u0440\u0435\u0441 \u043D\u0430 \u043B\u0438\u043D\u043A\u0430","TextLabelCaption":"\u0422\u0435\u043A\u0441\u0442 \u0437\u0430 \u043F\u043E\u043A\u0430\u0437\u0432\u0430\u043D\u0435"}}'),"zh-TW":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"\u9009\u62E9\u9644\u4EF6","SelectTemplate":"\u63D2\u5165\u6A21\u677F","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"\u6B63\u5F0F\u7684","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"\u5132\u5B58","OpenLinkButtonCaption":"\u958B\u555F\u65B0\u5206\u9801","CloseLinkButtonCaption":"\u95DC\u9589","UnlinkLinkButtonCaption":"\u53D6\u6D88\u94FE\u63A5","LinkLabelCaption":"\u94FE\u63A5\u5730\u5740","TextLabelCaption":"\u663E\u793A\u5185\u5BB9"}}'),"no-NO":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Vis verkt\xF8ylinje","UploadAttachments":"Velg vedlegg"},"RichTextEditorLink":{"SaveLinkButtonCaption":"Lagre","OpenLinkButtonCaption":"\xC5pne i ny fane","CloseLinkButtonCaption":"Lukk","UnlinkLinkButtonCaption":"Frakoble","LinkLabelCaption":"Lenke adresse","TextLabelCaption":"Tekst som skal vises"}}'),"ko-KR":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"\uCCA8\uBD80\uD30C\uC77C \uC120\uD0DD","SelectTemplate":"\uD15C\uD50C\uB9BF \uC0BD\uC785","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Formal","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"\uC644\uB8CC","OpenLinkButtonCaption":"\uC0C8 \uD0ED\uC5D0\uC11C \uC5F4\uAE30","CloseLinkButtonCaption":"\uB2EB\uAE30","UnlinkLinkButtonCaption":"\uC5F0\uACB0 \uD574\uC81C","LinkLabelCaption":"\uB9C1\uD06C \uC8FC\uC18C","TextLabelCaption":"\uD45C\uC2DC\uD560 \uD14D\uC2A4\uD2B8"}}'),"ja-JP":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"\u6DFB\u4ED8\u30D5\u30A1\u30A4\u30EB\u306E\u9078\u629E","SelectTemplate":"\u30C6\u30F3\u30D7\u30EC\u30FC\u30C8\u306E\u633F\u5165","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"\u6B63\u5F0F","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"\u4FDD\u5B58","OpenLinkButtonCaption":"\u65B0\u3057\u3044\u30BF\u30D6\u3067\u958B\u304F","CloseLinkButtonCaption":"\u9589\u3058\u308B","UnlinkLinkButtonCaption":"\u30EA\u30F3\u30AF\u306E\u89E3\u9664","LinkLabelCaption":"\u30EA\u30F3\u30AF\u306E\u30A2\u30C9\u30EC\u30B9","TextLabelCaption":"\u8868\u793A\u3059\u308B\u30C6\u30AD\u30B9\u30C8"}}'),"fr-CA":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Display toolbar"},"RichTextEditorLink":{"SaveLinkButtonCaption":"Save","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"Close","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),zh:JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Display toolbar"},"RichTextEditorLink":{"SaveLinkButtonCaption":"Save","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"Close","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"vi-VN":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Select attachments","SelectTemplate":"Insert template","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Formal","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"L\u01B0u","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"\u0110\xF3ng","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"tr-TR":JSON.parse(`{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Ekleri se\xE7in","SelectTemplate":"\u015Eablonu ekle","SelectionActions":{"AskCopilot":"Createo Ai'ye sorun","Friendly":"Arkada\u015F\xE7a","Formal":"Resmi","Shorten":"K\u0131saltmak","Extend":"Uzatmak","Rephrase":"Yeniden ifade etmek","RewriteCaption":"Metni yeniden yaz"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Kaydet","OpenLinkButtonCaption":"Yeni sekmede a\xE7","CloseLinkButtonCaption":"Kapat","UnlinkLinkButtonCaption":"Ba\u011F\u0131rmak","LinkLabelCaption":"Ba\u011Flant\u0131 adresi","TextLabelCaption":"G\xF6r\xFCnt\xFClemek i\xE7in metin"}}`),"th-TH":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Select attachments","SelectTemplate":"Insert template","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Formal","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"\u0E1B\u0E34\u0E14","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"sv-SE":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Select attachments","SelectTemplate":"Insert template","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Formal","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Spara","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"St\xE4ng","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"ro-RO":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Selecta\u021Bi ata\u0219amentele","SelectTemplate":"Inserare template","SelectionActions":{"AskCopilot":"\xCEntreab\u0103 Creatio AI","Friendly":"Prietenos","Formal":"Formal","Shorten":"Scurteaz\u0103","Extend":"Extinde","Rephrase":"Reformuleaz\u0103 textul","RewriteCaption":"Rescriere text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Salveaz\u0103","OpenLinkButtonCaption":"Deschide \xEEntr-un tab nou","CloseLinkButtonCaption":"\xCEnchide\u021Bi","UnlinkLinkButtonCaption":"Deconectare","LinkLabelCaption":"Adresa link-ului","TextLabelCaption":"Text de afi\u0219at"}}'),"pt-PT":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Select attachments","SelectTemplate":"Insert template","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Formal","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Gravar","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"Fechar","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"pt-BR":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Selecionar anexos","SelectTemplate":"Inserir um modelo","SelectionActions":{"AskCopilot":"Pergunte \xE0 IA do Creatio","Friendly":"Amig\xE1vel","Formal":"Formal","Shorten":"Encurtar","Extend":"Estender","Rephrase":"Refrasear","RewriteCaption":"Reescrever o texto"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Salvar","OpenLinkButtonCaption":"Abrir em uma nova aba","CloseLinkButtonCaption":"Fechar","UnlinkLinkButtonCaption":"Desvincular","LinkLabelCaption":"Vincular o endere\xE7o","TextLabelCaption":"Texto a ser exibido"}}'),"pl-PL":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Wybierz za\u0142\u0105czniki","SelectTemplate":"Wstaw szablon","SelectionActions":{"AskCopilot":"Wywo\u0142ania Creatio AI","Friendly":"Przyjazny","Formal":"Formalny","Shorten":"Skr\xF3\u0107","Extend":"Rozszerz","Rephrase":"Przekszta\u0142\u0107","RewriteCaption":"Przepisz tekst"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Zapisz","OpenLinkButtonCaption":"Otw\xF3rz w nowej karcie","CloseLinkButtonCaption":"Zamknij","UnlinkLinkButtonCaption":"Od\u0142\u0105cz","LinkLabelCaption":"Adres linku","TextLabelCaption":"Tekst do wy\u015Bwietlenia"}}'),no:JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Display toolbar"},"RichTextEditorLink":{"SaveLinkButtonCaption":"Save","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"Close","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"nl-NL":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Selecteer bijlagen","SelectTemplate":"Voeg sjabloon in","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Vriendelijk","Formal":"Formeel","Shorten":"Verkorten","Extend":"Uitbreiden","Rephrase":"Herformuleer tekst","RewriteCaption":"Herformuleer tekst"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Opslaan","OpenLinkButtonCaption":"Open in nieuwe tab","CloseLinkButtonCaption":"Sluiten","UnlinkLinkButtonCaption":"Loskoppelen","LinkLabelCaption":"Link adres","TextLabelCaption":"Tekst te tonen"}}'),"lv-LV":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Format\u0113\u0161anas iesp\u0113jas (Alt+F10)","UploadAttachments":"Atlasiet pielikumus","SelectTemplate":"Ievietot veidni","SelectionActions":{"AskCopilot":"Jaut\u0101jiet Creatio AI","Friendly":"Draudz\u012Bgs","Formal":"Form\u0101ls","Shorten":"Sa\u012Bsin\u0101t","Extend":"Papla\u0161in\u0101t","Rephrase":"P\u0101rfr\u0101z\u0113t tekstu","RewriteCaption":"P\u0101rrakst\u012Bt tekstu"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Saglab\u0101t","OpenLinkButtonCaption":"Atv\u0113rt jaun\u0101 ciln\u0113","CloseLinkButtonCaption":"Aizv\u0113rt","UnlinkLinkButtonCaption":"Atvienot","LinkLabelCaption":"Saites adrese","TextLabelCaption":"Teksts, kas j\u0101par\u0101da"}}'),"kk-KZ":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Display toolbar","UploadAttachments":"Select attachments"},"RichTextEditorLink":{"SaveLinkButtonCaption":"Save","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"Close","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"it-IT":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Seleziona allegati","SelectTemplate":"Inserisci modello","SelectionActions":{"AskCopilot":"Chiedi a Creatio AI","Friendly":"Amichevole","Formal":"Formale","Shorten":"Abbrevia","Extend":"Estendi","Rephrase":"Riformula","RewriteCaption":"Riscrivi il testo"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Salva","OpenLinkButtonCaption":"Apri in una nuova scheda","CloseLinkButtonCaption":"Chiudi","UnlinkLinkButtonCaption":"Scollega","LinkLabelCaption":"Indirizzo del link","TextLabelCaption":"Testo da mostrare"}}'),"id-ID":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Select attachments","SelectTemplate":"Insert template","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Formal","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Save","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"Close","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"he-IL":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"\u05D0\u05E4\u05E9\u05E8\u05D5\u05D9\u05D5\u05EA \u05E2\u05D9\u05E6\u05D5\u05D1 (Alt+F10)","UploadAttachments":"\u05D1\u05D7\u05E8 \u05E7\u05D1\u05E6\u05D9\u05DD \u05DE\u05E6\u05D5\u05E8\u05E4\u05D9\u05DD","SelectTemplate":"\u05D4\u05DB\u05E0\u05E1 \u05EA\u05D1\u05E0\u05D9\u05EA","SelectionActions":{"AskCopilot":"\u05E9\u05D0\u05DC \u05D0\u05EA Creatio AI","Friendly":"\u05D9\u05D3\u05D9\u05D3\u05D5\u05EA\u05D9","Formal":"\u05E4\u05D5\u05E8\u05DE\u05DC\u05D9","Shorten":"\u05E7\u05E6\u05E8","Extend":"\u05D4\u05E8\u05D7\u05D1","Rephrase":"\u05E9\u05DE\u05D5\u05E8 \u05E2\u05DC \u05D4\u05E0\u05D9\u05E1\u05D5\u05D7","RewriteCaption":"\u05E9\u05DB\u05EA\u05D1 \u05D0\u05EA \u05D4\u05D8\u05E7\u05E1\u05D8"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"\u05E9\u05DE\u05D5\u05E8","OpenLinkButtonCaption":"\u05E4\u05EA\u05D7 \u05D1\u05D8\u05D0\u05D1 \u05D7\u05D3\u05E9","CloseLinkButtonCaption":"\u05E1\u05D2\u05D5\u05E8","UnlinkLinkButtonCaption":"\u05D4\u05E1\u05E8 \u05D0\u05EA \u05D4\u05E7\u05D9\u05E9\u05D5\u05E8","LinkLabelCaption":"\u05DB\u05EA\u05D5\u05D1\u05EA \u05D4\u05E7\u05D9\u05E9\u05D5\u05E8","TextLabelCaption":"\u05D8\u05E7\u05E1\u05D8 \u05DC\u05D4\u05E6\u05D2\u05D4"}}'),"fr-FR":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"S\xE9lectionner les pi\xE8ces jointes","SelectTemplate":"Ins\xE9rer le mod\xE8le","SelectionActions":{"AskCopilot":"Demander Creatio IA","Friendly":"Amical","Formal":"Formel","Shorten":"Raccourcir","Extend":"\xC9tendre","Rephrase":"R\xE9diger diff\xE9remment","RewriteCaption":"R\xE9\xE9crire le texte"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Enregistrer","OpenLinkButtonCaption":"Ouvrir dans un nouvel onglet","CloseLinkButtonCaption":"Fermer","UnlinkLinkButtonCaption":"Supprimer le lien","LinkLabelCaption":"Adresse du lien","TextLabelCaption":"Texte \xE0 afficher"}}'),"fa-IR":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Display toolbar","UploadAttachments":"Select attachments"},"RichTextEditorLink":{"SaveLinkButtonCaption":"\u0630\u062E\u06CC\u0631\u0647","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"\u0628\u0633\u062A\u0646","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"es-ES":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Opciones de formato (Alt+F10)","UploadAttachments":"Seleccionar adjuntos","SelectTemplate":"Insertar plantilla","SelectionActions":{"AskCopilot":"Preguntar a Creatio AI","Friendly":"Amistoso","Formal":"Formal","Shorten":"Acortado","Extend":"Extendido","Rephrase":"Refrasear","RewriteCaption":"Reescribir texto"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Guardar","OpenLinkButtonCaption":"Abrir en nueva p\xE1gina","CloseLinkButtonCaption":"Cerrar","UnlinkLinkButtonCaption":"Desvincular","LinkLabelCaption":"Direcci\xF3n del enlace","TextLabelCaption":"Texto a mostrar"}}'),"de-DE":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Anh\xE4nge ausw\xE4hlen","SelectTemplate":"Vorlage einf\xFCgen","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Formal","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Speichern","OpenLinkButtonCaption":"In neuem Tab \xF6ffnen","CloseLinkButtonCaption":"Schlie\xDFen","UnlinkLinkButtonCaption":"Link entfernen","LinkLabelCaption":"Linkadresse","TextLabelCaption":"anzuzeigender Text"}}'),"cs-CZ":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Select attachments","SelectTemplate":"Insert template","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Formal","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Ulo\u017Eit","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"Zav\u0159\xEDt","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"ar-SA":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Select attachments","SelectTemplate":"Insert template","SelectionActions":{"AskCopilot":"Ask Creatio AI","Friendly":"Friendly","Formal":"Formal","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Save","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"Close","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"}}'),"en-US":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"Select attachments","SelectTemplate":"Insert template","SelectionActions":{"AskCopilot":"Ask Creatio.ai","Friendly":"Friendly","Formal":"Formal","Shorten":"Shorten","Extend":"Extend","Rephrase":"Rephrase","RewriteCaption":"Rewrite text"},"TableOfContents":{"Title":"Table of contents","Placeholder":"A table of contents based on the headings on this page will appear here once it has been published."}},"RichTextEditorLink":{"SaveLinkButtonCaption":"Save","OpenLinkButtonCaption":"Open in new tab","CloseLinkButtonCaption":"Close","UnlinkLinkButtonCaption":"Unlink","LinkLabelCaption":"Link address","TextLabelCaption":"Text to display"},"RichTextEditorVideo":{"DialogTitle":"Insert video","PasteUrlTab":"Paste url","UploadFileTab":"Upload file","EmbedCodeTab":"Embed code","DialogDescription":"This video will be embedded at 640 pixels wide.<br>This embedded video will include a text link.","SaveButton":"Insert video","CancelButton":"Cancel","UploadButton":"Upload file","InputPlaceholder":"Paste here","DragAndDropPlaceholder":"Drag-and-drop file here or","NotVideoFile":"The inserted file is not a video, please select a file with a video type.","ConfirmMessage":"This page contains unsaved changes. They will be lost if you close the page. Save the changes?"}}'),"ru-RU":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"\u0424\u043E\u0440\u043C\u0430\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 (Alt+F10)","UploadAttachments":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432\u043B\u043E\u0436\u0435\u043D\u0438\u0435","SelectTemplate":"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u0448\u0430\u0431\u043B\u043E\u043D","SelectionActions":{"AskCopilot":"\u0421\u043F\u0440\u043E\u0441\u0438\u0442\u044C Copilot","Friendly":"\u0414\u0440\u0443\u0436\u0435\u043B\u044E\u0431\u043D\u044B\u0439","Formal":"\u0424\u043E\u0440\u043C\u0430\u043B\u044C\u043D\u044B\u0439","Shorten":"\u0421\u043E\u043A\u0440\u0430\u0442\u0438","Extend":"\u0420\u0430\u0441\u0448\u0438\u0440\u044C","Rephrase":"\u041F\u0435\u0440\u0435\u0444\u0440\u0430\u0437\u0438\u0440\u0443\u0439","RewriteCaption":"\u041F\u0435\u0440\u0435\u043F\u0438\u0441\u0430\u0442\u044C \u0442\u0435\u043A\u0441\u0442"},"TableOfContents":{"Title":"\u041E\u0433\u043B\u0430\u0432\u043B\u0435\u043D\u0438\u0435","Placeholder":"\u041E\u0433\u043B\u0430\u0432\u043B\u0435\u043D\u0438\u0435, \u0441\u043E\u0437\u0434\u0430\u043D\u043D\u043E\u0435 \u043D\u0430 \u043E\u0441\u043D\u043E\u0432\u0435 \u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043A\u043E\u0432 \u043D\u0430 \u044D\u0442\u043E\u0439 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0435, \u043F\u043E\u044F\u0432\u0438\u0442\u0441\u044F \u0437\u0434\u0435\u0441\u044C \u043F\u043E\u0441\u043B\u0435 \u043F\u0443\u0431\u043B\u0438\u043A\u0430\u0446\u0438\u0438."}},"RichTextEditorLink":{"SaveLinkButtonCaption":"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C","OpenLinkButtonCaption":"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0432 \u043D\u043E\u0432\u043E\u0439 \u0432\u043A\u043B\u0430\u0434\u043A\u0435","CloseLinkButtonCaption":"\u0417\u0430\u043A\u0440\u044B\u0442\u044C","UnlinkLinkButtonCaption":"\u041E\u0442\u043A\u0440\u0435\u043F\u0438\u0442\u044C","LinkLabelCaption":"\u0410\u0434\u0440\u0435\u0441 \u0441\u0441\u044B\u043B\u043A\u0438","TextLabelCaption":"\u0422\u0435\u043A\u0441\u0442 \u0434\u043B\u044F \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F"},"RichTextEditorVideo":{"DialogTitle":"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u0432\u0438\u0434\u0435\u043E","PasteUrlTab":"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u0441\u0441\u044B\u043B\u043A\u0443","UploadFileTab":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0444\u0430\u0439\u043B","EmbedCodeTab":"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u043A\u043E\u0434","DialogDescription":"\u042D\u0442\u043E \u0432\u0438\u0434\u0435\u043E \u0431\u0443\u0434\u0435\u0442 \u0432\u0441\u0442\u0440\u043E\u0435\u043D\u043E \u0441 \u0448\u0438\u0440\u0438\u043D\u043E\u0439 640 \u043F\u0438\u043A\u0441\u0435\u043B\u0435\u0439.<br>\u0412\u0441\u0442\u0440\u043E\u0435\u043D\u043D\u043E\u0435 \u0432\u0438\u0434\u0435\u043E \u0431\u0443\u0434\u0435\u0442 \u0432\u043A\u043B\u044E\u0447\u0430\u0442\u044C \u0442\u0435\u043A\u0441\u0442\u043E\u0432\u0443\u044E \u0441\u0441\u044B\u043B\u043A\u0443.","SaveButton":"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u0432\u0438\u0434\u0435\u043E","CancelButton":"\u041E\u0442\u043C\u0435\u043D\u0430","UploadButton":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0444\u0430\u0439\u043B","InputPlaceholder":"\u0412\u0441\u0442\u0430\u0432\u044C\u0442\u0435 \u0441\u044E\u0434\u0430","DragAndDropPlaceholder":"\u041F\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0444\u0430\u0439\u043B \u0441\u044E\u0434\u0430 \u0438\u043B\u0438","NotVideoFile":"\u0412\u0441\u0442\u0430\u0432\u043B\u0435\u043D\u043D\u044B\u0439 \u0444\u0430\u0439\u043B \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u0432\u0438\u0434\u0435\u043E. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043B \u0441 \u0432\u0438\u0434\u0435\u043E\u0444\u043E\u0440\u043C\u0430\u0442\u043E\u043C.","ConfirmMessage":"\u041D\u0430 \u044D\u0442\u043E\u0439 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0435 \u0435\u0441\u0442\u044C \u043D\u0435\u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043D\u044B\u0435 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F. \u041E\u043D\u0438 \u0431\u0443\u0434\u0443\u0442 \u043F\u043E\u0442\u0435\u0440\u044F\u043D\u044B, \u0435\u0441\u043B\u0438 \u0432\u044B \u0437\u0430\u043A\u0440\u043E\u0435\u0442\u0435 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443. \u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F?"}}'),"uk-UA":JSON.parse('{"RichTextEditor":{"ToggleToolbar":"Formatting options (Alt+F10)","UploadAttachments":"\u0412\u0438\u0431\u0440\u0430\u0442\u0438 \u0432\u043A\u043B\u0430\u0434\u0435\u043D\u043D\u044F","SelectTemplate":"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u0438 \u0448\u0430\u0431\u043B\u043E\u043D","SelectionActions":{"AskCopilot":"\u0417\u0430\u043F\u0438\u0442\u0430\u0442\u0438 Creatio AI","Friendly":"\u0414\u0440\u0443\u0436\u043D\u0456\u0439","Formal":"\u0424\u043E\u0440\u043C\u0430\u043B\u044C\u043D\u0438\u0439","Shorten":"\u0421\u043A\u043E\u0440\u043E\u0442\u0438\u0442\u0438","Extend":"\u0420\u043E\u0437\u0448\u0438\u0440\u0438\u0442\u0438","Rephrase":"\u041F\u0435\u0440\u0435\u0444\u0440\u0430\u0437\u0443\u0432\u0430\u0442\u0438","RewriteCaption":"\u041F\u0435\u0440\u0435\u043F\u0438\u0441\u0430\u0442\u0438 \u0442\u0435\u043A\u0441\u0442"}},"RichTextEditorLink":{"SaveLinkButtonCaption":"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438","OpenLinkButtonCaption":"\u0412\u0456\u0434\u043A\u0440\u0438\u0442\u0438 \u0432 \u043D\u043E\u0432\u0456\u0439 \u0432\u043A\u043B\u0430\u0434\u0446\u0456","CloseLinkButtonCaption":"\u0417\u0430\u043A\u0440\u0438\u0442\u0438","UnlinkLinkButtonCaption":"\u0412\u0456\u0434\u2019\u0432\u044F\u0437\u0430\u0442\u0438","LinkLabelCaption":"\u0410\u0434\u0440\u0435\u0441\u0430 \u043F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F","TextLabelCaption":"\u0422\u0435\u043A\u0441\u0442 \u0434\u043B\u044F \u0432\u0456\u0434\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u043D\u044F"}}')};var n=u(59131);const se=new n.InjectionToken("CkeditorThemeStyleUrl");var O=u(73308),Ce=u(18081),ve=u(59445),fe=u(85638),ye=u(87368),K=u(22438),Te=u(30268),I=u(28399),h=u(62278),le=u(36486),ce=u(89422),R=u(79772),U=u(10850);function ke(l,t){if(l&1){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-button",9),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.unlink())}),n.\u0275\u0275elementEnd()}l&2&&n.\u0275\u0275property("caption",n.\u0275\u0275pipeBind1(1,1,"RichTextEditorLink.UnlinkLinkButtonCaption"))}let D=class he{get linkControl(){return this.richTextLinkForm.get("linkControl")}get displayTextControl(){return this.richTextLinkForm.get("displayTextControl")}get editor(){return this._editor}set editor(t){!this._isEditorInitialize&&t&&(this._editor=t,this._isEditorInitialize=!0)}set tooltipConfig(t){this.editor=t.value.editor,this._tooltipConfig=t}constructor(t,e,i,o,r,a){this._translate=t,this.window=e,this._changeDetector=i,this._injector=o,this._crtControlStateAdapter=r,this._element=a,this._isEditorInitialize=!1,this.isUnlinkButtonVisible=!1,this.richTextLinkForm=new w.FormGroup({linkControl:new w.FormControl("",{validators:[this._crtControlStateAdapter.transform({instance:new U.RequiredValidator(this._injector)}),this._createLinkPatternValidatorFn.bind(this)]}),displayTextControl:new w.FormControl("",{})})}_clearFields(){this.linkControl.reset(),this.linkControl.setErrors(null),this.linkControl.updateValueAndValidity(),this.displayTextControl.setValue(""),this.displayTextControl.updateValueAndValidity()}_createLinkPatternValidatorFn(t){return m.CustomValidators.linkValidator()(t)!==null?this._createValidatorErrorsMessage("InvalidLink","Validators.Link.Message"):null}_createValidatorErrorsMessage(t,e){return{[t]:{message:this._translate.instant(`${e}`)}}}_initialize(){if(!this.editor)return;const t=this.editor.getSelection()?.getSelectedText(),e=CKEDITOR.plugins.link.getSelectedLink(this.editor,!0),i=e?.[0]||null;i?.is("a")?(this.displayTextControl.setValue(i.$.innerText),this.linkControl.setValue(i.getAttribute("href"))):t&&this.displayTextControl.setValue(t),this.isUnlinkButtonVisible=e?.length>0,this._changeDetector.detectChanges(),this.focusLink()}focusLink(){setTimeout(()=>this._element.nativeElement.querySelector(".rich-text-link-container .rich-text-link-field input").focus(),0)}closeLink(){this._clearFields(),this._tooltipConfig?.onClose?.()}openLink(){this.window.open(this.linkControl.value,"_blank")}unlink(){this.editor.execCommand("unlink"),this._tooltipConfig?.onUnlink?.()}save(){if(this.richTextLinkForm.updateValueAndValidity(),this.richTextLinkForm.valid){const t={url:this.linkControl.value,linkText:this.displayTextControl.value};CKEDITOR.plugins.creatiolink.insertOrUpdateLink(t,this.editor),this._clearFields(),this._tooltipConfig?.onSave?.()}}ngOnInit(){this._initialize()}static{this.\u0275fac=function(e){return new(e||he)(n.\u0275\u0275directiveInject(R.TranslateService),n.\u0275\u0275directiveInject(k.WINDOW_TOKEN),n.\u0275\u0275directiveInject(n.ChangeDetectorRef),n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(U.CrtControlStateAdapter),n.\u0275\u0275directiveInject(n.ElementRef))}}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:he,selectors:[["crt-rich-text-link"]],inputs:{editor:"editor"},decls:14,vars:25,consts:[[1,"rich-text-link-page"],[1,"rich-text-link-container"],["data-qa","input-link",1,"rich-text-link-field",3,"keyup.enter","control","labelPosition","appearance","label"],["data-qa","input-displayText",3,"keyup.enter","control","labelPosition","appearance","label"],[1,"link-button-container"],["iconPosition","left-icon","icon","open-link","size","small","displayType","text","color","default",1,"open-link-button","link-button",3,"clicked","disabled","caption"],["class","unlink-link-button link-button","iconPosition","left-icon","icon","unlink-link","size","small","displayType","text","color","default",3,"caption","clicked",4,"ngIf"],["iconPosition","left-icon","icon","close-link","size","small","displayType","text","color","default",1,"close-link-button","link-button",3,"clicked","caption"],["icon","save-link","size","small","displayType","text","color","default",1,"save-link-button","link-button",3,"clicked","disabled","iconPosition","caption"],["iconPosition","left-icon","icon","unlink-link","size","small","displayType","text","color","default",1,"unlink-link-button","link-button",3,"clicked","caption"]],template:function(e,i){e&1&&(n.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"crt-input",2),n.\u0275\u0275pipe(3,"translate"),n.\u0275\u0275listener("keyup.enter",function(){return i.save()}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(4,"crt-input",3),n.\u0275\u0275pipe(5,"translate"),n.\u0275\u0275listener("keyup.enter",function(){return i.save()}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(6,"div",4)(7,"crt-button",5),n.\u0275\u0275pipe(8,"translate"),n.\u0275\u0275listener("clicked",function(){return i.openLink()}),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(9,ke,2,3,"crt-button",6),n.\u0275\u0275elementStart(10,"crt-button",7),n.\u0275\u0275pipe(11,"translate"),n.\u0275\u0275listener("clicked",function(){return i.closeLink()}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(12,"crt-button",8),n.\u0275\u0275pipe(13,"translate"),n.\u0275\u0275listener("clicked",function(){return i.save()}),n.\u0275\u0275elementEnd()()()()),e&2&&(n.\u0275\u0275advance(2),n.\u0275\u0275property("control",i.richTextLinkForm.controls.linkControl)("labelPosition","above")("appearance","legacy")("label",n.\u0275\u0275pipeBind1(3,15,"RichTextEditorLink.LinkLabelCaption")),n.\u0275\u0275advance(2),n.\u0275\u0275property("control",i.richTextLinkForm.controls.displayTextControl)("labelPosition","above")("appearance","legacy")("label",n.\u0275\u0275pipeBind1(5,17,"RichTextEditorLink.TextLabelCaption")),n.\u0275\u0275advance(3),n.\u0275\u0275property("disabled",i.linkControl.invalid)("caption",n.\u0275\u0275pipeBind1(8,19,"RichTextEditorLink.OpenLinkButtonCaption")),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",i.isUnlinkButtonVisible),n.\u0275\u0275advance(),n.\u0275\u0275property("caption",n.\u0275\u0275pipeBind1(11,21,"RichTextEditorLink.CloseLinkButtonCaption")),n.\u0275\u0275advance(2),n.\u0275\u0275property("disabled",i.richTextLinkForm.invalid)("iconPosition","left-icon")("caption",n.\u0275\u0275pipeBind1(13,23,"RichTextEditorLink.SaveLinkButtonCaption")))},dependencies:[E.NgIf,g.CrtButtonComponent,g.CrtInputComponent,R.TranslatePipe],styles:[".rich-text-link-page[_ngcontent-%COMP%]{width:500px;box-shadow:0 2px 4px #0003;border-radius:4px;padding:16px 16px 0}.link-button-container[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center;justify-content:right;margin:12px 0}"]})}};D=(0,c.__decorate)([(0,s.CrtViewElement)({type:"crt.RichTextLinkComponent"}),(0,c.__metadata)("design:paramtypes",[R.TranslateService,Window,n.ChangeDetectorRef,n.Injector,U.CrtControlStateAdapter,n.ElementRef])],D);var de=u(76923);function Se(l,t){if(l&1){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"crt-rich-text-url-video",12),n.\u0275\u0275listener("valueChanged",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onValueChanged())})("videoUploaded",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(r.onVideoUploaded(o))}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()}}function Ee(l,t){if(l&1){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"crt-rich-text-local-video",13),n.\u0275\u0275listener("valueChanged",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onValueChanged())})("videoUploaded",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(r.onVideoUploaded(o))}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()}if(l&2){const e=n.\u0275\u0275nextContext();n.\u0275\u0275advance(),n.\u0275\u0275property("editor",e.editor)("dataValue",e.data==null?null:e.data.value)("primaryDataSchemaName",e.data==null?null:e.data.primaryDataSchemaName)}}function we(l,t){if(l&1){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275elementStart(1,"crt-rich-text-embed-video",12),n.\u0275\u0275listener("valueChanged",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onValueChanged())})("videoUploaded",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(r.onVideoUploaded(o))}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()}}var G;(function(l){l[l.Url=0]="Url",l[l.Local=1]="Local",l[l.Embeded=2]="Embeded"})(G||(G={}));class F{constructor(){this.destroy$=new h.Subject,this.videoUploaded=new n.EventEmitter,this.valueChanged=new n.EventEmitter}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(e){return new(e||F)}}static{this.\u0275dir=n.\u0275\u0275defineDirective({type:F,outputs:{videoUploaded:"videoUploaded",valueChanged:"valueChanged"}})}}let N=class ue{constructor(t,e,i,o,r){this.data=t,this._notifyService=e,this._translateService=i,this._messageDialogProvider=o,this._dialog=r,this._destroy$=new h.Subject,this.tabItems=[],this.currentTabIndex=G.Url,this.hasUnsavedChanges=!1,this.TabType=G,this.editor=t?.value?.editor}_initDialogTabs(){const t=this._translateService.instant("RichTextEditorVideo.PasteUrlTab"),e=this._translateService.instant("RichTextEditorVideo.UploadFileTab"),i=this._translateService.instant("RichTextEditorVideo.EmbedCodeTab");this.tabItems=[{caption:t,name:"PasteUrlTab",iconPosition:K.IconPositionEnum.OnlyText,type:"crt.GridContainer"},{caption:e,name:"UploadFileTab",iconPosition:K.IconPositionEnum.OnlyText,type:"crt.GridContainer"},{caption:i,name:"EmbedCodeTab",iconPosition:K.IconPositionEnum.OnlyText,type:"crt.GridContainer"}]}_listenChildRemoved(t){const e=t.firstChild;if(!e)return;const i=new MutationObserver(o=>{o.forEach(r=>{r.removedNodes.forEach(a=>{a===e&&(t?.remove(),i.disconnect())})})});i.observe(t,{childList:!0})}_addResizeListeners(){setTimeout(()=>{document.querySelectorAll(".resizable-video-wrapper").forEach(e=>{e.addEventListener("mousemove",()=>{if(getComputedStyle(e).resize!=="none"){const i=e.getBoundingClientRect();e.style.width=`${i.width}px`,e.style.height=`${i.height}px`}}),this._listenChildRemoved(e)})},0)}_checkUnsavedChanges(){return!this.currentTab||this.currentTab.hasUnsavedChanges()}_handleSecurityPolicyViolation(t){const e=`
			Blocked URI: ${t.blockedURI}
			Directive: ${t.violatedDirective}
			Document URI: ${t.documentURI}
		`;this._notifyService.show({message:e})}onTabChanged(t){this.currentTabIndex=t}onSaveClick(){!this.currentTab||!this.currentTab.hasUnsavedChanges()||this.currentTab.onSaveClick()}onVideoUploaded(t){const e=`<div contenteditable="false" class="resizable-video-wrapper">${t}</div>`;this.editor.insertHtml(e),this._addResizeListeners(),this._dialog.close()}onCloseClick(){if(this.currentTab)if(this.currentTab.hasUnsavedChanges()){const t=this._translateService.instant("RichTextEditorVideo.ConfirmMessage");this._messageDialogProvider.confirmation(t).pipe((0,h.takeUntil)(this._destroy$)).subscribe(e=>{e&&this._dialog.close()})}else this._dialog.close()}ngOnInit(){this._initDialogTabs(),document.addEventListener("securitypolicyviolation",this._handleSecurityPolicyViolation.bind(this))}onValueChanged(){this.hasUnsavedChanges=this._checkUnsavedChanges()}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete(),document.removeEventListener("securitypolicyviolation",this._handleSecurityPolicyViolation.bind(this))}static{this.\u0275fac=function(e){return new(e||ue)(n.\u0275\u0275directiveInject(de.MAT_LEGACY_DIALOG_DATA),n.\u0275\u0275directiveInject(C.NotifyService),n.\u0275\u0275directiveInject(R.TranslateService),n.\u0275\u0275directiveInject(g.MessageDialogProvider),n.\u0275\u0275directiveInject(de.MatLegacyDialogRef))}}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:ue,selectors:[["crt-rich-text-video"]],viewQuery:function(e,i){if(e&1&&n.\u0275\u0275viewQuery(F,5),e&2){let o;n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(i.currentTab=o.first)}},decls:20,vars:19,consts:[[1,"rich-text-video"],[1,"rich-text-video__container"],[1,"rich-text-video__header"],["labelType","headline-2","labelEllipsis","true","tabindex","0",1,"rich-text-video__header__title",3,"caption"],["icon","close-button-icon","iconPosition","icon-only","size","medium","color","default","clickMode","default",1,"rich-text-video__buttons_close",3,"clicked"],[3,"selectedTabIndexChange","items","showTabViewModelContent"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"rich-text-video__description",3,"innerHtml"],[1,"rich-text-video__buttons"],[1,"rich-text-video__buttons_action",3,"clicked"],["color","primary",1,"rich-text-video__buttons_action",3,"clicked","disabled"],[3,"valueChanged","videoUploaded"],[3,"valueChanged","videoUploaded","editor","dataValue","primaryDataSchemaName"]],template:function(e,i){e&1&&(n.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),n.\u0275\u0275element(3,"crt-label",3),n.\u0275\u0275pipe(4,"translate"),n.\u0275\u0275elementStart(5,"crt-button",4),n.\u0275\u0275listener("clicked",function(){return i.onCloseClick()}),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(6,"crt-tab-panel",5),n.\u0275\u0275listener("selectedTabIndexChange",function(r){return i.onTabChanged(r)}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerStart(7,6),n.\u0275\u0275template(8,Se,2,0,"ng-container",7)(9,Ee,2,3,"ng-container",7)(10,we,2,0,"ng-container",7),n.\u0275\u0275elementContainerEnd(),n.\u0275\u0275element(11,"label",8),n.\u0275\u0275pipe(12,"translate"),n.\u0275\u0275elementStart(13,"div",9)(14,"crt-button",10),n.\u0275\u0275listener("clicked",function(){return i.onCloseClick()}),n.\u0275\u0275text(15),n.\u0275\u0275pipe(16,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(17,"crt-button",11),n.\u0275\u0275listener("clicked",function(){return i.onSaveClick()}),n.\u0275\u0275text(18),n.\u0275\u0275pipe(19,"translate"),n.\u0275\u0275elementEnd()()()()),e&2&&(n.\u0275\u0275advance(3),n.\u0275\u0275property("caption",n.\u0275\u0275pipeBind1(4,11,"RichTextEditorVideo.DialogTitle")),n.\u0275\u0275advance(3),n.\u0275\u0275property("items",i.tabItems)("showTabViewModelContent",!1),n.\u0275\u0275advance(),n.\u0275\u0275property("ngSwitch",i.currentTabIndex),n.\u0275\u0275advance(),n.\u0275\u0275property("ngSwitchCase",i.TabType.Url),n.\u0275\u0275advance(),n.\u0275\u0275property("ngSwitchCase",i.TabType.Local),n.\u0275\u0275advance(),n.\u0275\u0275property("ngSwitchCase",i.TabType.Embeded),n.\u0275\u0275advance(),n.\u0275\u0275property("innerHtml",n.\u0275\u0275pipeBind1(12,13,"RichTextEditorVideo.DialogDescription"),n.\u0275\u0275sanitizeHtml),n.\u0275\u0275advance(4),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(16,15,"RichTextEditorVideo.CancelButton")," "),n.\u0275\u0275advance(2),n.\u0275\u0275property("disabled",!i.hasUnsavedChanges),n.\u0275\u0275advance(),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(19,17,"RichTextEditorVideo.SaveButton")," "))},styles:[".rich-text-video[_ngcontent-%COMP%]{height:100%;border-radius:8px;padding:24px 32px 0}.rich-text-video__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:100%;padding-bottom:16px}.rich-text-video__input[_ngcontent-%COMP%]{margin-top:1px;display:block;height:154px}.rich-text-video__buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;flex-flow:row nowrap;margin-top:16px;margin-bottom:32px}.rich-text-video__buttons_action[_ngcontent-%COMP%]{margin-left:16px}.rich-text-video__buttons_upload[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:16px}"]})}};N=(0,c.__decorate)([(0,s.CrtViewElement)({type:"crt.RichTextVideoComponent"}),(0,c.__metadata)("design:paramtypes",[Object,C.NotifyService,R.TranslateService,g.MessageDialogProvider,de.MatLegacyDialogRef])],N);var Re=u(35266);class B{static{this.fileIconImageCssClass="file-icon-system-image"}static getLastSnapshotContent(t){const e=t.undoManager.snapshots;return e[e.length-1].contents}static getEditorImages(t){const e=t.editable().$.getElementsByTagName("img");return Array.from(e).filter(i=>!i.classList.contains(this.fileIconImageCssClass))}static getThemeCssLink(t,e){const i=t.styleSheets;let o;for(let r=0;r<i.length;r++)if(i[r].href&&(o=o??i[r].href,i[r].href?.toLowerCase().indexOf(e)>-1))return i[r].href;return o}static appendLink(t,e){function i(r){const a=document.createElement("link");return a.rel="stylesheet",a.type="text/css",a.href=r,a.media="all",a}function o(r,a){function d(b){const y=b.indexOf("?");return y>=0?b.substr(0,y):b}const p=d(a),_=r.getElementsByTagName("link");for(let b=0;b<_.length;b++)if(d(_[b].href).endsWith(p.replace("./","")))return!0;return!1}e&&!o(t,e)&&t.appendChild(i(e))}}class Le{constructor(t,e,i){this._contactColorService=t,this._initialsService=e,this._matIconRegistry=i,this._getMentionsWithDebounce=(0,I.debounce)(this._getMentions,500),this._mentionStyles="padding-inline-start: 5px;padding-inline-end: 10px;margin-top: 2px;margin-inline-start: 2px;border-radius: 16px;text-decoration: none;max-width: calc(100% - 10px);display: inline-flex;max-height: 1.23em;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;line-height: 1.23em;vertical-align: text-bottom;",this._mentionUserIconStyles="display: inline-flex;height: 2em;line-height: 1.9em;margin-inline-end: 5px;border-radius: 50%;width: 2em;align-self: center;color: white;font-size: 0.6em;justify-content: space-evenly;box-sizing: border-box;font-weight: 400;",this._generalUserMentionStyles="color: var(--crt-palette-primary-500);background-color: var(--crt-palette-interaction-900);",this._externalUserMentionStyles="color: var(--crt-palette-success-700);background-color: var(--crt-palette-success-100);",this._initialsBorderStyle="border: 1px solid var(--crt-palette-border-400)",this._loadExternalUserIcon()}_loadExternalUserIcon(){this._matIconRegistry.getNamedSvgIcon("external-user-type-icon").pipe((0,h.catchError)(()=>(0,h.of)(null))).subscribe(t=>{if(t){const e=(0,m.convertImageToBase64String)(t.outerHTML);this._userIcon=`data:image/svg+xml;base64,${e}`}})}_getPhotoUrl(t){return!t||(0,s.isEmptyGuid)(t)?"":(0,m.getImageFullUrlById)(t)}_mapMention(t){const e=t.connectionType===`${m.UserConnectionType.External}`,i=this._getPhotoUrl(t.primaryImageValue),o=!(0,I.isEmpty)(i),r=o?"":this._contactColorService.getNextColor(t.value),a=this._mentionStyles+(e?this._externalUserMentionStyles:this._generalUserMentionStyles),d=o?this._mentionUserIconStyles:"display:none;";let p="display:none;";o||(p=this._mentionUserIconStyles+`background: ${r};`+this._initialsBorderStyle);const _=this._initialsService.getInitials(t.displayValue),b=e?this._userIcon:"",y=JSON.stringify(t);return{id:t.value,name:t.displayValue,icon:i,typeIcon:b,pageUrl:(0,m.getEntityUrl)("Contact",t.value),styles:a,iconStyles:d,initialsStyles:p,initials:_,shortInitials:(0,I.isEmpty)(_)?"":_[0],color:r,contactDto:encodeURIComponent(y)}}_getMentions(t){this._mentionRequestOptions=t;const{mentionsService:e,queryString:i,callback:o}=t;e.getContacts(i).pipe((0,h.catchError)(()=>(0,h.of)(null))).subscribe(r=>{o&&o(r?.map(a=>this._mapMention(a))),this._processQueuedRequest(i)})}_processQueuedRequest(t){this._mentionRequestOptions&&this._mentionRequestOptions.queryString!==t?this._getMentions(this._mentionRequestOptions):this._mentionRequestOptions=null}getMentionsWithDebounce(t,e,i){if(!t)return i([]);if(this._mentionRequestOptions){this._mentionRequestOptions={mentionsService:t,queryString:e,callback:i};return}e===""?this._getMentions({mentionsService:t,queryString:e,callback:i}):this._getMentionsWithDebounce({mentionsService:t,queryString:e,callback:i})}getMentionsFromHtml(t){if((0,I.isEmpty)(t))return[];const e=new RegExp(/mention-info="(.+?)"/gi);return[...t.matchAll(e)].map(i=>{try{const o=decodeURIComponent(i[1]),r=JSON.parse(o);return r.value?r:null}catch{return null}}).filter(i=>!!i)}}var Oe=u(51521);class W{constructor(t){this._markdownService=t,this._highlightClass="rich-editor-highlight",this._wrapperClass="rich-editor-highlight-wrapper"}_highlightElements(t){const e=[],i=new CKEDITOR.dom.walker(t);let o;for(;o=i.next();)if(o.type===CKEDITOR.NODE_TEXT)e.push(o);else if(o.contains(t.endContainer)){e.push(o);break}e.forEach(r=>{this._wrapElements(r,t)})}_wrapElements(t,e){if(t.type===CKEDITOR.NODE_TEXT){const i=t.getUniqueId()===e.startContainer.getUniqueId()?e.startOffset:0,o=t.getUniqueId()===e.endContainer.getUniqueId()?e.endOffset:0;this._wrapTextElement(t,i,o)}else{const i=t.getChildren();for(let o=0;o<i.count();o++)this._wrapElements(i.getItem(o),e)}}_wrapTextElement(t,e=0,i=0){const o=this._createWrapElement(this._wrapperClass),r=t.getText();if(e>0&&i===0){const a=r.slice(0,e),d=new CKEDITOR.dom.text(a);o.append(d);const p=r.slice(e),_=this._createWrapElement();_.setHtml(p),o.append(_)}else if(e===0&&i>0){const a=r.slice(0,i),d=this._createWrapElement();d.setHtml(a),o.append(d);const p=r.slice(i),_=new CKEDITOR.dom.text(p);o.append(_)}else if(e>0&&i>0){const a=r.slice(0,e),d=new CKEDITOR.dom.text(a);o.append(d);const p=r.slice(e,i),_=this._createWrapElement();_.setHtml(p),o.append(_);const b=r.slice(i),y=new CKEDITOR.dom.text(b);o.append(y)}else if(e===0||i===0){const a=this._createWrapElement();a.setHtml(r),o.append(a)}o.replace(t)}_createWrapElement(t=this._highlightClass){const e=new CKEDITOR.dom.element("span");return(0,I.isEmpty)(t)||e.setAttribute("class",t),e}_removeHighlighting(t){this._getElementsBySelector(t,this._highlightClass).toArray().forEach(o=>{o.remove(!0)}),this._getElementsBySelector(t,this._wrapperClass).toArray().forEach(o=>{o.remove(!0)})}_removeSelection(t){if(!this.isEditorContainingSelection(t))return;t.getSelection()?.removeAllRanges(),getSelection()?.empty()}_getElementsBySelector(t,e){return t.editable().find("."+e)}_createRange(t,e,i){const o=t.createRange();return o.setStartBefore(e),o.setEndAfter(i),o}_cleanUpRange(t){const e=["ul","ol"],i=o=>{o.getText()===""&&e.includes(o.getName())&&o.remove(!1)};t?.deleteContents(),t.startContainer?.getChildren().toArray().forEach(o=>i(o))}_retrieveSelectionNodes(t){const e=document.createElement("div");e.innerHTML=t;const i=[];return Array.from(e.childNodes).forEach(o=>{const r=new CKEDITOR.dom.element(o),a=new CKEDITOR.dom.node(r.$);i.push(a)}),i}_sanitizeHtmlSelection(t){let e=t.replace(/&#10;/g,"");const i=["p"];for(const o of i)e=this._trimStartTag(e,o);return e}_trimStartTag(t,e){const i=new RegExp(`^<${e}>(.*?)</${e}>`),o=new RegExp(`(<${e}>[^<]*</${e}>)(?!.*<${e}>[^<]*</${e}>)`,"i");return t.replace(i,"$1").replace(o,r=>r.replace(/<\/?p>/gi,""))}highlightSelection(t){if(!t||t.readOnly)return;this._removeHighlighting(t),t.getSelection().getRanges().forEach(o=>{t.fire("saveSnapshot"),this._highlightElements(o)}),this.clearSelection(t),t.fire("saveSnapshot")}removeHighlight(t){!t||t.readOnly||(this._removeHighlighting(t),this._removeSelection(t))}isEditorContainingSelection(t){const e=getSelection();return!e||!t?!1:!!t?.container?.$?.contains(e?.focusNode)}clearSelection(t){!t||t.readOnly||this._removeSelection(t)}replaceSelection(t,e){if(!t||t.readOnly)return;const i=this._getElementsBySelector(t,this._highlightClass);if(i.count()===0)return;const o=i.getItem(0),r=i.getItem(i.count()-1),a=this._markdownService.parse(e.selection),d=this._sanitizeHtmlSelection(a),p=this._retrieveSelectionNodes(d);switch(e.editorAction){case m.ChatMessageActionType.Replace:{const _=this._createRange(t,o,r);this._cleanUpRange(_);for(let b=p.length-1;b>=0;b--)_.insertNode(p[b]);break}case m.ChatMessageActionType.InsertAbove:for(let _=0;_<p.length;_++)o.insertBeforeMe(p[_]);break;case m.ChatMessageActionType.InsertBelow:for(let _=p.length-1;_>=0;_--)p[_].insertAfter(r);break}this.removeHighlight(t)}selectHighlighted(t){if(!t||t.readOnly)return;const e=this._getElementsBySelector(t,this._highlightClass),i=e.getItem(0),o=e.getItem(e.count()-1);if(!i||!o)return;this._removeSelection(t);const r=this._createRange(t,i,o),a=t.getSelection();a.selectRanges([r]);const d=a.createBookmarks(r);this._removeHighlighting(t),a.selectBookmarks(d),t.fire("saveSnapshot")}static{this.\u0275fac=function(e){return new(e||W)(n.\u0275\u0275inject(Oe.MarkdownService))}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:W,factory:W.\u0275fac})}}class ee{static{this._wrapperClass="crt-table-of-contents"}static{this._translatePrefix="RichTextEditor"}static _getTranslate(t){return this._translateService.instant(`${this._translatePrefix}.${t}`)}static _insertTableOfContentsPlaceholder(t){const e=`<div contenteditable="false" class="${this._wrapperClass}">
		<div class="placeholder">
			<div class="title-wrapper">
				<img src="${CKEDITOR.plugins.getPath("crtTableOfContents")+"icon.svg"}"></img>
				<span class="title">${this._getTranslate("TableOfContents.Title")}</span>
			</div>
			${this._getTranslate("TableOfContents.Placeholder")}
		</div></div><br/>`;t.editor.insertHtml(e)}static _buildNestedList(t){const e=this._renderer.createElement("ul"),i=[{level:0,list:e}];return t.forEach(o=>{if(!o.id)return;const r=parseInt(o.tagName[1]),a=this._renderer.createElement("li"),d=this._createLink(o);this._appendLinkToItem(a,d),this._updateStack(i,r),this._appendItemToList(i,a,r)}),e}static _createLink(t){const e=this._renderer.createElement("a");return this._renderer.setAttribute(e,"href",`#${t.id}`),this._renderer.setProperty(e,"textContent",t.textContent),this._renderer.setAttribute(e,"tabIndex","0"),e}static _appendLinkToItem(t,e){this._renderer.appendChild(t,e)}static _updateStack(t,e){for(;t.length>1&&t[t.length-1].level>=e;)t.pop()}static _appendItemToList(t,e,i){if(t[t.length-1].level<i){const o=this._renderer.createElement("ul");this._renderer.appendChild(t[t.length-1].list,o),this._renderer.appendChild(o,e),t.push({level:i,list:o})}else this._renderer.appendChild(t[t.length-1].list,e),t.push({level:i,list:t[t.length-1].list})}static init(t){this._translateService=t.get(R.TranslateService);const e=t.get(n.RendererFactory2);this._renderer=e.createRenderer(null,null)}static subscribeEvents(t){t.on("CrtInsertTableOfContentsPlaceholder",this._insertTableOfContentsPlaceholder.bind(this))}static generateTableOfContents(t){const e=t?.editable?.()?.$,i=e?.getElementsByClassName(this._wrapperClass)||[];if(i.length<1)return;const o=e.querySelectorAll("h1, h2, h3, h4, h5, h6");o.length!==0&&(Array.from(o).filter(r=>r.innerText.trim()!=="").forEach((r,a)=>{r.id||(r.id=`crtHeader${a+1}`)}),Array.from(i).forEach(r=>{r.innerHTML="",r.appendChild(this._buildNestedList(o)),setTimeout(()=>{r.setAttribute("contenteditable","false")},0)}))}}class M{constructor(t,e,i){this._fileApiService=t,this._fileService=e,this.queryExecutor=i,this._sysDownloadMethod="/rest/FileService/Download"}_replaceSrc(t,e,i){t.removeAttribute("data-cke-saved-src"),t.setAttribute("src",e),t.setAttribute("data-uploaded-image-id",i)}_getFileType(t){const e=t.match(/data:(.*);base64/);return e?e[1]:null}_mapFileDto(t,e){return{...t,id:(0,s.generateGuid)(),fileEntitySchemaName:e.fileSchemaName||"SysFile",recordColumnName:e.recordColumnName||"RecordId",recordEntitySchemaName:e.schemaName,recordId:e.recordId,tag:"inline"}}_getFile(t,e,i){const o=this._getFileData(t,e);return new File([o],i,{type:e})}_getFileData(t,e){const i=t.split(";base64,"),o=window.atob(i[1]),r=new Array(o.length);for(let p=0;p<o.length;p++)r[p]=o.charCodeAt(p);const a=new Uint8Array(r);return new Blob([a],{type:e})}_getImageIdentifiers(t){const e=/data-uploaded-image-id="([^"]*)"/gim,i=[];let o=e.exec(t);for(;o!=null;)i.push(o[1]),o=e.exec(t);return i}_catchErrorResponse(t){return console.error(t),(0,h.of)({success:!1,errorInfo:{errorCode:null,message:t.message,stackTrace:t.stack},result:null})}_getDeleteQuery(t){const e=new s.DeleteQuery("SysFile");return e.filters.addSchemaColumnInFilterWithParameters(s.ComparisonType.Equal,"Id",t),e}getUploadUrl(t){return"/"+(0,m.joinPath)((0,m.getAppUrl)(),this._sysDownloadMethod,t.fileEntitySchemaName||"SysFile",t.id)}uploadImages(t,e){const i=t.map(o=>{const r=B.getEditorImages(o),a=[];e.fileSchemaName=e.fileSchemaName||o.config.fileStorageName,e.recordColumnName=e.recordColumnName||o.config.recordColumnName;for(let d=0;d<r?.length;d++){const p=r[d],_=p.getAttribute("src"),b=p.getAttribute("crt-file-name"),y=this._getFileType(_);if(y){const q=y.match(/\/(\w+)/)?.[1],Y=(0,s.generateGuid)();let oe=b||`${e.schemaName}_${e.recordId}_${Y}`;q&&!b&&(oe+=`.${q}`),a.push({element:p,file:this._getFile(_,y,oe),fileId:Y})}}return{editor:o,imageFiles:a}}).filter(o=>o.imageFiles.length>0);return i.length===0?(0,h.of)(!1):(0,h.from)(i).pipe((0,h.concatMap)(o=>(0,h.from)(o.imageFiles).pipe((0,h.concatMap)(r=>(0,h.zip)(this._fileService.read(r.file),(0,h.of)(r))),(0,h.map)(r=>({dto:this._mapFileDto(r[0],e),image:r[1]})),(0,h.concatMap)(r=>this._fileApiService.upload(r.dto).pipe((0,h.map)(()=>(this._replaceSrc(r.image.element,this.getUploadUrl(r.dto),r.dto.id),o.editor.fire("change"),!0)),(0,h.catchError)(a=>this._catchErrorResponse(a).pipe((0,h.map)(d=>d.success))))),(0,h.toArray)(),(0,h.map)(r=>r.some(a=>a===!0)))),(0,h.toArray)(),(0,h.map)(o=>o.some(r=>r===!0)))}removeImages(t){t.forEach(e=>{const i=this._getImageIdentifiers(B.getLastSnapshotContent(e)),o=this._getImageIdentifiers(e.getData()),r=i.filter(a=>!o.includes(a));if(r.length>0){const a=this._getDeleteQuery(r);this.queryExecutor.execute(a).pipe((0,h.map)(()=>({success:!0,errorInfo:null,result:[]})),(0,h.catchError)(d=>this._catchErrorResponse(d))).subscribe()}})}uploadFile(t,e,i){const o=t.filter(r=>r.uploadFilesData);return(0,h.from)(o).pipe((0,h.concatMap)(r=>{const{readyToUploadFiles:a,uploadEvent:d}=r.uploadFilesData,p=r.uploadFilesData.filesStorage;return d.stop(),(0,h.from)(a).pipe((0,h.concatMap)(_=>this._fileService.read(_.file).pipe((0,h.map)(b=>{let y=p.masterRecordColumnValue?i[p.masterRecordColumnValue.replace("$","")]:e.recordId;return y=y?.value?y.value:y,{...b,id:_.fileId,fileEntitySchemaName:p.entitySchemaName,recordColumnName:p.recordColumnName,recordEntitySchemaName:p.recordEntitySchemaName||e.schemaName,recordId:y}}),(0,h.concatMap)(b=>this._fileApiService.upload(b).pipe((0,h.catchError)(y=>(y?.status!==200&&r.fire("CreatioFileUploadFailed",{fileName:b.file.name}),this._catchErrorResponse(y))))))),(0,h.toArray)())}),(0,h.toArray)())}updateColumnValue(t,e,i){const o=new s.UpdateQuery(t);return i.forEach(r=>{o.addColumn(r.name,r.value,s.DataValueType.Text)}),o.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,"Id",e),this.queryExecutor.executeUpdateQuery(o)}static{this.\u0275fac=function(e){return new(e||M)(n.\u0275\u0275inject(m.FileApiService),n.\u0275\u0275inject(m.FileReaderService),n.\u0275\u0275inject(Re.QueryExecutor))}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:M,factory:M.\u0275fac,providedIn:"any"})}}const Ie=["EmailMiniPage","CommunicationsPanel_FeedsTab"];class j{constructor(t,e,i){this._translateService=t,this._sysSettingsService=e,this._featureValues=i}_createAttribute(t,e,i){const o=t.viewModelConfig.attributes;return o[e]={value:i},e}_rewriteOptionsAvailable(t,e){var i=this;return(0,O.A)(function*(){return i._featureValues.SelectionRewriteActions&&i._featureValues["GenAIFeatures.Copilot"]&&i._featureValues.SidebarExtensions&&!e.disableSelectionOptions&&(yield i._useNewShell())&&!Ie.includes(t)})()}_useNewShell(){var t=this;return(0,O.A)(function*(){return(yield t._sysSettingsService.getByCode("UseNewShell"))?.value})()}setRewriteOptions(t,e){var i=this;return(0,O.A)(function*(){if(!(yield i._rewriteOptionsAvailable(t.name,e))){e.disableSelectionOptions=!0;return}const o=(0,I.isEmpty)(e.selection)?i._createAttribute(t,`${e.name}_Selection`,""):e.selection.replace("$","");e.selection=`$${o}`,(0,I.isEmpty)(e.selectionActions)&&(e.selectionActions=[{type:"crt.Button",icon:"copilot-rewrite-btn-icon",color:"outline",iconPosition:K.IconPositionEnum.OnlyIcon,clickMode:"menu",menuItems:[{type:"crt.MenuLabel",caption:i._translateService.instant("RichTextEditor.SelectionActions.RewriteCaption")},{type:"crt.MenuItem",caption:i._translateService.instant("RichTextEditor.SelectionActions.Friendly"),icon:"copilot-rewrite-friendly-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:o,rewriteAction:"Friendly"}}},{type:"crt.MenuItem",caption:i._translateService.instant("RichTextEditor.SelectionActions.Formal"),icon:"copilot-rewrite-formal-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:o,rewriteAction:"Formal"}}},{type:"crt.MenuItem",caption:i._translateService.instant("RichTextEditor.SelectionActions.Shorten"),icon:"copilot-rewrite-shorten-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:o,rewriteAction:"Shorten"}}},{type:"crt.MenuItem",caption:i._translateService.instant("RichTextEditor.SelectionActions.Extend"),icon:"copilot-rewrite-extend-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:o,rewriteAction:"Extend"}}},{type:"crt.MenuItem",caption:i._translateService.instant("RichTextEditor.SelectionActions.Rephrase"),icon:"copilot-rewrite-rephrase-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:o,rewriteAction:"Rephrase"}}},{type:"crt.MenuDivider"},{type:"crt.MenuItem",caption:i._translateService.instant("RichTextEditor.SelectionActions.AskCopilot"),icon:"copilot-action-button-icon",clicked:{request:"crt.SelectionActionRequest",params:{selectionAttributeName:o,rewriteAction:"AskCopilot"}}}]}])})()}static{this.\u0275fac=function(e){return new(e||j)(n.\u0275\u0275inject(R.TranslateService),n.\u0275\u0275inject(s.SysSettingsService),n.\u0275\u0275inject(m.FEATURE_VALUES))}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:j,factory:j.\u0275fac,providedIn:"any"})}}class H{constructor(){this._editorClassName=".cke_editable"}_setSelectionActionsVisibility(t,e){if(t){const i=this._getSelectionActionsPanelPosition();e.nativeElement.style.display="unset",e.nativeElement.style.top=i.clientY,e.nativeElement.style.left=i.clientX}else e.nativeElement.style.display="none"}_getSelectionActionsPanelPosition(){return this._getPositionFromSelection()||{clientX:"50%",clientY:"50%"}}_getPositionFromSelection(){const t=getSelection()?.getRangeAt(0)?.getClientRects(),e=Array.from(t||[]);if(e.length===0)return null;let i=e[0];const o=getSelection()?.getRangeAt(0)?.getBoundingClientRect();return e.forEach(r=>{(r.top>i.top||r.top===i.top&&r.right>i.right)&&(i=r)}),{clientX:`${Math.min(i.right,o.right)}px`,clientY:`${i.bottom}px`}}updatePosition(t,e){if(!t)return!1;const i=getSelection(),o=i?.type==="Range",r=e?.contains(i?.focusNode),d=!!(i.focusNode?.nodeType===Node.ELEMENT_NODE?i.focusNode:i.focusNode?.parentElement)?.closest(this._editorClassName),p=o&&r&&d;return this._setSelectionActionsVisibility(p,t),p}static{this.\u0275fac=function(e){return new(e||H)}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:H,factory:H.\u0275fac,providedIn:"any"})}}class Fe{constructor(t,e){this._injector=t,this.dialogName=e,this.componentFactoryResolver=t.get(n.ComponentFactoryResolver)}createComponent(t){return this.componentFactoryResolver.resolveComponentFactory(t).create(this._injector)}overrideDialog(t,e){if(!this.dialogName||this.dialogName!==t.data.name)return;const i=this,o=t.data.definition,r=t.editor.document;o.onShow=function(){i.onDialogOpen(this,r,e)}}}class Ae extends Fe{constructor(){super(...arguments),this._customComboboxClass="custom-combobox-input",this._customDialogBodyClass="code-snippet-override",this._focusSelectors=["a.cke_dialog_close_button",".cke_dialog_ui_select .crt-base-input-container input",".cke_dialog_ui_select .crt-base-input-container .combobox-expander.clear",".cke_dialog_ui_select .crt-base-input-container .combobox-expander.closed","textarea.cke_dialog_ui_input_textarea","a.cke_dialog_ui_button_cancel","a.cke_dialog_ui_button_ok"]}_replaceButtons(t){const e=t.findOne(".cke_dialog_footer");if(!e)return;const i=e.findOne(".cke_dialog_ui_button_ok"),o=e.findOne(".cke_dialog_ui_button_cancel");if(i&&o){const r=i.getParent(),a=o.getParent();if(r.getIndex()<a.getIndex()){const d=r.getParent();d.append(a),d.append(r)}}}_replaceCloseIcon(t){const e=t.findOne(".cke_dialog_close_button");if(!e)return;const i=e.findOne("span");if(i){const o=this.createComponent(S.MatIcon);o.instance.svgIcon="close",o.location.nativeElement.classList.add("close-button-icon"),i.$.replaceWith(o.location.nativeElement)}}_replaceCombobox(t,e){const i=t.getContentElement("info","lang");if(!i)return;const o=e.findOne(".cke_dialog_ui_select");if(!o)return;const r=o.findOne(`.${this._customComboboxClass}`);r&&r.remove();const a=this._createAndSetupCombobox(i);o.$.appendChild(a.location.nativeElement);const d=a.instance.control.value;a.instance.control.setValue(d)}_createAndSetupCombobox(t){const e=this.createComponent(g.CrtComboBoxComponent),i=t.items.map(([d,p])=>({displayValue:d,value:p||"-"}));e.instance.items=i,e.instance.label=t.label,e.instance.labelPosition="above";const o=t.getValue(),r=new w.FormControl(i.find(d=>d.value===o)??i[0]);return e.instance.control=r,e.instance.readonly=!1,e.instance.required=!0,e.instance.useStaticFiltering=!1,e.instance.showList.subscribe(d=>{e.instance.items=d?.filterValue?i.filter(p=>p.displayValue.includes(d.filterValue)):i}),e.instance.showValueAsLink=!0,e.instance.listActions=[],e.instance.valueChange.subscribe(d=>{if(!d||typeof d=="string")return;const p=d.value!=="-"?d.value:"";t.setValue(p)}),t.on("change",()=>{const d=t.getValue(),p=i.find(_=>_.value===d)??i[0];r.setValue(p,{emitEvent:!1})}),e.location.nativeElement.classList.add(this._customComboboxClass),e.location.nativeElement.classList.add("crt-base-edit-input"),e.location.nativeElement.querySelector(".crt-base-input-container input")?.addEventListener("blur",()=>this._removeComboboxInputFocus(e.location.nativeElement)),setTimeout(()=>{const p=e.instance.autocomplete?.autoCompleteTrigger?.autocomplete;p&&p.optionActivated.subscribe(()=>{e.changeDetectorRef.detectChanges()})},0),e}_removeComboboxInputFocus(t){const e="mat-focused",i=t.querySelector(".crt-autocomplete-input-control-container");i&&i.classList.contains(e)&&i.classList.remove(e)}_changeDialogZindex(t,e){const i=t.findOne(`.cke_dialog_container.cke_editor_${e}_dialog`);i&&i.setStyle("z-index","1010");const o=t.findOne(".cke_dialog_background_cover");o&&o.setStyle("z-index","1000");const r=t.getById(`cke_${e}`);r&&r.setStyle("z-index","999")}_initDialogFocusLogic(t){t.on("keydown",e=>{const i=e.data.getKeystroke();(i===27||i===13||[37,38,39,40].includes(i))&&e.stop()},this,null,-1),t.$.addEventListener("keydown",e=>{if(e.key!==ce.Key.Tab)return;const i=e.target,o=this._focusSelectors.findIndex(r=>i.matches(r));o!==-1&&(e.preventDefault(),this._focusNextElement(o,e.shiftKey))})}_focusNextElement(t,e,i=!1){const o=e?(t-1+this._focusSelectors.length)%this._focusSelectors.length:(t+1)%this._focusSelectors.length,r=document.querySelector(this._focusSelectors[o]);if(!r&&!i){this._focusNextElement(o,e,!0);return}setTimeout(()=>{r.focus()},0)}onDialogOpen(t,e,i){this._changeDialogZindex(e,i);const o=t.getElement();o.addClass(this._customDialogBodyClass),o.removeAllListeners(),this._replaceCloseIcon(o),this._replaceButtons(o),this._replaceCombobox(t,o),this._initDialogFocusLogic(o)}}const Me={codeSnippet:Ae},Pe=new n.InjectionToken("DialogOverrideMap",{providedIn:"any",factory:()=>Me});class J{constructor(t,e){this._injector=t,this._strategyMap=e}_isDialogOverrideType(t){return t in this._strategyMap}_createOverride(t){const e=this._strategyMap[t];if(!e)throw new Error(`Dialog override type "${t}" is not supported.`);return new e(this._injector,t)}overrideDialog(t,e){const i=t.data.name;this._isDialogOverrideType(i)&&this._createOverride(i).overrideDialog(t,e)}static{this.\u0275fac=function(e){return new(e||J)(n.\u0275\u0275inject(n.Injector),n.\u0275\u0275inject(Pe))}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:J,factory:J.\u0275fac,providedIn:"any"})}}const Be=["tooltipLink"],Ve=["selectionActionsPanel"],Ue=["*"],De=l=>({"crt-input-required":l}),Ne=()=>["cke_widget_drag_handler","cke_widget_mask"];function je(l,t){l&1&&n.\u0275\u0275elementContainer(0)}function He(l,t){if(l&1&&n.\u0275\u0275element(0,"crt-base-input-width-holder",12),l&2){const e=n.\u0275\u0275nextContext();n.\u0275\u0275property("label",e.label)("minWidth",180)}}function ze(l,t){if(l&1&&n.\u0275\u0275element(0,"div",13,2),l&2){const e=n.\u0275\u0275nextContext();n.\u0275\u0275property("tooltipConfig",e.getLinkWindowTooltipConfig())}}function $e(l,t){l&1&&n.\u0275\u0275element(0,"crt-skeleton-loader")}function Ke(l,t){if(l&1){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"ckeditor",25),n.\u0275\u0275twoWayListener("dataChange",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext(2);return n.\u0275\u0275twoWayBindingSet(r.control.value,o)||(r.control.value=o),n.\u0275\u0275resetView(o)})("configChange",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext(2);return n.\u0275\u0275twoWayBindingSet(r.editorConfig,o)||(r.editorConfig=o),n.\u0275\u0275resetView(o)}),n.\u0275\u0275listener("ready",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(r.onEditorReady(o))})("focus",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(r.onEditorFocus(o))})("blur",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(r.onEditorBlur(o))})("click",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(r.onClick(o))})("keydown.escape",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(r.tryCloseToolbar(o))}),n.\u0275\u0275elementEnd()}if(l&2){const e=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("crtAnchorScrollHandler",(!e.isFocused||e.readonly)&&e.isReady&&!e.loading)("ignoreImageClasses",n.\u0275\u0275pureFunction0(9,Ne))("toggleImageHandlers",(!e.isFocused||e.readonly)&&e.isReady&&!e.loading)("resetHighlightCode",e.control.value)("resetHighlightQuote",e.control.value),n.\u0275\u0275twoWayProperty("data",e.control.value)("config",e.editorConfig),n.\u0275\u0275property("type",e.editorType)("editorUrl",e.editorUrl)}}function We(l,t){if(l&1){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"mat-icon",26),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275listener("click",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.onClipClicked())})("keyup.enter",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext(2);return o.stopPropagation(),n.\u0275\u0275resetView(r.onClipClicked())})("mousedown",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.setBlurLocked())})("focus",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.setBlurLocked())})("blur",function(o){n.\u0275\u0275restoreView(e),n.\u0275\u0275nextContext();const r=n.\u0275\u0275reference(8),a=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(a.tryBlurToggle(o,r))}),n.\u0275\u0275elementEnd()}l&2&&(n.\u0275\u0275property("crtTooltip",n.\u0275\u0275pipeBind1(1,2,"RichTextEditor.UploadAttachments")),n.\u0275\u0275attribute("aria-label",n.\u0275\u0275pipeBind1(2,4,"RichTextEditor.UploadAttachments")))}function Je(l,t){if(l&1){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"mat-icon",27),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275listener("click",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.onSelectTemplateClicked())})("keyup.enter",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext(2);return o.stopPropagation(),n.\u0275\u0275resetView(r.onSelectTemplateClicked())})("focus",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.setBlurLocked())})("mousedown",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.setBlurLocked())})("blur",function(o){n.\u0275\u0275restoreView(e),n.\u0275\u0275nextContext();const r=n.\u0275\u0275reference(8),a=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(a.tryBlurToggle(o,r))}),n.\u0275\u0275elementEnd()}l&2&&(n.\u0275\u0275property("crtTooltip",n.\u0275\u0275pipeBind1(1,2,"RichTextEditor.SelectTemplate")),n.\u0275\u0275attribute("aria-label",n.\u0275\u0275pipeBind1(2,4,"RichTextEditor.SelectTemplate")))}function Ze(l,t){if(l&1){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"mat-icon",28),n.\u0275\u0275pipe(1,"translate"),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275listener("click",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(r.toggleToolbar(o.buttons===1&&o.isPrimary))})("focus",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.setBlurLocked())})("blur",function(o){n.\u0275\u0275restoreView(e),n.\u0275\u0275nextContext();const r=n.\u0275\u0275reference(8),a=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(a.tryBlurToggle(o,r))})("keyup.enter",function(o){n.\u0275\u0275restoreView(e);const r=n.\u0275\u0275nextContext(2);return o.stopPropagation(),n.\u0275\u0275resetView(r.toggleToolbar(!0))})("mousedown",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext(2);return n.\u0275\u0275resetView(o.setBlurLocked())}),n.\u0275\u0275elementEnd()}if(l&2){const e=n.\u0275\u0275nextContext(2);n.\u0275\u0275classMap("toggle-icon toggle-"+(e.showToolbar?"selected":"default")),n.\u0275\u0275property("tooltipConfig",e.getToggleTooltipConfig(n.\u0275\u0275pipeBind1(1,4,"RichTextEditor.ToggleToolbar"))),n.\u0275\u0275attribute("aria-label",n.\u0275\u0275pipeBind1(2,6,"RichTextEditor.ToggleToolbar"))}}function qe(l,t){l&1&&(n.\u0275\u0275element(0,"mat-icon",29),n.\u0275\u0275pipe(1,"translate")),l&2&&n.\u0275\u0275property("title",n.\u0275\u0275pipeBind1(1,1,"Input.Readonly"))}function Qe(l,t){if(l&1&&(n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275element(1,"crt-icon-tooltip",30),n.\u0275\u0275elementContainerEnd()),l&2){const e=n.\u0275\u0275nextContext(2);n.\u0275\u0275advance(),n.\u0275\u0275property("tooltip",e.errorMessages)("ariaLabel",e.label)}}function Ge(l,t){if(l&1&&n.\u0275\u0275element(0,"crt-icon-tooltip",32),l&2){const e=n.\u0275\u0275nextContext(3);n.\u0275\u0275property("tooltip",e.tooltip)("ariaLabel",e.label)}}function Xe(l,t){if(l&1&&n.\u0275\u0275template(0,Ge,1,2,"crt-icon-tooltip",31),l&2){const e=n.\u0275\u0275nextContext(2);n.\u0275\u0275property("ngIf",e.tooltip)}}function Ye(l,t){if(l&1&&(n.\u0275\u0275elementStart(0,"div",14)(1,"label",15),n.\u0275\u0275text(2),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(3,"div",16)(4,"div",17)(5,"div",18),n.\u0275\u0275template(6,Ke,1,10,"ckeditor",19),n.\u0275\u0275elementStart(7,"div",20,3),n.\u0275\u0275template(9,We,3,6,"mat-icon",21)(10,Je,3,6,"mat-icon",22)(11,Ze,3,8,"mat-icon",23)(12,qe,2,3,"mat-icon",24)(13,Qe,2,2,"ng-container",11)(14,Xe,1,1,"ng-template",null,4,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementEnd()()()()),l&2){const e=n.\u0275\u0275reference(15),i=n.\u0275\u0275nextContext();n.\u0275\u0275advance(),n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(16,De,i.isShownRequiredMark)),n.\u0275\u0275advance(),n.\u0275\u0275textInterpolate(i.label),n.\u0275\u0275advance(),n.\u0275\u0275property("ngClass","label-position-"+i.displayLabelPosition),n.\u0275\u0275advance(2),n.\u0275\u0275classProp("invalid",i.invalid)("readonly",i.readonly)("hasTooltip",i.tooltip),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",i.control),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngIf",i.showClip&&i.isFocused&&!i.readonly),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",i.useTemplates&&i.isFocused&&!i.readonly),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",i.isFocused&&!i.readonly),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",i.readonly),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",i.invalid)("ngIfElse",e)}}let x=class me extends g.CrtInputComponent{get _useMentions(){return!!this.mentionsService||!!this._mentionsConfig}get showToolbar(){return this._showToolbar}set showToolbar(t){this._showToolbar=t,this._setToolbarVisibility(t),this.currentEditor.fire("toggleToolbar",{display:t})}get editorConfig(){return this._editorConfig}set editorConfig(t){Object.assign(this._editorConfig,t)}get mentionsConfig(){return this._mentionsConfig||this._defaultMentionsConfig}set mentionsConfig(t){Object.assign(this._mentionsConfig,t)}set content(t){this.control.setValue(t)}constructor(t,e,i,o,r,a,d,p,_,b,y,X,q,Y,oe,it,ot,rt,at){super(t,e),this.matDateLocale=i,this.window=o,this.ckeditorUrl=r,this.themeCssUrlSearchTemplate=a,this._messageDialogProvider=d,this._contactColorService=p,this._initialsService=_,this._currentTheme$=b,this._platform=y,this._featureValues=X,this._domPurifier=q,this._fileUploadProcessingService=Y,this._fileIconService=oe,this._uploadService=it,this._rightsService=ot,this._dialogService=rt,this._dialogOverrideService=at,this._editorConfig={skin:"freedom",customConfig:"",toolbar:[["Format","-","CopyFormatting","Bold","Italic","Underline","Strike","-","TextColor","-","NumberedList","BulletedList","-","CreatioLink","CreatioImageFileUploadButton","CreatioFileUploadButton","CreatioVideo","CreatioTable","CrtTableOfContents","-","Blockquote","CodeSnippet","-","JustifyLeft","JustifyCenter","JustifyRight","-","Outdent","Indent","Expand","Collapse"]],extraPlugins:"creatioeditorplaceholder,expandcollapse,textmatch,autolink,link,creatiolink,imagebase,uploadimage,creatiouploadfile,creatioImageFileUpload,dragresize,creatiotabletools,tableresize,justify,copyformatting,indent,creatiofixedtoolbox,tableselection",removePlugins:"smiley,pagebreak,iframe,language,flash,image,magicline,scayt,editorplaceholder,imageresizerowandcolumn",format_tags:"p;h1;h2;h3",colorButton_enableMore:!1,context_menu:[],title:"",allowedContent:!0,removeButtons:"Link,Image",toolbarStartupExpanded:!1,enterMode:2,startupShowBorders:!1,entities_greek:!1,entities_latin:!1,disableNativeSpellChecker:!1,versionCheck:!1,codeSnippet_languages:{bash:"Bash",cpp:"C++",cs:"C#",css:"CSS",html:"HTML",http:"HTTP",java:"Java",javascript:"JavaScript",json:"JSON",php:"PHP",pgsql:"PostgreSQL",python:"Python",ruby:"Ruby",scss:"SCSS",sql:"SQL",typescript:"TypeScript",xml:"XML"}},this._toolbarClassName="crt-rich-text-editor-toolbar",this._defaultMentionsConfig={feed:(st,lt)=>this._getMentions(st.query,lt),itemTemplate:'<li data-id="{id}" data-qa="{id}-mention-option" class="mention-item"><span class="contact-no-photo" color="{color}" style="background:{color}">{initials}</span><img src="{icon}">{name}<img src="{typeIcon}" class="user-type-icon"></li>',outputTemplate:'<a href="{pageUrl}" contentEditable="false" style="{styles}" data-value="{id}" mention-info="{contactDto}" data-mention-display-value="{name}" data-link="mention" target="_blank"><img style="{iconStyles}" src="{icon}"/><span color="{color}" style="{initialsStyles}">{shortInitials}</span>{name}</a>',minChars:0,marker:"@",throttle:0},this._uploadedFileClassName="file-download-link",this._uploadedFileNameAttribute="crt-uploaded-file-name",this._selectionDebounceDelay=250,this._primaryDataSchemaName="",this._showToolbar=!1,this._tooltipOffset=24,this._dialogIsShowing=!1,this._namespaceInitialized=!1,this._selectionDebounceFn=(0,I.debounce)(this._onSelectionChange,this._selectionDebounceDelay),this._onDomSelectionChangeHandler=this._onDocumentSelectionChange.bind(this),this.isFocused=!1,this.isReady=!1,this.lockBlur=!1,this.plainTextChange=new n.EventEmitter,this.editorType="inline",this.needHandleSave=!0,this.alwaysShowToolbar=!1,this.filesStorage={masterRecordColumnValue:"$Id",recordEntitySchemaName:"",recordColumnName:"RecordId",entitySchemaName:"SysFile"},this.selectAttachments=new n.EventEmitter,this.selectionChange=new n.EventEmitter,this.selectTemplate=new n.EventEmitter,this.filesUploaded=new n.EventEmitter,this.useBodyFilesLinks=!0,this.editorBlur=new n.EventEmitter,this.editorFocus=new n.EventEmitter,this.editorValueChanged=new n.EventEmitter,this.newMention=new n.EventEmitter,this.editorUrl=r,this._sanitizeHtmlPipe=this.injector.get(m.SanitizeHtmlPipe),this._matIconRegistry=this.injector.get(S.MatIconRegistry),this._mentionUtils=new Le(this._contactColorService,this._initialsService,this._matIconRegistry),this._selectionActionsPositionService=t.get(H),this._copilotToEditorCommunicationService=t.get(m.CopilotToEditorCommunicationService),this._selectionUtils=t.get(W),this._schemaService=t.get(K.SchemaService),ee.init(t)}_updateValue(){CKEDITOR.currentInstance&&CKEDITOR.currentInstance.name===this.currentEditor?.name&&(this._currentRecordId=this.control.parent?.value?.Id,this.currentEditor.schemaRecordId=this._currentRecordId,this._updateValueInControl(CKEDITOR.currentInstance)),this.editorValueChanged.emit()}_updateValueInControl(t){const e=t.getData();this.control.setValue(e);const o=t.editable().$?.innerText;this.plainTextChange.emit(o),this._updateValidity()}_setToolbarVisibility(t){const e=(this._lastEditor||CKEDITOR.currentInstance)?.name,i=document.getElementById("cke_"+e);i&&(t?(i.style.opacity="1",i.style.pointerEvents="auto",i.style.removeProperty("display"),this.alwaysShowToolbar||window.dispatchEvent(new Event("scroll"))):(i.style.opacity="0",i.style.display="none",i.style.pointerEvents="none"))}_updateValidity(){this.control.updateValueAndValidity(),this.control.markAsTouched()}_openUrl(t,e){t&&this.window.open(t,e)}_setContenteditable(t,e){t?.editable().$.setAttribute("contenteditable",e)}_subscribeBeforeDestroyEvent(t){t.editor.on("beforeDestroy",e=>{this.isReady=!1,this._hideTooltip(),e.editor.fire("blur"),this._unsubscribeFromSelectionChange(e.editor)},this)}_subscribeEvents(t){const e=t.editor;CKEDITOR.on("ariaWidget",this.onPanelElementCreated.bind(this)),CKEDITOR.on("dialogDefinition",this._updateBaseDialogs.bind(this)),e.on("change",this._updateValue.bind(this)),e.on("insertHtml",this._onInsertHtml.bind(this)),e.on("fileUploadRequest",this._handleFileUploadRequest.bind(this)),e.on("CreatioImageClick",()=>this.lockBlur=!0,this),e.on("CreatioImageWindowClose",()=>this.lockBlur=!1,this),e.on("CreatioLinkClick",this._showTooltip.bind(this)),e.on("CreatioLinkDoubleClick",this._showTooltip.bind(this)),e.on("CreatioFileUploadFailed",this._removeFailedLink.bind(this)),e.on("beforeCommandExec",this._beforeCommandExec.bind(this)),ee.subscribeEvents(e),e.document.on("keydown",this._handleKeyDownEvent.bind(this)),e.on("CreatioVideoClick",this._showVideoDialog.bind(this)),this._subscribeImageResize(e),this._subscribeToSelectionChange(e),e.container.$.addEventListener("contextmenu",function(i){i.stopPropagation()},!0)}_subscribeToSelectionChange(t){this.disableSelectionOptions||!this._featureValues.SelectionRewriteActions||(t.document.$.body.append(this.selectionActionsPanel.nativeElement),t.document.$.addEventListener("selectionchange",this._onDomSelectionChangeHandler))}_unsubscribeFromSelectionChange(t){this.disableSelectionOptions||!this._featureValues.SelectionRewriteActions||(t.document.$.removeEventListener("selectionchange",this._onDomSelectionChangeHandler),this.selectionActionsPanel?.nativeElement?.remove())}_onDocumentSelectionChange(){const t=this._selectionUtils.isEditorContainingSelection(this.currentEditor);(this.selectionActionsPanel.nativeElement.style.display==="unset"||t)&&this._selectionDebounceFn()}_handleKeyDownEvent(t){switch(t.data.$.key){case ce.Key.Backspace:case ce.Key.Delete:this._removeBRBeforeFile(t),this._removeAllZWS();break;default:break}}_updateBaseDialogs(t){const e=(CKEDITOR.currentInstance||this._lastEditor)?.name;e&&this._dialogOverrideService.overrideDialog(t,e)}_removeBRBeforeFile(t){const e=this.currentEditor.getSelection();if(!e)return;const o=e.getRanges()[0]?.getNextNode(),r=o?.$;if(r){const a=r.previousElementSibling?.tagName?.toUpperCase()==="BR"&&r.previousSibling?.wholeText?.length===0,d=o.hasClass?.("crt-file-wrapper"),p=r.nextElementSibling?.classList.contains("crt-file-wrapper"),_=r.nodeType===CKEDITOR.NODE_TEXT&&r.nodeValue?.length===0&&p,b=r.tagName?.toUpperCase()==="BR";a&&(d||_)?(r.previousElementSibling.remove(),t.data.preventDefault()):b&&p&&(o.remove(),t.data.preventDefault())}}_removeAllZWS(){const t=this.currentEditor?.editable()?.$;if(!t)return;const e=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let i;for(;i=e.nextNode();)i.nodeValue.includes("\u200B")&&(i.nodeValue=i.nodeValue.replace(/\u200B/g,""))}_removeFailedLink(t){this._replaceUploadedFileContainer(t.editor,t.data.fileName,""),this._showErrorDialog("InfoDialog.FileUpload.InvalidRequestParams")}_validateFileUploadRequest(){var t=this;return(0,O.A)(function*(){if(t.filesStorage.entitySchemaName==="SysFile"&&t.filesStorage.recordColumnName==="RecordId")return!0;if(!t.filesStorage.masterRecordColumnValue||!t.filesStorage.entitySchemaName||!t.filesStorage.recordColumnName||!t.filesStorage.recordEntitySchemaName)return t._showErrorDialog("InfoDialog.FileUpload.InvalidRequestParams"),!1;const e=(yield(0,h.lastValueFrom)(t._rightsService.getCanAdd([t.filesStorage.entitySchemaName]).pipe((0,le.catchError)(()=>(0,h.of)([])))))[0];return e?.errorMessage&&t._showErrorDialog(e.errorMessage),e?.result})()}_handleFileUploadRequest(t){const{editor:e}=t,i=t?.data?.requestData?.upload?.file,o=t?.data?.fileLoader;o&&(o.abort=()=>{}),t.stop(),i&&(e.crtUploadingFiles=e.crtUploadingFiles||[],e.crtUploadingFiles.push(i)),!(e.crtPastedFiles?.length>e.crtUploadingFiles.length)&&(e.crtUploadingFiles=e.crtUploadingFiles.filter(r=>r.name&&this.currentEditor.editable().$?.innerText?.includes(r.name)),e.crtPastedFiles=[],this._processFilesUpload(e.crtUploadingFiles).then(r=>{e.crtUploadingFiles=[],e.uploadFilesData={readyToUploadFiles:e.uploadFilesData?.readyToUploadFiles||[],filesStorage:this.filesStorage,uploadEvent:t},r.forEach(a=>{const d=(0,s.generateGuid)(),p=this._uploadService.getUploadUrl({fileEntitySchemaName:this.filesStorage.entitySchemaName,id:d});this._wrapFileLink(a.name,p),e.uploadFilesData.readyToUploadFiles.push({fileId:d,file:a})}),setTimeout(()=>{document.querySelectorAll(".crt-file-wrapper").forEach(a=>a.setAttribute("contenteditable","false"))},0),this.filesUploaded.emit(e.uploadFilesData?.readyToUploadFiles)}))}_processFilesUpload(t){var e=this;return(0,O.A)(function*(){let i;if(!(yield e._validateFileUploadRequest()))return t.forEach(p=>e._replaceUploadedFileContainer(e.currentEditor,p.name,"")),[];const o=yield e._fileUploadProcessingService.processSelectedFiles(t,null),r=o?.files?(0,I.differenceBy)(t,o?.files,"name"):[],a=[];o?.errors?.length>0&&(i=e._fileUploadProcessingService.createFileErrorMessageForLogs(o.errors));for(const p of t)(yield e._fileUploadProcessingService.isFileExtensionDeny(p))&&a.push(p);if(a.length>0){const p=e._fileUploadProcessingService.createExtensionAttachmentsErrorMessage(a);i=i?`${p}\r
\r
${i}`:p}const d=[...r,...a];return o.files=(0,I.differenceBy)(t,d,"name"),i&&(e._showErrorDialog(i),d.forEach(p=>e._replaceUploadedFileContainer(e.currentEditor,p.name,""))),e.useBodyFilesLinks||o.files.forEach(p=>e._replaceUploadedFileContainer(e.currentEditor,p.name,"")),o.files})()}_showErrorDialog(t){this._dialogIsShowing||(this._dialogIsShowing=!0,this._messageDialogProvider.error(t).subscribe(()=>{this._dialogIsShowing=!1}))}_wrapFileLink(t,e){const i=this._fileIconService.getFileIcon(t);this._matIconRegistry.getNamedSvgIcon(i).pipe((0,le.catchError)(()=>(0,h.of)(null)),(0,le.map)(o=>{let r="";o&&(o.classList.add(B.fileIconImageCssClass),o.style.width="16px",o.style.height="16px",r=o.outerHTML);const a=`<a ${this._uploadedFileNameAttribute}="${t}" class="${this._uploadedFileClassName}" href="${e}" target="_self">${t}</a>`;return`<span contenteditable="false" class="crt-file-wrapper">${r}${a}</span> `})).subscribe(o=>{this._replaceUploadedFileContainer(this.currentEditor,t,o),this._moveCaretPositionAfterFileLink(t)})}_moveCaretPositionAfterFileLink(t){const e=this.currentEditor,o=e.document?.find(`a[${this._uploadedFileNameAttribute}="${t}"]`)?.getItem(0)?.getParent()?.getNext();if(o){const r=e.getSelection(),a=e.createRange();a.setStart(o,1),a.setEnd(o,1),r.selectRanges([a])}}_replaceUploadedFileContainer(t,e,i){const r=t?.document?.$?.querySelector(`a[${this._uploadedFileNameAttribute}="${e}"]`)?.parentNode;r&&(r.parentNode?.querySelector("div[data-cke-hidden-sel]")?.remove(),r.outerHTML=i,this.currentEditor.fire("change"))}_replaceAnchorTags(t){return t.replace(/<a[^>]*data-mention-display-value="([^"]*)"[^>]*>(.*?)<\/a>/gs,function(e,i){return i})}_subscribeImageResize(t){const e=i=>{["*"].includes(i.data.type)&&(i.data.dataValue="")};t.on("paste",i=>{const o=i.editor?.elementPath()?.lastElement;o&&(i.data.dataValue=this._replaceAnchorTags(i.data.dataValue),i.editor.sizeBeforePaste={width:o.getSize("width"),height:o.getSize("height")}),i.editor.crtPastedFiles=i.data?.dataTransfer?.$?.files,e(i)}),t.on("resizeComplete",i=>{const o=i.data.element;o.style.width&&o.style.removeProperty("max-width")})}_onInsertHtml(t){const e=t?.data?.dataValue,i=this._mentionUtils.getMentionsFromHtml(e);i&&i.length>0&&this.newMention.next(i),t.editor?.elementPath()?.lastElement?.find("img").toArray().forEach(o=>{e.includes(CKEDITOR.tools.htmlEncode(o.getAttribute("src")))&&o.setStyle("max-width",`${t.editor.sizeBeforePaste?.width-20}px`)})}_loadSkin(){const t=this._getDomElement(this.window.document,"head");if(t){const e=this.ckeditorUrl.replace("ckeditor.js","");B.appendLink(t,e+"skins/freedom/editor.css")}}_overrideShowNotification(t){t.editor.showNotification=e=>{e&&(e=this._sanitizeHtmlPipe.transform(e,{mode:"textOnly",dataType:s.DataValueType.MAXSIZE_TEXT}),this._messageDialogProvider.info(e))}}_getDomElement(t,e){const i=t?.getElementsByTagName(e);return!i||i.length<1?null:i[0]}_restoreSelectionRanges(){this.currentEditor?.getSelection().selectRanges(this.currentEditor?.oldRanges)}_getMentions(t,e){this._mentionUtils.getMentionsWithDebounce(this.mentionsService,t,e)}_isFileLink(){const e=CKEDITOR.plugins.link.getSelectedLink(this.currentEditor,!0)?.[0]||null;return e?.is("a")&&e.hasClass(this._uploadedFileClassName)}_showTooltip(t){if(this._isFileLink())return;this.toggleLink(!0);const e=this.tooltipLink.nativeElement,i=t.editor.getSelectedRanges()[0];if(i){const o=i?.getClientRects()?.[0],r=t.editor.container.getClientRect(),a=(o?.x||0)-r.x,d=(o?.bottom||0)-r.y;e.style.left=`${a}px`,e.style.top=`${d}px`,e.click()}}_showVideoDialog(t){this._dialogService.open(N,{data:{value:{editor:this.currentEditor,viewModel:this._viewModel,editorConfig:this.editorConfig,primaryDataSchemaName:this._primaryDataSchemaName}},panelClass:"rich-text-video-dialog",disableClose:!0}).subscribe()}_hideTooltip(){this.tooltipLink.nativeElement.dispatchEvent(new Event("blur")),this.toggleLink(!1)}_sanitizeGlobalStyleTagContent(t){if(!t.data.sanitized&&!this._featureValues.DisableRemoveRichtextGlobalStyles){const e=this._domPurifier.sanitize(t.data.dataValue,{FORBID_TAGS:["style","base"],ADD_TAGS:["signature","iframe","video"],ADD_ATTR:["bodylimiter","crt-file-name"]});t.data.dataValue=e,t.data.sanitized=!0}}_disablePlugin(t,e,i){t()&&(this.editorConfig.toolbar[0]=this.editorConfig.toolbar[0].filter(o=>o!==i),this.editorConfig.extraPlugins=this.editorConfig.extraPlugins.replace(new RegExp(`${e},`,"g"),""))}_setAdditionalExtraPlugins(){this.extraPlugins&&this.extraPlugins.length>0&&(this.editorConfig.extraPlugins+=`,${this.extraPlugins.join(",")}`)}_subscribeInstanceCreated(){this._namespaceInitialized?this._namespaceInitialized=!0:CKEDITOR?.on("instanceCreated",t=>{t.editor.on("setData",this._sanitizeGlobalStyleTagContent.bind(this))})}_getSelection(){const t=this.currentEditor;return t?t.getSelection():null}_onSelectionChange(){const e=this._getSelection()?.getSelectedText()??"";if((0,I.isEmpty)(this.selection)&&this.selection===e)return;this.selectionChange.emit(e),this._selectionActionsPositionService.updatePosition(this.selectionActionsPanel,this.currentEditor?.container?.$)&&this._subscribeToHighlightSelection()}_subscribeToHighlightSelection(){this._copilotToEditorCommunicationService.subscribeToNotifications(this.currentEditor.id,t=>{if(!(!this.isReady||!this.currentEditor.editable))switch(t.editorAction){case m.EditorActionType.SetHighlighting:this._selectionUtils.highlightSelection(this.currentEditor);break;case m.EditorActionType.RemoveHighlighting:this._selectionUtils.removeHighlight(this.currentEditor),this._updateValueInControl(this.currentEditor);break;case m.ChatMessageActionType.Replace:case m.ChatMessageActionType.InsertAbove:case m.ChatMessageActionType.InsertBelow:this._selectionUtils.replaceSelection(this.currentEditor,t);break}})}_beforeCommandExec(t){t.data.name==="toolbarFocus"&&(this.showToolbar=!0,this.detectChanges())}isFocusingOutside(t,e){let i=!0;const o=t?.relatedTarget?.parentElement;return o&&(i=o!==e),i}onPanelElementCreated(t){const e=this._getDomElement(t.data.$.contentDocument,"head");if(e){const o=this.ckeditorUrl.replace("ckeditor.js","");B.appendLink(e,o+"contents.css"),B.appendLink(e,o+"skins/freedom/editor.css");const r=B.getThemeCssLink(document,this.themeCssUrlSearchTemplate);r?B.appendLink(e,r):console.warn(`Not found css-file by ${this.themeCssUrlSearchTemplate}`)}const i=this._getDomElement(t.data.$.contentDocument,"body");i&&(i.classList.contains(this._currentTheme.cssSelector)||i.classList.add(this._currentTheme.cssSelector))}ngOnInit(){this.editorConfig.name=this.name,this.editorConfig.language=this.matDateLocale?.split("-")[0],this.editorConfig.editorplaceholder=this.placeholder,this.editorConfig.fileStorageName=this.filesStorage.entitySchemaName,this.editorConfig.recordColumnName=this.filesStorage.recordColumnName,this.editorConfig.recordEntitySchemaName=this.filesStorage.recordEntitySchemaName,this._loadSkin(),this._useMentions&&(Object.assign(this.editorConfig,{mentions:[this.mentionsConfig]}),this.editorConfig.extraPlugins+=", mentions"),this._setAdditionalExtraPlugins(),this._disablePlugin(()=>!this._featureValues.EnableVideoInRichTextEditor,"creatiovideo","CreatioVideo"),this._disablePlugin(()=>!this.needHandleSave||!this._featureValues.UseRichTextUploadFile,"creatiouploadfile","CreatioFileUploadButton"),(0,Te.$)(this.editorUrl).then(this._subscribeInstanceCreated.bind(this)),this._viewModel=this.control.parent?.value;const t=this._schemaService.getModelConfig();this._primaryDataSchemaName=t.dataSources[t.primaryDataSourceName].config.entitySchemaName}ngAfterViewInit(){var t=()=>super.ngAfterViewInit,e=this;return(0,O.A)(function*(){t().call(e),e._currentTheme=yield(0,h.firstValueFrom)(e._currentTheme$)})()}onEditorReady(t){t.editor.setActiveEnterMode(CKEDITOR.ENTER_DIV),this._subscribeEvents(t),t.editor.setReadOnly(this.readonly),this.editorName=t.editor.name;const e=document.querySelector(`#cke_${t.editor.name}.cke_float`);e?.classList.add(this._toolbarClassName),e?.classList.add("cdk-overlay-pane"),this.currentEditor=this._lastEditor=t.editor,t.editor.schemaRecordId=this._currentRecordId,t.editor.editable().changeAttr("aria-label",this.label),this._subscribeBeforeDestroyEvent(t),t.editor.needHandleSave=this.needHandleSave,this._overrideShowNotification(t),this.detectChanges(),this.isReady=!0}toggleLink(t){this.currentEditor.oldRanges=this.currentEditor.getSelectedRanges(),this._setToolbarVisibility(!t)}onEditorFocus(t){const e=document.querySelectorAll(":hover");if(e[e.length-1]instanceof HTMLAnchorElement){this._setContenteditable(t.editor,!1),this._setToolbarVisibility(!1);return}this.alwaysShowToolbar&&!this.readonly&&(this.showToolbar=!0),this.isFocused=!0,this.editorFocus.emit(),this.showToolbar?t.editor.focus():this._setToolbarVisibility(!1),t.editor.editable().setAttribute("spellcheck",!0),this._selectionUtils.selectHighlighted(t.editor)}clearSelection(){this._selectionUtils.clearSelection(this.currentEditor)}focus(){this.currentEditor?.focus()}onEditorBlur(t){this._lastEditor=t.editor,t.editor?.editable()&&t.editor.editable().setAttribute("spellcheck",!1),this.showToolbar=!1,this.lockBlur?t.stop():(this.isFocused&&(this.editorBlur.emit(),this.currentEditor?.focusManager?.blur(),this.isFocused=!1),this.readonly||(ee.generateTableOfContents(this.currentEditor),this.currentEditor.fire("change"),this._updateValidity()))}toggleToolbar(t=!1){this.lockBlur=!1,this.showToolbar=!this.showToolbar;const e=CKEDITOR.currentInstance||this._lastEditor;e?.focus(),t&&this.showToolbar&&e?.toolbox?.focus()}onClick(t){const e=t.target;if(e instanceof HTMLAnchorElement&&!this.isFocused){const i=e.getAttribute("href");i.startsWith("#")||this._openUrl(i,e.target||"_blank")}this.currentEditor.readOnly||this._setContenteditable(CKEDITOR.currentInstance,!0)}tryBlurToggle(t,e){const i=this.isFocusingOutside(t,e);this.lockBlur&&i&&(this.lockBlur=!1,this.onEditorBlur({}))}onClipClicked(){this.selectAttachments.emit()}onSelectTemplateClicked(){this.selectTemplate.emit()}ngOnChanges(t){t.readonly&&this.currentEditor&&this.currentEditor.setReadOnly(t.readonly.currentValue)}removeReadyToUploadFile(t){const e=this.currentEditor?.uploadFilesData?.readyToUploadFiles;e&&(this.currentEditor.uploadFilesData.readyToUploadFiles=e.filter(i=>i.fileId!==t))}getLinkWindowTooltipConfig(){return new C.TooltipOverlayConfig({showEvent:"click",hideEvent:"blur",closeOnOutsideClick:!0,tooltipConfig:{value:{editor:this.currentEditor},onClose:this.onLinkWindowClosed.bind(this),onSave:this.onLinkSaved.bind(this),onUnlink:this.onLinkUnlink.bind(this)},preferredPositions:[{originX:"end",originY:"bottom",overlayX:"start",overlayY:"top",offsetY:this._tooltipOffset,offsetX:-this._tooltipOffset},{originX:"end",originY:"top",overlayX:"start",overlayY:"bottom",offsetY:-this._tooltipOffset,offsetX:-this._tooltipOffset}],componentType:D})}getToggleTooltipConfig(t){return new C.TooltipOverlayConfig({showEvent:["focus","mouseenter"],hideEvent:["blur","mouseleave"],closeOnOutsideClick:!0,tooltipConfig:{value:t},componentType:C.CrtBaseTooltipComponent})}onLinkSaved(){this._hideTooltip(),this.focus(),this._updateValueInControl(this.currentEditor)}onLinkWindowClosed(){this.focus(),this._restoreSelectionRanges(),this._hideTooltip()}onLinkUnlink(){this._hideTooltip(),this._updateValueInControl(this.currentEditor)}onBeforeUnload(){this._selectionUtils.removeHighlight(this.currentEditor),this._updateValueInControl(this.currentEditor)}setBlurLocked(){this.lockBlur=!0}tryCloseToolbar(t){this.showToolbar&&(this.showToolbar=!1,t?.stopPropagation())}static{this.\u0275fac=function(e){return new(e||me)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(n.ChangeDetectorRef),n.\u0275\u0275directiveInject(ve.MAT_DATE_LOCALE,8),n.\u0275\u0275directiveInject(k.WINDOW_TOKEN),n.\u0275\u0275directiveInject(m.CKEDITOR_URL),n.\u0275\u0275directiveInject(se),n.\u0275\u0275directiveInject(g.MessageDialogProvider),n.\u0275\u0275directiveInject(m.ContactColorService),n.\u0275\u0275directiveInject(m.InitialsService),n.\u0275\u0275directiveInject(m.THEME),n.\u0275\u0275directiveInject(Ce.Platform),n.\u0275\u0275directiveInject(m.FEATURE_VALUES),n.\u0275\u0275directiveInject(k.DOM_PURIFIER),n.\u0275\u0275directiveInject(m.BaseFileUploadProcessingService),n.\u0275\u0275directiveInject(A.FileIconService),n.\u0275\u0275directiveInject(M),n.\u0275\u0275directiveInject(fe.RightsService),n.\u0275\u0275directiveInject(C.DialogService),n.\u0275\u0275directiveInject(J))}}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:me,selectors:[["crt-rich-text-editor"]],viewQuery:function(e,i){if(e&1&&(n.\u0275\u0275viewQuery(Be,5,n.ElementRef),n.\u0275\u0275viewQuery(Ve,5,n.ElementRef)),e&2){let o;n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(i.tooltipLink=o.first),n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(i.selectionActionsPanel=o.first)}},hostBindings:function(e,i){e&1&&n.\u0275\u0275listener("beforeunload",function(){return i.onBeforeUnload()},!1,n.\u0275\u0275resolveWindow)},inputs:{plainText:"plainText",extraPlugins:"extraPlugins",editorConfig:"editorConfig",mentionsConfig:"mentionsConfig",mentionsService:"mentionsService",editorType:"editorType",content:"content",editorUrl:"editorUrl",needHandleSave:"needHandleSave",alwaysShowToolbar:"alwaysShowToolbar",showClip:"showClip",useTemplates:"useTemplates",filesStorage:"filesStorage",selection:"selection",disableSelectionOptions:"disableSelectionOptions",useBodyFilesLinks:"useBodyFilesLinks",selectionActions:"selectionActions"},outputs:{plainTextChange:"plainTextChange",selectAttachments:"selectAttachments",selectionChange:"selectionChange",selectTemplate:"selectTemplate",filesUploaded:"filesUploaded",editorBlur:"editorBlur",editorFocus:"editorFocus",editorValueChanged:"editorValueChanged",newMention:"newMention"},features:[n.\u0275\u0275ProvidersFeature([ye.defaultComponentLoaderVisibilityDelayProvider]),n.\u0275\u0275InheritDefinitionFeature,n.\u0275\u0275NgOnChangesFeature],ngContentSelectors:Ue,decls:11,vars:7,consts:[["selectionActionsPanel",""],["input",""],["tooltipLink",""],["iconsContainer",""],["tooltipIcon",""],[1,"rich-text-selection-actions"],[4,"ngTemplateOutlet"],[3,"label","minWidth",4,"ngIf"],[1,"crt-base-input-container"],["class","link-tooltip","crtTooltip","",3,"tooltipConfig",4,"ngIf"],["crtResizable","",1,"crt-input",3,"resized","ngClass","crtResizableDisabled"],[4,"ngIf","ngIfElse"],[3,"label","minWidth"],["crtTooltip","",1,"link-tooltip",3,"tooltipConfig"],[1,"crt-input-label-container"],[1,"crt-input-label",3,"ngClass"],["floatLabel","never",1,"crt-input-control-container","rich-editor","mat-form-field",3,"ngClass"],[1,"crt-input-control"],[1,"rich-editor-wrapper"],["crtFullSizeImage","","crtBlockQuoteHighlight","","crtCodeSnippetHighlight","","class","rich-editor",3,"crtAnchorScrollHandler","ignoreImageClasses","toggleImageHandlers","resetHighlightCode","resetHighlightQuote","data","config","type","editorUrl","dataChange","configChange","ready","focus","blur","click","keydown.escape",4,"ngIf"],[1,"icons"],["matSuffix","","class","clip-icon","svgIcon","clip-filled","tabindex","0","role","button","aria-hidden","false",3,"crtTooltip","click","keyup.enter","mousedown","focus","blur",4,"ngIf"],["matSuffix","","svgIcon","select-template-icon","tabindex","0","role","button","aria-hidden","false","class","select-template-icon",3,"crtTooltip","click","keyup.enter","focus","mousedown","blur",4,"ngIf"],["matSuffix","","crtTooltip","","tabindex","0","role","button","aria-hidden","false","svgIcon","richtext-toggle",3,"class","tooltipConfig","click","focus","blur","keyup.enter","mousedown",4,"ngIf"],["matSuffix","","svgIcon","lock","class","readonly-icon",3,"title",4,"ngIf"],["crtFullSizeImage","","crtBlockQuoteHighlight","","crtCodeSnippetHighlight","",1,"rich-editor",3,"dataChange","configChange","ready","focus","blur","click","keydown.escape","crtAnchorScrollHandler","ignoreImageClasses","toggleImageHandlers","resetHighlightCode","resetHighlightQuote","data","config","type","editorUrl"],["matSuffix","","svgIcon","clip-filled","tabindex","0","role","button","aria-hidden","false",1,"clip-icon",3,"click","keyup.enter","mousedown","focus","blur","crtTooltip"],["matSuffix","","svgIcon","select-template-icon","tabindex","0","role","button","aria-hidden","false",1,"select-template-icon",3,"click","keyup.enter","focus","mousedown","blur","crtTooltip"],["matSuffix","","crtTooltip","","tabindex","0","role","button","aria-hidden","false","svgIcon","richtext-toggle",3,"click","focus","blur","keyup.enter","mousedown","tooltipConfig"],["matSuffix","","svgIcon","lock",1,"readonly-icon",3,"title"],["type","error",3,"tooltip","ariaLabel"],[3,"tooltip","ariaLabel",4,"ngIf"],[3,"tooltip","ariaLabel"]],template:function(e,i){if(e&1){const o=n.\u0275\u0275getCurrentView();n.\u0275\u0275projectionDef(),n.\u0275\u0275elementStart(0,"div",5,0),n.\u0275\u0275projection(2),n.\u0275\u0275template(3,je,1,0,"ng-container",6),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(4,He,1,2,"crt-base-input-width-holder",7),n.\u0275\u0275elementStart(5,"div",8),n.\u0275\u0275template(6,ze,2,1,"div",9),n.\u0275\u0275elementStart(7,"div",10),n.\u0275\u0275listener("resized",function(a){return n.\u0275\u0275restoreView(o),n.\u0275\u0275resetView(i.onResized(a))}),n.\u0275\u0275template(8,$e,1,0,"crt-skeleton-loader",11)(9,Ye,16,18,"ng-template",null,1,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementEnd()()}if(e&2){const o=n.\u0275\u0275reference(10);n.\u0275\u0275advance(3),n.\u0275\u0275property("ngTemplateOutlet",i.selectionActions),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",i.displayLabelPosition==="auto"),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngIf",!i.loaderVisible),n.\u0275\u0275advance(),n.\u0275\u0275property("ngClass","label-position-"+i.displayLabelPosition+" appearance-"+i.appearance)("crtResizableDisabled",!i.isAutoLabelPosition||i.containerQueryMechanismAvailable),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",i.loaderVisible)("ngIfElse",o)}},dependencies:[E.NgClass,E.NgIf,E.NgTemplateOutlet,ae.CKEditorComponent,S.MatIcon,C.SkeletonLoaderComponent,C.TooltipDirective,C.CrtIconTooltipComponent,P.MatLegacySuffix,C.CrtResizableDirective,C.CrtBaseInputWidthHolderComponent,C.CrtFullSizeImageDirective,g.CodeSnippetHighlightDirective,g.BlockQuoteHighlightDirective,C.AnchorScrollHandlerDirective,R.TranslatePipe],styles:["body[_ngcontent-%COMP%]{--focus-outline-outer-color: var(--crt-palette-secondary-500);--focus-outline-inner-color: white}[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .link-tooltip[_ngcontent-%COMP%], [_nghost-%COMP%]   .video-tooltip[_ngcontent-%COMP%]{width:0px;height:0px;position:relative}[_nghost-%COMP%]   .crt-input-control-container.rich-editor[_ngcontent-%COMP%]{pointer-events:none}[_nghost-%COMP%]   .crt-input-control-container.rich-editor[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]{pointer-events:none}[_nghost-%COMP%]   .crt-input-control-container.rich-editor[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]   .rich-editor[_ngcontent-%COMP%]{pointer-events:auto}[_nghost-%COMP%]   .rich-editor[_ngcontent-%COMP%]{width:100%;overflow:auto}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]{width:100%;float:left;overflow:hidden;display:flex;position:relative}[_nghost-%COMP%]   .rich-editor-wrapper.hasTooltip[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]{min-width:40px;max-width:40px}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]{display:flex;align-self:flex-end;justify-content:flex-end;padding:0 0 4px;min-width:20px;max-width:20px;pointer-events:auto}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .select-template-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .clip-icon[_ngcontent-%COMP%]{cursor:pointer;color:var(--crt-palette-secondary-500)}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .select-template-icon[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .clip-icon[_ngcontent-%COMP%]:hover{color:var(--crt-palette-primary-500)}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]   .hover-tooltip[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;bottom:var(--crt-body-2-line-height)}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{max-width:16px;max-height:16px}[_nghost-%COMP%]   .rich-editor-wrapper[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]:focus-visible{box-shadow:inset 0 0 0 1px var(--focus-outline-outer-color),inset 0 0 0 2px var(--focus-outline-inner-color);outline:none;border-radius:4px}.rich-text-selection-actions[_ngcontent-%COMP%]{position:fixed;display:none;z-index:2010}","body[_ngcontent-%COMP%]{--focus-outline-outer-color: var(--crt-palette-secondary-500);--focus-outline-inner-color: white}[_nghost-%COMP%]{max-width:100%}.crt-base-edit-input-responsible[_nghost-%COMP%]   .crt-base-input-container[_ngcontent-%COMP%]{container-type:inline-size}@container (width <= 320px){[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]{min-height:52px;flex-direction:column;padding-top:0}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:8px}[_nghost-%COMP%]   .crt-input.label-position-auto.appearance-outline[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-bottom:8px}}@container (width > 320px){[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]{min-height:32px;flex-direction:row;padding-top:8px}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%]{align-self:baseline}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-inline-end:10px;display:flex;align-items:flex-start;align-self:baseline;word-break:break-word;width:136px;min-width:136px}[_nghost-%COMP%]   .crt-input.label-position-auto[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{width:100%;margin:9px 0 4px;display:-webkit-box;overflow:hidden;-webkit-line-clamp:2;-webkit-box-orient:vertical}}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]{overflow:hidden;padding-bottom:1px}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]{min-height:32px;flex-direction:row;padding-top:8px}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-control-container[_ngcontent-%COMP%]{align-self:baseline}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-inline-end:10px;display:flex;align-items:flex-start;align-self:baseline;word-break:break-word;width:136px;min-width:136px}[_nghost-%COMP%]   .crt-input.label-position-left[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{width:100%;margin:9px 0 4px;display:-webkit-box;overflow:hidden;-webkit-line-clamp:2;-webkit-box-orient:vertical}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]{min-height:52px;flex-direction:column;padding-top:0}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .crt-input.label-position-above[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:8px}[_nghost-%COMP%]   .crt-input.label-position-above.appearance-outline[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]{width:0;min-width:0;margin:0}[_nghost-%COMP%]   .crt-input.label-position-hidden[_ngcontent-%COMP%]   .crt-input-label-container[_ngcontent-%COMP%]   .crt-input-label[_ngcontent-%COMP%]{height:0;color:transparent}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]   .inner-tools-panel[_ngcontent-%COMP%]{opacity:1;display:inline-flex;flex-direction:row;flex-wrap:nowrap;justify-content:flex-end;align-items:center}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]:not(:hover)   .readonly-icon[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%], [_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   .crt-input-control[_ngcontent-%COMP%]{display:flex;padding-inline-end:2px}[_nghost-%COMP%]   .crt-input[_ngcontent-%COMP%]   textarea.mat-input-element[_ngcontent-%COMP%]{padding:0;margin:0}[_nghost-%COMP%]   .crt-input-control[_ngcontent-%COMP%]{display:flex;align-items:center;padding-inline-end:2px}"]})}};(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",String)],x.prototype,"plainText",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Array)],x.prototype,"extraPlugins",void 0),(0,c.__decorate)([(0,s.CrtOutput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"plainTextChange",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Object),(0,c.__metadata)("design:paramtypes",[Object])],x.prototype,"editorConfig",null),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Object),(0,c.__metadata)("design:paramtypes",[Object])],x.prototype,"mentionsConfig",null),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"mentionsService",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",String)],x.prototype,"editorType",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Object),(0,c.__metadata)("design:paramtypes",[Object])],x.prototype,"content",null),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",String)],x.prototype,"editorUrl",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"needHandleSave",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"alwaysShowToolbar",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Boolean)],x.prototype,"showClip",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Boolean)],x.prototype,"useTemplates",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"filesStorage",void 0),(0,c.__decorate)([(0,s.CrtOutput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"selectAttachments",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",String)],x.prototype,"selection",void 0),(0,c.__decorate)([(0,s.CrtOutput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"selectionChange",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Boolean)],x.prototype,"disableSelectionOptions",void 0),(0,c.__decorate)([(0,s.CrtOutput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"selectTemplate",void 0),(0,c.__decorate)([(0,s.CrtOutput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"filesUploaded",void 0),(0,c.__decorate)([(0,s.CrtInput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"useBodyFilesLinks",void 0),(0,c.__decorate)([(0,s.CrtOutput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"editorBlur",void 0),(0,c.__decorate)([(0,s.CrtOutput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"editorFocus",void 0),(0,c.__decorate)([(0,s.CrtOutput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"editorValueChanged",void 0),(0,c.__decorate)([(0,s.CrtOutput)(),(0,c.__metadata)("design:type",Object)],x.prototype,"newMention",void 0),x=(0,c.__decorate)([(0,s.CrtViewElement)({type:"crt.RichTextEditor",contentSlots:["selectionActions"],formControlConfig:{relatesTo:"control"},reuseStrategy:s.ViewElementReuseStrategy.Reuse}),(0,s.CrtInterfaceDesignerItem)({toolbarConfig:{groupType:s.DesignerToolGroupType.Inputs,position:41,icon:u(14560),defaultPropertyValues:{label:"",control:"",labelPosition:"auto",placeholder:"",tooltip:"",needHandleSave:!0,filesStorage:{masterRecordColumnValue:"$Id",entitySchemaName:"SysFile",recordColumnName:"RecordId",recordEntitySchemaName:""}},defaultLocalizableStrings:{caption:"Components.RichTextEditor.Caption",label:"Components.RichTextEditor.Caption"}},dataValueTypes:[s.DataValueType.RICH_TEXT],propertiesPanelComponentTypeName:"crt.RichTextPropertiesPanel",viewElementGroupType:s.ViewElementGroupType.Inputs,typeCaption:"Components.RichTextEditor.Caption"}),(0,c.__metadata)("design:paramtypes",[n.Injector,n.ChangeDetectorRef,String,Window,String,String,g.MessageDialogProvider,m.ContactColorService,m.InitialsService,h.Observable,Ce.Platform,m.FeatureValues,Function,m.BaseFileUploadProcessingService,A.FileIconService,M,fe.RightsService,C.DialogService,J])],x);class z extends F{constructor(t){super(),this._domSanitizer=t,this.urlControl=new w.FormControl("",{})}_convertToEmbedUrl(t){try{const e=new URL(t);return e.hostname.includes("youtube.com")&&e.searchParams.get("v")?`https://www.youtube.com/embed/${e.searchParams.get("v")}`:e.hostname.includes("youtu.be")?`https://www.youtube.com/embed/${e.pathname.substring(1)}`:t}catch{return""}}_getVideoTemplate(t){const e=this._domSanitizer.bypassSecurityTrustUrl(t),i=this._domSanitizer.sanitize(n.SecurityContext.URL,e);return'<iframe style="width: 100%; height: 100%;" src="'+CKEDITOR.tools.htmlEncode(this._convertToEmbedUrl(i))+'" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'}hasUnsavedChanges(){return this.urlControl.value}onSaveClick(){const t=this._getVideoTemplate(this.urlControl.value);this.videoUploaded.emit(t)}ngOnInit(){this.urlControl.valueChanges.pipe((0,h.takeUntil)(this.destroy$)).subscribe(t=>{this.valueChanged.emit(t)})}static{this.\u0275fac=function(e){return new(e||z)(n.\u0275\u0275directiveInject(f.DomSanitizer))}}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:z,selectors:[["crt-rich-text-url-video"]],features:[n.\u0275\u0275ProvidersFeature([{provide:F,useExisting:(0,n.forwardRef)(()=>z)}]),n.\u0275\u0275InheritDefinitionFeature],decls:2,vars:7,consts:[[1,"rich-text-video__input",3,"control","labelPosition","appearance","placeholder","multiline"]],template:function(e,i){e&1&&(n.\u0275\u0275element(0,"crt-input",0),n.\u0275\u0275pipe(1,"translate")),e&2&&n.\u0275\u0275property("control",i.urlControl)("labelPosition","hidden")("appearance","outline")("placeholder",n.\u0275\u0275pipeBind1(1,5,"RichTextEditorVideo.InputPlaceholder"))("multiline",!0)},dependencies:[g.CrtInputComponent,R.TranslatePipe],styles:[".rich-text-video[_ngcontent-%COMP%]{height:100%;border-radius:8px;padding:24px 32px 0}.rich-text-video__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:100%;padding-bottom:16px}.rich-text-video__input[_ngcontent-%COMP%]{margin-top:1px;display:block;height:154px}.rich-text-video__buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;flex-flow:row nowrap;margin-top:16px;margin-bottom:32px}.rich-text-video__buttons_action[_ngcontent-%COMP%]{margin-left:16px}.rich-text-video__buttons_upload[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:16px}"]})}}const et=["videoInput"];function tt(l,t){if(l&1){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementContainerStart(0),n.\u0275\u0275element(1,"crt-placeholder",7),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275elementStart(3,"crt-button",8),n.\u0275\u0275pipe(4,"translate"),n.\u0275\u0275listener("clicked",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onUploadClick())}),n.\u0275\u0275text(5),n.\u0275\u0275pipe(6,"translate"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementContainerEnd()}l&2&&(n.\u0275\u0275advance(),n.\u0275\u0275property("image",null)("subhead",n.\u0275\u0275pipeBind1(2,4,"RichTextEditorVideo.DragAndDropPlaceholder")),n.\u0275\u0275advance(2),n.\u0275\u0275property("title",n.\u0275\u0275pipeBind1(4,6,"RichTextEditorVideo.UploadButton")),n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate1(" ",n.\u0275\u0275pipeBind1(6,8,"RichTextEditorVideo.UploadButton")," "))}function nt(l,t){if(l&1){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",9),n.\u0275\u0275element(1,"mat-icon",10),n.\u0275\u0275elementStart(2,"span",11),n.\u0275\u0275text(3),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(4,"span",12),n.\u0275\u0275text(5),n.\u0275\u0275pipe(6,"memoryFormat"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(7,"mat-icon",13),n.\u0275\u0275pipe(8,"translate"),n.\u0275\u0275listener("keydown.enter",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onClearClick())})("keydown.space",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onClearClick())})("click",function(){n.\u0275\u0275restoreView(e);const o=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(o.onClearClick())}),n.\u0275\u0275elementEnd()()}if(l&2){const e=n.\u0275\u0275nextContext();n.\u0275\u0275advance(),n.\u0275\u0275property("svgIcon",e.selectedFileIcon),n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate(e.selectedFile.name),n.\u0275\u0275advance(2),n.\u0275\u0275textInterpolate(n.\u0275\u0275pipeBind1(6,4,e.selectedFile.size)),n.\u0275\u0275advance(2),n.\u0275\u0275property("crtAccessibleAttributes",n.\u0275\u0275pipeBind1(8,6,"ComboBox.ClearValue")+" "+e.ariaLabel)}}const xe={elements:{video:function(l){return l},source:function(l){return l}}};class $ extends F{get selectedFileIcon(){return this._fileIconService.getFileIcon(this.selectedFile.name)}constructor(t,e,i,o,r,a,d,p){super(),this._maskService=t,this._notifyService=e,this._fileApiService=i,this._fileService=o,this._fileIconService=r,this._translateService=a,this._toFileLinkConverter=d,this._fileUploadProcessingService=p,this.primaryDataSchemaName=""}_uploadedVideoToHtml(t){const e=new CKEDITOR.dom.element("video");e.setAttribute("controls","controls");const i=new CKEDITOR.dom.element("source");return i.setAttribute("src",t),i.setAttribute("type",this.selectedFile.type),e.append(i),e.getOuterHtml()}_getFileUploadObserver(t,e){return{next:i=>{if(i&&i[0]&&i[0].success){const o=this._toFileLinkConverter.convert(t,null,e.fileStorageName),r=this._uploadedVideoToHtml(o);this.videoUploaded.emit(r)}},complete:()=>{this._maskService.hideBodyMask()}}}_uploadVideoFile(){const t=this.dataValue.editorConfig,e=this.dataValue.viewModel,i=(0,s.generateGuid)();let o=t.masterRecordColumnValue?e[t.masterRecordColumnValue.replace("$","")]:e.Id;if(o=o?.value?o.value:o,!o){const r=this._translateService.instant("InfoDialog.FileUpload.AttachedToUnsavedRecord");this._notifyService.show({message:r}),this._maskService.hideBodyMask();return}(0,h.from)(this._fileUploadProcessingService.processSelectedFiles([this.selectedFile],null)).pipe((0,h.map)(r=>{if(r?.errors?.length>0){const a=this._fileUploadProcessingService.createFileErrorMessageForLogs(r.errors);return this._notifyService.show({message:a}),!1}return!0}),(0,h.filter)(r=>r),(0,h.switchMap)(()=>this._fileService.read(this.selectedFile)),(0,h.map)(r=>({...r,id:i,fileEntitySchemaName:t.fileStorageName,recordColumnName:t.recordColumnName,recordEntitySchemaName:t.recordEntitySchemaName||this.primaryDataSchemaName,recordId:o})),(0,h.concatMap)(r=>this._fileApiService.upload(r)),(0,h.catchError)(r=>(r?.status!==200&&this._notifyService.show({message:r.message}),h.EMPTY)),(0,h.takeUntil)(this.destroy$)).subscribe(this._getFileUploadObserver(i,t))}_addProcessorRulesForVideo(){const t=this.editor.dataProcessor;t.dataFilter.addRules(xe),t.htmlFilter.addRules(xe)}_isVideoFileValid(t){if(!t.type.startsWith("video/")){const e=this._translateService.instant("RichTextEditorVideo.NotVideoFile");return this._notifyService.show({message:e}),!1}return!0}onUploadClick(){this.videoInput.nativeElement.click()}onClearClick(){this.selectedFile=null,this.valueChanged.emit()}hasUnsavedChanges(){return!!this.selectedFile}onVideoSelected(t){const i=(t instanceof Event?t.target.files:t.files)?.[0];i&&this._isVideoFileValid(i)&&(this.selectedFile=i,this.valueChanged.emit())}onSaveClick(){this._maskService.showBodyMask(),this.hasUnsavedChanges()&&(this._addProcessorRulesForVideo(),this._uploadVideoFile())}static{this.\u0275fac=function(e){return new(e||$)(n.\u0275\u0275directiveInject(s.MaskService),n.\u0275\u0275directiveInject(C.NotifyService),n.\u0275\u0275directiveInject(m.FileApiService),n.\u0275\u0275directiveInject(m.FileReaderService),n.\u0275\u0275directiveInject(A.FileIconService),n.\u0275\u0275directiveInject(R.TranslateService),n.\u0275\u0275directiveInject(K.ToFileLinkConverter),n.\u0275\u0275directiveInject(m.BaseFileUploadProcessingService))}}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:$,selectors:[["crt-rich-text-local-video"]],viewQuery:function(e,i){if(e&1&&n.\u0275\u0275viewQuery(et,5),e&2){let o;n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(i.videoInput=o.first)}},inputs:{dataValue:"dataValue",editor:"editor",primaryDataSchemaName:"primaryDataSchemaName"},features:[n.\u0275\u0275ProvidersFeature([{provide:F,useExisting:(0,n.forwardRef)(()=>$)}]),n.\u0275\u0275InheritDefinitionFeature],decls:8,vars:6,consts:[["fileSelected",""],["videoInput",""],[3,"fileDropped","ngClass","showOverlay","multiple","disabled"],[1,"rich-text-video__file-drop"],[1,"rich-text-video__file-drop__placeholder"],[4,"ngIf","ngIfElse"],["type","file","accept","video/*",2,"display","none",3,"change"],[3,"image","subhead"],["size","large","color","primary","icon","upload-button-icon","iconPosition","left-icon",1,"rich-text-video__buttons_upload",3,"clicked","title"],[1,"rich-text-video__file"],["matSuffix","",1,"rich-text-video__file_icon",3,"svgIcon"],[1,"rich-text-video__file_name"],[1,"rich-text-video__file_size"],["matSuffix","","svgIcon","small-close",1,"rich-text-video__file_icon",3,"keydown.enter","keydown.space","click","crtAccessibleAttributes"]],template:function(e,i){if(e&1){const o=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"crt-file-drop",2),n.\u0275\u0275listener("fileDropped",function(a){return n.\u0275\u0275restoreView(o),n.\u0275\u0275resetView(i.onVideoSelected(a))}),n.\u0275\u0275elementStart(1,"div",3)(2,"div",4),n.\u0275\u0275template(3,tt,7,10,"ng-container",5)(4,nt,9,8,"ng-template",null,0,n.\u0275\u0275templateRefExtractor),n.\u0275\u0275elementEnd()()(),n.\u0275\u0275elementStart(6,"input",6,1),n.\u0275\u0275listener("change",function(a){return n.\u0275\u0275restoreView(o),n.\u0275\u0275resetView(i.onVideoSelected(a))}),n.\u0275\u0275elementEnd()}if(e&2){const o=n.\u0275\u0275reference(5);n.\u0275\u0275property("ngClass","drop-placeholder")("showOverlay",!0)("multiple",!1)("disabled",!1),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngIf",!i.selectedFile)("ngIfElse",o)}},dependencies:[E.NgClass,E.NgIf,g.CrtButtonComponent,S.MatIcon,P.MatLegacySuffix,C.CrtPlaceholderComponent,g.CrtFileDropComponent,R.TranslatePipe,m.MemoryFormatPipe],styles:[".rich-text-video[_ngcontent-%COMP%]{height:100%;border-radius:8px;padding:24px 32px 0}.rich-text-video__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:100%;padding-bottom:16px}.rich-text-video__input[_ngcontent-%COMP%]{margin-top:1px;display:block;height:154px}.rich-text-video__buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;flex-flow:row nowrap;margin-top:16px;margin-bottom:32px}.rich-text-video__buttons_action[_ngcontent-%COMP%]{margin-left:16px}.rich-text-video__buttons_upload[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:16px}",".rich-text-video__file-drop[_ngcontent-%COMP%]{padding:8px;width:100%;height:136px;align-items:center}.rich-text-video__file-drop__placeholder[_ngcontent-%COMP%]{align-items:center;width:100%;height:100%;text-align:center;display:flex;flex-direction:column;justify-content:center}.rich-text-video__file[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;height:100%}.rich-text-video__file_icon[_ngcontent-%COMP%]{width:16px;height:16px}.rich-text-video__file_name[_ngcontent-%COMP%]{white-space:nowrap}"]})}}class V extends F{constructor(){super(...arguments),this.embededControl=new w.FormControl("",{})}hasUnsavedChanges(){return this.embededControl.value}onSaveClick(){this.videoUploaded.emit(this.embededControl.value)}ngOnInit(){this.embededControl.valueChanges.pipe((0,h.takeUntil)(this.destroy$)).subscribe(t=>{this.valueChanged.emit(t)})}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=n.\u0275\u0275getInheritedFactory(V)))(i||V)}})()}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:V,selectors:[["crt-rich-text-embed-video"]],features:[n.\u0275\u0275ProvidersFeature([{provide:F,useExisting:(0,n.forwardRef)(()=>V)}]),n.\u0275\u0275InheritDefinitionFeature],decls:2,vars:7,consts:[[1,"rich-text-video__input",3,"control","labelPosition","appearance","placeholder","multiline"]],template:function(e,i){e&1&&(n.\u0275\u0275element(0,"crt-input",0),n.\u0275\u0275pipe(1,"translate")),e&2&&n.\u0275\u0275property("control",i.embededControl)("labelPosition","hidden")("appearance","outline")("placeholder",n.\u0275\u0275pipeBind1(1,5,"RichTextEditorVideo.InputPlaceholder"))("multiline",!0)},dependencies:[g.CrtInputComponent,R.TranslatePipe],styles:[".rich-text-video[_ngcontent-%COMP%]{height:100%;border-radius:8px;padding:24px 32px 0}.rich-text-video__header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:100%;padding-bottom:16px}.rich-text-video__input[_ngcontent-%COMP%]{margin-top:1px;display:block;height:154px}.rich-text-video__buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;flex-flow:row nowrap;margin-top:16px;margin-bottom:32px}.rich-text-video__buttons_action[_ngcontent-%COMP%]{margin-left:16px}.rich-text-video__buttons_upload[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:16px}"]})}}let te=class extends s.BaseRequestHandler{constructor(t,e,i){super(),this._service=t,this._maskService=e,this._copilotToEditorCommunicationService=i}_getEditors(t){return window.CKEDITOR?.instances?Object.values(CKEDITOR.instances).filter(i=>i.needHandleSave&&i.schemaRecordId===t):[]}_removeCopilotHighlighting(){this._copilotToEditorCommunicationService?.notify({editorAction:m.EditorActionType.RemoveHighlighting})}_saveTableOfContents(t){t.forEach(e=>{ee.generateTableOfContents(e),e.fire("change")})}_saveFiles(t,e,i){var o=this;return(0,O.A)(function*(){if(t.length>0){const r=o._service.uploadFile(t,{schemaName:e.name,recordId:i.$context.attributes.Id},i.$context.attributes).pipe((0,h.take)(1));yield(0,h.lastValueFrom)(r,{defaultValue:null}),t.forEach(a=>{a.uploadFilesData=null})}})()}_saveImages(t,e,i){var o=this;return(0,O.A)(function*(){if(t.length>0){const r=o._service.uploadImages(t,{schemaName:e,recordId:i.$context.attributes.Id}).pipe((0,h.take)(1)),a=yield(0,h.lastValueFrom)(r,{defaultValue:null});return o._service.removeImages(t),a}})()}handle(t){var e=this;return(0,O.A)(function*(){const i="RECORD_SAVING",o=t.$context,r=yield o.Id,a=yield o.getPrimaryDataSchema(),d=e._getEditors(r);if(!a||d.length===0)return e.next?.handle(t);yield e._maskService.showMask(i,t.$context);const p=yield t.$context.CardState;p===s.ModelInPageAction.Edit&&(yield e._saveImages(d,a.name,t)),e._removeCopilotHighlighting(),e._saveTableOfContents(d);const _=yield e.next?.handle(t);if(_&&(yield e._saveFiles(d,a,t),p===s.ModelInPageAction.Add&&(yield e._saveImages(d,a.name,t)))){const y=d.map(X=>{const q=o.getAttributeNameByViewItemName(X.config.name);return{name:o.getBoundDataSchemaAttributeByAttributePath(q).path,value:X.getData()}});yield(0,h.lastValueFrom)(e._service.updateColumnValue(a.name,r,y))}return yield e._maskService.hideMask(i,t.$context),_})()}};te=(0,c.__decorate)([(0,s.CrtRequestHandler)({type:"crt.RichTextEditorSaveHandler",requestType:"crt.SaveRecordRequest",scopes:[U.Scopes.AllCards,"BasePageFreedomTemplate",U.Scopes.AllSections]}),(0,c.__metadata)("design:paramtypes",[M,s.MaskService,m.CopilotToEditorCommunicationService])],te);let ne=class extends s.BaseRequestHandler{constructor(){super()}handle(t){var e=this;return(0,O.A)(function*(){const o=yield t.$context.Id;return window.CKEDITOR?.instances&&Object.values(CKEDITOR.instances).filter(a=>a.schemaRecordId===o&&a.uploadFilesData!==null).forEach(a=>{a.uploadFilesData=null}),yield e.next?.handle(t)})()}};ne=(0,c.__decorate)([(0,s.CrtRequestHandler)({type:"crt.RichTextEditorCancelHandler",requestType:"crt.CancelRecordChangesRequest",scopes:[U.Scopes.AllCards,"BasePageFreedomTemplate",U.Scopes.AllSections]}),(0,c.__metadata)("design:paramtypes",[])],ne);class Z{constructor(t){this._selectionActionsMetadataService=t}_getViewConfigs(t,e){return m.MetadataSchemaUtils.getViewConfigInfoByProperty("type",e,t.viewConfig).map(i=>i?.viewConfig).filter(Boolean)}crtOnMetaDataInit(t){var e=this;return(0,O.A)(function*(){const i=t,o=e._getViewConfigs(i,"crt.RichTextEditor");for(const r of o)yield e._selectionActionsMetadataService.setRewriteOptions(i,r);return Promise.resolve(t)})()}static{this.\u0275fac=function(e){return new(e||Z)(n.\u0275\u0275inject(j))}}static{this.\u0275prov=n.\u0275\u0275defineInjectable({token:Z,factory:Z.\u0275fac})}}let ie=class _e{constructor(t,e){this._matIconRegistry=t,this._domSanitizer=e,this._registerIcons()}_registerIcons(){["clip-filled","select-template-icon","richtext-toggle","open-link","close-link","save-link","unlink-link","info-icon"].forEach(e=>{const i=u(57900)("./"+e+".svg");this._matIconRegistry.addSvgIconLiteral(e,this._domSanitizer.bypassSecurityTrustHtml(i))})}static{this.\u0275fac=function(e){return new(e||_e)(n.\u0275\u0275inject(S.MatIconRegistry),n.\u0275\u0275inject(f.DomSanitizer))}}static{this.\u0275mod=n.\u0275\u0275defineNgModule({type:_e})}static{this.\u0275inj=n.\u0275\u0275defineInjector({providers:[{provide:m.CKEDITOR_URL,useValue:(0,m.getWorkspaceBaseUrl)()+"core/hash/CKEditor/ckeditor.js"},{provide:se,useFactory:()=>window.Terrasoft?.isAngularHost?"shell/styles":"schema-view-component/styles.css"},{provide:m.CRT_METADATA_PREPROCESSOR,useClass:Z,multi:!0},j,H,M,m.FileReaderService,W],imports:[E.CommonModule,ae.CKEditorModule,g.CrtButtonModule,g.CrtDialogModule,S.MatIconModule,v.MatLegacyTooltipModule,w.FormsModule,w.ReactiveFormsModule,C.CrtSkeletonLoaderModule,A.CdkModule,C.TooltipModule,P.MatLegacyFormFieldModule,re.MatLegacyInputModule,g.CrtInputModule,k.CrtLibTranslateModule.forRoot({i18n:be}),C.CrtBaseInputWidthHolderModule,C.CrtFullSizeImageModule,g.CrtTabPanelModule,g.CrtComponentsModule,ge.ViewModule,L.MatDialogModule,g.CrtFileDropModule,m.MemoryFormattingModule]})}};ie=(0,c.__decorate)([(0,s.CrtModule)({viewElements:[x,D],requestHandlers:[te,ne]}),(0,c.__metadata)("design:paramtypes",[S.MatIconRegistry,f.DomSanitizer])],ie),function(){(typeof ngJitMode>"u"||ngJitMode)&&n.\u0275\u0275setNgModuleScope(ie,{declarations:[x,D,N,z,$,V],imports:[E.CommonModule,ae.CKEditorModule,g.CrtButtonModule,g.CrtDialogModule,S.MatIconModule,v.MatLegacyTooltipModule,w.FormsModule,w.ReactiveFormsModule,C.CrtSkeletonLoaderModule,A.CdkModule,C.TooltipModule,P.MatLegacyFormFieldModule,re.MatLegacyInputModule,g.CrtInputModule,k.CrtLibTranslateModule,C.CrtResizableDirective,C.CrtBaseInputWidthHolderModule,C.CrtFullSizeImageModule,g.CrtTabPanelModule,g.CrtComponentsModule,ge.ViewModule,L.MatDialogModule,g.CrtFileDropModule,m.MemoryFormattingModule,g.CodeSnippetHighlightDirective,g.BlockQuoteHighlightDirective,C.AnchorScrollHandlerDirective],exports:[x,D,N]})}(),n.\u0275\u0275setComponentScope(N,[E.NgSwitch,E.NgSwitchCase,g.CrtButtonComponent,g.CrtTabPanelComponent,g.CrtLabelComponent,z,$,V],[R.TranslatePipe]);let pe=class extends s.BaseRequest{};pe=(0,c.__decorate)([(0,s.CrtRequest)({type:"crt.SelectionActionRequest"})],pe)},86142:T=>{T.exports=`<svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M9.91327 3.69279C9.53448 3.69279 9.17121 3.84326 8.90337 4.1111L4.46517 8.54931C3.98313 9.03135 3.71232 9.68513 3.71232 10.3668C3.71232 11.0485 3.98313 11.7023 4.46517 12.1844C4.94721 12.6664 5.60099 12.9372 6.2827 12.9372C6.96441 12.9372 7.6182 12.6664 8.10024 12.1844L12.5384 7.74617C12.8728 7.41182 13.4149 7.41182 13.7492 7.74617C14.0836 8.08052 14.0836 8.62261 13.7492 8.95696L9.31103 13.3952C8.50787 14.1983 7.41854 14.6495 6.2827 14.6495C5.14686 14.6495 4.05754 14.1983 3.25437 13.3952C2.45121 12.592 2 11.5027 2 10.3668C2 9.231 2.45121 8.14168 3.25437 7.33851L7.69258 2.90031C8.28154 2.31134 9.08035 1.98047 9.91327 1.98047C10.7462 1.98047 11.545 2.31134 12.1339 2.90031C12.7229 3.48927 13.0538 4.28807 13.0538 5.12099C13.0538 5.95391 12.7229 6.75271 12.1339 7.34167L7.69003 11.7799C7.3153 12.1544 6.80683 12.3652 6.27699 12.3652C5.747 12.3652 5.23871 12.1546 4.86395 11.7799C4.48919 11.4051 4.27865 10.8968 4.27865 10.3668C4.27865 9.83685 4.48919 9.32856 4.86395 8.9538L8.90298 4.92049C9.23753 4.58633 9.77962 4.58665 10.1138 4.9212C10.4479 5.25575 10.4476 5.79784 10.1131 6.13199L6.07475 10.1646C6.02116 10.2182 5.99097 10.291 5.99097 10.3668C5.99097 10.4427 6.02111 10.5154 6.07475 10.5691C6.12839 10.6227 6.20114 10.6529 6.27699 10.6529C6.35285 10.6529 6.4256 10.6227 6.47924 10.5691L10.9232 6.13088C11.191 5.86305 11.3415 5.49974 11.3415 5.12099C11.3415 4.74221 11.191 4.37894 10.9232 4.1111C10.6553 3.84326 10.292 3.69279 9.91327 3.69279Z" fill="currentColor"/>
</svg>
`},32258:T=>{T.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M3.28501 3.28501C3.66502 2.905 4.28114 2.905 4.66115 3.28501L8 6.62385L11.3388 3.28501C11.7189 2.905 12.335 2.905 12.715 3.28501C13.095 3.66502 13.095 4.28114 12.715 4.66115L9.37615 8L12.715 11.3388C13.095 11.7189 13.095 12.335 12.715 12.715C12.335 13.095 11.7189 13.095 11.3388 12.715L8 9.37615L4.66115 12.715C4.28114 13.095 3.66502 13.095 3.28501 12.715C2.905 12.335 2.905 11.7189 3.28501 11.3388L6.62385 8L3.28501 4.66115C2.905 4.28114 2.905 3.66502 3.28501 3.28501Z" fill="currentColor"/>
</svg>
`},29759:T=>{T.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M13.1592 7.99998C13.1592 5.15064 10.8494 2.84079 8.00004 2.84079C5.1507 2.84079 2.84085 5.15064 2.84085 7.99998C2.84085 10.8493 5.1507 13.1592 8.00004 13.1592C10.8494 13.1592 13.1592 10.8493 13.1592 7.99998ZM8.00004 1.50079C11.5894 1.50079 14.4992 4.41058 14.4992 7.99998C14.4992 11.5894 11.5894 14.4992 8.00004 14.4992C4.41064 14.4992 1.50085 11.5894 1.50085 7.99998C1.50085 4.41058 4.41064 1.50079 8.00004 1.50079ZM7.16167 5.39671C7.16167 4.93555 7.53551 4.56171 7.99667 4.56171H8.00333C8.46449 4.56171 8.83833 4.93555 8.83833 5.39671C8.83833 5.85786 8.46449 6.23171 8.00333 6.23171H7.99667C7.53551 6.23171 7.16167 5.85786 7.16167 5.39671ZM7.99979 6.95437C8.46095 6.95477 8.83447 7.32893 8.83407 7.79009L8.83163 10.6063C8.83123 11.0674 8.45706 11.4409 7.9959 11.4405C7.53475 11.4401 7.16123 11.066 7.16163 10.6048L7.16407 7.78864C7.16447 7.32749 7.53864 6.95397 7.99979 6.95437Z" fill="currentColor"/>
</svg>
`},37480:T=>{T.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8.67553 3.30182C8.67553 2.85899 9.03452 2.5 9.47735 2.5H12.6017C13.0975 2.5 13.4995 2.90198 13.4995 3.39784V6.52217C13.4995 6.965 13.1405 7.32398 12.6977 7.32398C12.2549 7.32398 11.8959 6.965 11.8959 6.52217V5.23993L7.61104 9.53408C7.29825 9.84755 6.79057 9.8481 6.4771 9.53531C6.16363 9.22252 6.16308 8.71484 6.47587 8.40137L10.7643 4.10363H9.47735C9.03452 4.10363 8.67553 3.74465 8.67553 3.30182ZM5.22234 4.10363C4.60449 4.10363 4.10363 4.60449 4.10363 5.22234V10.7776C4.10363 11.3954 4.60449 11.8963 5.22234 11.8963H10.7776C11.3954 11.8963 11.8963 11.3954 11.8963 10.7776V9.78139C11.8963 9.33856 12.2553 8.97958 12.6981 8.97958C13.1409 8.97958 13.4999 9.33856 13.4999 9.78139V10.7776C13.4999 12.2811 12.2811 13.4999 10.7776 13.4999H5.22234C3.71883 13.4999 2.5 12.2811 2.5 10.7776V5.22234C2.5 3.71883 3.71883 2.5 5.22234 2.5H6.18746C6.63029 2.5 6.98928 2.85899 6.98928 3.30182C6.98928 3.74465 6.63029 4.10363 6.18746 4.10363H5.22234Z" fill="currentColor"/>
</svg>
`},54373:T=>{T.exports=`<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
<g>
<path d="M13.7355 1.48633H3.73547C2.6309 1.48633 1.73547 2.38176 1.73547 3.48633V13.4863C1.73547 14.5909 2.6309 15.4863 3.73547 15.4863H13.7355C14.84 15.4863 15.7355 14.5909 15.7355 13.4863V3.48633C15.7355 2.38176 14.84 1.48633 13.7355 1.48633Z" stroke="currentColor" stroke-width="2" stroke-miterlimit="10"/>
<path d="M9.73547 12.4863H7.73547V6.48633H4.73547V4.48633H12.7355V6.48633H9.73547V12.4863Z" fill="currentColor"/>
</g>
</svg>
`},42085:T=>{T.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M3.69231 2C3.24348 2 2.81303 2.1783 2.49567 2.49567C2.1783 2.81303 2 3.24348 2 3.69231V12.3077C2 12.7565 2.1783 13.187 2.49567 13.5043C2.81303 13.8217 3.24348 14 3.69231 14H12.3077C12.7565 14 13.187 13.8217 13.5043 13.5043C13.8217 13.187 14 12.7565 14 12.3077V5.53846C14 5.41605 13.9514 5.29866 13.8648 5.2121L10.7879 2.13518C10.7013 2.04863 10.5839 2 10.4615 2H3.69231ZM11.2653 7.25728C11.6058 6.95867 11.6397 6.44059 11.3411 6.10011C11.0425 5.75963 10.5244 5.72569 10.1839 6.0243L6.7897 9.00114L5.80197 8.05396C5.4751 7.74051 4.95601 7.75139 4.64257 8.07826C4.32912 8.40514 4.34 8.92422 4.66687 9.23767L6.19742 10.7054C6.5045 10.9998 6.98579 11.0105 7.30565 10.73L11.2653 7.25728Z" fill="currentColor"/>
</svg>
`},56148:T=>{T.exports=`<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M2.5 3.31445C2.5 2.76217 2.94772 2.31445 3.5 2.31445H13.5C14.0523 2.31445 14.5 2.76217 14.5 3.31445V4.28496C14.5 4.83725 14.0523 5.28496 13.5 5.28496H3.5C2.94772 5.28496 2.5 4.83724 2.5 4.28496V3.31445ZM7.44922 7.32042C7.44922 6.76813 7.89693 6.31768 8.44922 6.31768H13.4492C14.0015 6.31768 14.4492 6.76813 14.4492 7.32042C14.4492 7.8727 14.0015 8.32316 13.4492 8.32316H8.44922C7.89693 8.32316 7.44922 7.8727 7.44922 7.32042ZM14.4492 10.3161C14.4492 9.76378 14.0015 9.31332 13.4492 9.31332H8.44922C7.89693 9.31332 7.44922 9.76378 7.44922 10.3161C7.44922 10.8683 7.89693 11.3188 8.44922 11.3188H13.4492C14.0015 11.3188 14.4492 10.8683 14.4492 10.3161ZM7.44922 13.3117C7.44922 12.7594 7.89693 12.309 8.44922 12.309H13.4492C14.0015 12.309 14.4492 12.7594 14.4492 13.3117C14.4492 13.864 14.0015 14.3145 13.4492 14.3145H8.44922C7.89693 14.3145 7.44922 13.864 7.44922 13.3117ZM6.5 7.29254C6.5 6.74025 6.05228 6.29254 5.5 6.29254H3.5C2.94772 6.29254 2.5 6.74025 2.5 7.29254V13.2139C2.5 13.7662 2.94772 14.2139 3.5 14.2139H5.5C6.05228 14.2139 6.5 13.7662 6.5 13.2139V7.29254Z" fill="currentColor"/>
</svg>
`},52655:T=>{T.exports=`<svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M14.8054 3.54116C15.0664 3.27893 15.0655 2.85471 14.8033 2.59364C14.5411 2.33256 14.1168 2.33349 13.8558 2.59572L13.0894 3.36548C12.848 3.19009 12.5809 3.04244 12.2943 2.95882C12.0236 2.87985 11.7237 2.85474 11.4149 2.92959C11.1043 3.00489 10.8272 3.17115 10.5891 3.40989L8.50246 5.50488C8.26429 5.744 8.09908 6.02184 8.02434 6.33239C7.95008 6.64101 7.97498 6.94087 8.05342 7.21173C8.20418 7.73228 8.56447 8.18891 8.91972 8.54519C9.27452 8.90182 9.72985 9.26456 10.2498 9.4164C10.5206 9.49549 10.8208 9.5206 11.1298 9.44543C11.4405 9.36985 11.7176 9.20319 11.9555 8.96413L14.0418 6.86944C14.2799 6.63038 14.4451 6.35262 14.5199 6.0421C14.5942 5.7335 14.5692 5.43367 14.4908 5.16285C14.4008 4.85233 14.2363 4.56451 14.0427 4.30714L14.8054 3.54116ZM12.1243 4.33479L11.3749 5.08754C11.1138 5.34976 11.1147 5.77398 11.377 6.03506C11.6392 6.29613 12.0634 6.2952 12.3245 6.03298L13.0814 5.27274C13.1403 5.36906 13.181 5.45731 13.2037 5.53572C13.2296 5.62497 13.2275 5.68522 13.2171 5.72848C13.2071 5.76981 13.1801 5.83569 13.0923 5.92382L11.006 8.0185C10.9181 8.10689 10.8527 8.13376 10.8131 8.1434C10.7716 8.15349 10.7132 8.15576 10.6254 8.13012C10.4282 8.07253 10.1664 7.89836 9.86944 7.59987C9.57303 7.30265 9.39836 7.03864 9.34053 6.83896C9.31466 6.74964 9.31672 6.68928 9.32715 6.64591C9.33712 6.60447 9.36416 6.53857 9.45188 6.4505L11.5379 4.35612C11.6256 4.26822 11.6908 4.24152 11.7306 4.23186C11.7723 4.22175 11.831 4.21953 11.919 4.24519C11.9813 4.26337 12.0501 4.29316 12.1243 4.33479Z" fill="currentColor"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M4.68883 14.8904C4.39456 14.8045 4.12097 14.651 3.87456 14.4693L3.1448 15.2023C2.88373 15.4645 2.45951 15.4655 2.19728 15.2044C1.93506 14.9433 1.93412 14.5191 2.1952 14.2569L2.92612 13.5227C2.73833 13.2699 2.57926 12.9881 2.49137 12.6847C2.41289 12.4137 2.38799 12.1137 2.46228 11.805C2.53704 11.4943 2.70232 11.2164 2.94059 10.9771L5.02824 8.88111C5.26643 8.64226 5.54401 8.47564 5.8547 8.40031C6.16356 8.32543 6.46362 8.35055 6.73441 8.42955C7.25451 8.58128 7.71012 8.94371 8.0653 9.30031C8.42058 9.65701 8.78117 10.1139 8.93203 10.6347C9.01052 10.9056 9.03545 11.2056 8.96113 11.5143C8.88634 11.8249 8.72104 12.1028 8.48283 12.342L6.39549 14.4377C6.15749 14.6768 5.88001 14.8439 5.56923 14.9195C5.26011 14.9947 4.95979 14.9696 4.68883 14.8904ZM5.97749 9.8269C6.06532 9.73887 6.13047 9.71227 6.17043 9.70258C6.21224 9.69245 6.27105 9.69023 6.35912 9.71592C6.55676 9.77358 6.81888 9.94774 7.11588 10.2459C7.41279 10.544 7.58706 10.8077 7.64496 11.0076C7.67085 11.0969 7.66879 11.1573 7.65835 11.2007C7.64837 11.2421 7.62129 11.3081 7.53341 11.3963L5.44577 13.4924C5.35774 13.5809 5.29224 13.6078 5.25248 13.6175C5.21093 13.6276 5.15238 13.6298 5.06447 13.6042C4.99616 13.5842 4.92011 13.5503 4.83756 13.5021L5.62511 12.7111C5.88618 12.4489 5.88525 12.0246 5.62303 11.7636C5.3608 11.5025 4.93658 11.5034 4.6755 11.7656L3.88909 12.5555C3.83644 12.4667 3.79967 12.385 3.77848 12.3119C3.75258 12.2225 3.75462 12.162 3.76509 12.1185C3.77508 12.0769 3.80218 12.0109 3.89001 11.9228L5.97749 9.8269Z" fill="currentColor"/>
</svg>
`},14560:T=>{T.exports=`<svg width="72" height="40" viewBox="0 0 72 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect x="8.5" y="8.5" width="55" height="23" rx="0.5" fill="white" stroke="#0D2E4E"/>
<path d="M37 17H19C17.3431 17 16 18.3431 16 20C16 21.6569 17.3431 23 19 23H37C38.6569 23 40 21.6569 40 20C40 18.3431 38.6569 17 37 17Z" fill="#D1D1D1"/>
<path d="M57 13H47C45.8954 13 45 13.8954 45 15V25C45 26.1046 45.8954 27 47 27H57C58.1046 27 59 26.1046 59 25V15C59 13.8954 58.1046 13 57 13Z" stroke="#FF4013" stroke-width="2" stroke-miterlimit="10"/>
<path d="M53 24H51V18H48V16H56V18H53V24Z" fill="#FF4013"/>
</svg>
`}}]);
