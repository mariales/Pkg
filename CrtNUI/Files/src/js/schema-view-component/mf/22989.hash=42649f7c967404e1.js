(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[22989,73308,50927,28546,6165,62832,40451,18070,95689,94260,71879,41421,63802,86183,8564,30945,53326,75707,98088,20469,42850,70422,48041,15184,92803,80898,58517,25660,3279,91374,68993,83231,5612,38469],{22989:(ie,K,p)=>{p.r(K),p.d(K,{CrtPageToolsComponent:()=>V,CrtReusableSchemaComponent:()=>R,SCHEMA_COMPONENT_INJECTION_TOKEN:()=>de,SchemaCacheInitializerService:()=>B,SchemaComponent:()=>D,SchemaConvertersRegistryService:()=>M,SchemaInitializerService:()=>E,SchemaModule:()=>J,SchemaViewModelGenerator:()=>w});var y=p(40297),v=p(96590),T=p(20822),_=p(47742),f=p(22438),o=p(10850),s=p(59131),P=p(85638),l=p(21018),c=p(62278),b=p(79772);function Y(C,e){if(C&1){const t=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"crt-button",2),s.\u0275\u0275pipe(1,"translate"),s.\u0275\u0275listener("clicked",function(a){s.\u0275\u0275restoreView(t);const n=s.\u0275\u0275nextContext();return s.\u0275\u0275resetView(n.onDesignButtonClicked(a))}),s.\u0275\u0275elementEnd()}C&2&&s.\u0275\u0275property("iconSize","medium")("iconPosition","only-icon")("size","medium")("title",s.\u0275\u0275pipeBind1(1,5,"PageTools.DesignButtonHint"))("shape","rounded")}function ae(C,e){if(C&1){const t=s.\u0275\u0275getCurrentView();s.\u0275\u0275elementStart(0,"crt-button",3),s.\u0275\u0275pipe(1,"translate"),s.\u0275\u0275listener("clicked",function(){s.\u0275\u0275restoreView(t);const a=s.\u0275\u0275nextContext();return s.\u0275\u0275resetView(a.onExpandButtonClicked())}),s.\u0275\u0275elementEnd()}if(C&2){const t=s.\u0275\u0275nextContext();s.\u0275\u0275property("icon",t.expandButtonIcon)("iconSize","medium")("iconPosition","only-icon")("size","medium")("title",s.\u0275\u0275pipeBind1(1,6,t.expandButtonTitle)+" (Ctrl+Shift+F)")("shape","rounded")}}class V{constructor(e){this.injector=e,this._rightsService=this.injector.get(P.RightsService),this._storageService=this.injector.get(l.StorageService),this._featureValues=this.injector.get(l.FEATURE_VALUES),this._window=this.injector.get(v.WINDOW_TOKEN),this._document=this.injector.get(y.DOCUMENT),this._allowPageDesign=this.injector.get(l.ALLOW_PAGE_DESIGN,!1),this._trapFocusService=this.injector.get(l.TrapFocusService,null,{optional:!0}),this._expandAttributeName="center-container-expanded",this._storageExpandedKey="isCenterContainerExpanded",this._features$=new c.ReplaySubject(1),this.expandButtonIcon="expand-icon",this.designButtonVisible=!1,this.expandButtonVisible=!1,this.isRtl=!1,this._expandButtonState=this._loadExpandedFromStorage()}get _expandButtonState(){return this._document.body.getAttribute(this._expandAttributeName)==="true"}set _expandButtonState(e){this._document.body.setAttribute(this._expandAttributeName,String(e)),this._setTrapFocusState(),this._saveExpandedToStorage(e)}get schema(){return this._schemaName}set schema(e){this._schemaName=e,this._updateToolsButtonVisibility(),this._updateExpandButtonInfo()}set features(e){this._features$.next(e)}_saveExpandedToStorage(e){this._storageService.set(this._storageExpandedKey,String(e))}_loadExpandedFromStorage(){return this._storageService.get(this._storageExpandedKey)==="true"}_updateExpandButtonInfo(){const e=this._expandButtonState;this._setExpandButtonInfo(e)}_updateToolsButtonVisibility(){this._updateDesignButtonVisibility(),this._updateExpandButtonVisibility()}_updateDesignButtonVisibility(){if(!this._allowPageDesign){this.designButtonVisible=!1;return}(0,c.combineLatest)([this._features$,this._rightsService.getCanExecuteOperation("CanManageSolution")]).subscribe(([e,t])=>{this.designButtonVisible=e?.tools?.canDesign&&t})}_updateExpandButtonVisibility(){if(this._featureValues.DisableCenterContainerExpandButtonFeature){this.expandButtonVisible=!1;return}this._features$.subscribe(e=>{this.expandButtonVisible=e?.tools?.canExpand,this._setTrapFocusState()})}_setExpandButtonInfo(e){this.expandButtonIcon=e?"collapse-icon":"expand-icon",this.expandButtonTitle=e?"PageTools.CollapseButtonTitle":"PageTools.ExpandButtonTitle"}_setTrapFocusState(){this._trapFocusService&&this.expandButtonVisible&&(this._trapFocusService.enabled=this._expandButtonState)}onKeyDown(e){this.expandButtonVisible&&e.ctrlKey&&e.shiftKey&&e.code==="KeyF"&&this.onExpandButtonClicked()}onDesignButtonClicked(e){let i=`${(0,l.getWorkspaceBaseUrl)()}ClientApp/#/InterfaceDesigner/${this.schema}`;e?.altKey&&(i+="?sourceCode=true"),this._window.open(i,"_blank")}onExpandButtonClicked(){const t=!this._expandButtonState;this._expandButtonState=t,this._setExpandButtonInfo(t)}static{this.\u0275fac=function(t){return new(t||V)(s.\u0275\u0275directiveInject(s.Injector))}}static{this.\u0275cmp=s.\u0275\u0275defineComponent({type:V,selectors:[["crt-page-tools"]],hostVars:2,hostBindings:function(t,i){t&1&&s.\u0275\u0275listener("keydown",function(n){return i.onKeyDown(n)},!1,s.\u0275\u0275resolveWindow),t&2&&s.\u0275\u0275classProp("rtl",i.isRtl)},inputs:{isRtl:"isRtl",schema:"schema",features:"features"},features:[s.\u0275\u0275ProvidersFeature([l.StorageService])],decls:2,vars:2,consts:[["class","design-button","icon","min-settings-icon",3,"iconSize","iconPosition","size","title","shape","clicked",4,"ngIf"],["class","expand-button",3,"icon","iconSize","iconPosition","size","title","shape","clicked",4,"ngIf"],["icon","min-settings-icon",1,"design-button",3,"clicked","iconSize","iconPosition","size","title","shape"],[1,"expand-button",3,"clicked","icon","iconSize","iconPosition","size","title","shape"]],template:function(t,i){t&1&&s.\u0275\u0275template(0,Y,2,7,"crt-button",0)(1,ae,2,8,"crt-button",1),t&2&&(s.\u0275\u0275property("ngIf",i.designButtonVisible),s.\u0275\u0275advance(),s.\u0275\u0275property("ngIf",i.expandButtonVisible))},dependencies:[y.NgIf,T.CrtButtonComponent,b.TranslatePipe],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row}.rtl[_nghost-%COMP%]{flex-direction:row-reverse}crt-button[_ngcontent-%COMP%]{--button-rounded-border-radius: 50%;--crt-button-default-contrast-color: var(--crt-color-primary-grey)}"]})}}class x{constructor(e,t){this._macrosHandlerService=e,this._metadataModifierService=t}crtOnMetaDataInit(e){return(0,c.lastValueFrom)(this._macrosHandlerService.handleResourceMacros(e,e.resources,{setPropertyFn:t=>this._metadataModifierService.updateProperty(t)}),{defaultValue:null})}crtOnViewModelInit(e,t,i){return(0,c.lastValueFrom)(this._macrosHandlerService.handleResourceMacros(e,i.Resources,{setPropertyFn:a=>this._metadataModifierService.updateProperty(a)}),{defaultValue:null})}static{this.\u0275fac=function(t){return new(t||x)(s.\u0275\u0275inject(l.MacrosHandlerService),s.\u0275\u0275inject(o.MetadataModifierService))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:x,factory:x.\u0275fac})}}var g=p(73308);class O{_setPrimaryDataSource(e){e.modelConfig&&(e.modelConfig.primaryDataSourceName=(0,f.resolveSchemaPrimaryDataSource)(e))}_setScopes(e){(0,f.setDataSourcesScope)(e)}crtOnMetaDataInit(e){var t=this;return(0,g.A)(function*(){const i=e;return t._setPrimaryDataSource(i),t._setScopes(i),e})()}static{this.\u0275fac=function(t){return new(t||O)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac})}}class A{constructor(e,t){this._macrosHandlerService=e,this._metadataModifierService=t}_handleMacros(e,t){return(0,c.lastValueFrom)(this._macrosHandlerService.handleMacros(e,t,t,{setPropertyFn:i=>this._metadataModifierService.updateProperty(i)}),{defaultValue:null})}crtOnMetaDataInit(e){var t=this;return(0,g.A)(function*(){let i=e;return i=yield t._handleMacros("PrimaryDataSourceName",i),i=yield t._handleMacros("DataSourceEntityName",i),i=yield t._handleMacros("DataSourceModuleCaption",i),i})()}static{this.\u0275fac=function(t){return new(t||A)(s.\u0275\u0275inject(l.MacrosHandlerService),s.\u0275\u0275inject(o.MetadataModifierService))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:A,factory:A.\u0275fac})}}class N{constructor(e,t){this._macrosHandlerService=e,this._metadataModifierService=t}crtOnViewModelInit(e,t,i){return(0,c.lastValueFrom)(this._macrosHandlerService.handleMacros("MacrosTemplateString,ResourceString",e,{...i,...i.Resources},{setPropertyFn:a=>this._metadataModifierService.updateProperty(a)}),{defaultValue:null})}static{this.\u0275fac=function(t){return new(t||N)(s.\u0275\u0275inject(l.MacrosHandlerService),s.\u0275\u0275inject(o.MetadataModifierService))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:N,factory:N.\u0275fac})}}class H{crtOnMetaDataInit(e){const t=e,i=t.modelConfig,a=i?.dataSources?.[l.PAGE_PARAMETERS_DATA_SOURCE_NAME];if(a){const n=a.config;n.parameters=t.parameters,n.schemaName=t.name,i.loadingConfig=Object.assign(i.loadingConfig??{},{[l.PAGE_PARAMETERS_DATA_SOURCE_NAME]:{type:l.DataSourceLoadingType.OnInit}})}return Promise.resolve(t)}static{this.\u0275fac=function(t){return new(t||H)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:H,factory:H.\u0275fac})}}var m=p(38495);class F{_getAttributesConfig(e){const t=e?.attributes??{};return Object.entries(t)}_getDataSourceBinding(e){const t=e.modelConfig?.path;let i="",a="";if(t){const n=t.split(".");i=n.shift(),a=n.join(".")}return{dataSourceName:i,attributePath:a}}_getSupportedDataValueTypes(e){return m.InterfaceDesignerItemRegistry.get(e)?.dataValueTypes??[]}_getBoundViewConfigs(e,t){const i=e.viewConfig;return l.MetadataSchemaUtils.getViewConfigInfoByFilter(a=>{const n=m.ViewElementRegistry.getFormControlRelatesAttribute(a.type),r=a[n]??"";return r.startsWith("$")?r.substring(1)===t:!1},i)}_getDataValueTypeByViewConfig(e,t){const i=this._getBoundViewConfigs(e,t);if(i.length===0)return null;const a=i.map(({viewConfig:n})=>this._getSupportedDataValueTypes(n.type)).flat();return a.length===1?a[0]:(0,o.getGeneralDataValueType)(a,m.DataValueType.Text)}_getBoundDataSourceAttribute(e,t){var i=this;return(0,g.A)(function*(){const a=i._getDataSourceBinding(e),n=t.find(u=>u.name===a.dataSourceName);if(!n)return null;const r=yield(0,c.firstValueFrom)(n.getSchema());return r?r.findAttributeByName(a.attributePath):null})()}_updateAttributeDataValueType(e,t,i,a){var n=this;return(0,g.A)(function*(){if("dataValueTypeName"in i)return;const r=yield n._getBoundDataSourceAttribute(i,a),u=r?r.dataValueType:n._getDataValueTypeByViewConfig(e,t);u!=null&&(i.dataValueTypeName=n._getDataValueTypeName(u))})()}_getDataValueTypeName(e){return m.DataValueType[e]}_getInlineViewModelConfig(e){return e.viewModelConfig}_setAttributesDataValueType(e,t,i){var a=this;return(0,g.A)(function*(){const r=a._getAttributesConfig(t).map(([u,d])=>{const S=a._getInlineViewModelConfig(d);return S?a._setAttributesDataValueType(e,S,i):a._updateAttributeDataValueType(e,u,d,i)});yield Promise.all(r)})()}crtOnModelInit(e,t){var i=this;return(0,g.A)(function*(){const a=e;return yield i._setAttributesDataValueType(a,a.viewModelConfig,t),e})()}static{this.\u0275fac=function(t){return new(t||F)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:F,factory:F.\u0275fac})}}class L{constructor(){this._exclusions=["crt.TabPanelHeader","crt.ToggleContainer"]}crtOnMetaDataInit(e){const t=e;return l.MetadataSchemaUtils.getViewConfigInfoByFilter(a=>!Object.prototype.hasOwnProperty.call(a,"name"),t.viewConfig).forEach(({viewConfig:a},n)=>{this._exclusions.includes(a.type)||(a.name="AutogeneratedName"+(n+1))}),Promise.resolve(e)}static{this.\u0275fac=function(t){return new(t||L)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:L,factory:L.\u0275fac})}}class k{get isProcessingDisabled(){return(0,c.lastValueFrom)(this._featureService.getFeatureState(this._autoBindToDisabled))}constructor(e){this._featureService=e,this._autoBindToDisabled="AutoBindToDisabled",this._readonlyPropertyName="readonly"}crtOnMetaDataInit(e){var t=this;return(0,g.A)(function*(){if(yield t.isProcessingDisabled)return e;const i=e;return l.MetadataSchemaUtils.getViewConfigInfoByFilter(n=>(0,m.isComponentPropertyBindable)(n.type,t._readonlyPropertyName),i.viewConfig).forEach(({viewConfig:n})=>{Object.prototype.hasOwnProperty.call(n,"readonly")||(Object.prototype.hasOwnProperty.call(n,"disabled")?n.readonly=n.disabled:n.readonly=!1)}),e})()}static{this.\u0275fac=function(t){return new(t||k)(s.\u0275\u0275inject(P.FeatureService))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:k,factory:k.\u0275fac})}}class z{get isProcessingDisabled(){return(0,c.lastValueFrom)(this._featureService.getFeatureState(this._autoBindToDisabled))}constructor(e){this._featureService=e,this._autoBindToDisabled="AutoBindToDisabled"}_setAttributeViewItemName(e,t,i){const a=t.replace("$",""),n=e.viewModelConfig.attributes||{};n[a]={...n[a],viewItemName:i},e.viewModelConfig.attributes=n}_createPropertiesBindingAttribute(e,t){const i=e.viewModelConfig.attributes||{};i[t]={},e.viewModelConfig.attributes=i}_processViewConfigBinding(e,t){const i=m.ViewElementRegistry.getFormControlRelatesAttribute(t.type);if(i!==null&&t[i]){const a=t[i];this._setAttributeViewItemName(e,a,t.name),t.bindTo=a}else{const a=(0,l.generatePropertiesAttributeName)(t.name);this._createPropertiesBindingAttribute(e,a),t.bindTo=`$${a}`}}_updateAttributeProperties(e,t){const i=m.ViewElementRegistry.getViewElementPropertiesDefaultValues(t.type);_.ViewElementConfigUtils.updateAttributeProperties(t,e,i)}crtOnMetaDataInit(e){var t=this;return(0,g.A)(function*(){if(yield t.isProcessingDisabled)return e;const i=e,a=i.viewConfig;return l.MetadataSchemaUtils.getViewConfigInfoByFilter(r=>!!r.name,a).forEach(({viewConfig:r})=>{r.bindTo||t._processViewConfigBinding(i,r),t._updateAttributeProperties(i,r)}),e})()}static{this.\u0275fac=function(t){return new(t||z)(s.\u0275\u0275inject(P.FeatureService))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:z,factory:z.\u0275fac})}}var X=p(30478),W=p(50456),$=p(52552),j=p(27331),se=p(37019),ne=p(31418),re=p(26958),oe=p(25343),h=p(36486),Z=p(28399),Q=p(70765);function ee(){return[o.SchemaParametersStore,{provide:o.AbstractModelLifecycleHookNotificationService,useExisting:o.ContextHandlerChainModelLifecycleHookNotificationService},o.ContextHandlerChainModelLifecycleHookNotificationService,Q.U,{provide:o.ViewModelDataDelayer,useExisting:Q.U}]}class M extends _.ConverterRegistryService{constructor(){super(...arguments),this._schemaConverters=new Map}get(e,t){return this._schemaConverters.has(e)?this._schemaConverters.get(e):super.get(e,t)}register(e,t){(0,m.checkTypeNameFormat)(e,"ConverterTypeName"),(0,m.checkCrtTypeNamePascalCase)(e),this._schemaConverters.set(e,new t)}clear(){this.clearSchemaConverters(),super.clear()}clearSchemaConverters(){this._schemaConverters.clear()}static{this.\u0275fac=(()=>{let e;return function(i){return(e||(e=s.\u0275\u0275getInheritedFactory(M)))(i||M)}})()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:M,factory:M.\u0275fac})}}class G{constructor(e,t){this._performanceService=e,this._featureValues=t,this._subscription=new c.Subscription,this._handlerTypesByRequestType=new Map;for(const[,i]of m.InternalRequestHandlerRegistry.requestHandlersMap)this._registerHandler(i);this._subscription.add(m.InternalRequestHandlerRegistry.onAddRequestHandler((i,a)=>{this._registerHandler(a)})),this._subscription.add(m.InternalRequestHandlerRegistry.onRemoveRequestHandler((i,a)=>{this._removeHandler(a)}))}_registerHandler(e){const{type:t,requestType:i}=e.instanceConfig;let a=this._handlerTypesByRequestType.get(i);a||(a=new Set,this._handlerTypesByRequestType.set(i,a)),a.add(t)}_removeHandler(e){const{type:t,requestType:i}=e.instanceConfig;this._handlerTypesByRequestType.get(i).delete(t)}_getHandlersMetadata(e,t){const i=new Set;e.forEach(r=>{this._handlerTypesByRequestType.get(r)?.forEach(d=>i.add(d))});const a=new Set,n=(0,f.getRequestScopes)(t);return i.forEach(r=>{const u=m.InternalRequestHandlerRegistry.requestHandlersMap.get(r);u&&u.instanceConfig.lazy&&(0,m.matchScopes)(u.instanceConfig.scopes,n)&&a.add(u)}),a}load(e){if(this._featureValues.DisableFreedomUiLazyLoading)return m.LazyModulesManager.instance.loadAll();const t=new Set;return this._performanceService.measure("SEARCHING_SCHEMA_LAZY_ITEMS",()=>{const{viewElements:i,requests:a,converters:n,validators:r}=(0,f.getUsedItems)(e);i.forEach(d=>{const S=m.ViewElementRegistry.viewElements.get(d);S?.lazy&&t.add(S.lazyModuleRef)}),n.forEach(d=>{const S=m.ConverterRegistry.find(d);S?.lazy&&t.add(S.lazyModuleRef)}),r.forEach(d=>{const S=m.ValidatorRegistry.items.get(d);S?.lazy&&t.add(S.lazyModuleRef)}),this._getHandlersMetadata(a,e).forEach(d=>t.add(d.instanceConfig.lazyModuleRef))}),this._performanceService.measureCallback("LOADING_SCHEMA_LAZY_ITEMS",(0,g.A)(function*(){const i=yield Promise.all(Array.from(t,a=>a.loadAndBootstrap()));return(0,m.getDeepModuleDependencies)(i)}))}ngOnDestroy(){this._subscription.unsubscribe()}static{this.\u0275fac=function(t){return new(t||G)(s.\u0275\u0275inject(l.MeasurePerformanceService),s.\u0275\u0275inject(l.FEATURE_VALUES))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:G,factory:G.\u0275fac,providedIn:"root"})}}class E{constructor(){this._viewModelDiffPatchService=(0,s.inject)(o.ViewModelDiffPatchService),this.injector=(0,s.inject)(s.Injector),this.injectionContextService=(0,s.inject)(l.CrtInjectionContextsService),this.modelGenerator=(0,s.inject)(o.ModelGenerator),this.viewModelGenerator=(0,s.inject)(o.BaseViewModelGenerator),this.schemaConverterRegistry=(0,s.inject)(M),this.schemaValidatorFactory=(0,s.inject)(o.SchemaValidatorFactory),this.schemaValidatorTypeResolver=(0,s.inject)(o.SchemaValidatorTypeResolver),this.schemaValidatorRegistryService=(0,s.inject)(o.SchemaValidatorRegistryService),this.schemaAccessService=(0,s.inject)(l.SchemaAccessService),this.entitySchemaRepository=(0,s.inject)(l.EntitySchemaRepository),this.featureValues=(0,s.inject)(l.FEATURE_VALUES),this.window=(0,s.inject)(v.WINDOW_TOKEN),this.crtModulesLoader=(0,s.inject)(G),this.preprocessorsRunnerFactory=(0,s.inject)(o.MetadataPreprocessorsRunnerFactory),this.measurePerformanceService=(0,s.inject)(l.MeasurePerformanceService),this._shouldSetupAdditionalProviders=this.featureValues.UseSchemaOutletReuseViewStrategy&&(0,Z.get)(this.window,["Terrasoft","isAngularHost"])}_init(e,t){var i=this;return this.registerSchemaElements(e),t().pipe((0,h.switchMap)(function(){var a=(0,g.A)(function*([n,r,u,d]){const S=!(yield i.preprocessorsRunner.getIsPreventCaching());return{schema:n,models:r,viewModel:u,isBundleCacheable:S,intermediatePreprocessedBundle:d}});return function(n){return a.apply(this,arguments)}}()),this.measurePerformanceService.measure$(`SchemaInitializer._init.${e.name}`))}_getViewModelPatch(e,t,i){return this._viewModelDiffPatchService.diff(e,t,i)}_preprocessOnMetadataInit(e){return(0,c.from)(this.preprocessorsRunner.onMetaDataInit(e))}_preprocessOnModelInit(e,t){return(0,c.from)(this.preprocessorsRunner.onModelInit(e,t))}_preprocessOnViewModelInit(e,t,i){return(0,c.from)(this.preprocessorsRunner.onViewModelInit(e,t,i))}_generateModel(e,t){return e.modelConfig?this.modelGenerator.generate(e.modelConfig,t):(0,c.of)([])}_generateViewModel(e,t,i,a,n,r){return this.viewModelGenerator.generate({viewModelConfig:e.viewModelConfig,modelConfig:e.modelConfig,resources:e.resources,models:t,scopes:e.tag?.split(".")||[],modelInitConfigs:i,handlers:e.handlers,schemaName:a,businessRulesActive:!0},r).pipe((0,h.tap)(u=>{u._injectionContext.inject(o.ContextHandlerChainModelLifecycleHookNotificationService).setContext(u)}))}registerSchemaElements(e){this.registerConverters(e.converters),this.registerValidators(e.validators)}getMetadataPreprocessedSchema(e,t){return this._preprocessOnMetadataInit(e).pipe(this.measurePerformanceService.measure$(`SchemaInitializer.PreprocessMetadataInit.${e.name}`))}getModels(e,t,i){return this._generateModel(e,i).pipe(this.measurePerformanceService.measure$(`SchemaInitializer.generateModels.${e.name}`))}getModelPreprocessedSchema(e,t,i){return this._preprocessOnModelInit(e,t).pipe(this.measurePerformanceService.measure$(`SchemaInitializer.PreprocessModelInit.${e.name}`))}getViewModel(e,t,i,a,n,r){return this._generateViewModel(e,t,i,a,n,r).pipe(this.measurePerformanceService.measure$(`SchemaInitializer.generateViewModel.${a}`))}getViewModelPreprocessedSchema(e,t,i,a){return this._preprocessOnViewModelInit(e,t,i).pipe(this.measurePerformanceService.measure$(`SchemaInitializer.PreprocessViewModelInit.${e.name}`))}_getModelPreprocessedSchemaData(e,t,i){return i().pipe((0,h.switchMap)(n=>{const r=this.getModelPreprocessedSchema(e,n,t);return(0,c.combineLatest)([r,(0,c.of)(n)])}))}_getViewModelPreprocessedSchemaData(e,t,i,a){const n=(0,Z.cloneDeep)(e);return a().pipe((0,h.switchMap)(u=>{const d=this.getViewModelPreprocessedSchema(e,i,u,t);return(0,c.combineLatest)([d,(0,c.of)(i),(0,c.of)(u),(0,c.of)(n)])}))}_executeCheckEntitySchemaRights(e){var t=this;return(0,g.A)(function*(){if(!e.modelConfig)return Promise.resolve();const i=t._getPrimaryDataSourceSchemaName(e);if(i){const a=yield(0,c.firstValueFrom)(t.entitySchemaRepository.getSchemaByName(i).pipe((0,h.take)(1),(0,h.catchError)(()=>(0,c.of)(void 0))));return a&&(yield t.schemaAccessService.checkAccess(a)),Promise.resolve()}})()}_getPrimaryDataSourceSchemaName(e){const t=e.modelConfig.primaryDataSourceName;return t?e.modelConfig.dataSources[t].config?.entitySchemaName:Object.values(e.modelConfig.dataSources).find(i=>i.scope===m.DataSourceScope.Page&&i.type==="crt.EntityDataSource")?.config?.entitySchemaName}_createInjectionContext(e,t){const i=[{provide:o.AbstractValidatorTypeResolver,useValue:this.schemaValidatorTypeResolver},{provide:o.SCOPE_NAME,useValue:e},{provide:o.INJECTION_CONTEXT,useFactory:()=>r},...this._shouldSetupAdditionalProviders?ee():[]],a=s.Injector.create({providers:i,parent:this.injector}),n=`${e}_${(0,m.generateGuid)()}`,r=this.injectionContextService.createContext(n,a);return t.forEach(u=>r.addLazyModule(u)),(0,m.callOnContextCreateHooks)(r),r}_initPreprocessorsRunner(e){const t=e.get(o.CRT_METADATA_PREPROCESSOR,[]),i=(0,Z.uniqBy)(t,a=>a.constructor??a);this.preprocessorsRunner=this.preprocessorsRunnerFactory.createRunner(i)}_loadLazyModules(e,t,i){var a=this;return(0,g.A)(function*(){(yield a.crtModulesLoader.load(e)).forEach(r=>{t.includes(r)||(t.push(r),i.addLazyModule(r))}),(0,m.callOnContextUpdateHooks)(i)})()}init(e,t,i=null){var a=this;return(0,c.from)(this.crtModulesLoader.load(e)).pipe((0,h.switchMap)(n=>{const r=this._createInjectionContext(t,n),u=r.inject(s.Injector);return this._initPreprocessorsRunner(u),this._init(e,()=>this.getMetadataPreprocessedSchema(e,t).pipe((0,h.switchMap)(function(){var d=(0,g.A)(function*(S){return yield a._loadLazyModules(S,n,r),yield a._executeCheckEntitySchemaRights(S),(0,c.firstValueFrom)(a._getModelPreprocessedSchemaData(S,t,()=>a.getModels(S,t,u)))});return function(S){return d.apply(this,arguments)}}()),(0,h.switchMap)(([d,S])=>this._getViewModelPreprocessedSchemaData(d,t,S,()=>{const I=d?.modelConfig?.primaryDataSourceName,q=d?.modelConfig?.loadingConfig,pe=(0,o.addDefaultActionForRootModels)(i,S,I,q);return this.getViewModel(d,S,pe,t,r,u)})))).pipe((0,h.map)(d=>({...d,modules:n})))}),this.measurePerformanceService.measure$(`SchemaInitializer.init.${e.name}`))}refresh(e,t){const{models:i,viewModel:a,rawBundle:n,intermediatePreprocessedBundle:r}=t;return(0,c.from)(this.crtModulesLoader.load(n)).pipe(this.measurePerformanceService.measure$(`SchemaInitializer.Refresh.${e}`),(0,h.switchMap)(u=>{const d=a._injectionContext;u.forEach(I=>d.addLazyModule(I)),(0,m.callOnContextUpdateHooks)(d);const S=d.inject(s.Injector);return this._initPreprocessorsRunner(S),this._init(n,()=>this.getMetadataPreprocessedSchema(n,e).pipe((0,h.switchMap)(I=>this._getModelPreprocessedSchemaData(I,e,()=>(0,c.of)(i))),(0,h.switchMap)(([I])=>this._getViewModelPreprocessedSchemaData(I,e,i,()=>this._getViewModelPatch(r,I,S).pipe((0,h.switchMap)(q=>a._hotSwap(q)),(0,h.map)(()=>a))))))}))}registerConverters(e){this.schemaConverterRegistry.clearSchemaConverters(),Object.entries(e||{}).forEach(([t,i])=>{this.schemaConverterRegistry.register(t,class{constructor(){this.convert=i}})})}registerValidators(e){this.schemaValidatorRegistryService.clearSchemaValidators(),Object.values(e||{}).forEach(i=>{const a=(0,Z.omit)(i,["validator"]);this.schemaValidatorRegistryService.register(a,this.schemaValidatorFactory.create(i))})}static{this.\u0275fac=function(t){return new(t||E)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:E,factory:E.\u0275fac})}}class B extends E{constructor(){super(),this._destroyed$=new c.Subject,this._schemaCacheService=(0,s.inject)(f.SchemaCacheService),this._schemaChangeListenerService=(0,s.inject)(l.SchemaChangeListenerService),this.zone=(0,s.inject)(s.NgZone),this._schemaChangeListenerService.schemaChanged$.pipe((0,h.takeUntil)(this._destroyed$)).subscribe(e=>{e.schemaType===l.SchemaTypes.ClientUnitSchema&&this._schemaCacheService.invalidateClientUnitSchema(e.name),e.schemaType===l.SchemaTypes.EntitySchema&&this._schemaCacheService.invalidateByDataSchemaName(e.name)})}_getSnapshot(e,t){var i=this;return(0,g.A)(function*(){if(yield i.preprocessorsRunner.getIsPreventCaching())return null;const n=i._schemaCacheService.getSchemaSnapshots(e);return n?n[t]:null})()}_setSnapshot(e,t,i){var a=this;return(0,g.A)(function*(){(yield a.preprocessorsRunner.getIsPreventCaching())||a._schemaCacheService.setCacheSnapshot({schemaName:t,hook:i,snapshot:e})})()}getMetadataPreprocessedSchema(e,t){const i=this._schemaCacheService.isCached(t);return(0,c.from)(this._getSnapshot(t,l.SchemaProcessingLifecycleHooks.METADATA_INIT)).pipe((0,h.switchMap)(a=>i&&a?(0,c.of)(a):super.getMetadataPreprocessedSchema(e).pipe((0,h.tap)(n=>this._setSnapshot(n,t,l.SchemaProcessingLifecycleHooks.METADATA_INIT)))))}getModels(e,t,i){return super.getModels(e,t,i).pipe((0,h.tap)(a=>{const n=a.map(r=>r.dataSchemaName);this._schemaCacheService.setDataSchemaDepsToCache(t,n)}))}getModelPreprocessedSchema(e,t,i){const a=this._schemaCacheService.isCached(i);return(0,c.from)(this._getSnapshot(i,l.SchemaProcessingLifecycleHooks.MODEL_INIT)).pipe((0,h.switchMap)(n=>a&&n?(0,c.of)(n):super.getModelPreprocessedSchema(e,t).pipe((0,h.tap)(r=>this._setSnapshot(r,i,l.SchemaProcessingLifecycleHooks.MODEL_INIT)))))}getViewModelPreprocessedSchema(e,t,i,a){const n=this._schemaCacheService.isCached(a);return(0,c.from)(this._getSnapshot(a,l.SchemaProcessingLifecycleHooks.VIEW_MODEL_INIT)).pipe((0,h.switchMap)(r=>n&&r?(0,c.of)(r):super.getViewModelPreprocessedSchema(e,t,i).pipe((0,h.tap)(u=>this._setSnapshot(u,a,l.SchemaProcessingLifecycleHooks.VIEW_MODEL_INIT)))))}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||B)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:B,factory:B.\u0275fac})}}class U{constructor(){this._handlerChain=m.HandlerChainService.instance,this._registered=new Map}_register(e,t){const i=[];t.forEach(a=>{const n=class extends m.BaseRequestHandler{handle(r){return a.handler(r,this.next)}};i.push(this._handlerChain.register({requestType:a.request,createHandler:()=>new n,source:{type:m.HandlerSourceType.Schema,...a.source},scopes:[e]}))}),this._registered.set(e,{schemaInstancesCount:1,unregister:()=>i.forEach(a=>a())})}_unregister(e){this._registered.get(e).unregister(),this._registered.delete(e)}_unregisterAll(){for(const e of this._registered.keys())this._unregister(e)}onSchemaInstanceCreated(e,t){const i=this._registered.get(e);i?i.schemaInstancesCount++:this._register(e,t)}onSchemaInstanceDestroyed(e){const t=this._registered.get(e);t.schemaInstancesCount--,t.schemaInstancesCount===0&&this._unregister(e)}ngOnDestroy(){this._unregisterAll()}static{this.\u0275fac=function(t){return new(t||U)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:U,factory:U.\u0275fac,providedIn:"root"})}}class w extends o.ViewModelGenerator{_hookOnDestroy(e,t){e.destroy=new Proxy(e.destroy,{apply:(i,a)=>i.apply(a).pipe((0,h.tap)({next:t}))})}initDependencies(){super.initDependencies(),this._schemaHandlersManager=this.injector.get(U)}generateLifecycleHooks(e,t){const{handlers:i,schemaName:a}=t;this._schemaHandlersManager.onSchemaInstanceCreated(a,i??[]),super.generateLifecycleHooks(e,t),this._hookOnDestroy(e,()=>this._schemaHandlersManager.onSchemaInstanceDestroyed(a))}static{this.\u0275fac=(()=>{let e;return function(i){return(e||(e=s.\u0275\u0275getInheritedFactory(w)))(i||w)}})()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:w,factory:w.\u0275fac,providedIn:"root"})}}function te(){return[M,{provide:_.ConverterRegistryService,useExisting:M},o.SchemaValidatorRegistryService,o.SchemaValidatorTypeResolver,E,B,o.ViewModelDiffPatchService,f.SchemaPartsService,f.SchemaService,j.SummaryItemColumnExplorer,ne.P,{provide:W.DataSourceStructureExplorerService,useClass:oe.$},X.DataProviderResolverService,W.DataSourceStructureExplorerDataProviderService,{provide:X.DATA_PROVIDER,useExisting:W.DataSourceStructureExplorerDataProviderService,multi:!0},X.StructureExplorerService,{provide:_.BINDING_CONTEXT,useValue:null},{provide:T.DATA_GRID_STATE_HANDLER,useClass:se.p},$.DATA_GRID_CELL_VIEW_CONFIG_CREATOR_FACTORY_PROVIDER,{provide:T.DataGridColumnSelectionService,useFactory:C=>new $.SchemaDataGridColumnSelectionService(C),deps:[$.StructureExplorerDataGridColumnSelectionService]},$.StructureExplorerDataGridColumnSelectionService,{provide:T.DATA_GRID_COLUMN_EDIT_HANDLER,useClass:$.SchemaDataGridColumnEditHandler},{provide:o.BaseViewModelGenerator,useClass:w},o.ModelGenerator,{provide:o.DataSourceFactoryService,useClass:re.j},j.SummaryItemColumnProvider,j.SummaryItemEditingService,{provide:j.BaseSummaryItemColumnProvider,useClass:j.SummaryItemColumnProvider},j.SummaryItemSetupService]}var ce=p(13053);function le(C,e){if(C&1&&(s.\u0275\u0275elementContainerStart(0)(1,1),s.\u0275\u0275elementContainer(2,2),s.\u0275\u0275elementContainerEnd()()),C&2){const t=s.\u0275\u0275nextContext();s.\u0275\u0275advance(),s.\u0275\u0275property("crtViewModel",t.schemaState.viewModel),s.\u0275\u0275advance(),s.\u0275\u0275property("modules",t.schemaState==null?null:t.schemaState.modules)("viewConfig",t.schemaState==null?null:t.schemaState.viewConfig)("selector",t.schema)("autoLoadLazyModules",!1)}}class D{set parameters(e){this.getSchemaParametersStore().setValues(e)}set schema(e){this._schema=e}get schema(){return this._schema}constructor(e,t){this._injector=e,this._document=t,this._destroyed$=new c.Subject,this._schemaName$=new c.Subject,this._partsChangedSubscription=new c.Subscription,this._init$=new c.ReplaySubject(1),this._addClsToHost=!0,this._dataItemMarker="crt-schema-component",this._addFlexFullHeightToHost=!0,this.modelInitConfigs=null,this.schemaStateGenerated=new s.EventEmitter,this.parametersChanged=new s.EventEmitter,this.schemaExceptionThrown=new s.EventEmitter,this.schemaPartsService=this._injector.get(f.SchemaPartsService),this._schemaCacheService=this._injector.get(f.SchemaCacheService),this.viewModelDiffPatchService=this._injector.get(o.ViewModelDiffPatchService),this._schemaService=this._injector.get(f.SchemaService),this._cdr=this._injector.get(s.ChangeDetectorRef),this.customEventService=this._injector.get(v.CustomEventService),this._isRtl=this._injector.get(ce.Directionality)?.value==="rtl",this.zone=this._injector.get(s.NgZone),this._featureValues=this._injector.get(l.FEATURE_VALUES),this._enableCustomSchemaStylesFeature=this._featureValues.EnableCustomSchemaStyles,this._schemaInitializerService=this._injector.get(this._featureValues.DisableRuntimeSchemaCaching?E:B),this._measurePerformanceService=this._injector.get(l.MeasurePerformanceService),this._subscribeToSchemaNameChange(),this._subscribeToSchemaParts()}_subscribeToSchemaNameChange(){this._schemaName$.pipe((0,h.tap)(()=>this._init$.next(!1)),(0,h.switchMap)(e=>this.schemaPartsService.init(e)),(0,h.tap)(e=>this._schemaService.init(e)),(0,v.runOutsideZone)(this.zone),(0,v.switchMapWith)(e=>this._schemaInitializerService.init(e,this.schema,this.modelInitConfigs)),(0,h.tap)(([e,{schema:t,models:i,viewModel:a,isBundleCacheable:n,intermediatePreprocessedBundle:r,modules:u}])=>{this.init(e,t,a,i,n,r,u),this._init$.next(!0)}),(0,v.runInZone)(this.zone),(0,h.tap)(()=>{this._measurePerformanceService.measure(`SchemaComponent.schemaNameChange.detectChanges.${this.schema}`,()=>{this._cdr.reattach(),this._cdr.detectChanges()})}),this._measurePerformanceService.measure$(()=>`SchemaComponent.schemaNameChange.${this.schema}`),(0,h.takeUntil)(this._destroyed$)).subscribe({error:e=>{this.schemaExceptionThrown.emit(e),console.error(e)}})}_onSchemaPartsChanged(e,t){var i=this;return(0,g.A)(function*(){if(i._schemaCacheService.invalidateClientUnitSchema(i.schema),i._schemaService.init(e),i.schemaState.rawBundle=e,!t){const a=i.schemaState.preprocessedBundle;yield i._updatePreprocessedBundles(),i._featureValues.DisablePreprocessRefreshSchema&&(yield i.updateViewModel(a,i.schemaState.preprocessedBundle)),i.updateView(i.schemaState.preprocessedBundle),i.emitSchemaStateGenerated()}})()}_subscribeToSchemaParts(){var e=this;this._partsChangedSubscription.add(this.schemaPartsService.subscribeOnPartsChanged(function(){var t=(0,g.A)(function*({bundle:i,silent:a}){return(0,c.firstValueFrom)(e._init$.pipe((0,c.filter)(n=>n),(0,h.switchMap)(()=>e._onSchemaPartsChanged(i,a))))});return function(i){return t.apply(this,arguments)}}()))}_updatePreprocessedBundles(){const e=this._featureValues.DisablePreprocessRefreshSchema?this._schemaInitializerService.init(this.schemaState.rawBundle,this.schema).pipe((0,v.switchMapWithout)(t=>t.viewModel.destroy())):this._schemaInitializerService.refresh(this.schema,this.schemaState);return(0,c.firstValueFrom)(e.pipe((0,h.tap)(({schema:t,intermediatePreprocessedBundle:i})=>{this.schemaState.preprocessedBundle=t,this.schemaState.intermediatePreprocessedBundle=i}),(0,h.map)(()=>{})))}_onSchemaNameChanged(e){this.schema=e,this._schemaName$.next(this.schema)}onSchemaStateRestored(){this._init$.next(!1),this._cdr.reattach(),this.schema=this.schemaState.scope,this.schemaPartsService.restoreState(this.schemaState.schemaPartsState),this._schemaService.init(this.schemaState.rawBundle),this._schemaInitializerService.registerConverters(this.schemaState.converters),this._schemaInitializerService.registerValidators(this.schemaState.validators),this.applyCustomStyles(),this.emitSchemaStateGenerated(),this.subscribeParametersChanged(),this._init$.next(!0)}emitSchemaStateGenerated(){this._generatedSchemaState=this.schemaState,this.schemaStateGenerated.next(this.schemaState),this.customEventService.createOutboundChannel("8xSchemaStateGenerated").next(void 0)}applyCustomStyles(){if(!this._enableCustomSchemaStylesFeature)return;const e=this.schemaState.styles;if(e?.length){if(!this._stylesElement){const t=this._document.createElement("style");t.id=`${this.schema}_styles`,this._document.head.appendChild(t),this._stylesElement=t}this._stylesElement.innerHTML=e.join(`
`)}}removeCustomStyles(){this._stylesElement&&this._document.head.removeChild(this._stylesElement)}init(e,t,i,a,n,r,u){this._destroyView(),this.schemaState={models:a,viewModel:i,viewConfig:t.viewConfig,handlers:t.handlers,scope:this.schema,converters:t.converters,validators:t.validators,styles:t.styles,rawBundle:e,preprocessedBundle:t,schemaPartsState:this.schemaPartsService.getState(),intermediatePreprocessedBundle:r,modules:u},this.applyCustomStyles(),this.emitSchemaStateGenerated(),this.subscribeParametersChanged()}updateView(e){this.zone.run(()=>{this.schemaState.viewConfig=e.viewConfig,this.schemaState.styles=e.styles,this.applyCustomStyles()}),this._cdr.detectChanges()}updateViewModel(e,t){var i=this;return(0,g.A)(function*(){const a=yield(0,c.firstValueFrom)(i.getViewModelPatch(e,t));return(0,c.firstValueFrom)(i.schemaState.viewModel._hotSwap(a))})()}getViewModelPatch(e,t){return this.viewModelDiffPatchService.diff(e,t)}getSchemaParametersStore(){return this._schemaParametersStore??=this._injector.get(o.SchemaParametersStore)}subscribeParametersChanged(){const e=this.getSchemaParametersStore();this._parametersChangedSubscription?.unsubscribe(),this._parametersChangedSubscription=e.changedValues$.subscribe(t=>{this.parametersChanged.emit(t)})}_destroyView(){this.schemaState=null,this._cdr.detectChanges()}ngOnChanges(e){const t=e.schema?.currentValue,i=e.schemaState?.currentValue;if(e.schema&&!t&&e.schemaState&&!i){this._cdr.detach(),this._generatedSchemaState=null;return}if(i&&i!==this._generatedSchemaState){this._generatedSchemaState=null,this.onSchemaStateRestored();return}t&&this._onSchemaNameChanged(t)}ngOnDestroy(){this.removeCustomStyles(),this._partsChangedSubscription.unsubscribe(),this._destroyed$.next(),this._destroyed$.complete()}clearResources(e){}static{this.\u0275fac=function(t){return new(t||D)(s.\u0275\u0275directiveInject(s.Injector),s.\u0275\u0275directiveInject(y.DOCUMENT))}}static{this.\u0275cmp=s.\u0275\u0275defineComponent({type:D,selectors:[["crt-schema"]],hostVars:7,hostBindings:function(t,i){t&2&&(s.\u0275\u0275attribute("data-item-marker",i._dataItemMarker),s.\u0275\u0275classProp("crt-schema",i._addClsToHost)("rtl",i._isRtl)("flex-full-height",i._addFlexFullHeightToHost))},inputs:{modelInitConfigs:"modelInitConfigs",parameters:"parameters",schema:"schema",schemaState:"schemaState"},outputs:{schemaStateGenerated:"schemaStateGenerated",parametersChanged:"parametersChanged",schemaExceptionThrown:"schemaExceptionThrown"},features:[s.\u0275\u0275ProvidersFeature([...te(),...ee()]),s.\u0275\u0275HostDirectivesFeature([W.CrtRemoveDuplicateIDsStyleTogglingDirective]),s.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[[4,"ngIf"],[3,"crtViewModel"],["crtViewGenerator","",3,"modules","viewConfig","selector","autoLoadLazyModules"]],template:function(t,i){t&1&&s.\u0275\u0275template(0,le,3,5,"ng-container",0),t&2&&s.\u0275\u0275property("ngIf",i.schemaState==null?null:i.schemaState.viewConfig)},dependencies:[y.NgIf,_.ViewModelDirective,_.ViewGeneratorDirective]})}}function ue(C,e){if(C&1&&(s.\u0275\u0275elementContainerStart(0),s.\u0275\u0275elementContainer(1,1),s.\u0275\u0275elementContainerEnd()),C&2){const t=s.\u0275\u0275nextContext();s.\u0275\u0275advance(),s.\u0275\u0275property("viewConfigId",t.schemaState==null?null:t.schemaState.viewConfigId)("instanceId",t.schemaState==null?null:t.schemaState.instanceId)("viewModel",t.schemaState==null?null:t.schemaState.viewModel)("viewConfig",t.schemaState==null?null:t.schemaState.viewConfig)("selector",t.schema)("skipCache",!(t.schemaState!=null&&t.schemaState.isBundleCacheable))("modules",t.schemaState==null?null:t.schemaState.modules)("autoLoadLazyModules",!1)}}class R extends D{constructor(){super(...arguments),this._viewConfigIdCounter=0,this._actualViewConfigId=0,this._cacheService=(0,s.inject)(_.ReusableViewGeneratorCacheService),this._bindingCache=(0,s.inject)(_.SCHEMA_BINDING_CACHE)}set parameters(e){this._parameters=e,this.schemaState&&this._injectFromContext(o.SchemaParametersStore).setValues(e)}_generateViewConfigId(){return++this._viewConfigIdCounter}_injectFromContext(e){return this.schemaState?.viewModel?._injectionContext.inject(e)}init(e,t,i,a,n,r,u){this.schemaState={models:a,viewModel:i,viewConfig:t.viewConfig,handlers:t.handlers,scope:this.schema,converters:t.converters,validators:t.validators,styles:t.styles,rawBundle:e,preprocessedBundle:t,schemaPartsState:this.schemaPartsService.getState(),instanceId:i._injectionContext.id,viewConfigId:this._actualViewConfigId,isBundleCacheable:n,intermediatePreprocessedBundle:r,modules:u},this.applyCustomStyles(),this.emitSchemaStateGenerated(),this._injectFromContext(o.SchemaParametersStore).setValues(this._parameters),this.subscribeParametersChanged()}updateView(e){this.schemaState.viewConfigId=this._generateViewConfigId(),this.schemaState.isBundleCacheable&&(this._actualViewConfigId=this.schemaState.viewConfigId),super.updateView(e)}getViewModelPatch(e,t){const i=this._injectFromContext(s.Injector);return this.viewModelDiffPatchService.diff(e,t,i)}getSchemaParametersStore(){return this._injectFromContext(o.SchemaParametersStore)}clearResources(e){const t=e._injectionContext.id;this._cacheService?.invalidateInstance(t),this._bindingCache.delete(e)}static{this.\u0275fac=(()=>{let e;return function(i){return(e||(e=s.\u0275\u0275getInheritedFactory(R)))(i||R)}})()}static{this.\u0275cmp=s.\u0275\u0275defineComponent({type:R,selectors:[["crt-reusable-schema"]],features:[s.\u0275\u0275ProvidersFeature([...te(),{provide:_.SCHEMA_BINDING_CACHE,useFactory:()=>new WeakMap},_.ReusableViewGeneratorCacheService]),s.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[4,"ngIf"],["crtReusableViewGenerator","",3,"viewConfigId","instanceId","viewModel","viewConfig","selector","skipCache","modules","autoLoadLazyModules"]],template:function(t,i){t&1&&s.\u0275\u0275template(0,ue,2,8,"ng-container",0),t&2&&s.\u0275\u0275property("ngIf",i.schemaState==null?null:i.schemaState.viewConfig)},dependencies:[y.NgIf,_.ReusableViewGeneratorDirective]})}}const he={"zh-TW":JSON.parse('{"PageTools":{"DesignButtonHint":"\u7DE8\u8F2F\u9801\u9762","ExpandButtonTitle":"\u5C55\u958B","CollapseButtonTitle":"\u647A\u758A"}}'),"zh-CN":JSON.parse('{"PageTools":{"DesignButtonHint":"Edit page","ExpandButtonTitle":"Expand","CollapseButtonTitle":"Collapse"}}'),"vi-VN":JSON.parse('{"PageTools":{"DesignButtonHint":"Edit page","ExpandButtonTitle":"M\u1EDF r\u1ED9ng","CollapseButtonTitle":"Collapse"}}'),"uk-UA":JSON.parse('{"PageTools":{"DesignButtonHint":"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0443","ExpandButtonTitle":"\u0420\u043E\u0437\u0433\u043E\u0440\u043D\u0443\u0442\u0438","CollapseButtonTitle":"\u0417\u0433\u043E\u0440\u043D\u0443\u0442\u0438"}}'),"tr-TR":JSON.parse('{"PageTools":{"DesignButtonHint":"Edit page","ExpandButtonTitle":"Geni\u015Fletmek","CollapseButtonTitle":"Y\u0131k\u0131lmak"}}'),"th-TH":JSON.parse('{"PageTools":{"DesignButtonHint":"Edit page","ExpandButtonTitle":"Expand","CollapseButtonTitle":"\u0E25\u0E49\u0E21"}}'),"sv-SE":JSON.parse('{"PageTools":{"DesignButtonHint":"Redigeringssida","ExpandButtonTitle":"Expandera","CollapseButtonTitle":"Kollapsa"}}'),"sq-AL":JSON.parse('{"PageTools":{"DesignButtonHint":"Modifiko faqen","ExpandButtonTitle":"Zgjero","CollapseButtonTitle":"Redukto"}}'),"ro-RO":JSON.parse('{"PageTools":{"DesignButtonHint":"Pagina editare","ExpandButtonTitle":"Extinde","CollapseButtonTitle":"Restr\xE2nge"}}'),"pt-PT":JSON.parse('{"PageTools":{"DesignButtonHint":"Editar pagina","ExpandButtonTitle":"Expand","CollapseButtonTitle":"Recolher"}}'),"pt-BR":JSON.parse('{"PageTools":{"DesignButtonHint":"P\xE1gina de edi\xE7\xE3o","ExpandButtonTitle":"Expandir","CollapseButtonTitle":"Recolher"}}'),"pl-PL":JSON.parse('{"PageTools":{"DesignButtonHint":"Edytuj stron\u0119","ExpandButtonTitle":"Rozwi\u0144","CollapseButtonTitle":"Zwi\u0144"}}'),"nl-NL":JSON.parse('{"PageTools":{"DesignButtonHint":"Pagina bewerken","ExpandButtonTitle":"Uitvouwen","CollapseButtonTitle":"Verkleinen"}}'),"lv-LV":JSON.parse('{"PageTools":{"DesignButtonHint":"Redi\u0123\u0113t lapu","ExpandButtonTitle":"Izv\u0113rst","CollapseButtonTitle":"Sak\u013Caut"}}'),"ko-KR":JSON.parse('{"PageTools":{"DesignButtonHint":"\uD3B8\uC9D1 \uD398\uC774\uC9C0","ExpandButtonTitle":"\uD655\uC7A5","CollapseButtonTitle":"\uBD95\uAD34"}}'),"ja-JP":JSON.parse('{"PageTools":{"DesignButtonHint":"\u30DA\u30FC\u30B8\u7DE8\u96C6","ExpandButtonTitle":"\u5C55\u958B\u3059\u308B","CollapseButtonTitle":"\u6298\u308A\u305F\u305F\u3080"}}'),"it-IT":JSON.parse('{"PageTools":{"DesignButtonHint":"Modifica pagina","ExpandButtonTitle":"Espandi","CollapseButtonTitle":"Riduci"}}'),"id-ID":JSON.parse('{"PageTools":{"DesignButtonHint":"Edit halaman","ExpandButtonTitle":"Perluas","CollapseButtonTitle":"Kolaps"}}'),"hu-HU":JSON.parse('{"PageTools":{"DesignButtonHint":"Oldal szerkeszt\xE9se","ExpandButtonTitle":"Kibont\xE1s","CollapseButtonTitle":"\xD6sszez\xE1r"}}'),"hr-HR":JSON.parse('{"PageTools":{"DesignButtonHint":"Uredi stranicu","ExpandButtonTitle":"Pro\u0161iri","CollapseButtonTitle":"Skupi"}}'),"he-IL":JSON.parse('{"PageTools":{"DesignButtonHint":"\u05E2\u05E8\u05D5\u05DA \u05E2\u05DE\u05D5\u05D3","ExpandButtonTitle":"\u05D4\u05E8\u05D7\u05D1\u05D4","CollapseButtonTitle":"\u05E6\u05DE\u05E6\u05DD"}}'),"fr-FR":JSON.parse('{"PageTools":{"DesignButtonHint":"Modifier la page","ExpandButtonTitle":"Etendre","CollapseButtonTitle":"R\xE9duire"}}'),"es-ES":JSON.parse('{"PageTools":{"DesignButtonHint":"P\xE1gina de edici\xF3n","ExpandButtonTitle":"Expandir","CollapseButtonTitle":"Colapsar"}}'),"de-DE":JSON.parse('{"PageTools":{"DesignButtonHint":"\xC4nderungsseite","ExpandButtonTitle":"Erweitern","CollapseButtonTitle":"Einklappen"}}'),"cs-CZ":JSON.parse('{"PageTools":{"DesignButtonHint":"Upravit str\xE1nku","ExpandButtonTitle":"Roz\u0161\xED\u0159it","CollapseButtonTitle":"Sbalit"}}'),"bg-BG":JSON.parse('{"PageTools":{"DesignButtonHint":"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u0430\u0439 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0430\u0442\u0430","ExpandButtonTitle":"\u0420\u0430\u0437\u0448\u0438\u0440\u0438","CollapseButtonTitle":"\u0421\u0432\u0438\u0439"}}'),"ar-SA":JSON.parse('{"PageTools":{"DesignButtonHint":"\u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0635\u0641\u062D\u0629","ExpandButtonTitle":"\u062A\u0648\u0633\u064A\u0639","CollapseButtonTitle":"\u062A\u0635\u063A\u064A\u0631"}}'),"en-US":JSON.parse('{"PageTools":{"DesignButtonHint":"Edit page","ExpandButtonTitle":"Expand","CollapseButtonTitle":"Collapse"}}'),"ru-RU":JSON.parse('{"PageTools":{"DesignButtonHint":"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443","ExpandButtonTitle":"\u0420\u0430\u0437\u0432\u0435\u0440\u043D\u0443\u0442\u044C","CollapseButtonTitle":"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C"}}')};class J{static{this.\u0275fac=function(t){return new(t||J)}}static{this.\u0275mod=s.\u0275\u0275defineNgModule({type:J})}static{this.\u0275inj=s.\u0275\u0275defineInjector({providers:[{provide:o.CRT_METADATA_PREPROCESSOR,useClass:L,multi:!0},{provide:o.CRT_METADATA_PREPROCESSOR,useClass:x,multi:!0},{provide:o.CRT_METADATA_PREPROCESSOR,useClass:O,multi:!0},{provide:o.CRT_METADATA_PREPROCESSOR,useClass:z,multi:!0},{provide:o.CRT_METADATA_PREPROCESSOR,useClass:k,multi:!0},{provide:o.CRT_METADATA_PREPROCESSOR,useClass:A,multi:!0},{provide:o.BaseViewModelGenerator,useClass:w},{provide:o.CRT_METADATA_PREPROCESSOR,useClass:N,multi:!0},{provide:o.CRT_METADATA_PREPROCESSOR,useClass:H,multi:!0},{provide:o.CRT_METADATA_PREPROCESSOR,useClass:F,multi:!0}],imports:[y.CommonModule,_.ViewModule,o.ModelModule,_.ViewGeneratorModule,f.LowCodeModule,T.CrtButtonModule,v.CrtLibTranslateModule.forRoot({i18n:he}),_.ViewModule,o.ModelModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(J,{declarations:[D,R,V],imports:[y.CommonModule,_.ViewModule,o.ModelModule,_.ViewGeneratorModule,f.LowCodeModule,T.CrtButtonModule,v.CrtLibTranslateModule],exports:[D,R,V,_.ViewModule,o.ModelModule]})})();const de=new s.InjectionToken("SCHEMA_COMPONENT")},73308:(ie,K,p)=>{p.d(K,{A:()=>v});function y(T,_,f,o,s,P,l){try{var c=T[P](l),b=c.value}catch(Y){f(Y);return}c.done?_(b):Promise.resolve(b).then(o,s)}function v(T){return function(){var _=this,f=arguments;return new Promise(function(o,s){var P=T.apply(_,f);function l(b){y(P,o,s,l,c,"next",b)}function c(b){y(P,o,s,l,c,"throw",b)}l(void 0)})}}}}]);
