(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[89926,73308,50927,28546,6165,62832,40451,18070,95689,94260,71879,41421,63802,86183,8564,30945,53326,75707,98088,20469,42850,70422,48041,15184,92803,80898,58517,25660,3279,91374,68993,83231,5612,38469,67545],{67545:(j,p,n)=>{n.r(p),n.d(p,{BaseAudienceHandler:()=>h,BaseAudienceNotificationHandler:()=>i});var o=n(73308),c=n(38495),f=n(79772),y=n(59564),m=n(20822),l=n(28399),d=n(62278);class h extends c.BaseRequestHandler{constructor(e){super(),this.injector=e,this.injectDependencies()}injectDependencies(){this._notifyService=this.injector.get(y.NotifyService),this._translateService=this.injector.get(f.TranslateService),this._messageDialogProvider=this.injector.get(m.MessageDialogProvider)}getItemsCollection(e){return Array.isArray(e)?e.map(t=>typeof t=="string"?t:t.value):e?.value?[e.value]:[]}isValidFilter(e){return(0,l.isObject)(e)&&"items"in e&&!(0,l.isEmpty)(e.items)}isEmptyFilter(e){let t=!0;return Object.entries(e.items).forEach(([a,s])=>{s.isEnabled&&(s.filterType===c.FilterType.FilterGroup&&!this.isEmptyFilter(s)||s.filterType!==c.FilterType.FilterGroup)&&(t=!1)}),t}showNotification(e,t){var a=this;return(0,o.A)(function*(){yield a._notifyService.show({message:e,duration:t})})()}showConfirmationDialog(e){return(0,d.lastValueFrom)(this._messageDialogProvider.confirmation(e))}translate(e){return this._translateService.instant(`${this.translationPrefix}.${e}`)}}var u=n(21018),r=n(59131);class i extends c.BaseRequestHandler{constructor(e){super(),this.messageChannelService=e}_tryReloadAudienceDetail(e,t,a){var s=this;return(0,o.A)(function*(){if(e.toLowerCase()!==(yield t).toLowerCase())return;const v={type:"crt.LoadDataRequest",config:{loadType:c.DataSourceLoadType.Reload},$context:a,dataSourceName:s.audienceDataSourceName};yield s.handlerChain.process(v)})()}_subscribeOnChannelMessages(e){var t=this;return(0,o.A)(function*(){const a=yield e.getPrimaryModelName(),s=e.getViewModelAttributePath(a,"Id");t.channelSubscription=t.messageChannelService.messageEvent$.pipe((0,d.filter)(v=>{const g=v?.body?.Notifications;return g?.length>0?!!g[0].EntityId:!1})).subscribe(v=>{const g=e[s],A=v?.body?.Notifications[0]?.EntityId;t._tryReloadAudienceDetail(A,g,e)})})()}handle(e){var t=this;return(0,o.A)(function*(){const a=e.$context;yield t._subscribeOnChannelMessages(a),yield t.next?.handle(e)})()}ngOnDestroy(){this.channelSubscription?.unsubscribe()}static{this.\u0275fac=function(t){return new(t||i)(r.\u0275\u0275inject(u.MessageChannelService))}}static{this.\u0275prov=r.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac})}}},73308:(j,p,n)=>{n.d(p,{A:()=>c});function o(f,y,m,l,d,h,u){try{var r=f[h](u),i=r.value}catch(S){m(S);return}r.done?y(i):Promise.resolve(i).then(l,d)}function c(f){return function(){var y=this,m=arguments;return new Promise(function(l,d){var h=f.apply(y,m);function u(i){o(h,l,d,u,r,"next",i)}function r(i){o(h,l,d,u,r,"throw",i)}u(void 0)})}}}}]);
