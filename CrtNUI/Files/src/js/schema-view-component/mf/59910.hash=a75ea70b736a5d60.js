(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[59910],{84330:($,W,a)=>{a.d(W,{H:()=>f});var s=a(73308),m=a(59131),M=a.n(m),O=a(38495),F=a.n(O),x=a(96590),P=a.n(x),T=a(21018),h=a.n(T),u=a(62278),v=a.n(u),L=a(73723),o=a(72417),c=a(68678),_=a(41756),C=a(60824),y=a(94660),E=a(97082),I=a(19808),N=a(30662),S=a(47096),b=a(3928),j=a(66882);class f{constructor(e,t,i,r,l,g,A){this._crtControlStateAdapter=e,this._validatorTypeResolver=t,this._viewModelGenerator=i,this._attributeCreator=r,this._viewModelRepository=l,this._attributesTopologicalSorting=g,this._injector=A,this._featureValues=this._injector.get(T.FEATURE_VALUES,null,{optional:!0}),this._measurePerformanceService=this._injector.get(T.MeasurePerformanceService)}_generateAttributes(e,t,i){const r=this._attributesTopologicalSorting.sort(t,e._attributeConfigs);return Promise.all(r.map(([l,g])=>e._systemAttributes.includes(l)?(console.warn(`Overriding of system attributes is denied. Attribute name:"${l}"`),Promise.resolve()):(i.disableDefaultConfig||(g??={}),e._attributeConfigs[l]=g,g?"viewModelConfig"in g||"viewModelName"in g?g.isCollection?this._generateNestedModelCollectionAttribute(e,l,g,i):this._generateNestedModelAttribute(e,l,g,i):(0,S.tC)(g)?this._generateCalculatedAttribute(e,l,g,i):this._generateModelAttribute(e,l,g,i):this._removeViewModelAttribute(e,l))))}_generateNestedModelCollectionAttribute(e,t,i,r){var l=this;return this._measurePerformanceService.measureCallback(`BaseViewModelAttributeGenerator.nestedCollectionAttribute.${t}`,(0,s.A)(function*(){const g=e.getBoundDataSourceNameByAttributePath(t),A=e.getModelByName(g),p="viewModelConfig"in i?i.viewModelConfig:yield(0,u.lastValueFrom)(l._viewModelRepository.resolveModelConfig(i.viewModelName)),D=new L.A(l._viewModelGenerator,p,A,e,t);l._registerOrSetFormControl(e.formApiModel,t,D.formApiModel);const n=e.attributes[t];e.attributes[t]=D,l._defineNestedModelAttribute(e,t,i,r),l._subscribeOnCollectionChanged(e,t,D,r),n!==void 0&&r.onChangeAttributeValue(t,D,n)}))}_defineNestedModelAttribute(e,t,i,r){const l=A=>{const p=e.attributes[t];e.attributes[t]=A,p instanceof L.A&&A instanceof L.A&&this._subscribeOnCollectionChanged(e,t,A,r),r.onChangeAttributeValue(t,A,p)},g=()=>e.attributes[t];b.iR.defineAsyncAttribute(e,t,i,g,l)}_generateNestedModelAttribute(e,t,i,r){return this._measurePerformanceService.measureCallback(`BaseViewModelAttributeGenerator.nestedModelAttribute.${t}`,()=>{const l="viewModelConfig"in i?i.viewModelConfig:i.viewModelName,g=e?.[o.wi];return(0,u.lastValueFrom)(this._viewModelGenerator.generate({viewModelConfig:l,parentViewModel:e},g?m.Injector.create({providers:[{provide:c.Fj,useValue:null}],parent:g}):null).pipe((0,u.map)(A=>{this._registerOrSetFormControl(e.formApiModel,t,A.formApiModel);const p=e.attributes[t];e.attributes[t]=A,this._defineNestedModelAttribute(e,t,i,r),p!==void 0&&r.onChangeAttributeValue(t,A,p)})))})}_subscribeOnCollectionChanged(e,t,i,r){if(e._collectionSubscription.has(t)){const g=e._collectionSubscription.get(t);g.unsubscribe(),e._subscriptions.remove(g)}const l=new u.Subscription;l.add(i.changed.subscribe(()=>{r.onChangeAttributeValue(t,i,null)})),l.add(i.itemAttributeChanged.subscribe(()=>{r.onChangeAttributeValue(t,i,null)})),e._collectionSubscription.set(t,l),e._subscriptions.add(l)}_generateCalculatedAttribute(e,t,i,r){this._measurePerformanceService.measure(`BaseViewModelAttributeGenerator.generateCalculatedAttribute.${t}`,()=>{this._attributeCreator.create(C.i)?.defineAttribute({viewModel:e,attribute:t,attributeConfig:i,generateOptions:r})})}_addDataValueTypePropertyConfig(e,t){t.dataValueTypeName&&e.push({name:_.sq,defaultValue:O.DataValueType[t.dataValueTypeName]})}_disableSystemAttributes(e,t,i){if(this._featureValues?.DisableBlockingSystemColumns===!0)return;if(e.getBoundDataSchemaAttributeByAttributePath(t)?.isSystem){let l=i.find(g=>g.name==="readonly");l||(l={name:"readonly"},i.push(l)),l.locked=!0,l.defaultValue=!0}}_getCrtControlPropertiesConfig(e,t,i){const r=Object.entries(i.properties??[]).map(([l,g])=>({name:l,defaultValue:g.defaultValue,locked:g.locked===!0}));return this._addDataValueTypePropertyConfig(r,i),this._disableSystemAttributes(e,t,r),r}_generateModelAttribute(e,t,i,r){this._measurePerformanceService.measure(`BaseViewModelAttributeGenerator.generateModelAttribute.${t}`,()=>{const l=e.attributes[t],g=i?.value,A=this._getCrtControlPropertiesConfig(e,t,i),p=_.CI.create({name:t,value:g,crtControlStateAdapter:this._crtControlStateAdapter,validatorTypeResolver:this._validatorTypeResolver,validatorInfo:e._validators[t],propertiesConfig:A,injectionContext:e._injectionContext??(0,b.Rz)(e)?._injectionContext});e._subscriptions.add(p.onChanged.subscribe(d=>{e.attributes[t]=d.value,r.onChangeAttributeValue(d.name,d.value,d.oldValue)})),e._subscriptions.add(p.onPropertyChanged.subscribe(({name:d,value:V,oldValue:w})=>{r.onChangeAttributeValue(`${t}:${d}`,V,w)})),e._crtControls.set(t,p),this._registerOrSetFormControl(e.formApiModel,t,p.formControl),e.attributes[t]=g??null;const D=e._getDataSourceAttributeDataValueType(t);this._attributeCreator.create(D).defineAttribute({viewModel:e,attribute:t,attributeConfig:i,control:p}),l!==void 0&&r.onChangeAttributeValue(t,g,l)})}_registerOrSetFormControl(e,t,i){this._measurePerformanceService.measure(`BaseViewModelAttributeGenerator.registerOrSetFormControl.${t}`,()=>{if(this._featureValues?.DisableAttributeOnlyRegisteringControl){e.setControl(t,i);return}e.contains(t)?e.setControl(t,i):e.registerControl(t,i)})}_removeViewModelAttribute(e,t){return delete e._attributeConfigs[t],delete e.attributes[t],delete e[t],Promise.resolve()}generate(e,t,i){var r=this;return this._measurePerformanceService.measureCallback("BaseViewModelAttributeGenerator.generateAttributes",(0,s.A)(function*(){yield r._generateAttributes(e,t,i),!r._featureValues?.DisableAttributeOnlyRegisteringControl&&e.formApiModel.updateValueAndValidity()}))}static{this.\u0275fac=function(t){return new(t||f)(m.\u0275\u0275inject(E.f),m.\u0275\u0275inject(_.LL),m.\u0275\u0275inject(y.d),m.\u0275\u0275inject(N.x),m.\u0275\u0275inject(j.k),m.\u0275\u0275inject(I.v),m.\u0275\u0275inject(m.Injector))}}static{this.\u0275prov=m.\u0275\u0275defineInjectable({token:f,factory:f.\u0275fac,providedIn:"root"})}}},73723:($,W,a)=>{a.d(W,{A:()=>I});var s=a(73308),m=a(59131),M=a.n(m),O=a(56711),F=a.n(O),x=a(38495),P=a.n(x),T=a(96590),h=a.n(T),u=a(21018),v=a.n(u),L=a(62278),o=a.n(L),c=a(36486),_=a.n(c),C=a(72417),y=a(68678),E=a(65576);class I extends Array{constructor(...S){return super(),this._itemsChanged=new L.Subject,this._itemAttributeChanged=new L.Subject,this._destroyed$=new L.Subject,this._changed=new L.Subject,this._trackChanges=!0,this._createdItems=[],this._deletedItems=[],this._isDestroyed=!1,typeof S[0]=="number"?new Array(S[0]):([this._viewModelGenerator,this._viewModelConfig={},this._model,this._host,this._hostAttributeName]=S,this._measurePerformanceService=this._host?.[C.wi]?.get(u.MeasurePerformanceService,null,{optional:!0}),this._featureValues=this._host?.[C.wi]?.get(u.FEATURE_VALUES,{},{optional:!0})??{},this._ngZone=this._host?.[C.wi]?.get(m.NgZone,null,{optional:!0}),Object.setPrototypeOf(this,Object.create(I.prototype)),this._subscribeItemsModelModesChanges(),this._subscribeItemsAttributesChanges(),new Proxy(this,{set:(b,j,f,R)=>{const e=b[j];return b[j]=f,this._trackChanges&&(j==="length"&&f!==e?this._onItemsChanged():isNaN(parseInt(j))||this._onItemsChanged()),!0}}))}get changed(){return this._changed.asObservable().pipe((0,T.runInZone)(this._ngZone),(0,c.takeUntil)(this._destroyed$))}get itemAttributeChanged(){return this._itemAttributeChanged.asObservable().pipe((0,c.takeUntil)(this._destroyed$))}get isChanged(){return this.getChangedItems().length>0}get formApiModel(){return this._formApiModel||this._updateFormApiModelValues({emitEvent:!1}),this._formApiModel}_isItemPrimaryAttributeEqual(S,b){return(0,s.A)(function*(){if(!S)return!1;const j=yield S[S.primaryAttributeName];return b.includes(j)})()}_insertItem(S,b){typeof b!="number"&&(b=this.length),b=Math.max(b,0),b=Math.min(b,this.length),this.splice(b,0,S)}_generateItem(S){const b=()=>{const j=this._model?.createCollectionItemModel(u.ModelMode.Create),f=this._host?.[C.wi],R=this._viewModelGenerator.generate({viewModelConfig:this._viewModelConfig,modelConfig:j?{primaryDataSourceName:j.name}:void 0,models:j?[j]:void 0,parentViewModel:this._host,businessRulesActive:S.businessRulesActive??!1},f?m.Injector.create({providers:[{provide:y.Fj,useValue:null}],parent:f}):null).pipe((0,c.tap)(e=>{j?.name&&(e.dataSchemas[j.name]=this._host.dataSchemas[j.name])}),(0,c.switchMap)(e=>j?.name?e.create(j.name,S.initialModelValues).pipe((0,c.map)(()=>e)):(0,L.of)(e)),(0,c.tap)(e=>{Object.entries(S.initialAttributeValues??{}).forEach(([t,i])=>e[t]=i),e._markAsPristine(S.initialAttributeValues??{}),this._model?.childrenChange()}));return(0,L.lastValueFrom)(R)};return this._measurePerformanceService?this._measurePerformanceService.measureCallback("ViewModelCollection.generateItem",()=>b()):b()}_mergeItems(S,b){const j=()=>{const f=(S[0]||b[0])?.primaryAttributeName;for(const R of b){const e=S.findIndex(t=>{const i=t.attributes?.[f],r=R.attributes?.[f];return i&&i===r});e===-1?S.push(R):S.splice(e,1,R)}return S};return this._measurePerformanceService?this._measurePerformanceService.measure("ViewModelCollection.mergeItems",()=>j()):j()}_triggerChangesAfter(S){this._trackChanges=!1;const b=S.call(this);return this._trackChanges=!0,this._isDestroyed||this._onItemsChanged(),b}_onItemsChanged(){const S=this.map(b=>({item:b,itemModelMode:b?.getPrimaryModelMode?.()}));this._updateCollectionState(S,!0)}_subscribeItemsModelModesChanges(){this._itemsChanged.pipe((0,c.switchMap)(()=>this._getItemsModelModesChanges()),(0,c.tap)(S=>this._updateCollectionState([S],!1)),(0,c.takeUntil)(this._destroyed$)).subscribe()}_subscribeItemsAttributesChanges(){this._itemsChanged.pipe((0,c.switchMap)(()=>this._getItemsAttributesChanges()),(0,c.filter)(S=>!S.payload.silent),(0,c.tap)(()=>this._itemAttributeChanged.next()),(0,c.takeUntil)(this._destroyed$)).subscribe()}_getItemsAttributesChanges(){const S=this.map(b=>b?.events$?.pipe((0,c.filter)(j=>j.type===E.n.ChangeAttributeValue))).filter(Boolean);return S.length?(0,L.merge)(...S):L.EMPTY}_getItemsModelModesChanges(){const S=[...this,...this._deletedItems].map(b=>b?._getPrimaryModelModeChanges?.()?.pipe((0,c.map)(j=>({item:b,itemModelMode:j})))).filter(Boolean);return S.length?(0,L.merge)(...S):L.EMPTY}_updateCollectionState(S,b){this._trackChanges=!1;const j=S.map(f=>this._onItemModelModeChanged(f)).some(f=>!!f);this._trackChanges=!0,!(!b&&!j)&&(this._updateFormApiModelValues(),this._updateFormApiModelPristineState(),this._changed.next(),this._itemsChanged.next())}_onItemModelModeChanged(S){const{item:b,itemModelMode:j}=S;if(!b||j==null)return!1;switch(j){case u.ModelMode.Create:return this._onCreateItem(b);case u.ModelMode.Update:return this._onUpdateItem(b);case u.ModelMode.Delete:return this._onDeleteItem(b);default:return!1}}_onCreateItem(S){const b=this._deletedItems.indexOf(S);return b!==-1?(this._deletedItems.splice(b,1),!0):(this._createdItems.indexOf(S)===-1&&this._createdItems.push(S),!1)}_onUpdateItem(S){const b=this._createdItems.indexOf(S);if(b!==-1)return this._createdItems.splice(b,1),!1;const j=this._deletedItems.indexOf(S);if(j!==-1){const f=this._deletedItems.splice(j,1);super.push(...f)}return!0}_onDeleteItem(S){const b=this._createdItems.indexOf(S),j=this._deletedItems.indexOf(S);return b!==-1?this._createdItems.splice(b,1):j===-1&&this._deletedItems.push(S),super.splice(this.indexOf(S),1),!0}_updateFormApiModelValues(S){if(this._featureValues.DisableBaseViewModelCollectionOptimization){this._formApiModel??=new O.FormArray([]),this._formApiModel.clear({emitEvent:!1}),this.filter(j=>j?.formApiModel).forEach(j=>{this._formApiModel.push(j.formApiModel,{emitEvent:!1})}),S?.emitEvent!==!1&&this._formApiModel.updateValueAndValidity();return}if(!this._formApiModel||!this._formApiModel.length){const j=new O.FormArray(this.filter(f=>f?.formApiModel)?.map(f=>f.formApiModel));this._formApiModel||(this._formApiModel=j),this._formApiModel.length||this._host?.formApiModel?.setControl(this._hostAttributeName,j)}else this._formApiModel.clear({emitEvent:!1}),this.filter(j=>j?.formApiModel).forEach(j=>{this._formApiModel.push(j.formApiModel,{emitEvent:!1})}),S?.emitEvent!==!1&&this._formApiModel.updateValueAndValidity()}_updateFormApiModelPristineState(){const S=this.formApiModel.pristine,b=this.some(j=>j?.formApiModel?.dirty);if(b&&S){this.formApiModel.markAsDirty();return}!b&&!S&&this.formApiModel.markAsPristine()}_reload(S){const b=()=>{for(const R of[...this._deletedItems,...this])this.removeChildModel(R,{triggerNotification:!1});this._model?.childrenChange();const j=[],f=R=>j.push(R.destroy());return this._createdItems.forEach(f),this._createdItems.splice(0,this._createdItems.length),this._deletedItems.forEach(f),this._deletedItems.splice(0,this._deletedItems.length),this.forEach(f),this.splice(0,this.length,...S),(0,L.forkJoin)(j).pipe((0,c.defaultIfEmpty)(void 0),(0,c.map)(()=>{}))};return this._measurePerformanceService?this._measurePerformanceService.measure("ViewModelCollection.reload",()=>b()):b()}removeChildModel(S,b){const j=b?.triggerNotification??!0,f=this._model?.name,R=S.getModelByName(f);this._model?.removeChild(R),j&&this._model?.childrenChange()}copyWithin(S,b,j){return this._triggerChangesAfter(()=>super.copyWithin(S,b,j))}fill(S,b,j){return this._triggerChangesAfter(()=>super.fill(S,b,j))}push(...S){return this._triggerChangesAfter(()=>super.push(...S))}reverse(){return this._triggerChangesAfter(()=>super.reverse())}shift(){return this._triggerChangesAfter(()=>super.shift())}sort(S){return this._triggerChangesAfter(()=>super.sort(S))}splice(S,b,...j){return this._triggerChangesAfter(()=>super.splice(S,b,...j))}unshift(...S){return this._triggerChangesAfter(()=>super.unshift(...S))}getChangedItems(){const S=[...this._deletedItems];return this.filter(j=>{if(j.attributes.IsChanged)return!0;const f=j.getPrimaryModelMode();return f&&f!==u.ModelMode.Update}).concat(S)}createItem(S){var b=this;const j=function(){var f=(0,s.A)(function*(){const R=yield b._generateItem(S||{});return b._insertItem(R,S?.index),R});return function(){return f.apply(this,arguments)}}();return this._measurePerformanceService?this._measurePerformanceService.measureCallback("ViewModelCollection.createItem",()=>j()):j()}getPrimaryAttributeValues(){return Promise.all(this.map(S=>S?.[S?.primaryAttributeName]))}findByPrimaryAttribute(S){var b=this;return(0,s.A)(function*(){for(const j of b)if(yield b._isItemPrimaryAttributeEqual(j,[S]))return j})()}filterByPrimaryAttributes(S){var b=this;return(0,s.A)(function*(){const j=[];for(const f of b)(yield b._isItemPrimaryAttributeEqual(f,S))&&j.push(f);return j})()}merge(S){const b=()=>{this._triggerChangesAfter(()=>{const j=this._mergeItems([...this],S);super.splice(0,this.length,...j),this._createdItems.splice(0,this._createdItems.length),S instanceof I&&this._mergeItems(this._deletedItems,S._deletedItems)})};return this._measurePerformanceService?this._measurePerformanceService.measure("ViewModelCollection.merge",()=>b()):b()}reload(S){return(0,L.lastValueFrom)(this._reload(S))}remove(S){const[b,j]=typeof S=="number"?[S,this[S]]:[this.indexOf(S),S];if(b>=0&&b<this.length)return this.splice(b,1),(0,L.lastValueFrom)(j.destroy())}clear(){return this.reload([])}moveTo(S,b){if(b>=this.length)throw new x.ArgumentOutOfRangeException("Target index cannot be greater than collection length");const j=this.indexOf(S);j===b||b<0||this._triggerChangesAfter(()=>{super.splice(b,0,super.splice(j,1)[0])})}destroy(){this._isDestroyed=!0,this._host=null;const S=this._reload([]);return this._formApiModel.clear({emitEvent:!1}),this._itemAttributeChanged.complete(),this._itemsChanged.complete(),this._destroyed$.next(),this._destroyed$.complete(),(0,L.lastValueFrom)(S)}}},38128:($,W,a)=>{a.d(W,{o:()=>f});var s=a(73308),m=a(59131),M=a(56711),O=a(38495),F=a(79772),x=a(20442),P=a(21018),T=a(28399),h=a(62278),u=a(36486),v=a(84330),L=a(73723);class o{_defineResourceAttribute(e,t,i,r,l){return new h.Observable(g=>{const A=e._getDataSourceAttributeCaption(r,l);if(this._defineResourceProperty(t,i,A),r.includes(".")){const p=r.split(".")[1];this._defineResourceProperty(t,p,A)}g.next(),g.complete()})}_defineResourceProperty(e,t,i){e[t]||Object.defineProperty(e,t,{get:()=>Promise.resolve(i??""),configurable:!0})}_getResourceNameByPath(e){const t=e.split(".");return t.length>1?t.join("_"):e}generate(e,t){return Object.entries(t||{}).map(([i,r])=>{const l=e[P.SchemaResourcesSuffix][P.TypeResources.string],g=this._getResourceNameByPath(i);return this._defineResourceAttribute(e,l,g,i,r)})}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=m.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}var c=a(72417),_=a(11848),C=a(68678),y=a(65576),E=a(28114),I=a(81116),N=a(41756),S=a(18046),b=a(47096);const j=500;class f{constructor(e,t,i,r,l,g,A,p){this.viewModelGenerator=e,this.injector=t,this.viewModelConfig=i,this.resources=r,this._eventScopes=g,this._modelsInitConfig=A,this._defaultPrimaryAttributeName="Id",this._models$=new h.BehaviorSubject([]),this._businessRulesActive=!0,this._dropdownPageSizeSettingsCode="DropdownPageSize",this._dataSourcesInfos=new Map,this._attributesToDataSourceNameMap=new Map,this._dropdownPageSize=null,this._replayEvents$=new h.ReplaySubject,this._loadedDataSources=new Set,this._conflictedModels=[],this.__destroyed=!1,this._disableViewModelWaitingForAsyncTasks=!1,this._disableViewModelLoadUnblockingThread=!1,this._blockFieldsAffectedByBusinessRules=!1,this._asyncTasksExecutingSubject=new h.BehaviorSubject(new Set),this._modelsRequestedToLoad=new Set,this._attributesAffectedByBusinessRules=[],this._businessRulesAreActivated=!1,this._modelLoaded$=new h.Subject,this._destroySubject=new h.Subject,this._viewModelAttributeChangeEventOptions=new P.ViewModelAttributeChangeEventOptions({preventAttributeChangeRequest:!1,preventStateChange:!0,preventRunBusinessRules:!0}),this._attributeConfigs={},this._eventsSubject$=new h.Subject,this._collectionSubscription=new Map,this._crtControls=new Map,this._subscriptions=new h.Subscription,this._destroy$=this._destroySubject.asObservable(),this._businessRulesActivated$=new h.BehaviorSubject(!1),this.attributes={},this.dataSchemas={},this.events$=(0,h.merge)(this._eventsSubject$,this._replayEvents$),this._systemAttributes=[],this.getAttributeViewModelConfig=D=>this._attributeConfigs[D]?.viewModelConfig?.attributes,this.initDependencies(),this._subscribeModelsChanges(),this.handlerChain=O.HandlerChainService.instance,l?this.formApiModel=l:this.formApiModel=this.formBuilder.group({}),this.parent=p,this._viewModelDataDelayerService&&!this.parent&&this._viewModelDataDelayerService.setViewModel(this)}get IsChanged(){return Promise.resolve(this.attributes[c.j7])}set IsChanged(e){}get HasUnsavedData(){return Promise.resolve(this.attributes[c.ie])}set HasUnsavedData(e){}set BusinessRulesActivated(e){}get BusinessRulesActivated(){return Promise.resolve(this._businessRulesAreActivated)}get _isChanged(){return console.warn("Warning: The `_isChanged` property of the view-model is deprecated. It will be removed in future versions. Use `IsChanged` or `HasUnsavedData` attribute instead."),Object.keys(this._attributeConfigs).filter(e=>!(0,T.isEmpty)(this._attributeConfigs[e].modelConfig)).some(e=>this.formApiModel.controls[e]?.dirty)}get _scopes(){return[...this._eventScopes??[]]}get _injectionContext(){return this._context}get[c.wi](){return this.injector}get primaryAttributeName(){if(!this._primaryModelName)return this._defaultPrimaryAttributeName in this._attributeConfigs?this._defaultPrimaryAttributeName:null;const t=this.dataSchemas[this._primaryModelName].primaryAttributeName,i=this._dataSourcesInfos.get(this._primaryModelName);return this._getMappedAttributeName(i,t)}get PrimaryModelMode(){return this.getPrimaryModelMode()}get State(){return(0,b.Rz)(this).attributes[c.$s]}get _destroyed(){return this.__destroyed}get models(){return this._models$.value}_executeWithOptions(e,t){let i;try{return i=this._viewModelAttributeChangeEventOptions.getOptions(),this._viewModelAttributeChangeEventOptions.setOptions(t),e()}finally{this._viewModelAttributeChangeEventOptions.setOptions(i)}}_setSystemAttributeValue(e,t){const i=this.attributes[e];this.attributes[e]=t,this._executeWithOptions(()=>{this._fireChangeAttributeEvent({type:y.n.ChangeAttributeValue,payload:{attributeName:e,oldValue:i,value:t}})},{preventStateChange:!0,preventRunBusinessRules:!0})}_fireChangeAttributeEvent(e){e.payload.silent??=this._viewModelAttributeChangeEventOptions.getAsSilent(),Object.assign(e.payload,this._viewModelAttributeChangeEventOptions.getOptions()),this._eventsSubject$.next(e)}_getViewModelValidators(e){const t=this.viewModelConfig.attributes[e]??{};return("validators"in t&&t.validators)??{}}_initDataSourceValidators(){return this._measurePerformanceService?.measure(`ViewModel.initDataSourceValidators.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>(this._validators={},this._dataSourcesInfos.forEach(e=>{e.attributesMap.forEach((t,i)=>{const r=this.viewModelConfig.attributes[i]??{};if("modelConfig"in r&&r.modelConfig?.ignoreValidators)return;this._validators[i]=this._validators[i]||[];const l=this._getDataSourceAttributeSchema(e,t);if(l?.validators){for(const[g,A]of Object.entries(l.validators))if(A?.type){const p=this._injectionContext??(0,b.Rz)(this)?._injectionContext,D=this.validatorTypeResolver.getValidator(A.type,{validationParameters:A?.params,injectionContext:p}),n=this._getViewModelValidators(i),d=Object.values(n).find(V=>V.type===A.type);this._validators[i].push({name:g,instance:D,disabled:!!d?.disabled,params:A?.params})}}})}),(0,h.of)(null)))}_initSchemaValidators(e){this._measurePerformanceService.measure(`ViewModel.initSchemaValidators.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>{Object.entries(e||{}).forEach(([t])=>{const i=this._getViewModelValidators(t);this._validators[t]=this._validators[t]||[];for(const[r,l]of Object.entries(i))if(l?.type){const g=this._injectionContext??(0,b.Rz)(this)?._injectionContext,A=this.validatorTypeResolver.getValidator(l.type,{validationParameters:l.params,injectionContext:g});this._validators[t].push({name:r,instance:A,disabled:l.disabled,params:l?.params})}})})}_waitAsyncValidation(){return(0,h.from)(this.waitAsyncTasksFinish()).pipe((0,u.switchMap)(()=>this.formApiModel.statusChanges.pipe((0,u.startWith)(this.formApiModel.status),(0,u.filter)(e=>e.toLowerCase()!=="pending"),(0,u.first)(),(0,u.map)(()=>null))))}_getDataSourceAttributeCaption(e,t){let i=this.resourceFinderService.findLocalizableValue(t);const r=this._getDataSourceInfoByViewModelAttributePath(e);if(i==null&&r){const l=r.getDataSourceAttributePath(e),g=l?this._getDataSourceAttributeSchema(r,l):"";i=g?g.caption:this._translateService.instant("BaseViewModel.DataSourceAttributeRemoved")}return i}_getResourcesStrings(){const e=this.resources?.strings??{};return{...e,...this._getResourceStringsByAttributes(e)}}_getChangedResourcesStrings(e){const t=Object.entries(e).reduce((r,[l,g])=>{const A=this.resources?.strings[l]||{},p=g&&{...A,...g};return{...r,[l]:p}},{}),i={...this.resources?.strings,...t};return JSON.parse(JSON.stringify(i))}_generateResourceAttribute(){this[P.SchemaResourcesSuffix]={},this[P.SchemaResourcesSuffix][P.TypeResources.string]={};const e=this._getResourcesStrings();return this._attributeResourceGenerator.generate(this,e)}_getBoundAttributeNames(){const e=new Set;return this._dataSourcesInfos.forEach(t=>{for(const i of t.mappedViewModelAttributes)e.add(i)}),Array.from(e.values())}_getDataSourceInfoByViewModelAttributePath(e){const t=this.getBoundDataSourceNameByAttributePath(e);return this._dataSourcesInfos.has(t)?this._dataSourcesInfos.get(t):null}_getResourceStringsByAttributes(e){const t=Object.keys(e);return this._getBoundAttributeNames().filter(r=>!t.includes(r)).reduce((r,l)=>(r[l]={},r),{})}_getDataSourceAttributeSchema(e,t){return this.dataSchemas[e.name]?.attributes?.find(i=>i.name===t)}_generatePrimaryAttributes(){return this._measurePerformanceService.measure(`ViewModel.generatePrimaryAttributes.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>{const e=Array.from(this._dataSourcesInfos.values()).map(t=>{const i=t.name,r=this.dataSchemas[i],g=(t.includePrimaryAttributes?[r?.primaryAttributeName,r?.primaryDisplayAttributeName]:[]).filter(A=>A&&!t.getIsDataSourceAttributePathExists(A)).map(A=>{const p=(0,O.generateGuid)(),D=`${i}_${A}_${p}`,n=r.findAttributeByName(A),d={modelConfig:{path:`${i}.${A}`},dataValueTypeName:O.DataValueType[n.dataValueType]};return this._attributeConfigs[D]=d,t.addNewAttribute(D,d),this._attributeGenerate({[D]:d})});return g.length===0?(0,h.of)(null):(0,h.forkJoin)(g)});return e.length===0?(0,h.of)(null):(0,h.forkJoin)(e).pipe(this._measurePerformanceService.measure$(`ViewModel.generatePrimaryAttributes.forkJoin.${this._injectionContext?.id}.parent.${!!this.parent}`))})}_getDataSourceDto(e){const t={},i=this._dataSourcesInfos.get(e);return i.attributesMap.forEach((r,l)=>{if(!i.getIsMapOnCollection(l)){const g=this.attributes[l],A=this._getDataSourceAttributeSchema(i,r);!g&&A?.dataValueType===O.DataValueType.Lookup?t[r]=null:t[r]=g}}),(0,h.of)(t)}_checkFilteringAttributes(e,t){if(t.some(r=>(0,T.isNil)(r.name)))throw new Error(`Filtering attributes for ${e} are not valid!`)}_attributeGenerate(e,t){return this._attributeGenerator.generate(this,e,{...t,onChangeAttributeValue:(i,r,l)=>{this._fireChangeAttributeEvent({type:y.n.ChangeAttributeValue,payload:{attributeName:i,value:r,oldValue:l,silent:this._viewModelAttributeChangeEventOptions.getAsSilent()}})}})}_getDataSourceNamesAffectedByFilteringAttribute(e){return[...this._dataSourcesInfos.entries()].filter(([,t])=>t.isCollection).filter(([t])=>{const i=this.getModelByName(t);return this._modelsRequestedToLoad?.has(i?.name)||i?.isLoaded||i?.isLoading}).filter(([t,i])=>{const r=i.getFilteringConfig(),l=r.some(g=>g?.name===e&&g?.loadOnChange);return l&&this._checkFilteringAttributes(t,r),l}).map(([t])=>t)}_createRequestsForReloadingDataSources(e){return e.map(t=>({type:"crt.LoadDataRequest",$context:this,dataSourceName:t,config:{loadType:O.DataSourceLoadType.Reload}}))}_dispatchStartLoadModelAttributes(e){const t=`${_.I4.AttributeLoading}_${this._context?.id}_${Object.keys(e)}`;this._measurePerformancePageLoadService?.addTask(t,{targetTask:!0}),this._replayEvents$.next({type:y.n.StartLoadModelAttributes,payload:e})}_dispatchFinishLoadModelAttributes(e){const t=`${_.I4.AttributeLoading}_${this._context?.id}_${Object.keys(e)}`;this._measurePerformancePageLoadService?.removeTask(t,{targetTask:!0}),this._replayEvents$.next({type:y.n.FinishLoadModelAttributes,payload:e})}_processEmptyLoadDataForCollection(e,t){var i=this;return(0,s.A)(function*(){if(!e.isCollection||!e.collectionViewModelAttributeName)return;const r=t.find(p=>p.type===O.ModelParameterType.PrimaryColumnValue);if(!r)return;const l=r.value?.value,g=i.attributes[e.collectionViewModelAttributeName];if(!l||!g)return;const A=yield g.findByPrimaryAttribute(l);A&&g.remove(A)})()}_loadDynamicModel(e){const t=e.attributeName,i=e.dataSourceConfig,r=e.dataSourceName||b.iR.createDynamicDataSourceNameFromAttributeName(this,t),l=b.iR.createAttributeConfig(this,r,e),g=this._createAndSetDataSourceInfo(r,t,l);return this._defineOrUpdateAttribute(t,l),this._setupSortingAttribute(e.sortingConfig),this._setupFiltersAttributes(e.filtersConfig),this._modelGenerator.generateOne(i,r).pipe((0,u.tap)(A=>this._markModelAsCollection(A,g)),(0,u.tap)(A=>this._upsertModel(r,A)),(0,u.tap)(A=>this._addModelDependencies(A,e.dependencies)),(0,u.switchMap)(A=>(0,h.forkJoin)([(0,h.of)(A),this._addDataSchemaToDataSchemas(A)])),(0,u.switchMap)(([A])=>(0,h.forkJoin)([(0,h.of)(A),(0,h.of)(this._replaceAttributesToDataSourceNameMap(g))])),(0,u.switchMap)(([A])=>(0,h.forkJoin)([(0,h.of)(A),this._reGenerateResourcesAttributes()])),(0,u.switchMap)(([A])=>this._loadModelData({model:A,dataSourceInfo:g,parametersConfig:[],loadType:O.DataSourceLoadType.Reload,useLastLoadParameters:e.useLastLoadParameters}).pipe(this._measurePerformanceService.measure$(`ViewModel.loadDynamicModel.${this._injectionContext?.id}.parent.${!!this.parent}.datasourceName.${e.dataSourceName}`))))}_defineOrUpdateAttribute(e,t){this.attributes[e]?this._attributeConfigs[e]=t:this._attributeGenerate({[e]:t})}_createAndSetDataSourceInfo(e,t,i){const l=N.OU.getFromViewModelConfig({attributes:{[t]:i}}).get(e);return this._dataSourcesInfos.set(e,l),l}_setupSortingAttribute(e){if(!e?.default)return;const t=e.attributeName;this.attributes[t]=e.default}_setupFiltersAttributes(e){e?.forEach(t=>{if(!t.value)return;const i=t.name,r=t.value;this[i]=r.value||r})}_addModelDependencies(e,t){this._modelDependencies[e.name]=t||[]}_addDataSchemaToDataSchemas(e){return e.getSchema().pipe((0,u.tap)(t=>this.dataSchemas[e.name]=t))}_reGenerateResourcesAttributes(){return(0,h.forkJoin)([...this._generateResourceAttribute(),(0,h.of)(null)])}_replaceAttributesToDataSourceNameMap(e){const t=this._getDataSourceAttributesMap(e),i=[...Array.from(this._attributesToDataSourceNameMap.entries()),...t];this._initializeAttributesToDataSourceNameMap(i)}_getMappedAttributeName(e,t){if(!e)return"";const i=e.getMappedAttributeNames(t);return!i||i.length===0?"":i[0]}_getMappedAttributeNames(e,t){return e?e.getMappedAttributeNames(t):[]}_getModelAttributesToLoad(e,t){const i=this._dataSourcesInfos.get(e.name);if(t?.attributes){const r=t.attributes.filter(l=>{const g=this._getMappedAttributeName(i,l);return!this.getIsDirty(g)});return this._getModelDependentAttributes(e,r)}return i.attributes.map(r=>r.path)}_loadStaticModel(e,t,i,r,l,g){const A=this.getModelByName(e),p=this._dataSourcesInfos.get(A.name);return this._loadModelData({model:A,dataSourceInfo:p,parametersConfig:t,loadType:i,payload:r,useLastLoadParameters:l,doNotUpdateLastLoadParameters:g})}_waitDataDelay(e){return this._viewModelDataDelayerService?.shouldBeDelayed()?(0,h.of)(e).pipe((0,u.delayWhen)(()=>this._viewModelDataDelayerService.loadTrigger$)):(0,h.of)(e)}_updateTrackedAttributes(e){const t=this._modelDependencies[e.name];if(!t||!e.isAggregate)return;const i=/^.{0,2}\[\w+:\w+(:\w+)?]/;t.forEach(r=>{const l=r.relationPath.split(".")[0],g=this.getModelByName(l),A=e.affectedAttributes.filter(D=>D.schemaName===g.dataSchemaName).map(D=>D.path.split(".")[0]).filter(D=>!i.test(D)),p=new Set([...r.trackByAttributes??[],...A]);r.trackByAttributes=[...p.values()]})}_getDependOnModelsNames(e){const t=this._modelDependencies[e];if(!t)return[];const i=t.map(r=>r.relationPath.split(".")[0]);return[...new Set(i)]}_waitForModelLoad(e){var t=this;return(0,s.A)(function*(){const i=t.getModelByName(e);!i||i?.isLoaded||i.mode===P.ModelMode.Create||i.mode===P.ModelMode.Copy||(yield(0,h.firstValueFrom)(t._modelLoaded$.pipe((0,u.filter)(r=>r===e),(0,u.take)(1))))})()}_waitForModelsLoad(e){var t=this;return(0,s.A)(function*(){if(e.length===0||t._isDesignTime)return;const i=e.map(r=>t._waitForModelLoad(r));yield Promise.all(i)})()}_getAffectedAttributes(e,t,i){const l=this.dataSchemas[e].primaryAttributeName,g=[...t];return l&&!t.includes(l)&&i?.length>0&&i?.[0][l]&&g.push(l),g}_getModelLoadParameters(e,t,i,r,l,g){return this._modelParametersBuilder.getModelLoadParameters(this,e,t,i,r,l,g).catch(A=>(console.error(A),this._showNotification({message:A.message}),[[{type:O.ModelParameterType.Never}],{},{}]))}_loadModelData({model:e,dataSourceInfo:t,parametersConfig:i,loadType:r,payload:l,useLastLoadParameters:g,doNotUpdateLastLoadParameters:A}){const p=e.name;this._modelsRequestedToLoad.add(p);const D=this._getModelAttributesToLoad(e,l),n=l?.attributes;if(n&&D.length===0)return(0,h.of)([]);if(this._conflictedModels.includes(p))return(0,h.of)([]);const d=this._getDataSourceMappingAttributes(t,D),V=this._getLoadTypeForDataSource(t,r);if(V===O.DataSourceLoadType.LoadNext&&this._loadedDataSources.has(p))return(0,h.of)([]);this._dispatchStartLoadModelAttributes(d);const w=!this._isSyncForModelAllowed(e)||n===null||e.mode===P.ModelMode.Init,B=this._getDependOnModelsNames(p);return this._checkAndLoadUnloadedDependOnModels(B),(0,h.from)(this._waitForModelsLoad(B)).pipe((0,u.switchMap)(U=>this._getModelLoadParameters(t,i,V,l,g,A)),(0,u.mergeMap)(U=>this._waitDataDelay(U)),(0,u.switchMap)(([U,k,K])=>e.load({attributes:D,parameters:U,options:{loadType:r,pagingConfig:k,sortingConfig:K}}).pipe(this._measurePerformanceService.measure$(`ViewModel.loadStaticModel.model.load.${this._injectionContext?.id}.parent.${!!this.parent}.modelName.${p}`),(0,u.catchError)(H=>this._handleLoadErrorResponse(H,[])),(0,u.tap)(()=>this._updateTrackedAttributes(e)),(0,u.tap)(H=>{H.length<k?.rowCount?this._loadedDataSources.add(p):this._loadedDataSources.delete(p)}),(0,u.tap)(H=>{H.length===0&&this._dispatchFinishLoadModelAttributes(d)}),(0,u.mergeMap)(H=>H.length===0?(0,h.from)(this._processEmptyLoadDataForCollection(t,U)).pipe((0,u.map)(()=>H)):(0,h.of)(H)))),(0,u.map)(U=>({data:U,viewModelAttributes:t.getModelDto(U)})),(0,u.switchMap)(({data:U,viewModelAttributes:k})=>this.setValue(k,{collectionLoadType:V===O.DataSourceLoadType.Reload?P.CollectionLoadType.Reload:P.CollectionLoadType.Merge,silent:!0}).pipe((0,u.tap)(()=>{!t.isCollection||!k||Object.keys(k).forEach(K=>{this.attributes[K]?.forEach(G=>{G.formApiModel.updateValueAndValidity()})})}),(0,u.tap)(()=>this._markAsPristine(k)),(0,u.map)(()=>U))),(0,u.tap)(()=>this._modelLoaded$.next(p)),(0,u.switchMap)(U=>this._runBusinessRulesForModel(e,U)),(0,u.tap)(U=>{if(w)return;const k=this._getAffectedAttributes(p,D,U);this._reloadDependentModels(e,k)}),(0,u.tap)(()=>{e.setLoadedState(),this._dispatchFinishLoadModelAttributes(d)}))}_checkAndLoadUnloadedDependOnModels(e){const t=e.filter(i=>{const r=!this._modelsRequestedToLoad.has(i),l=!(0,b.CB)(this.getModelByName(i));return r&&l});this._requestReloadModels(t)}_createChangeAttributeTriggers(e){return e.map(t=>({type:P.BusinessRuleTriggerType.ChangeAttributeValue,name:t,scopeId:""}))}_runBusinessRulesForModel(e,t,i=!1,r=[]){const l=this._dataSourcesInfos.get(e.name);if(l.isCollection||!this._businessRulesProcessingEnabled||!this._businessRulesActive)return(0,h.of)(t);const g=t[0]??{},A=i?[...l.mappedViewModelAttributes]:Object.keys(g).flatMap(n=>this._getMappedAttributeNames(l,n)).filter(n=>n!=null),p=this._createChangeAttributeTriggers(A),D={type:P.BusinessRuleTriggerType.DataLoaded,name:e.name,scopeId:""};return(0,h.forkJoin)([this._getModelBusinessRuleContext(l.name,[D,...r]),(0,h.of)(this._getViewModelBusinessRuleContext([...p,...r,D]))]).pipe(this._measurePerformanceService.measure$(`ViewModel.runBusinessRulesForModel.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,u.switchMap)(n=>this._runBusinessRulesForContexts(n)),(0,u.map)(()=>t))}_runInitialBusinessRules(){if(!this._businessRulesProcessingEnabled||!this._businessRulesActive)return(0,h.of)(null);const e={type:P.BusinessRuleTriggerType.ContextReady,name:null,scopeId:""};return this._prepareBusinessRulesContexts([e]).pipe(this._measurePerformanceService.measure$(`ViewModel.runInitialBusinessRules.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,u.mergeMap)(t=>t.length===0?(0,h.of)(null):this._runBusinessRulesForContexts(t)))}_createViewModelAttributesValues(e,t){const i=Object.entries(this.dataSchemas),[,r]=i.find(([g])=>g===e),l={};for(const g of r.attributes){const A=t[g.name],p=this.getViewModelAttributePath(e,g.name);p&&(l[p]=A??null)}return l}_createModelData(e,t){const i=this._dataSourcesInfos.get(e),r=this._getDataSourceMappingAttributes(i);this._dispatchStartLoadModelAttributes(r);const l=this.getModelByName(e),g=l.disableSync,A=this._getModelAttributesToLoad(l,null);return l.disableSync=!0,l.create(t).pipe((0,u.switchMap)(p=>{const D=this._createViewModelAttributesValues(e,p);return this.setValue(D).pipe((0,u.tap)(()=>this._forEachControl(D,n=>{n.markAsPristine(),n.markAsUntouched()})))}),(0,u.tap)(()=>{l.disableSync=g,this._modelLoaded$.next(e)}),(0,u.switchMap)(()=>this._runBusinessRulesForModel(l,[],!0)),(0,u.tap)(()=>{this._isSyncForModelAllowed(l)&&this._reloadDependentModels(l,A)}),(0,u.tap)(()=>{this._dispatchFinishLoadModelAttributes(r),l.setLoadedState()}),(0,u.map)(()=>null))}_copyModelData(e,t,i){const r=this._dataSourcesInfos.get(e),l=this._getDataSourceMappingAttributes(r);this._dispatchStartLoadModelAttributes(l);let g;const A=this.getModelByName(e),p=this._getModelAttributesToLoad(A,null),D=A.disableSync;return A.disableSync=!0,A.copy(t,i).pipe((0,u.catchError)(n=>this._handleLoadErrorResponse(n,{})),(0,u.map)(n=>({data:[n],viewModelAttributes:r.getModelDto([n])})),(0,u.switchMap)(({data:n,viewModelAttributes:d})=>this.setValue(d).pipe((0,u.tap)(()=>this._markAsPristine(d)),(0,u.map)(()=>n))),(0,u.tap)(()=>{A.disableSync=D,this._modelLoaded$.next(e)}),(0,u.switchMap)(n=>this._runBusinessRulesForModel(A,n,!0)),(0,u.tap)(()=>{this._isSyncForModelAllowed(A)&&this._reloadDependentModels(A,p)}),(0,u.tap)(()=>{this._dispatchFinishLoadModelAttributes(l),A.setLoadedState()}),(0,u.mergeMap)(()=>(0,h.of)(g)))}_getDataSourceMappingAttributes(e,t=null){const i=t??e.attributes.map(l=>l.path),r=Object.fromEntries(i.map(l=>[this._getMappedAttributeName(e,l),!0]));return e.collectionViewModelAttributeName&&(r[e.collectionViewModelAttributeName]=!0),r}_handleLoadErrorResponse(e,t){return console.error(e),this._showNotification({message:e.message,duration:1e4}),(0,h.of)(t)}_canExecuteBusinessRulesByModelAttributeValue(e,t,i){return t&&e?this._isModelAttributeValueValid(e,t,i):!0}_canExecuteBusinessRulesByViewModelAttributeValue(e,t){const i=this._getDataSourceInfoByViewModelAttributePath(e);if(i){const r=i.getDataSourceAttributePath(e);return this._canExecuteBusinessRulesByModelAttributeValue(i,r,t)}return!0}_getContextAttributeValue(e){return e instanceof Date?(0,O.toLocalISOString)(e):e}_getNormalizedContextAttributeValue(e,t,i){const r=e;return O.DataValueType[t]===O.DataValueType.Lookup||r?.displayValue?r?.value??e:i===!0||!t?e:[O.DataValueType.RICH_TEXT,O.DataValueType.Image].includes(O.DataValueType[t])?null:O.DataValueType[t]===O.DataValueType.MAXSIZE_TEXT&&e?e.slice(0,500):e}_getHasValueContextAttributeValue(e,t){return!!(t&&O.DataValueType[t]===O.DataValueType.Boolean||e!=null&&e!=="")}_getViewModelAttributeInfos(e,t,i){return Object.keys(t).filter(r=>!(t[r]instanceof L.A)).map(r=>{if(t[r]instanceof f)return this._getViewModelAttributeInfos(e?`${e}.${r}`:r,t[r]?.attributes??{},i);const l=this._attributeConfigs[r]?.dataValueTypeName,g=this._getContextAttributeValue(t[r]),A=this._getNormalizedContextAttributeValue(g,l,i);return{name:e?`${e}.${r}`:r,value:A??null,displayValue:t[r]?.displayValue,dataValueTypeName:l,hasValue:this._getHasValueContextAttributeValue(g,l)}}).flat()}_runBusinessRulesForContexts(e){const t=`${_.I4.RunningBusinessRules}-${(0,O.generateGuid)()}`;return this._onAsyncTaskStarted(t),(0,h.of)(e).pipe(this._measurePerformanceService.measure$(`ViewModel.runBusinessRules.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,u.map)(i=>i&&i.length>0?i.filter(r=>!(0,T.isNil)(r)).filter(r=>r.triggers&&r.triggers.length>0):[]),(0,u.mergeMap)(i=>{if(i.length===0)return(0,h.of)(null);const r=i.map(l=>({scopeName:l.scopeName,scopeId:l.scopeId,scopeType:l.scopeType,triggers:l.triggers}));return this._toggleControlsAffectedByBusinessRules(!1,r),this._businessRulesEngine.execute(i).pipe(this._measurePerformanceService.measure$(`ViewModel.runBusinessRules.execute.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,u.tap)(l=>{l.forEach(g=>{const A=r.find(p=>p.scopeId===g.scopeId&&p.scopeName===g.scopeName&&p.scopeType===g.scopeType);g.triggers=A?.triggers??[]})}),(0,u.switchMap)(l=>l?this._businessRulesApplier.applyRules(this,l):(0,h.of)(null)),(0,u.tap)(()=>{this._toggleControlsAffectedByBusinessRules(!0,r)}))}),(0,u.tap)(()=>this._onAsyncTaskFinished(t)))}_createViewModelContext(e,t){return{scopeType:x.ScopeType.ViewModel,scopeName:this._scopeName,scopeId:this._scopeName,scopeState:x.ScopeStateType.Unknown,parentScopeId:null,attributes:t,triggers:e}}_getViewModelBusinessRuleContext(e){const t=this._featureValues["BRules-EnableCompareLargeAttributeValues"],i=this._getViewModelAttributeInfos(null,this.attributes,t);return this._createViewModelContext(e,[...i].map(r=>({attributeName:r.name,value:r.value,displayValue:r.displayValue,dataValueTypeName:r.dataValueTypeName,hasValue:r.hasValue})))}_prepareModelBusinessRuleTrigger(e,t){return t.map(i=>{if(i.type===P.BusinessRuleTriggerType.DataLoaded||i.type===P.BusinessRuleTriggerType.ContextReady)return i;const r=this._getDataSourceInfoByViewModelAttributePath(i.name);return!r||r.name!==e?null:{type:P.BusinessRuleTriggerType.ChangeAttributeValue,name:r.getDataSourceAttributePath(i.name),scopeId:""}}).filter(i=>i!=null)}_getModelContextScopeStateType(e){switch(e.mode){case P.ModelMode.Init:return x.ScopeStateType.Init;case P.ModelMode.Create:return x.ScopeStateType.Create;case P.ModelMode.Copy:return x.ScopeStateType.Copy;case P.ModelMode.Update:return x.ScopeStateType.Update;default:return x.ScopeStateType.Unknown}}_getModelBusinessRuleContext(e,t){const i=this._dataSourcesInfos.get(e),r=this.getModelByName(e),l=this.dataSchemas[e],g=this._prepareModelBusinessRuleTrigger(e,t),A=this._getModelContextScopeStateType(r);return this._getDataSourceDto(e).pipe((0,u.map)(p=>({...r._getPersistedState(),...p})),(0,u.map)(p=>({enableCompareLargeAttributeValues:this._featureValues["BRules-EnableCompareLargeAttributeValues"],modelDto:p})),(0,u.map)(({enableCompareLargeAttributeValues:p,modelDto:D})=>Object.entries(D).map(([n,d])=>{let V;const w=this._getMappedAttributeName(i,n);if(w)V=this._attributeConfigs[w]?.dataValueTypeName;else{const k=l.findAttributeByName(n);V=O.DataValueType[k.dataValueType]}const B=this._getContextAttributeValue(d),U=this._getNormalizedContextAttributeValue(B,V,p);return{attributeName:n,value:U,displayValue:d?.displayValue,dataValueTypeName:V,hasValue:this._getHasValueContextAttributeValue(B,V),isSignificant:n===l.primaryAttributeName}})),(0,u.map)(p=>({scopeType:x.ScopeType.Model,scopeName:r.dataSchemaName,scopeId:e,scopeState:A,parentScopeId:this._scopeName,attributes:p,triggers:g,modelType:r.getDataSource()?.type})))}_prepareDataSourceNamesForBusinessRules(){return this._modelsMap.size===0?[]:[...this._modelsMap.values()].filter(e=>!this._dataSourcesInfos.get(e.name).isCollection).map(e=>e.name)}_getModelsBusinessRuleContexts(e){return this._prepareDataSourceNamesForBusinessRules().map(i=>i?this._getModelBusinessRuleContext(i,e):(0,h.of)(null))}_prepareBusinessRulesContexts(e){const t=this._getModelsBusinessRuleContexts(e);if(!this._scopeName)return t.length===0?(0,h.of)([]):(0,h.forkJoin)([...t]);const r=[(0,h.of)(this._getViewModelBusinessRuleContext(e)),...t];return r.length===0?(0,h.of)([]):(0,h.forkJoin)(r)}_isAttributeChange(e){return!e.attributeName?.includes(":")}_businessRulesSubscribeOnChangeAttributes(){if(!this._businessRulesProcessingEnabled)return;const e=this.events$.pipe((0,u.filter)(i=>i.type===y.n.ChangeAttributeValue),(0,u.filter)(i=>this._isAttributeChange(i.payload)),(0,u.filter)(i=>!i.payload.silent),(0,u.filter)(i=>!i.payload?.preventRunBusinessRules),(0,u.filter)(i=>{const r=i.payload;return this._canExecuteBusinessRulesByViewModelAttributeValue(r.attributeName,r.value)}),(0,u.filter)(()=>this._businessRulesActive),(0,u.map)(i=>i.payload.attributeName)),t=e.pipe((0,u.tap)(()=>this._onAsyncTaskStarted(_.I4.DebouncingBusinessRules)),(0,u.buffer)(e.pipe((0,u.debounceTime)(j))),(0,u.map)(i=>Array.from(new Set(i))),(0,u.map)(i=>this._createChangeAttributeTriggers(i)),(0,u.mergeMap)(i=>this._prepareBusinessRulesContexts(i)),(0,u.tap)(()=>this._onAsyncTaskFinished(_.I4.DebouncingBusinessRules)),(0,u.filter)(i=>i.length>0),(0,u.mergeMap)(i=>this._runBusinessRulesForContexts(i)));this._subscriptions.add(t.subscribe())}_subscribeOnChangeAttributes(){const e=this.events$.pipe((0,u.filter)(t=>t.type===y.n.ChangeAttributeValue),(0,u.tap)(t=>{const i=t,r=i.payload.attributeName,l=this.getBoundDataSourceName(r),g=this.getModelByName(l),p=this._dataSourcesInfos.get(l)?.attributesMap.get(r);p&&g?.attributeChanged(p,i.payload?.preventStateChange??i.payload?.silent)}));this._subscriptions.add(e.subscribe())}_getHasRelation(e,t,i){return e.map(l=>{const g=l.relationPath.split("."),A=l.trackByAttributes??[],p=g.shift(),D=g.shift();return A.push(D),{rootModelName:p,trackedAttributes:A}}).filter(({rootModelName:l})=>l===t).filter(({trackedAttributes:l})=>this._dataSourcesInfos.get(t).isCollection?!0:i.some(g=>l.includes(g))).length!==0}_getDependentModelsNames(e,t=[]){return e?Object.entries(this._modelDependencies).filter(([i])=>i!==e).filter(([,i])=>this._getHasRelation(i,e,t)).map(([i])=>i).map(i=>[i,...this._getDependentModelsNames(i)]).flat():[]}_getIsModelDataChanged(e){if(!this.getModelByName(e)?.isLoaded)return!1;const i=this._dataSourcesInfos.get(e);if(i.isCollection){const l=i.collectionViewModelAttributeName,g=this.attributes[l];return g?g.isChanged:!1}return i.getMappedAttributes().some(l=>this.getIsDirty(l))}_requestReloadModels(e){this._createRequestsForReloadingDataSources(e).forEach(i=>{this._ngZone.runOutsideAngular(()=>this.processRequest(i))})}_isModelAttributeValueValid(e,t,i){return this._getDataSourceAttributeSchema(e,t)?.dataValueType===O.DataValueType.Lookup?(0,P.isValidLookupValue)(i):!0}_canReloadModelDependentData(e,t){return e.canReloadDependentData(t)?!0:this._conflictedModels.includes(e.name)?!1:this._getDependentModelsNames(e.name,[t]).length>0}_getModelDependentAttributes(e,t){return[...t,...t.map(i=>e.getDependentAttributesNames(i)).flat()]}_getChangedModelsNames(e){return e.filter(t=>this._getIsModelDataChanged(t))}_showNotification(e){this._ngZone.runOutsideAngular(()=>this.processRequest({type:"crt.NotificationRequest",$context:this,...e}))}_isSyncForModelAllowed(e){return e.allowSync}_subscribeOnReloadDataEvents(){const e=this.events$.pipe((0,u.filter)(()=>this._modelSynchronizationEnabled),(0,u.filter)(t=>t.type===y.n.ChangeAttributeValue),(0,u.filter)(t=>t.payload.silent!==!0),(0,u.map)(t=>({modelName:this.getBoundDataSourceNameByAttributePath(t.payload.attributeName),attributeName:t.payload.attributeName,attributeValue:t.payload.value})),(0,u.filter)(({modelName:t})=>t!=null),(0,u.map)(({modelName:t,attributeName:i,attributeValue:r})=>{const l=this._dataSourcesInfos.get(t),g=l?.attributesMap.get(i);return{model:this.getModelByName(t),dataSourceInfo:l,modelAttribute:g,attributeValue:r}})).pipe((0,u.filter)(({model:t})=>t!=null),(0,u.filter)(({dataSourceInfo:t})=>!t.isCollection),(0,u.filter)(({model:t})=>this._isSyncForModelAllowed(t)),(0,u.filter)(({dataSourceInfo:t,modelAttribute:i,attributeValue:r})=>this._isModelAttributeValueValid(t,i,r)),(0,u.filter)(({model:t,modelAttribute:i})=>this._canReloadModelDependentData(t,i))).pipe((0,u.tap)(({model:t,dataSourceInfo:i,modelAttribute:r,attributeValue:l})=>{const g=this._getModelDependentAttributes(t,[r]),A=Object.fromEntries(g.map(p=>[this._getMappedAttributeName(i,p),!0]));this._dispatchStartLoadModelAttributes(A),t.reloadDependentData(r,l).pipe((0,u.switchMap)(p=>{if(p.length===0)return(0,h.of)(p);const D=i.getModelDto(p);return this.setValue(D,{silent:!0}).pipe((0,u.switchMap)(()=>this._runBusinessRulesForModel(t,p)))}),(0,u.tap)(()=>this._reloadDependentModels(t,[r])),(0,u.tap)(()=>this._dispatchFinishLoadModelAttributes(A))).subscribe()}));this._subscriptions.add(e.subscribe())}_subscribeOnChangeRequests(){const e=this.events$.pipe((0,u.filter)(t=>t.type===y.n.ChangeAttributeValue),(0,u.mergeMap)(t=>{const i=t.payload.attributeName,r=this._attributeConfigs[i];return Array.isArray(r?.change)?r.change:[r?.change]}),(0,u.filter)(t=>t!=null),(0,u.map)(t=>({type:t.request,$context:this,scopes:this._scopeName?[this._scopeName]:[],...t.params})),(0,u.tap)(t=>this._ngZone.runOutsideAngular(()=>this.handlerChain.process(t))));this._subscriptions.add(e.subscribe())}_subscribeOnFilteringEvents(){const e=this.events$.pipe((0,u.filter)(t=>t.type===y.n.ChangeAttributeValue),(0,u.map)(t=>{const i=t.payload.attributeName;return this._getDataSourceNamesAffectedByFilteringAttribute(i)}),(0,u.map)(t=>this._createRequestsForReloadingDataSources(t)),(0,u.tap)(t=>{t.forEach(i=>{this._ngZone.runOutsideAngular(()=>this.processRequest(i))})}));this._subscriptions.add(e.subscribe())}_saveModel(e,t,i){const r="MODEL_SAVING";this.maskService.showMask(r,this);const l=this._getBoundDataSourceAttributeControls(e);return Object.keys(l).forEach(g=>this.formApiModel.controls[g].updateValueAndValidity()),this._saveModelAndGetDataSourceSaveResult(e,t).pipe((0,u.finalize)(()=>this.maskService.hideMask(r,this)),(0,u.catchError)(g=>{const A=typeof g=="string"?g:g?.message||g?.errorInfo;return i?.silent===!0?(0,h.of)({success:!1,rowsAffected:0,errorInfo:A}):(0,h.throwError)(()=>new Error(A))}))}_saveModelAndGetDataSourceSaveResult(e,t){return(0,h.from)(this.isValid(e)).pipe((0,u.switchMap)(i=>{if(!i){const r=this.injector.get(F.TranslateService);return(0,h.of)({success:!1,rowsAffected:0,errorInfo:r.instant("HomePage.DialogMessages.RequiredFieldsAreNotFilled")})}return(0,h.forkJoin)({parameters:this._modelParametersBuilder.getModelParameters(this,t),dto:this._getDataSourceDto(e)}).pipe((0,u.mergeMap)(({parameters:r,dto:l})=>this.getModelByName(e).insertOrUpdate(l,r)))}))}_deleteModel(e,t,i){return(0,h.from)(this._modelParametersBuilder.getModelParameters(this,t,i?.payload)).pipe((0,u.mergeMap)(r=>this.getModelByName(e).delete(r)))}_initSubscriptions(){return this._measurePerformanceService.measure(`ViewModel.initSubscriptions.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>(this._subscribeOnFilteringEvents(),this._subscribeModelsEvents(),this._subscribeOnChangeAttributes(),this._subscribeOnChangeRequests(),this._subscribeOnReloadDataEvents(),this._businessRulesSubscribeOnChangeAttributes(),(0,h.of)(null)))}_getDataSchemas(){if(this.models&&this.models.length!==0){const e=this.models.map(t=>t.getSchema().pipe((0,u.map)(i=>[t.name,i])));return(0,h.combineLatest)(e).pipe((0,u.take)(1),(0,u.map)(t=>Object.fromEntries(t)))}return(0,h.of)({})}_setAttributesDefaultValues(e){var t=this;return(0,h.from)((0,s.A)(function*(){let i=Object.entries(t.dataSchemas);e&&(i=i.filter(([r])=>r===e));for(const[r,l]of i){const g={};for(const A of l.attributes){const p=yield(0,h.lastValueFrom)(A.defaultValue,{defaultValue:null});if(!(0,T.isNil)(p)){const D=t.getViewModelAttributePath(r,A.name);D&&(g[D]=p)}}t.setValue(g).subscribe()}})())}_generateDataSourcesInfo(){return this._dataSourcesInfos=N.OU.getFromViewModelConfig(this.viewModelConfig,this.models),(0,h.of)(this._dataSourcesInfos)}_generateAttributesToDataSourceNameMap(e){const t=Array.from(e.values()).map(i=>this._getDataSourceAttributesMap(i)).flat();return this._initializeAttributesToDataSourceNameMap(t),(0,h.of)(this._attributesToDataSourceNameMap)}_initializeAttributesToDataSourceNameMap(e){this._attributesToDataSourceNameMap=new Map(e)}_getDataSourceAttributesMap(e){const i=e.getMappedAttributes().map(r=>[r,e.name]);return e.isCollection&&i.push([e.collectionViewModelAttributeName,e.name]),i}_checkDataSourceName(e){if(!e)throw new Error("Data source name is not provided")}_getDataSourceLoadType(e){return e?e||O.DataSourceLoadType.Reload:null}_getLoadTypeForDataSource(e,t){if(t===O.DataSourceLoadType.Load)return t;const i=e.getPagingConfig();return!t&&i?O.DataSourceLoadType.LoadNext:t}_loadDefaultSorting(e){this._measurePerformanceService.measure(`ViewModel.mergeCollectionModels.${this._injectionContext?.id}.parent.${!!this.parent}.dsNames.${e?.toString()}`,()=>{Array.from(this._dataSourcesInfos.entries()).filter(([t])=>!e?.length||e.includes(t)).map(([,t])=>t.getSortingConfig()).filter(t=>!!t?.default).map(t=>({[t.attributeName]:t.default})).forEach(t=>this.setValue(t,{silent:!0}).subscribe())})}_getDropdownPageSize(){var e=this;return(0,s.A)(function*(){if(!(0,T.isEmpty)(e._dropdownPageSize))return e._dropdownPageSize;const t=yield e.sysSettingsService.getByCode(e._dropdownPageSizeSettingsCode);return e._dropdownPageSize={pagingConfig:{rowCount:t?.value,rowsOffset:0}},e._dropdownPageSize})()}_mergeCollectionModels(e,t){this._measurePerformanceService.measure(`ViewModel.mergeCollectionModels.${this._injectionContext?.id}.parent.${!!this.parent}.collection.${e}`,()=>{const i=this.attributes[e];this._featureValues.DisableBaseViewModelCollectionOptimization||i.length?i.merge(t):i.push(...t)})}_getEmbeddedModels(){const e=Object.entries(this.viewModelConfig?.attributes??{}).filter(([,r])=>r&&"embeddedModel"in r&&r.embeddedModel).map(([r,l])=>({attributeName:r,embeddedModel:l.embeddedModel}));if(e.length===0)return(0,h.of)([]);const t={},i=[];if(e.forEach(({attributeName:r,embeddedModel:{name:l,config:g}})=>{l?t[l]&&i.push(`Duplicated embedded model : ${l}.`):i.push(`Embedded model name is not provided for ${r}.`),t[l]=g}),i.length>0)throw new Error(i.join(" "));return this._modelGenerator.generate({dataSources:t},this.injector)}_concatModelsWithEmbedded(e=null){return this._getEmbeddedModels().pipe((0,u.map)(t=>{const i=[...e??[],...t??[]],r=i.map(l=>l.name).filter((l,g,A)=>A.indexOf(l)!==g);if(r.length>0)throw new Error(`Duplicated model names found : ${r.join(",")}.`);return i}))}_updateModelsMap(){const e=this.models.map(t=>[t.name,t]);this._modelsMap=new Map(e)}_subscribeModelsChanges(){this._subscriptions.add(this._models$.subscribe(()=>this._updateModelsMap()))}_subscribeModelsEvents(){this.models.forEach(e=>this._subscribeModelEvents(e))}_subscribeModelEvents(e){this._subscriptions.add(e.event$.pipe((0,u.mergeMap)(t=>this._waitDataDelay(t)),(0,u.mergeMap)(t=>this._ngZone.runOutsideAngular(()=>this.processRequest({type:"crt.HandleModelEventRequest",$context:this,scopes:this._eventScopes,modelName:e.name,modelEvent:t})),1)).subscribe())}initDependencies(){this.formBuilder=this.injector.get(M.FormBuilder),this.resourceFinderService=this.injector.get(P.ResourceFinderService),this.validatorTypeResolver=this.injector.get(N.LL),this.maskService=this.injector.get(P.DEVKIT_MASK_SERVICE),this.sysSettingsService=this.injector.get(O.SysSettingsService),this.crtControlStateAdapter=this.injector.get(S.f),this._businessRulesEngine=this.injector.get(x.BusinessRulesEngine),this._businessRulesApplier=this.injector.get(x.BusinessRulesApplier),this._featureValues=this.injector.get(P.FEATURE_VALUES),this._modelGenerator=this.injector.get(E.n),this._ngZone=this.injector.get(m.NgZone),this._translateService=this.injector.get(F.TranslateService),this._scopeName=this.injector.get(C.Fj,null),this._attributeGenerator=this.injector.get(v.H),this._attributeResourceGenerator=this.injector.get(o),this._crtZoneService=this.injector.get(P.CrtZoneService),this._viewEventZoneName=this.injector.get(C.C_,P.DefaultZones.Root),this._modelParametersBuilder=this.injector.get(I.R),this._context=this.injector.get(C.iB,null),this._crtInjectionContextService=this.injector.get(P.CrtInjectionContextsService),this._viewModelDataDelayerService=this.injector.get(N.bs,null),this._isDesignTime=this.injector.get(P.IS_DESIGN_TIME,null),this._measurePerformanceService=this.injector.get(P.MeasurePerformanceService,null),this._measurePerformancePageLoadService=this.injector.get(P.MeasurePerformancePageLoadService)}processRequest(e){return this.handlerChain.process(e)}_upsertModel(e,t){const i=[...this.models],r=i.findIndex(({name:l})=>l===e);r===-1?i.push(t):i.splice(r,1,t).forEach(l=>l.destroy()),this._subscribeModelEvents(t),this._models$.next(i)}_replaceDataSourceInfo(e,t){!e||!t||(this._loadedDataSources.has(e)&&this._loadedDataSources.delete(e),this._dataSourcesInfos.set(e,t),this._replaceAttributesToDataSourceNameMap(t))}_updateModels(e){e.forEach((t,i)=>{const r=this.getModelByName(i);r&&(this._markModelAsCollection(r,t),this._updateModelDependentAttributes(r,t))})}_markModelAsCollection(e,t){t.isCollection&&(e._isCollection=!0)}_updateModelDependentAttributes(e,t){const i=t.attributes.map(r=>({path:r.path,type:r.type}));e.updateDependentAttributes(i)}_initIsChangedAttribute(){this._systemAttributes.push(c.j7),this.attributes[c.j7]=!1;const e=this._models$.pipe((0,u.switchMap)(t=>t?.length?(0,h.combineLatest)(t.map(i=>i._dirty$)):(0,h.of)([])),(0,u.map)(t=>t.some(i=>i)),(0,u.filter)(()=>!this._viewModelAttributeChangeEventOptions.getOptions().preventStateChange),(0,u.distinctUntilChanged)()).subscribe(t=>{this._setSystemAttributeValue(c.j7,t)});this._subscriptions.add(e)}_initHasUnsavedDataAttribute(){this._systemAttributes.push(c.ie),this.attributes[c.ie]=!1;const e=this.events$.pipe((0,u.filter)(g=>g?.type===y.n.ChangeAttributeValue&&g.payload?.attributeName===c.j7),(0,u.map)(g=>g.payload.value)),t=(0,h.merge)(this.IsChanged,e),r=this._models$.pipe((0,u.map)(g=>g.map(A=>A._modeChanges$.pipe((0,u.startWith)(A.mode)))),(0,u.switchMap)(g=>g?.length?(0,h.combineLatest)(g):(0,h.of)([]))).pipe((0,u.map)(g=>g.some(A=>A===P.ModelMode.Create||A===P.ModelMode.Copy))),l=(0,h.combineLatest)([t,r]).pipe((0,u.map)(([g,A])=>!!(g||A)),(0,u.distinctUntilChanged)()).subscribe(g=>{this._setSystemAttributeValue(c.ie,g)});this._subscriptions.add(l)}_initPrimaryModelModeAttribute(){const e=this._getPrimaryModelModeChanges();if(!e)return;this._systemAttributes.push(c.yM),this.attributes[c.yM]=this.getPrimaryModelMode();const t=e.pipe((0,u.startWith)(this.getPrimaryModelMode())).subscribe(i=>this._setSystemAttributeValue(c.yM,i));this._subscriptions.add(t)}_initStateAttribute(){this._systemAttributes.push(c.$s),this.attributes[c.$s]=_.HQ.Active}_initBusinessRulesActivatedAttribute(){if(this._systemAttributes.push(c.kd),this.attributes[c.kd]=this._businessRulesAreActivated,this._businessRulesAreActivated)return;const e=this._businessRulesActivated$.pipe((0,u.filter)(t=>t===!0)).subscribe(t=>{this._setSystemAttributeValue(c.kd,t)});this._subscriptions.add(e)}_initSystemAttributes(){var e=this;return(0,s.A)(function*(){yield e._measurePerformanceService.measureCallback(`ViewModel.initSystemAttributes.${e._injectionContext?.id}.parent.${!!e.parent}`,()=>(e._initIsChangedAttribute(),e._initPrimaryModelModeAttribute(),e._initHasUnsavedDataAttribute(),e._featureValues.DisableDelayingModelEvents||e._initStateAttribute(),e._initBusinessRulesActivatedAttribute(),Promise.resolve()))})()}_handleCircularDependencies(){const e=(0,P.detectCircularDependencies)(this._modelDependencies);if(e.hasCycles){const t=this._translateService.instant("BaseViewModel.WarningModelsWithCircularDependencies");this._showNotification({message:t,duration:1e4}),console.warn(t,e.cycledModelsNames)}this._conflictedModels=e?.cycledModelsNames}_forEachControl(e,t){Object.keys(e).forEach(r=>{if(this.attributes[r]instanceof L.A){const l=this.attributes[r],g=e[r];l.forEach(A=>{const p=A.primaryAttributeName,D=A.attributes[p],n=g.find(d=>d[p]===D);n&&A._forEachControl(n,t)})}else if(this.attributes[r]instanceof f)this.attributes[r]._forEachControl(e[r],t);else{const l=this.getControl(r);t(l.formControl)}})}_getModelsErrors(e){return(e??[]).filter(t=>!t.isCollectionItemModel&&t.hasErrors).map(t=>t.getLastError())}_notifyAboutModelsErrors(e){const t=this._getModelsErrors(e);if(t.length>0){const i=t.map(r=>r.message).join(" ");this._showNotification({message:i})}}_initFeaturesStates(){this._disableViewModelWaitingForAsyncTasks=this._featureValues.DisableViewModelWaitingForAsyncTasks,this._disableViewModelLoadUnblockingThread=this._featureValues.DisableViewModelLoadUnblockingThread,this._blockFieldsAffectedByBusinessRules=this._featureValues.BlockFieldsWhileRunBusinessRules,this._modelSynchronizationEnabled=!this._featureValues.ModelSynchronizationDisabled}_handleAsyncTasksCycle(e){let t=null;const i=100,r=Array.from(e).filter(l=>l.startsWith(_.I4.ProcessingAttributeChangeRequest));if(!(!e.size||!r.length))return r.length&&(t=setTimeout(()=>{console.warn("[ViewModel]: Clearing executing tasks by exceeded timeout",r),r.forEach(l=>e.delete(l)),this._asyncTasksExecutingSubject.next(e)},i)),t}_getAffectedViewModelAttributes(e,t){return this.models.filter(r=>r.dataSchemaName===e).map(r=>r.name).flatMap(r=>this.getViewModelAttributePaths(r,t))}_toggleControlsAffectedByBusinessRules(e,t){if(!this._blockFieldsAffectedByBusinessRules)return;this._attributesAffectedByBusinessRules?.filter(r=>(0,x.canToggleAttribute)(this._scopeName,r,t))?.forEach(r=>{r.scopeName===this._scopeName?this.getControl(r.name).toggle(e):this._getAffectedViewModelAttributes(r.scopeName,r.name).forEach(g=>{this.getControl(g).toggle(e)})})}_initAttributesAffectedByBusinessRules(){var e=this;return(0,s.A)(function*(){const i=e._prepareDataSourceNamesForBusinessRules().filter(l=>!!l).map(l=>e.getModelByName(l)).map(l=>({scopeId:l.name,scopeName:l.dataSchemaName,scopeType:x.ScopeType.Model,modelType:l.getDataSource()?.type})),r={scopeName:e._scopeName,scopeType:x.ScopeType.ViewModel,scopeId:e._scopeName};e._attributesAffectedByBusinessRules=yield e._businessRulesEngine.getAffectedAttributes([r,...i])})()}_initBusinessRules(){var e=this;return(0,s.A)(function*(){return e._measurePerformanceService.measureCallback(`ViewModel.initBusinessRules.${e._injectionContext?.id}.parent.${!!e.parent}`,(0,s.A)(function*(){e._businessRulesProcessingEnabled=!e._featureValues.BusinessRulesProcessingDisabled,yield e._initAttributesAffectedByBusinessRules(),e._businessRulesAreActivated=e._businessRulesProcessingEnabled&&e._businessRulesActive!==!1,e._businessRulesActivated$.next(e._businessRulesAreActivated)}))})()}_attributeGenerate$(e,t){return(0,h.of)(this._featureValues.UseDesignerHotSwapViewModel).pipe((0,u.switchMap)(i=>i&&this._isDesignTime?this._initDataSourceValidators().pipe((0,u.tap)(()=>{this._initSchemaValidators(e)}),(0,u.switchMap)(()=>this._attributeGenerate(e,t))):this._attributeGenerate(e,t)))}_validateByDataSourceName(e){var t=this;return(0,s.A)(function*(){const i={},r=t._getBoundDataSourceAttributeControls(e);return yield Promise.all(Object.entries(r).map(([l,g])=>(g.markAsTouched(),g.updateValueAndValidity(),(0,h.lastValueFrom)((0,b.OL)(g).pipe((0,u.tap)(()=>{g.errors&&(i[l]=g.errors)})))))),i})()}_validateAll(){var e=this;return(0,s.A)(function*(){const t={};return e.formApiModel.markAllAsTouched(),e.formApiModel.updateValueAndValidity(),(0,b.SH)(e.formApiModel),yield(0,h.lastValueFrom)((0,b.OL)(e.formApiModel).pipe((0,u.tap)(()=>{Object.entries(e.formApiModel.controls).forEach(([r,l])=>{l.errors&&(t[r]=l.errors)})}))),t})()}runInitFlow(e=null){return this._concatModelsWithEmbedded(e).pipe(this._measurePerformanceService.measure$(`ViewModel.runInitFlow.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,u.tap)(t=>this._notifyAboutModelsErrors(t)),(0,u.tap)(t=>this._models$.next(t)),(0,u.tap)(()=>this._initFeaturesStates()),(0,u.mergeMap)(()=>this._generateDataSourcesInfo()),(0,u.tap)(t=>this._updateModels(t)),(0,u.mergeMap)(t=>this._generateAttributesToDataSourceNameMap(t)),(0,u.mergeMap)(t=>this._getDataSchemas()),(0,u.tap)(t=>this.dataSchemas=t),(0,u.mergeMap)(()=>this._initDataSourceValidators()),(0,u.switchMap)(()=>this._initBusinessRules()),(0,u.tap)(()=>{this._initSchemaValidators(this.viewModelConfig.attributes)}),(0,u.mergeMap)(()=>(0,h.forkJoin)([...this._generateResourceAttribute(),this._initSystemAttributes(),this._attributeGenerate(this.viewModelConfig.attributes),(0,h.of)(this),this._initSubscriptions()])),(0,u.mergeMap)(()=>this._generatePrimaryAttributes()),(0,u.tap)(()=>this._loadDefaultSorting()),(0,u.mergeMap)(()=>this._runInitialBusinessRules()),(0,u.tap)(()=>this._viewModelAttributeChangeEventOptions.reset())).pipe((0,u.switchMap)(()=>(0,h.of)(this)))}get modelInitConfigs(){return this._modelsInitConfig}init(e,t){return this._primaryModelName=t?.primaryModelName,this._modelDependencies=t?.modelDependencies||{},this._modelsLoadingConfig=t?.modelsLoadingConfig||{},this._lastEventLoadParameters=new Map,t?.businessRulesActive||this.deactivateBusinessRules(),this._modelDependencies&&this._handleCircularDependencies(),this._ngZone.runOutsideAngular(()=>this.runInitFlow(e))}setValue(e,t){const i=[],r=[];for(const l of Object.keys(this._attributeConfigs))"viewModelConfig"in this._attributeConfigs[l]||"viewModelName"in this._attributeConfigs[l]?r.push(l):i.push(l);return this._executeWithOptions(()=>{this._measurePerformanceService.measure(`ViewModel.setValue.updateViewModelModelAttributes.${this._injectionContext?.id}.parent.${!!this.parent}.data.${Object.keys(e).toString()}`,()=>{for(const l in e)i.includes(l)&&(this[l]=e[l])})},t),(0,h.forkJoin)([...r.filter(l=>e&&e[l]).map(l=>{if(this.attributes[l]instanceof f)return this.attributes[l].setValue(e[l],{silent:t?.silent,preventAttributeChangeRequest:t?.preventAttributeChangeRequest,preventStateChange:t?.preventStateChange,preventRunBusinessRules:t?.preventRunBusinessRules});{const g=this._attributeConfigs[l].viewModelConfig||this._attributeConfigs[l].viewModelName,A=!this._featureValues.DisableDataGridEditingMode,p=(e[l]||[]).map(D=>{const n=this.getBoundDataSourceName(l),V=this._getDataSourceInfoByViewModelAttributePath(l)?.isCollection&&this.getModelByName(n)?.createCollectionItemModel(P.ModelMode.Update);return this.viewModelGenerator.generate({viewModelConfig:g,modelConfig:A&&V?{primaryDataSourceName:V.name}:void 0,models:A&&V?[V]:void 0,parentViewModel:this,businessRulesActive:!1},m.Injector.create({providers:[{provide:C.Fj,useValue:null}],parent:this.injector})).pipe(this._measurePerformanceService.measure$(`ViewModel.setValue.generateViewModel.${this._injectionContext?.id}.parent.${!!this.parent}.modelName.${V?.name}`),(0,u.tap)(w=>{n&&(w.dataSchemas[n]=this.dataSchemas[n])}),(0,u.tap)(w=>{w.deactivateBusinessRules()}),(0,u.switchMap)(w=>w.setValue(D,{silent:t?.silent,preventAttributeChangeRequest:t?.preventAttributeChangeRequest,preventStateChange:t?.preventStateChange,preventRunBusinessRules:t?.preventRunBusinessRules}).pipe((0,u.tap)(()=>V&&V.setLoadedState()),(0,u.map)(()=>w))))});return!p.length&&t?.collectionLoadType===P.CollectionLoadType.Reload&&this.attributes[l].clear(),p.length===0?(0,h.of)(null):(0,h.forkJoin)([...p]).pipe((0,u.tap)(D=>{const n=this.getBoundDataSourceName(l);this.getModelByName(n)?.childrenChange(),this._executeWithOptions(()=>{t?.collectionLoadType===P.CollectionLoadType.Reload||!t?.collectionLoadType?this.attributes[l].reload(D):this.getBoundDataSchema(l)?this._mergeCollectionModels(l,D):this.attributes[l].push(...D)},t)}))}}),(0,h.of)(this)])}deactivateBusinessRules(){this._businessRulesActive=!1}activateBusinessRules(){const e=this._businessRulesActive;if(this._businessRulesActive=!0,e)return(0,h.of)(null);const t=this.models.filter(i=>i.isLoaded);if(t.length>0){const i={type:P.BusinessRuleTriggerType.ContextReady,name:null,scopeId:""};return(0,h.forkJoin)(t.map(r=>this._runBusinessRulesForModel(r,[],!0,[i]))).pipe((0,u.tap)(()=>this._businessRulesAreActivated=this._businessRulesProcessingEnabled),(0,u.tap)(()=>this._businessRulesActivated$.next(this._businessRulesAreActivated)))}}_getIsAffectedByBusinessRules(e){if(!this._businessRulesProcessingEnabled)return Promise.resolve(!1);const t=e.name,i=this._attributesAffectedByBusinessRules;if(i.length===0||!t)return Promise.resolve(!1);const r=i.some(p=>p.name===t),l=this.getBoundDataSchemaByAttributePath(t),g=this.getBoundDataSchemaAttributeByAttributePath(t);if(!g)return Promise.resolve(r);const A=i.filter(p=>p.scopeName===l.name).some(p=>p.name===g.name);return Promise.resolve(A||r)}executeRequest(e){return e.scopes=e.scopes||this._eventScopes,this._crtZoneService.runInZone(this._viewEventZoneName,()=>this.processRequest(e))}getAttributeControl(e){let t=this.formApiModel;(0,b.Jt)(this,e).then(T.noop);for(const i of e.split("."))t=t.get(i);return t??new M.FormControl}loadLookupList(e,t=[],i){const r=e.control,l=e.items,g=this._getDataSourceInfoByViewModelAttributePath(l);if(g){const A=this._ngZone.runOutsideAngular(()=>this.processRequest({type:"crt.LoadDataRequest",$context:this,dataSourceName:g.name,parameters:t,config:{payload:i}}));Promise.resolve(A)}else{const A=this._getDataSourceInfoByViewModelAttributePath(r);if(A){const p=A.getDataSourceAttributePath(r);(0,h.forkJoin)([this._getDropdownPageSize(),this._modelParametersBuilder.getModelParameters(this,t,i)]).pipe((0,u.mergeMap)(([D,n])=>this.getModelByName(A.name).loadLookupList(p,n,D)),(0,u.map)(D=>N.OU.getLookupListDataSourceInfo(l,{value:D.primaryAttributeName,displayValue:D.primaryDisplayAttributeName}).getModelDto(D.data)),(0,u.mergeMap)(D=>this.setValue(D,{silent:!0}))).subscribe()}}}load(...e){const t=this._disableViewModelLoadUnblockingThread?(0,h.of)(null):(0,h.timer)(0,h.asyncScheduler);if(typeof e[0]=="string"){const r=e[0],l=e[1],g=e[2];this._checkDataSourceName(r);const A=this._getDataSourceLoadType(g?.loadType);return t.pipe((0,u.switchMap)(()=>this._loadStaticModel(r,l,A,g?.payload,g?.useLastLoadParameters,g?.doNotUpdateLastLoadParameters).pipe(this._measurePerformanceService.measure$(`ViewModel.loadStaticModel.${this._injectionContext?.id}.parent.${!!this.parent}.datasourceName.${r}`))))}const i=e[0];return t.pipe((0,u.switchMap)(()=>this._loadDynamicModel(i).pipe(this._measurePerformanceService.measure$(`ViewModel.loadDynamicModel.${this._injectionContext?.id}.parent.${!!this.parent}.model.${i.dataSourceName}`))))}setSorting(e,t){const r=this._dataSourcesInfos.get(e).getSortingConfig(),l=r&&r.attributeName;return l&&(this[l]=t),(0,h.of)(null)}create(e,t){return this._checkDataSourceName(e),this._createModelData(e,t)}copy(e,t,i){return this._checkDataSourceName(e),this._copyModelData(e,t,i)}loadDefaultValues(e){return this._setAttributesDefaultValues(e)}save(e,t,i){return(0,h.from)(this.waitAsyncTasksFinish()).pipe((0,u.switchMap)(()=>(this._checkDataSourceName(e),this.getModelMode(e)===P.ModelMode.Delete?this.delete(e,t,i):this._saveModel(e,t,i))))}delete(e,t,i){return this._checkDataSourceName(e),this._deleteModel(e,t,i)}resume(){return(0,h.of)(void 0)}pause(){return(0,h.of)(void 0)}destroy(){this._subscriptions.unsubscribe(),Array.from(this._collectionSubscription.values()).forEach(t=>t.unsubscribe()),this._collectionSubscription.clear(),this._crtControls.forEach(t=>{t.destroy()}),this.models?.forEach(t=>t.destroy()),this._crtControls.clear(),this._eventsSubject$.complete(),this._replayEvents$.complete(),this._modelLoaded$.complete();const e=[];for(const t of Object.values(this.attributes))t instanceof f&&e.push(t.destroy()),t instanceof L.A&&e.push((0,h.from)(t.destroy()));return(0,h.forkJoin)(e).pipe((0,u.defaultIfEmpty)(void 0),(0,u.map)(()=>{}),(0,u.finalize)(()=>{this.parent||(this._crtInjectionContextService.removeContext(this._injectionContext?.id),(0,O.callOnContextDestroyHooks)(this._injectionContext),this._context=null,this._viewModelDataDelayerService?.destroy(),this._viewModelDataDelayerService=null),this._asyncTasksExecutingSubject.complete(),this._dataSourcesInfos.clear(),this.__destroyed=!0,this._destroySubject.next(),this._destroySubject.complete()}))}getBoundDataSourceName(e){if(this._attributesToDataSourceNameMap.has(e))return this._attributesToDataSourceNameMap.get(e);const t=Array.from(this._attributesToDataSourceNameMap.keys()).find(i=>i.includes(".")&&i.split(".")[1]===e);return this._attributesToDataSourceNameMap.has(t)?this._attributesToDataSourceNameMap.get(t):null}_getBoundDataSourceAttributeControls(e){return Object.fromEntries(Array.from(this._attributesToDataSourceNameMap.entries()).filter(([t,i])=>i===e).map(([t])=>[t,this.getAttributeControl(t)]))}getBoundDataSourceAttributeControls(e){return Object.values(this._getBoundDataSourceAttributeControls(e))}getBoundDataSourceNameByAttributePath(e){return this._attributesToDataSourceNameMap.has(e)?this._attributesToDataSourceNameMap.get(e):null}getBoundDataSchema(e){return this.dataSchemas[this.getBoundDataSourceName(e)]}getBoundDataSchemaByAttributePath(e){return this.dataSchemas[this.getBoundDataSourceNameByAttributePath(e)]??null}getBoundDataSchemaAttributeByAttributePath(e){const t=this.getBoundDataSourceNameByAttributePath(e),i=this.getBoundDataSchemaByAttributePath(e);if(!t||!i)return null;const l=this._getDataSourceInfoByViewModelAttributePath(e).getDataSourceAttributePath(e);return i.findAttributeByName(l)}getPrimaryModelName(){return Promise.resolve(this._primaryModelName)}getPrimaryDataSchema(){return this.getPrimaryModelName().then(e=>this.dataSchemas[e])}isValid(e){const t=this._waitAsyncValidation().pipe((0,u.map)(()=>e?this.getBoundDataSourceAttributeControls(e).every(i=>!i.invalid):this.formApiModel.valid));return(0,h.lastValueFrom)(t)}validate(e){return this._ngZone.run(()=>e?this._validateByDataSourceName(e):this._validateAll())}getViewModelAttributePath(e,t){const i=this._dataSourcesInfos.get(e);return this._getMappedAttributeName(i,t)}getViewModelAttributePaths(e,t){return this._dataSourcesInfos.get(e)?.getMappedAttributeNames(t)}getCollectionViewModelAttributePath(e){return this._dataSourcesInfos.get(e)?.collectionViewModelAttributeName}canDelete(e,t){var i=this;return(0,s.A)(function*(){return i.getModelByName(e).canDelete(t)})()}canSave(e,t){var i=this;return(0,s.A)(function*(){return i.getModelByName(e).canSave(t)})()}enableAttributeValidator(e,t){this.getControl(e).enableValidator(t)}disableAttributeValidator(e,t){this.getControl(e).disableValidator(t)}_hotSwap(e){return this._measurePerformanceService.measure(`ViewModel.generatePrimaryAttributes.${this._injectionContext?.id}.parent.${!!this.parent}.hotSwap`,()=>{const t=e?.attributes?.changed||[],i=(0,T.isEmpty)(e.resources?.strings);if((0,T.isEmpty)(t)&&i)return(0,h.of)(!1);i||(this.resources={strings:this._getChangedResourcesStrings(e.resources.strings)}),this.viewModelConfig=e.actualViewModelConfig;const r=N.OU.getFromViewModelConfig(this.viewModelConfig),l=Object.fromEntries(t.map(d=>[d,this.viewModelConfig.attributes[d]])),g=e?.models?.changed??[],A=g.map(d=>d.name),p=this.models.filter(d=>d.isLoaded||d.isLoading).filter(d=>A.includes(d.name)).map(d=>d.name),D=g.map(d=>{const V=r.get(d.name);return this._upsertModel(d.name,d),this._replaceDataSourceInfo(d.name,V),this._addDataSchemaToDataSchemas(d)}),n=this._attributeGenerate$(l,{disableDefaultConfig:!0});return(0,h.forkJoin)([...D,n]).pipe(this._measurePerformanceService.measure$(`ViewModel.generatePrimaryAttributes.${this._injectionContext?.id}.parent.${!!this.parent}.hotSwap.forkJoin`),(0,u.switchMap)(()=>this._reGenerateResourcesAttributes()),(0,u.tap)(()=>this._loadDefaultSorting(A)),(0,u.tap)(()=>this._requestReloadModels(p)),(0,u.map)(()=>!0))})}_setAttributeValue(e,t,i){this._executeWithOptions(()=>this[e]=t,i)}set(e,t,i){return this._setAttributeValue(e,t,i),Promise.resolve()}_markAsPristine(e){this._forEachControl(e,t=>t.markAsPristine())}getAttributeNameByViewItemName(e){return Object.keys(this._attributeConfigs).find(t=>this._attributeConfigs[t].viewItemName===e)}getControl(e){return this._crtControls.has(e)?this._crtControls.get(e):N.CI.create({name:e,value:null,propertiesConfig:[]})}getAttributePropertyValue(...e){let t,i;if(e.length===2)t=e[0],i=e[1];else if(e.length===1){const l=e[0].split(":");t=l[0],i=l[1]}else throw new Error("ArgumentException");return this.getControl(t).getPropertyValue(i)}setAttributePropertyValue(...e){let t,i,r;if(e.length===3)t=e[0],i=e[1],r=e[2];else if(e.length===2){const g=e[0].split(":");t=g[0],i=g[1],r=e[1]}else throw new Error("ArgumentException");return this.getControl(t).setPropertyValue(i,r)}resetAttributePropertyValue(...e){let t,i;if(e.length===1)[t,i]=e[0].split(":");else if(e.length===2)t=e[0],i=e[1];else throw new Error("ArgumentException");this.getControl(t).getPropertyByName(i)?.resetValue()}getInvariabilityPropertyName(e){return this.getControl(e).getInvariabilityPropertyName()}setModelValues(e,t){return this.getModelByName(e).setValue(t)}_getBoundAttributesNames(e){const t=this.getBoundDataSourceNameByAttributePath(e);if(!t)return null;const i=this._dataSourcesInfos.get(t),r=i.attributesMap.get(e);return Array.from(i.attributesMap.entries()).filter(([l,g])=>g===r&&l!==e).map(([l])=>l)}_getAttributeDataValueTypeName(e){return this._attributeConfigs[e].dataValueTypeName}getDataSourceLoadParameters(e){var t=this;return(0,s.A)(function*(){const i=t._dataSourcesInfos.get(e);return i?t._modelParametersBuilder.getModelLoadParameters(t,i,[]).then(([r,l,g])=>({parameters:r,options:{pagingConfig:l,sortingConfig:g}})):null})()}isDataSourceForCollection(e){return!!this._dataSourcesInfos.get(e)?.isCollection}_getDataSourceAttributeDataValueType(e){const t=this._getDataSourceInfoByViewModelAttributePath(e);let i=null;if(t){const r=t.getDataSourceAttributePath(e);r&&(i=this._getDataSourceAttributeSchema(t,r)?.dataValueType)}return i}_getModelNamesByLoadType(e){return Object.entries(this._modelsLoadingConfig).filter(([t,i])=>i.type===e).map(([t,i])=>t)}_reloadDependentModels(e,t=[]){const i=this._getDependentModelsNames(e.name,t);if(this._getChangedModelsNames(i).length!==0){this._showNotification({message:"BaseViewModel.RefreshModelDataConflict"});return}const l=i.filter(g=>this._modelsRequestedToLoad.has(g));this._requestReloadModels(l)}getIsDirty(e){return this.getControl(e).isDirty}getModelByName(e){return this._modelsMap.get(e)}getModelMode(e){return this.getModelByName(e)?.mode}getPrimaryModelMode(){return this.getModelMode(this._primaryModelName)}_getModelModeChanges(e){return this.getModelByName(e)?._modeChanges$}_getPrimaryModelModeChanges(){return this._getModelModeChanges(this._primaryModelName)}markModelFor(e,t){this.getModelByName(e)?.markFor(t)}markPrimaryModelFor(e){this.markModelFor(this._primaryModelName,e)}_setStateAttribute(e){this._setSystemAttributeValue(c.$s,e)}_onAsyncTaskStarted(e){if(this._disableViewModelWaitingForAsyncTasks)return;const t=this._asyncTasksExecutingSubject.value;t.add(e),this._asyncTasksExecutingSubject.next(t)}_onAsyncTaskFinished(e){if(this._disableViewModelWaitingForAsyncTasks)return;const t=this._asyncTasksExecutingSubject.value;t.delete(e),this._asyncTasksExecutingSubject.next(t)}waitAsyncTasksFinish(){let e;return(0,h.firstValueFrom)(this._asyncTasksExecutingSubject.pipe((0,u.tap)(t=>{clearTimeout(e),e=this._handleAsyncTasksCycle(t)}),(0,u.filter)(t=>t.size===0),(0,u.take)(1),(0,u.map)(()=>{})))}}},72417:($,W,a)=>{a.d(W,{kd:()=>h,qg:()=>O,Do:()=>m,ie:()=>x,j7:()=>P,yM:()=>T,Ef:()=>s,$s:()=>u,wi:()=>F});const s="Unsaved7xDetailsData",m="HasUnsavedDataAnd7xDetails";var M=a(21018);const O=["crt.CopilotActionDataSource","crt.CopilotIntentDataSource","crt.CopilotIntentParameterDataSource",M.EntityDataSourceTypeName],F=Symbol("InternalViewModelInjector"),x="HasUnsavedData",P="IsChanged",T="PrimaryModelMode",h="BusinessRulesActivated",u="State"},28930:($,W,a)=>{a.d(W,{Mf:()=>P,dY:()=>h,yR:()=>x,yz:()=>T});var s=a(62278),m=a.n(s),M=a(36486),O=a.n(M),F=a(90169);class x extends Error{get isCritical(){return!0}constructor(v,L){super(L),this.dataSource=v}}class P extends x{constructor(v,L){super(v,L)}}class T extends x{get isCritical(){return!1}constructor(v,L){super(v,L)}}class h{constructor(v,L){this.dataSourceName=v,this.injector=L,this._errors=[]}get scope(){return this._scope}get hasErrors(){return this._errors.length!==0}get hasCriticalErrors(){return this._errors.some(v=>v.isCritical)}get affectedAttributes(){return[]}getLastError(){return this.hasErrors?this._errors[this._errors.length-1]:null}get isAggregate(){return!1}getEmptySchema(){return new F.I}init(v,L){return this.initialConfig=v,this._scope=L,(0,s.of)(this)}load(v,L,o){return this.innerLoad(v,L,o)}save(v,L){return this.innerSave(v,L)}insert(v){return this.innerInsert(v)}delete(v){return this.innerDelete(v)}getSchema(){return this.dataSchema?(0,s.of)(this.dataSchema):this.innerGetSchema().pipe((0,M.tap)(v=>{this.dataSchema=v}))}getLookupDataSchema(v){return this.innerGetLookupDataSchema(v)}getDefaultValues(){return this.innerGetDefaultValues()}canEdit(v){return this.innerCanEdit(v)}canDelete(v){return this.innerCanDelete(v)}canCreate(v){return this.innerCanCreate(v)}}},37015:($,W,a)=>{a.d(W,{kr:()=>m,wY:()=>M,aA:()=>F,$E:()=>x,vx:()=>O,d4:()=>T,ww:()=>P,d1:()=>u,Al:()=>s,L9:()=>v});const s="invalidate-data-schema-cache",m="DS",M="DYN",O="CopilotIntentMode",F={Chat:"Chat",Api:"API"},x=new Map([["Chat","326bba59-302a-4a5e-857c-2576e1a38ab0"],["API","5f2dc095-4543-4972-b6bc-6599bf6bc3fd"]]),P="CopilotIntentStatus",T=new Map([["InDevelopment","4670b068-ad03-4364-9350-6cc61efd1b7f"],["Active","1d73b111-07a9-49e2-aa15-c9415cce7470"],["Deactivated","2c547e71-7a05-42e1-8b65-2bf63f200156"]]);var h=a(62278);const u={Default:{value:"35f3b644-4fa3-4d1e-8e62-5c3fdc4d3e52",displayValue:"Default",primaryColorValue:"#22AC14"},Common:{value:"6d940b75-21c8-4a90-89ab-9867e6e4a045",displayValue:"Common",primaryColorValue:"#7848EE"}};function v(){return(0,h.of)(Object.values(u))}},63801:($,W,a)=>{a.d(W,{m:()=>F});var s=a(38495),m=a(95868),M=a(62278),O=a(24089);class F extends O.f{constructor(P,T){super(P,T),this.dataSourceName=P,this.injector=T,this.type="crt.CopilotActionDataSource",this._intentManager=this.injector.get(m.CopilotIntentManagerService)}_getActionUId(P){return P.filter(h=>h.type===s.ModelParameterType.PrimaryColumnValue)[0]?.value}innerDelete(P){return(0,M.of)(void 0)}innerInsert(P){const T=P;return(0,M.forkJoin)([this._intentManager.createAction(T),this.getSchema()]).pipe((0,M.map)(([h,u])=>({success:h.success,rowsAffected:1,errorInfo:h.errorInfo?.message,primaryAttributes:h.success?[{[u.primaryAttributeName]:T.Id}]:null})))}innerLoad(P,T,h){const u=this._getActionUId(T);return u?this._intentManager.getActionByUId(u).pipe((0,M.map)(v=>[v])):(0,M.of)([])}innerSave(P,T){const h=this._getActionUId(P),u=T;return u.Id=h,this._intentManager.updateAction(u).pipe((0,M.map)(v=>({success:v.success,rowsAffected:1,errorInfo:v.errorInfo?.message})))}}},7896:($,W,a)=>{a.d(W,{g:()=>P});var s=a(38495),m=a(95868),M=a(62278),O=a(36486),F=a(24089),x=a(77325);class P extends F.f{constructor(h,u){super(h,u),this.dataSourceName=h,this.injector=u,this.type="crt.CopilotIntentDataSource",this._intentManager=this.injector.get(m.CopilotIntentManagerService),this._copilotIntentDataSourceModelConvertor=this.injector.get(x.tq)}innerGetDefaultValues(){return this._copilotIntentDataSourceModelConvertor.convertToDataSourceModel({UId:(0,s.generateGuid)(),Status:"InDevelopment",Mode:"Chat",Type:"Common"})}innerInsert(h){const u=this._copilotIntentDataSourceModelConvertor.convertToModel({...h});return(0,M.forkJoin)([this._intentManager.createIntent(u),this.getSchema()]).pipe((0,M.map)(([v,L])=>({success:v.success,rowsAffected:v.success?1:0,errorInfo:v.errorInfo?.message,primaryAttributes:[{[L.primaryAttributeName]:v.schemaUid}]})),(0,O.switchMap)(v=>v.success?(0,M.of)(v):(0,M.throwError)(()=>v)))}innerLoad(h,u,v){const L=u.filter(o=>o.type===s.ModelParameterType.PrimaryColumnValue);if(L.length)return this._intentManager.getIntent(L[0].value).pipe((0,O.switchMap)(o=>this._copilotIntentDataSourceModelConvertor.convertToDataSourceModel(o).pipe((0,M.map)(c=>[c]))))}innerSave(h,u){const L=h.filter(c=>c.type===s.ModelParameterType.PrimaryColumnValue)[0].value,o=this._copilotIntentDataSourceModelConvertor.convertToModel({...u});return o.UId=L,this._intentManager.updateIntent(o).pipe((0,M.map)(c=>({success:c.success,rowsAffected:c.success?1:0,errorInfo:c.errorInfo?.message})),(0,O.switchMap)(c=>c.success?(0,M.of)(c):(0,M.throwError)(()=>c)))}}},29812:($,W,a)=>{a.d(W,{V:()=>x});var s=a(38495),m=a(95868),M=a(62278),O=a(24089),F=a(77325);class x extends O.f{constructor(T,h){super(T,h),this.dataSourceName=T,this.injector=h,this.type="crt.CopilotIntentParameterDataSource",this._intentManager=this.injector.get(m.CopilotIntentManagerService),this._modelConvertor=this.injector.get(F.Y7)}_getPrimaryColumnParameter(T){return T.find(h=>h.type===s.ModelParameterType.PrimaryColumnValue&&(0,s.isGuid)(h.value))}_getIsIntentUIdParameter(T){return(T.relationsConfigs??[]).some(h=>h.dataSchemaName==="CopilotIntent"&&h.attributePath==="Intent")}_getSourceCollectionFilterValue(T){const h=T.find(L=>L.type===s.ModelParameterType.Filter);if(!h?.value)return null;const u=s.FilterParser.fromJson(h.value);let v;return u.filters.forEach(L=>{L instanceof s.CompareFilter&&L.leftExpression instanceof s.ColumnExpression&&L.leftExpression.columnPath==="SourceCollection"&&L.rightExpression instanceof s.ParameterExpression&&(v=L.rightExpression.value)}),v}innerGetDefaultValues(){return this._modelConvertor.convertToDataSourceModel({UId:(0,s.generateGuid)()})}innerInsert(T){const h=this._modelConvertor.convertToModel({...T});return this._intentManager.createIntentParameter(h).pipe((0,M.map)(u=>({success:u.success,rowsAffected:u.success?1:0,errorInfo:u.errorInfo?.message,primaryAttributes:[{Id:h.UId}]})),(0,M.switchMap)(u=>u.success?(0,M.of)(u):(0,M.throwError)(()=>u)))}innerLoad(T,h,u){const v=this._getPrimaryColumnParameter(h),L=this._getSourceCollectionFilterValue(h)??"InputParameters";return v?(this._getIsIntentUIdParameter(v)?this._intentManager.getIntentParameters(v.value,L):this._intentManager.getIntentParameter(v.value).pipe((0,M.map)(c=>[c]))).pipe((0,M.mergeMap)(c=>(0,M.from)(c).pipe((0,M.mergeMap)(_=>this._modelConvertor.convertToDataSourceModel(_)),(0,M.toArray)())),(0,M.catchError)(()=>(0,M.of)([]))):(0,M.of)([])}innerSave(T,h){const u=this._getPrimaryColumnParameter(T)?.value,v=this._modelConvertor.convertToModel({...h});return v.UId=u,this._intentManager.updateIntentParameter(v).pipe((0,M.map)(L=>({success:L.success,rowsAffected:L.success?1:0,errorInfo:L.errorInfo?.message})),(0,M.switchMap)(L=>L.success?(0,M.of)(L):(0,M.throwError)(()=>L)))}innerDelete(T){const h=this._getPrimaryColumnParameter(T)?.value;return this._intentManager.deleteIntentParameter(h).pipe((0,M.map)(u=>({success:u.success,rowsAffected:u.success?1:0,errorInfo:u.errorInfo?.message})),(0,M.switchMap)(u=>u.success?(0,M.of)(u):(0,M.throwError)(()=>u)))}}},99774:($,W,a)=>{a.d(W,{J:()=>o});var s=a(96590),m=a.n(s),M=a(21018),O=a.n(M),F=a(62278),x=a.n(F),P=a(36486),T=a.n(P),h=a(37015),u=a(87767),v=a(59131),L=a.n(v);class o{constructor(_,C){this._entitySchemaRepository=_,this._broadcastChannelFactory=C,this._dataSchemas=new Map,this._subscribeOnChangesInDesigner()}_subscribeOnChangesInDesigner(){this._broadcastChannelFactory.createInstance(h.Al).messages$.subscribe(({schemaName:_})=>{this._removeCachedSchema(_)})}_createEntityDataSchema(_){const C=new u.i;return C.setEntitySchema(_),(0,F.of)(C.build())}_getEntityDataSchema(_){return this._entitySchemaRepository.getSchemaByName(_).pipe((0,P.switchMap)(C=>this._createEntityDataSchema(C)))}_removeCachedSchema(_){this._dataSchemas.has(_)&&(this._dataSchemas.delete(_),this._entitySchemaRepository.clearSchemaCacheByName(_))}get(_){return this._dataSchemas.has(_)?(0,F.of)(this._dataSchemas.get(_)):this._getEntityDataSchema(_).pipe((0,P.tap)(C=>this._dataSchemas.set(_,C)))}getByEntitySchema(_){const C=_.name;return this._dataSchemas.has(C)?(0,F.of)(this._dataSchemas.get(C)):this._createEntityDataSchema(_).pipe((0,P.tap)(y=>this._dataSchemas.set(C,y)))}static{this.\u0275fac=function(C){return new(C||o)(v.\u0275\u0275inject(M.EntitySchemaRepository),v.\u0275\u0275inject(s.BroadcastChannelFactory))}}static{this.\u0275prov=v.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"platform"})}}},36688:($,W,a)=>{a.d(W,{w:()=>P});var s=a(38495),m=a.n(s),M=a(62278),O=a.n(M),F=a(36486),x=a.n(F);class P{get isDate(){return this.dataValueType===s.DataValueType.Date||this.dataValueType===s.DataValueType.DateTime||this.dataValueType===s.DataValueType.Time}get isImage(){return this.dataValueType===s.DataValueType.IMAGELOOKUP||this.dataValueType===s.DataValueType.Image}set isSystem(h){this._isSystem=h}get isSystem(){return this._isSystem}get isAggregate(){return this.attributeType===s.DataSchemaAttributeType.AggregationAttribute?!0:this.attributeType===s.DataSchemaAttributeType.FunctionAttribute&&this.functionConfig?.type==="aggregation"}constructor(h){if(this._isSystem=!1,h!=null){this.name=h.name,this.caption=h.caption,this.path=h.path,this.dataValueType=h.dataValueType,h.validators&&(this.validators={...h.validators||{}});const u=h.defaultValue;u&&(u instanceof M.Observable?this.defaultValue=u.pipe((0,F.map)(v=>this._getConvertDefaultValue(v))):this.defaultValue=(0,M.of)(this._getConvertDefaultValue(u))),this.defaultValueSchema=h.defaultValueSchema,this.isValueCloneable=h.isValueCloneable,this.attributeType=h.attributeType,this.referenceSchemaName=h.referenceSchemaName,this.functionConfig=h.functionConfig,this.aggregationConfig=h.aggregationConfig,this.isMasked=h.isMasked,this.isFormatValidated=h.isFormatValidated,this.isSensitiveData=h.isSensitiveData,this.usageType=h.usageType,this.isRequired=h.isRequired,this.lookupMode=h.lookupMode,this.isSystem=!!h.isSystem}}_getConvertDefaultValue(h){if(this.isDate)if(h instanceof Date){const u=new Date;return u.setTime(h.getTime()),u}else return h;else return typeof h=="object"?{...h}:h}clone(){return new P(this)}addDefaultValidators(){const h=this.validators??{};this.isRequired&&(h["crt.Required"]={type:"crt.Required"}),!this.validators&&Object.keys(h).length>0&&(this.validators=h)}}},52701:($,W,a)=>{a.d(W,{I:()=>s});class s{get attributes(){return this._parent?[...this._parent.attributes,...this._attributes]:[...this._attributes]}get parent(){return this._parent}constructor(M){if(M!=null){this.name=M.name,this.type=M.type,M.caption&&(this.caption=typeof M.caption=="string"?M.caption:{...M.caption}),this.primaryAttributeName=M.primaryAttributeName,this.primaryDisplayAttributeName=M.primaryDisplayAttributeName,this.primaryColorAttributeName=M.primaryColorAttributeName,this.hierarchyAttributeName=M.hierarchyAttributeName,this.createdByAttributeName=M.createdByAttributeName,this.createdOnAttributeName=M.createdOnAttributeName,this.modifiedByAttributeName=M.modifiedByAttributeName,this.modifiedOnAttributeName=M.modifiedOnAttributeName,M.dataSourceConfig&&(this.dataSourceConfig={...M.dataSourceConfig,config:{...M.dataSourceConfig.config}}),this._parent=M.parent;const O=M.attributes??[];this._attributes=[],O.forEach(F=>{if(this._parent){this._parent.findAttributeByName(F.name)||this._attributes.push(F.clone());return}this._attributes.push(F.clone())})}else this._attributes=[]}clearAttributes(){this._attributes=[]}addAttribute(M){if(this._parent){this._parent.findAttributeByName(M.name)||this._attributes.push(M);return}this._attributes.push(M)}findAttributeByName(M){return this.attributes.find(O=>O.name===M)??null}getPrimaryAttributesNames(){return[this.primaryAttributeName]}getPrimaryLoadAttributes(){const M=[];return this.primaryAttributeName&&M.push(this.primaryAttributeName),this.primaryDisplayAttributeName&&M.push(this.primaryDisplayAttributeName),M}clone(){return new s(this)}createChild(){const M=new s;return M.name=this.name,M.type=this.type,this.caption&&(M.caption=typeof this.caption=="string"?this.caption:{...this.caption}),M.primaryAttributeName=this.primaryAttributeName,M.primaryDisplayAttributeName=this.primaryDisplayAttributeName,M.primaryColorAttributeName=this.primaryColorAttributeName,M.hierarchyAttributeName=this.hierarchyAttributeName,M.createdByAttributeName=this.createdByAttributeName,M.createdOnAttributeName=this.createdOnAttributeName,M.modifiedByAttributeName=this.modifiedByAttributeName,M.modifiedOnAttributeName=this.modifiedOnAttributeName,this.dataSourceConfig&&(M.dataSourceConfig={...this.dataSourceConfig,config:{...this.dataSourceConfig.config}}),M._attributes=[],M._parent=this,M}}},90169:($,W,a)=>{a.d(W,{I:()=>s.I,w:()=>m.w});var s=a(52701),m=a(36688)},98594:($,W,a)=>{a.d(W,{L:()=>h});var s=a(59131),m=a.n(s),M=a(62278),O=a.n(M),F=a(36486),x=a.n(F),P=a(28930),T=a(96677);class h{constructor(v,L){this.injector=v,this.resolver=L}create(v,L,o){const{type:c,scope:_,config:C}=L;return this.resolver.resolve(c).pipe((0,F.switchMap)(E=>E?new E(v,o||this.injector).init(C,_):(0,M.throwError)(()=>new Error(`Data source type '${c}' not supported.`))),(0,F.catchError)(E=>E instanceof P.Mf?(0,M.of)(E.dataSource):(0,M.throwError)(()=>E)))}static{this.\u0275fac=function(L){return new(L||h)(s.\u0275\u0275inject(s.Injector),s.\u0275\u0275inject(T._))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac})}}},96677:($,W,a)=>{a.d(W,{_:()=>o});var s=a(59131),m=a.n(s),M=a(21018),O=a.n(M),F=a(62278),x=a.n(F),P=a(63801),T=a(7896),h=a(29812),u=a(24089),v=a(60928),L=a(24285);class o{resolve(_){let C=null;switch(_){case M.EntityDataSourceTypeName:C=u.f;break;case M.PAGE_PARAMETERS_DATA_SOURCE_TYPE_NAME:C=v.X;break;case"crt.WebServiceDataSource":C=L.b;break;case"crt.CopilotIntentDataSource":C=T.g;break;case"crt.CopilotIntentParameterDataSource":C=h.V;break;case"crt.CopilotActionDataSource":C=P.m;break}return(0,F.of)(C)}static{this.\u0275fac=function(C){return new(C||o)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac})}}},64581:($,W,a)=>{a.d(W,{D:()=>F,Q:()=>x});var s=a(38495),m=a.n(s),M=a(21018),O=a.n(M);const F=P=>{switch(P){case s.DataValueType.Guid:return s.DataValueType.Guid;case s.DataValueType.Text:case s.DataValueType.SHORT_TEXT:case s.DataValueType.PHONE_TEXT:case s.DataValueType.WEB_TEXT:case s.DataValueType.EMAIL_TEXT:case s.DataValueType.MEDIUM_TEXT:case s.DataValueType.MAXSIZE_TEXT:case s.DataValueType.LONG_TEXT:case s.DataValueType.HASH_TEXT:case s.DataValueType.SECURE_TEXT:case s.DataValueType.RICH_TEXT:return s.DataValueType.Text;case s.DataValueType.Integer:case s.DataValueType.Enum:return s.DataValueType.Integer;case s.DataValueType.Float:case s.DataValueType.FLOAT1:case s.DataValueType.FLOAT2:case s.DataValueType.FLOAT3:case s.DataValueType.FLOAT4:case s.DataValueType.FLOAT8:case s.DataValueType.Money:return s.DataValueType.Float;case s.DataValueType.DateTime:case s.DataValueType.Date:case s.DataValueType.Time:return s.DataValueType.DateTime;case s.DataValueType.Lookup:case s.DataValueType.IMAGELOOKUP:return s.DataValueType.Lookup;case s.DataValueType.Boolean:return s.DataValueType.Boolean;case s.DataValueType.Blob:return s.DataValueType.Blob;case s.DataValueType.Image:return s.DataValueType.Image;case s.DataValueType.Color:return s.DataValueType.Color;default:throw new Error(`Type ${P} not implemented`)}};function x(P,T=null,h=s.DataValueType.Float){if(!P||P.length===0)return T;if(P.length===1)return P[0];let u=P.map(v=>F(v)).map(v=>M.DataValueTypeGroup.Number.includes(v)?h:v);return u=[...new Set(u)],u.length===1?u[0]:T}},87767:($,W,a)=>{a.d(W,{i:()=>L});var s=a(38495),m=a.n(s),M=a(21018),O=a.n(M),F=a(28399),x=a.n(F),P=a(62278),T=a.n(P),h=a(36486),u=a.n(h),v=a(90169);class L{constructor(c=null,_){c==null?this._dataSchema=new v.I:this._dataSchema=_?.useClone?c.clone():c.createChild()}_createDataSchemaAttributeByConfig(c){const _=new v.w;return _.name=c.name,_.caption=c.caption,_.path=c.path,_.dataValueType=c.dataValueType,_.validators={...c.validators||{}},_.defaultValue=(0,P.of)(typeof c.defaultValue=="object"?{...c.defaultValue}:c.defaultValue),_.defaultValueSchema=c.defaultValueSchema,_.isValueCloneable=c.isValueCloneable,_.attributeType=c.attributeType,_.referenceSchemaName=c.referenceSchemaName,_.functionConfig=c.functionConfig,_.aggregationConfig=c.aggregationConfig,_.usageType=c.usageType,_.isMasked=c.isMasked,_.isFormatValidated=c.isFormatValidated,_.isSensitiveData=c.isSensitiveData,_.isRequired=c.isRequired,_.lookupMode=c.lookupMode,_.isSystem=c.isSystem??!1,_}setEntitySchemaColumnValidators(c,_){return c.isRequired&&this.setAttributeRequiredValidator(_),this.setAttributeTextDataValueTypeValidator(_,c.dataValueType).setAttributeNumberDataValueTypeValidator(_,c.dataValueType).setAttributePhoneDataValueTypeValidator(_,c)}setAttributeValidator(c,_,C){const y=this._dataSchema.attributes.find(I=>I.name===c),E=y.validators||{};return E[_]=C,y.validators=E,this}setAttributeRequiredValidator(c){return this.setAttributeValidator(c,"crt.Required",{type:"crt.Required"})}setAttributeMaxLengthValidator(c,_){return this.setAttributeValidator(c,"crt.MaxLength",{type:"crt.MaxLength",params:{maxLength:_}})}setAttributeTextDataValueTypeValidator(c,_){const C=(0,M.getTextDataValueTypeValidatorParams)(_);return C?this.setAttributeMaxLengthValidator(c,C.maxLength):this}setAttributeMinValueValidator(c,_){return this.setAttributeValidator(c,"crt.Min",{type:"crt.Min",params:{min:_}})}setAttributeMaxValueValidator(c,_){return this.setAttributeValidator(c,"crt.Max",{type:"crt.Max",params:{max:_}})}setAttributeMinMaxValidator(c,_,C){return this.setAttributeMinValueValidator(c,_).setAttributeMaxValueValidator(c,C)}setAttributeNumberDataValueTypeValidator(c,_){const C=(0,M.getNumberDataValueTypeValidatorParams)(_);return C&&this.setAttributeMinMaxValidator(c,C.minValue,C.maxValue),this}setAttributePhoneDataValueTypeValidator(c,_){return[s.DataValueType.PHONE_TEXT].includes(_.dataValueType)&&_.isMasked&&this.setAttributeRegExpValidator(c,{regex:/^((?!_).)*$/,errorCode:"phoneMaskValidator"}),this}setAttributeRegExpValidator(c,_){return this.setAttributeValidator(c,"crt.RegExp",{type:"crt.RegExp",params:_})}setAttributesDefaultValue(c){return this._dataSchema.attributes.forEach(_=>{_.defaultValue=c.pipe((0,h.map)(C=>C[_.name]))}),this}addAttribute(c,_){const{name:C,caption:y,dataValueType:E,isValueCloneable:I,referenceSchemaName:N,isMasked:S,isFormatValidated:b,usageType:j,isRequired:f,isSensitiveData:R}=c,e=new v.w;return e.name=_.attributeName||C,e.path=_.attributePath||C,e.caption=y,e.dataValueType=E,e.isValueCloneable=!!I,e.attributeType=_.attributeType||s.DataSchemaAttributeType.OwnAttribute,e.referenceSchemaName=N,e.validators={},e.isMasked=S,e.isFormatValidated=b,e.isSensitiveData=R,e.usageType=j,e.isRequired=f,e.defaultValueSchema=c.defaultValueSchema,e.lookupMode=c.lookupMode,e.isSystem=(0,F.compact)([this._dataSchema.createdByAttributeName,this._dataSchema.createdOnAttributeName,this._dataSchema.modifiedByAttributeName,this._dataSchema.modifiedOnAttributeName,this._dataSchema.primaryAttributeName,"ProcessListeners"]).includes(e.name),this._dataSchema.addAttribute(e),_.attributeType===s.DataSchemaAttributeType.OwnAttribute&&this.setEntitySchemaColumnValidators(c,e.name),_.attributeType===s.DataSchemaAttributeType.AggregationAttribute&&(e.aggregationConfig=_.aggregationConfig),_.attributeType===s.DataSchemaAttributeType.FunctionAttribute&&(e.functionConfig=_.functionConfig),this}addOwnAttribute(c){return this.addAttribute(c,{attributeType:s.DataSchemaAttributeType.OwnAttribute})}setEntitySchema(c){return this._dataSchema.dataSourceConfig={type:"crt.EntityDataSource",config:{entitySchemaName:c.name}},this._dataSchema.name=c.name,this._dataSchema.type=s.DataSchemaType.Entity,this._dataSchema.primaryAttributeName=c.getPrimaryColumn()?.name,this._dataSchema.primaryDisplayAttributeName=c.getPrimaryDisplayColumn()?.name,this._dataSchema.primaryColorAttributeName=c.getPrimaryColorColumn()?.name,this._dataSchema.hierarchyAttributeName=c.getHierarchyColumn()?.name,this._dataSchema.caption=c.caption,this._dataSchema.createdByAttributeName=c.columns.find(_=>_.uId===c.createdByColumnUId)?.name,this._dataSchema.createdOnAttributeName=c.columns.find(_=>_.uId===c.createdOnColumnUId)?.name,this._dataSchema.modifiedByAttributeName=c.columns.find(_=>_.uId===c.modifiedByColumnUId)?.name,this._dataSchema.modifiedOnAttributeName=c.columns.find(_=>_.uId===c.modifiedOnColumnUId)?.name,this._dataSchema.clearAttributes(),c.columns.forEach(_=>{this.addOwnAttribute(_)}),this}setDataSchemaConfig(c){return this._dataSchema.name=c.name,this._dataSchema.type=c.type,this._dataSchema.caption=typeof c.caption=="string"?c.caption:{...c.caption},this._dataSchema.primaryAttributeName=c.primaryAttributeName,this._dataSchema.primaryDisplayAttributeName=c.primaryDisplayAttributeName,this._dataSchema.dataSourceConfig={...c.dataSourceConfig,config:{...c.dataSourceConfig?.config}},(c.attributes||[]).forEach(C=>{const y=this._createDataSchemaAttributeByConfig(C);this._dataSchema.addAttribute(y)}),this}build(){return this._dataSchema.clone()}}},493:($,W,a)=>{a.d(W,{O:()=>c});var s=a(38495),m=a.n(s),M=a(96590),O=a.n(M),F=a(21018),x=a.n(F),P=a(62278),T=a.n(P),h=a(16605),u=a(81680),v=a(25060),L=a(59131),o=a.n(L);class c{constructor(C,y,E){this.entitySchemaQueryUtils=C,this._entitySchemaColumnAppenderFactory=y,this._dataSchemaToDataSourceAttributeConverter=E}_addPagingToEsq(C,y){y&&(C.rowsOffset=y.rowsOffset,C.rowCount=y.rowCount)}_addSortingToEsq(C,y){y&&y.columns.forEach((E,I)=>{const N=C.findColumn(E.columnName),S=(0,F.toOrderDirection)(E.direction);N?N.withOrdering(S,I):C.addSchemaColumn(E.columnName).withOrdering(S,I)})}_addIsDistinctToEsq(C,y){y&&(C.isDistinct=!0)}_addColumnToEsq(C,y){y.filter(Boolean).forEach(E=>{this._entitySchemaColumnAppenderFactory.create(E).addColumn(C,E)})}_prepareAttributePairsForLoad(C,y){return y.map(E=>{if(typeof E=="string"){const I=E,N=C.attributes.find(S=>S.name===I);return N?this._dataSchemaToDataSourceAttributeConverter.create(N.attributeType).convert(N):{name:I,path:I}}else return E})}build(C,y,E,I){if(E.some(N=>N.type===s.ModelParameterType.Never))throw new Error('Failed to build entity schema query: parameters contains "Never" model parameter.');return(0,P.forkJoin)([this.entitySchemaQueryUtils.convertToEntityDataSourceParameters(E),(0,P.of)(this._prepareAttributePairsForLoad(C,y))]).pipe((0,P.map)(([N,S])=>({esq:new s.EntitySchemaQuery(C.name),esqParameters:N,dataSourceAttributes:S})),(0,P.tap)(({esq:N,dataSourceAttributes:S})=>this._addColumnToEsq(N,S)),(0,P.tap)(({esq:N})=>this._addSortingToEsq(N,I?.sortingConfig)),(0,P.tap)(({esq:N})=>this._addPagingToEsq(N,I?.pagingConfig)),(0,P.tap)(({esq:N})=>this._addIsDistinctToEsq(N,I?.isDistinct)),(0,P.switchMap)(({esq:N,esqParameters:S})=>this.entitySchemaQueryUtils.applyParameters(S,N)))}static{this.\u0275fac=function(y){return new(y||c)(L.\u0275\u0275inject(h.A),L.\u0275\u0275inject(v.m),L.\u0275\u0275inject(u.L))}}static{this.\u0275prov=L.\u0275\u0275defineInjectable({token:c,factory:c.\u0275fac,providedIn:"root"})}}},16605:($,W,a)=>{a.d(W,{A:()=>v});var s=a(38495),m=a(28399),M=a(62278),O=a(73308),F=a(90169);class x{constructor(o){this._dataSchemaRepository=o}_getDataSchema(o){var c=this;return(0,O.A)(function*(){const _=yield(0,M.firstValueFrom)(c._dataSchemaRepository.get(o));if(!_)throw new Error(`Can not find DataSchema with name '${o}'`);return _})()}_getDataSchemaAttribute(o,c){var _=this;return(0,O.A)(function*(){const C=o instanceof F.I?o:yield _._getDataSchema(o),y=C.findAttributeByName(c);if(!y)throw new Error(`Can not find column '${c}' in Schema '${C.name}'`);return y})()}_getDataSchemaPrimaryAttribute(o){var c=this;return(0,O.A)(function*(){const _=yield c._getDataSchema(o);return c._getDataSchemaAttribute(_,_.primaryAttributeName)})()}_createRelationPathItemFromForwardPathItem(o,c){var _=this;return(0,O.A)(function*(){const C=yield _._getDataSchemaAttribute(o,c);let y=null,E=null;const I=C.dataValueType===s.DataValueType.Lookup;return I&&(y=C.referenceSchemaName,E=(yield _._getDataSchema(y)).primaryAttributeName),{isJoin:I,referenceSchemaName:y,referenceAttributeName:E,ownSchemaAttributeName:c,ownSchemaName:o}})()}_createRelationPathItemFromJoinPathItem(o,c,_,C){var y=this;return(0,O.A)(function*(){const E=_?yield y._getDataSchemaAttribute(c,_):yield y._getDataSchemaPrimaryAttribute(c);return{isJoin:!0,referenceSchemaName:c,referenceAttributeName:E.name,ownSchemaAttributeName:C,ownSchemaName:o}})()}_createRelationPathItem(o,c){const C=/(?<joinType>.*)\[(?<refSchema>.*?):(?<ownColumn>.*?)(?::(?<refColumn>.*))?]/.exec(c);if(C){const y=C.groups;return this._createRelationPathItemFromJoinPathItem(o,y.refSchema,y.refColumn,y.ownColumn)}return this._createRelationPathItemFromForwardPathItem(o,c)}_getReverseRelationPath(o){const c=[...o],_=[];let C;for(;(C=c.pop())!=null;)_.push({isJoin:!0,ownSchemaName:C.referenceSchemaName,ownSchemaAttributeName:C.referenceAttributeName,referenceSchemaName:C.ownSchemaName,referenceAttributeName:C.ownSchemaAttributeName});return _}_buildRelationPath(o,c){var _=this;return(0,O.A)(function*(){const C=c.split("."),y=[];let E=o;for(const I of C){const N=yield _._createRelationPathItem(E,I);E=N.referenceSchemaName,y.push(N)}return y})()}_getRelationPathToSourceSchema(o,c){const _=[...o],C=_.pop(),y=c.split("."),E={isJoin:!0,ownSchemaName:C.isJoin?C.referenceSchemaName:C.ownSchemaName,ownSchemaAttributeName:C.isJoin?C.referenceAttributeName:C.ownSchemaAttributeName,referenceSchemaName:null,referenceAttributeName:y.pop()};return[..._,...C.isJoin?[C]:[],E]}_buildRelationDataFromPath(o){return o.map(c=>({attributeName:c.ownSchemaAttributeName,referenceAttributeName:c.referenceAttributeName,referenceSchemaName:c.referenceSchemaName}))}_getDataSourceParameterRelationData(o){var c=this;return(0,O.A)(function*(){const _=yield c._buildRelationPath(o.dataSchemaName,o.relationPath),C=c._getRelationPathToSourceSchema(_,o.attributePath),y=c._getReverseRelationPath(C);return c._buildRelationDataFromPath(y)})()}_convertEntityDataSourceParameter(o){var c=this;return(0,O.A)(function*(){if(!o.relationsConfigs||o.relationsConfigs.length===0)return o;const _=[];for(const C of o.relationsConfigs){const y=yield c._getDataSourceParameterRelationData(C);_.push({...C,relationData:y})}return{...o,relationsConfigs:_}})()}convert(o,c=!1){return o.length===0?Promise.resolve([]):c?Promise.resolve(o):Promise.all(o.map(_=>this._convertEntityDataSourceParameter(_)))}}var P=a(29957);class T{_getExpressionColumnPath(o,c){const _="[{referenceSchemaName}:{referenceAttributeName}:{attributeName}]",C=o.relationData.map(S=>P.String.format(_,S)).join("."),y=o.attributePath.split("."),E=y.length>1?"{ownColumnPath}.{relationString}.{columnPath}":"{relationString}.{columnPath}";y.pop();const N={ownColumnPath:y.join("."),relationString:C,columnPath:c};return P.String.format(E,N)}_updateFilterLeftExpression(o,c){switch(o.expressionType){case s.ExpressionType.SchemaColumn:o.columnPath=this._getExpressionColumnPath(c,o.columnPath);break;case s.ExpressionType.SubQuery:o.columnPath=this._getExpressionColumnPath(c,o.columnPath);break;case s.ExpressionType.Function:o.functionType!==s.FunctionType.Macros&&this._updateFilterLeftExpression(o.functionArgument,c);break}}_updateRelatedFilterGroup(o,c){o instanceof s.FilterGroup?this._updateRelatedFilterGroupInstance(o,c):this._updateRelatedFilterGroupObject(o,c)}_updateRelatedFilterGroupObject(o,c){Object.values(o.items).forEach(_=>{this._updateRelatedFilter(_,c)})}_updateRelatedFilterGroupInstance(o,c){o.filters.forEach(_=>this._updateRelatedFilter(_,c))}_updateRelatedFilter(o,c){if(o.filterType!==s.FilterType.FilterGroup){const _=o.leftExpression;_&&this._updateFilterLeftExpression(_,c)}else this._updateRelatedFilterGroup(o,c)}convertToRelatedFilter(o,c=[]){if(!o)return o;let _;if(o instanceof s.BaseFilter)_=o.clone();else{const C=JSON.stringify(o);_=JSON.parse(C)}return[...c].reverse().forEach(C=>{C.relationData&&C.relationData.length!==0&&this._updateRelatedFilter(_,C)}),_}}var h=a(99774),u=a(59131);class v{_createPrimaryColumnValueFilter(o,c){const y=(c.relationsConfigs||[])[0]?.dataSchemaName??o;return this._dataSchemaRepository.get(y).pipe((0,M.map)(E=>{const I=new s.ColumnExpression({columnPath:E.primaryAttributeName}),N=new s.ParameterExpression({value:c.value});return new s.CompareFilter(s.ComparisonType.Equal,I,N)}))}_createColumnValueFilter(o){const c=o.value.attributePath,_=o.value.attributeValue,C=new s.ColumnExpression({columnPath:c}),y=new s.ParameterExpression({value:_}),E=new s.CompareFilter(s.ComparisonType.Equal,C,y);return(0,M.of)(E)}_createPrimaryDisplayValueFilter(o,c){const y=(c.relationsConfigs||[])[0]?.dataSchemaName??o;return this._dataSchemaRepository.get(y).pipe((0,M.map)(E=>{const I=new s.ColumnExpression({columnPath:E.primaryDisplayAttributeName}),N=new s.ParameterExpression({value:c.value});return new s.CompareFilter(c.comparisonType,I,N)}))}_createCustomFilter(o){let c={};return o.value&&(c=typeof o.value=="string"?JSON.parse(o.value):o.value),(0,M.of)(c)}_createEmptyParameterFiler(o){const c=o.relationsConfigs||[];if(c.length===0)return(0,M.of)({});const _=c[0];return this._dataSchemaRepository.get(_.dataSchemaName).pipe((0,M.map)(C=>C.primaryAttributeName),(0,M.map)(C=>{const y=new s.ColumnExpression({columnPath:C});return new s.ExistsFilter(y,null)}))}_createEsqFilter(o,c){switch(c.type){case s.ModelParameterType.PrimaryColumnValue:return this._createPrimaryColumnValueFilter(o,c);case s.ModelParameterType.ColumnValue:return this._createColumnValueFilter(c);case s.ModelParameterType.PrimaryDisplayValueFilter:return this._createPrimaryDisplayValueFilter(o,c);case s.ModelParameterType.Filter:return this._createCustomFilter(c);case s.ModelParameterType.Empty:return this._createEmptyParameterFiler(c)}}constructor(o){this._dataSchemaRepository=o}applyParameters(o,c){if(o.length===0)return(0,M.of)(c);const _=o.map(C=>this._createEsqFilter(c.rootSchemaName,C).pipe((0,M.map)(y=>new T().convertToRelatedFilter(y,C.relationsConfigs))));return(0,M.forkJoin)(_).pipe((0,M.tap)(C=>{C.forEach(y=>{(0,m.isEmpty)(y)||c.filters.add(y)})}),(0,M.map)(()=>c))}convertToEntityDataSourceParameters(o,c=!1){const _=new x(this._dataSchemaRepository);return(0,M.from)(_.convert(o,c))}static{this.\u0275fac=function(c){return new(c||v)(u.\u0275\u0275inject(h.J))}}static{this.\u0275prov=u.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}},24089:($,W,a)=>{a.d(W,{iu:()=>T.i,f:()=>t,CW:()=>O,g$:()=>x,WY:()=>F,hs:()=>P,OL:()=>b.O});var s=a(38495);class m{addColumnCaption(r,l){const{name:g,caption:A}=l;if(!A)return;const p=r.findColumn(g);p&&p.withCaption(A)}addColumn(r,l){!r||!l||(this.addColumnInternal(r,l),this.addColumnCaption(r,l))}}var M=a(59131);class O extends m{addColumnInternal(r,l){const{name:g,path:A,aggregationConfig:p}=l;r.addAggregationSubQueryColumn(A,(0,s.toAggregationType)(p?.aggregationFunction),p,g)}static{this.\u0275fac=(()=>{let r;return function(g){return(r||(r=M.\u0275\u0275getInheritedFactory(O)))(g||O)}})()}static{this.\u0275prov=M.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac,providedIn:"root"})}}class F extends m{addColumnInternal(r,l){r.addSchemaColumn(l.path,l.name)}static{this.\u0275fac=(()=>{let r;return function(g){return(r||(r=M.\u0275\u0275getInheritedFactory(F)))(g||F)}})()}static{this.\u0275prov=M.\u0275\u0275defineInjectable({token:F,factory:F.\u0275fac,providedIn:"root"})}}class x extends m{addColumnInternal(r,l){const{name:g,path:A}=l||{},p=l?.functionConfig;r.addAggregationFunctionColumn(A,(0,s.toAggregationType)(p?.aggregation),g,(0,s.toAggregationEvalType)(p?.aggregationEval))}static{this.\u0275fac=(()=>{let r;return function(g){return(r||(r=M.\u0275\u0275getInheritedFactory(x)))(g||x)}})()}static{this.\u0275prov=M.\u0275\u0275defineInjectable({token:x,factory:x.\u0275fac,providedIn:"root"})}}class P extends m{addColumnInternal(r,l){const{name:g,path:A}=l||{},p=l?.functionConfig;r.addDatePartFunctionColumn(A,(0,s.toDatePartType)(p?.datePart),g)}static{this.\u0275fac=(()=>{let r;return function(g){return(r||(r=M.\u0275\u0275getInheritedFactory(P)))(g||P)}})()}static{this.\u0275prov=M.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac,providedIn:"root"})}}var T=a(87767),h=a(63721),u=a(31589),v=a(79772),L=a(96590),o=a(85638),c=a(35266),_=a(21018),C=a(28399),y=a(62278),E=a(36486),I=a(28930);class N extends I.Mf{get entitySchemaName(){return this._entitySchemaName}constructor(r,l){super(r,`Entity schema with name '${l}' not found.`),this._entitySchemaName=l}}class S extends I.Mf{constructor(r){super(r,`Entity schema name for data source ${r.dataSourceName} is not provided`)}}var b=a(493),j=a(16605),f=a(90169),R=a(99774),e=a(64581);class t extends I.dY{constructor(r,l){super(r,l),this.dataSourceName=r,this.injector=l,this._affectedAttributes=[],this._errorReferenceAttributes=[],this.type=_.EntityDataSourceTypeName,this._featureValues=l.get(_.FEATURE_VALUES),this._queryExecutor=l.get(c.QueryExecutor),this._entitySchemaService=l.get(_.EntitySchemaService),this._httpClient=this.injector.get(h.HttpClient),this._rightsService=this.injector.get(o.RightsService),this.dataSchemaRepository=this.injector.get(R.J),this._entitySchemaRepository=this.injector.get(_.EntitySchemaRepository),this._entitySchemaQueryBuilder=this.injector.get(b.O),this._entitySchemaQueryUtils=this.injector.get(j.A),this._window=this.injector.get(L.WINDOW_TOKEN),this._measurePerformanceService=this.injector.get(_.MeasurePerformanceService);const g=this.injector.get(_.UserInfo);this._entityDefaultValuesUrl=g.isSSP?"/ssp/rest/EntitySchemaService/GetEntityDefaultValues":"/rest/EntitySchemaService/GetEntityDefaultValues"}_buildSelectEsq(r,l,g){return this.getSchema().pipe((0,E.switchMap)(A=>this._entitySchemaQueryBuilder.build(A,r,l,g)),(0,E.map)(A=>(this._featureValues["DataSource-DisableRecordDeactivation"]!==!0&&(A.useRecordDeactivation=this.initialConfig.useRecordDeactivation),A.adminUnitRoleSources=this._getEsqAdminUnitRoleSources(),A)))}_getEsqAdminUnitRoleSources(){let r;const l=this.initialConfig.adminUnitRoleSources;return(0,C.isNumber)(l)?l:((0,C.isArray)(l)&&l.forEach(g=>{const A=u.eAdminUnitRoleSources[g];(0,C.isNumber)(A)&&(r=r|A)}),r)}_normalizeValue(r,l){switch(l){case s.DataValueType.Lookup:return r||null;case s.DataValueType.Date:case s.DataValueType.Time:case s.DataValueType.DateTime:return r instanceof Date?(0,s.encodeDate)(r):typeof r=="string"&&Date.parse(r)>0?`"${r}"`:r;default:return r}}_buildUpdateEsq(r,l){return this._entitySchemaQueryUtils.convertToEntityDataSourceParameters(r,!0).pipe((0,E.map)(g=>({updateQuery:new s.UpdateQuery(this._entitySchemaName),esqParameters:g})),(0,E.tap)(({updateQuery:g})=>{g.isForceUpdate=!!this.initialConfig.isForceUpdate,Object.keys(l).forEach(A=>{const p=this._findEntitySchemaColumn(A);if(!p)throw new Error(`Column ${A} not found`);const D=l[A];this._isEntityColumnValue(D)&&g.addColumn(p.name,this._normalizeValue(D,p.dataValueType),(0,e.D)(p.dataValueType))})}),(0,E.switchMap)(({updateQuery:g,esqParameters:A})=>this._entitySchemaQueryUtils.applyParameters(A,g)),(0,E.catchError)(g=>(0,y.throwError)(()=>g)))}_buildInsertEsq(r){const l=new s.InsertQuery(this._entitySchemaName);return Object.keys(r).forEach(g=>{const A=this._findEntitySchemaColumn(g);if(!A)throw new Error(`Column ${g} not found`);const p=r[g];this._isEntityColumnValue(p)&&l.addColumn(A.name,this._normalizeValue(p,A.dataValueType),(0,e.D)(A.dataValueType))}),l}_buildDeleteEsq(r){return this._entitySchemaQueryUtils.convertToEntityDataSourceParameters(r,!0).pipe((0,E.switchMap)(l=>{const g=new s.DeleteQuery(this._entitySchemaName);return this._entitySchemaQueryUtils.applyParameters(l,g)}))}_checkOwnAttributes(r){return this.getSchema().pipe((0,E.switchMap)(l=>{const g=l.attributes.filter(A=>A.attributeType!==s.DataSchemaAttributeType.OwnAttribute).filter(A=>!(0,C.isUndefined)(r[A.name]));return g.length!==0?(0,y.throwError)(()=>new Error(`Not valid attributes for this data source: ${g.map(A=>A.name).join(",")}`)):(0,y.of)(null)}))}_findEntitySchemaColumn(r){return this._entitySchema.columns.find(l=>l.name===r)}_isEntityColumnValue(r){const l=g=>typeof g=="object"&&(g===null||"value"in g);return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||typeof r=="bigint"||r instanceof Date||l(r)}_parseDefaultValues(r,l){const g=new Map(r.attributes.map(A=>[A.name,A.dataValueType]));return l.reduce((A,p)=>{const{defaultValue:D,name:n}=p;if((0,C.isNil)(D.value))return A;if(D.displayValue)return{...A,[n]:D};const d=(0,_.parseJsonValue)(D.value,g.get(n));return{...A,[n]:d}},{})}_getDefaultValues(r){const l=`${this._entityDefaultValuesUrl}?entityName=${r}`;return this._httpClient.get(l).pipe((0,E.catchError)(g=>this._catchErrorResponse(g)),(0,E.map)(g=>g.GetEntityDefaultValuesResult),(0,E.mergeMap)(g=>this.getSchema().pipe((0,E.tap)(A=>{let p=this._window.defaultValueStorage;const D=g?.find(n=>n.name===A.primaryAttributeName)?.defaultValue?.value;if(p=p||{},D){const n=`${r}_${D}`;p[n]=g,this._window.defaultValueStorage=p}}),(0,E.map)(A=>this._parseDefaultValues(A,g)))))}_catchErrorResponse(r){return console.log(r),(0,y.of)({GetEntityDefaultValuesResult:[]})}_requestEntitySchemaColumnsInfo(r){const l=r.map(g=>g.attributePath);return this._entitySchemaService.getEntitySchemaColumnsInformationByPathsArray(this._entitySchema.uId,l).pipe((0,E.map)(g=>r.map(A=>({column:g[A.attributePath],config:A}))))}_getEntitySchemaForwardReferenceColumnsInfo(r){const l={name:this._entitySchemaName,loadLookupColumns:!1,forwardReferencePaths:r.map(g=>g.attributePath)};return this._entitySchemaRepository.getSchemes([l]).pipe((0,E.map)(()=>r.map(g=>{const A=g.attributePath.split("."),p=this._entitySchemaRepository.findEntitySchemaColumnByPath(this._entitySchemaName,A);return{column:new _.EntitySchemaColumn(p),config:g}})))}_createReferenceAttributes(r,l){return l.length===0?(0,y.of)(r):(0,y.of)(this._featureValues["DataSource-DontUseOneRequestForEntitySchemes"]).pipe((0,E.switchMap)(g=>g?this._requestEntitySchemaColumnsInfo(l):this._getEntitySchemaForwardReferenceColumnsInfo(l))).pipe((0,E.tap)(g=>{g.forEach(({column:A,config:p})=>{p.attributeType===s.DataSchemaAttributeType.AggregationAttribute&&p.aggregationConfig?.aggregationFunction===s.AggregationFunction.Count&&(A.dataValueType=s.DataValueType.Integer),r.addAttribute(A,p)})}),(0,E.map)(()=>r))}_createAttributesFromInitialConfig(r,l={}){const g=[];return Object.entries(l).forEach(([A,p])=>{const D=p;D.type===s.DataSchemaAttributeType.ForwardReferenceAttribute&&g.push({attributeName:A,attributeType:s.DataSchemaAttributeType.ForwardReferenceAttribute,attributePath:D.path}),D.type===s.DataSchemaAttributeType.AggregationAttribute&&g.push({attributeName:A,attributeType:s.DataSchemaAttributeType.AggregationAttribute,attributePath:D.path,aggregationConfig:D.aggregationConfig}),D.type===s.DataSchemaAttributeType.FunctionAttribute&&g.push({attributeName:A,attributeType:s.DataSchemaAttributeType.FunctionAttribute,attributePath:D.path,functionConfig:D.functionConfig})}),this._createReferenceAttributes(r,g).pipe((0,E.catchError)(A=>{const p=A.message&&A.toString(),D=new I.yz(this,p);return this._errors.push(D),g.forEach(n=>{this._errorReferenceAttributes.push(n)}),(0,y.of)(r)}))}_shouldSkipLoad(r){return r.some(l=>l.type===s.ModelParameterType.Never)}_setValidValuesForLookupAttributes(r,l){return Object.keys(l).forEach(g=>{const A=r.attributes.find(p=>p.name===g);A&&(A.dataValueType===s.DataValueType.Lookup||A.dataValueType===s.DataValueType.IMAGELOOKUP)&&l[g]===""&&(l[g]=null)}),l}_throwErrorResponse(r){const l=typeof r=="string"?r:r?.message;return(0,y.throwError)(()=>({success:!1,rowsAffected:0,errorInfo:l}))}_mapOperationResult(r){return{success:r.success,rowsAffected:r.rowsAffected}}get affectedAttributes(){return[...this._affectedAttributes]}get isAggregate(){return this.dataSchema?this.dataSchema.attributes.some(l=>l.isAggregate):!1}_getIsAffectedAttributeStored(r){return this._affectedAttributes.some(l=>l.path===r.path&&l.schemaName===r.schemaName)}_collectUsedAttributes(r){let l=r._getUsedColumns();l=l.filter(g=>!this._getIsAffectedAttributeStored(g)),this._affectedAttributes.push(...l)}_findErrorReferenceAttribute(r){const l=typeof r=="string"?r:r.name;return this._errorReferenceAttributes.find(g=>g.attributeName===l)}innerLoad(r,l,g){if(this.hasErrors){if(this.hasCriticalErrors)return(0,y.throwError)(()=>this.getLastError());if(r.length!==0&&r.every(p=>this._findErrorReferenceAttribute(p)!=null))return(0,y.throwError)(()=>this.getLastError())}return this._shouldSkipLoad(l)?(0,y.of)([]):this._buildSelectEsq(r,l,g||{}).pipe((0,E.tap)(A=>this._collectUsedAttributes(A)),(0,E.switchMap)(A=>this._queryExecutor.executeSelectQuery(A,{throttled:g?.throttled}).pipe(this._measurePerformanceService.measure$(`EntityDataSource.load.executeSelectQuery.${this.dataSourceName}`),(0,E.catchError)(()=>(0,y.throwError)(()=>{const p=this.injector.get(v.TranslateService);return new Error(p.instant("BaseViewModel.LoadingModelErrorMessage"))})))),(0,E.map)(A=>A),(0,E.mergeMap)(A=>this.getSchema().pipe((0,E.map)(p=>(p.attributes&&A.forEach(D=>{this._setValidValuesForLookupAttributes(p,D)}),A)))))}innerSave(r,l){return this.hasCriticalErrors?(0,y.throwError)(()=>this.getLastError()):this._checkOwnAttributes(l).pipe((0,E.switchMap)(()=>this._buildUpdateEsq(r,l)),(0,E.switchMap)(g=>this._queryExecutor.executeUpdateQuery(g)),(0,E.map)(g=>this._mapOperationResult(g)),(0,E.catchError)(g=>this._throwErrorResponse(g)))}innerInsert(r){return this.hasCriticalErrors?(0,y.throwError)(()=>this.getLastError()):this._checkOwnAttributes(r).pipe((0,E.map)(()=>this._buildInsertEsq(r)),(0,E.switchMap)(l=>(0,y.forkJoin)({response:this._queryExecutor.executeInsertQuery(l),dataSchema:this.getSchema()})),(0,E.map)(({response:l,dataSchema:g})=>({...this._mapOperationResult(l),primaryAttributes:[{[g.primaryAttributeName]:l.id}]})),(0,E.catchError)(l=>this._throwErrorResponse(l)))}innerDelete(r){return this.hasCriticalErrors?(0,y.throwError)(()=>this.getLastError()):this._buildDeleteEsq(r).pipe((0,E.switchMap)(l=>this._queryExecutor.executeDeleteQuery(l)),(0,E.map)(l=>this._mapOperationResult(l)),(0,E.catchError)(l=>this._throwErrorResponse(l)))}innerGetSchema(){return this.hasCriticalErrors?(0,y.throwError)(()=>this.getLastError()):this.dataSchemaRepository.get(this._entitySchemaName).pipe((0,E.map)(r=>new T.i(r)),(0,E.switchMap)(r=>this._createAttributesFromInitialConfig(r,this.initialConfig.attributes)),(0,E.tap)(r=>{const l=this._getDefaultValues(this._entitySchemaName).pipe((0,E.shareReplay)({bufferSize:1,refCount:!0}));r.setAttributesDefaultValue(l)}),(0,E.map)(r=>r.build()))}innerGetLookupDataSchema(r){if(this.hasCriticalErrors)return(0,y.throwError)(()=>this.getLastError());const g=r.split(".")[0],A=this._findEntitySchemaColumn(g);return A?A.dataValueType!==s.DataValueType.Lookup?(0,y.throwError)(()=>new Error(`DataValueType for column '${g}' isn't lookup`)):A.referenceSchemaName?this.dataSchemaRepository.get(A.referenceSchemaName):(0,y.throwError)(()=>new Error(`referenceSchemaName for column '${g}' is absent`)):(0,y.throwError)(()=>new Error(`Can't find column with name '${g}'`))}innerGetDefaultValues(){return this.hasCriticalErrors?(0,y.throwError)(()=>this.getLastError()):this._getDefaultValues(this._entitySchemaName)}innerCanDelete(r){return this.hasCriticalErrors?(0,y.of)({result:!1}):this._rightsService.getCanDelete({schemaName:this.initialConfig.entitySchemaName,primaryColumnValue:r.primaryColumnValue})}innerCanCreate(r){if(this.hasCriticalErrors)return(0,y.of)({result:!1});const l={isNew:!0,schemaName:this.initialConfig.entitySchemaName};return this._rightsService.getCanEdit(l)}innerCanEdit(r){if(this.hasCriticalErrors)return(0,y.of)({result:!1});const l={primaryColumnValue:r.primaryColumnValue,isNew:!1,schemaName:this.initialConfig.entitySchemaName};return this._rightsService.getCanEdit(l)}getEmptySchema(){return this._entitySchemaName?new f.I({name:this._entitySchemaName}):super.getEmptySchema()}init(r,l){return super.init(r,l).pipe((0,E.mergeMap)(g=>{if(!this.initialConfig.entitySchemaName){const A=new S(this);return this._errors.push(A),(0,y.throwError)(()=>A)}return(0,y.of)(g)}),(0,E.tap)(()=>this._entitySchemaName=this.initialConfig.entitySchemaName),(0,E.mergeMap)(g=>this._entitySchemaRepository.getSchemaByName(this.initialConfig.entitySchemaName).pipe((0,E.tap)(A=>this._entitySchema=A),(0,E.catchError)(()=>{this._entitySchema=new _.EntitySchema,this._entitySchema.name=this._entitySchemaName,this._entitySchema.columns=[];const A=new N(this,this._entitySchemaName);return this._errors.push(A),(0,y.throwError)(()=>A)}),(0,E.map)(()=>g))))}}},57117:($,W,a)=>{a.d(W,{DI:()=>x.DI,dY:()=>v.dY,me:()=>I.m,g9:()=>y.g,tq:()=>x.tq,Vc:()=>E.V,Y7:()=>x.Y7,LT:()=>T.L,DC:()=>h,kr:()=>s.kr,wY:()=>s.wY,IO:()=>m.I,wG:()=>m.w,J_:()=>L.J,Mp:()=>x.Mp,Ts:()=>x.Ts,SP:()=>x.SP,yR:()=>v.yR,LZ:()=>o.L,Mf:()=>v.Mf,_h:()=>c._,mv:()=>P.m,yf:()=>u,iu:()=>M.iu,f:()=>M.f,OL:()=>M.OL,aA:()=>s.aA,$E:()=>s.$E,vx:()=>s.vx,d4:()=>s.d4,ww:()=>s.ww,d1:()=>s.d1,yz:()=>v.yz,mj:()=>x.mj,X4:()=>N.X,Al:()=>s.Al,bX:()=>_.b,Q6:()=>C.Q,L9:()=>s.L9,DR:()=>C.D});var s=a(37015),m=a(90169),M=a(24089),O=a(38495),F=a(96590),x=a(77325),P=a(25060),T=a(81680);const h=F.FactoryProvider.create({token:T.L,mappings:[{predicate:O.DataSchemaAttributeType.AggregationAttribute,injectable:x.Mp},{predicate:O.DataSchemaAttributeType.FunctionAttribute,injectable:x.SP}],default:{injectable:x.Ts}}),u=F.FactoryProvider.create({token:P.m,mappings:[{predicate:S=>S.type==="aggregation",injectable:M.CW},{predicate:S=>S.type==="function"&&S.functionConfig?.type==="aggregation",injectable:M.g$},{predicate:S=>S.type==="function"&&S.functionConfig?.type==="datePart",injectable:M.hs}],default:{injectable:M.WY}});var v=a(28930),L=a(99774),o=a(98594),c=a(96677),_=a(24285),C=a(64581),y=a(7896),E=a(29812),I=a(63801),N=a(60928)},60928:($,W,a)=>{a.d(W,{X:()=>v});var s=a(38495),m=a(21018),M=a(62278),O=a(11848),F=a(49159),x=a(10763),P=a(28930),T=a(52701),h=a(36688),u=a(54665);class v extends P.dY{constructor(o,c){super(o,c),this.dataSourceName=o,this._injector=c,this.type=m.PAGE_PARAMETERS_DATA_SOURCE_TYPE_NAME,this._schemaParametersStore=this._injector.get(x.B),this._lookupDataLoadService=this._injector.get(u.m),this._featureValues=this._injector.get(m.FEATURE_VALUES),this._featureValues.DisableCommunicationBetweenSchemas||this._subscribeParametersChanged()}_subscribeParametersChanged(){this._schemaParametersStore.changedValues$.subscribe(o=>{F.q.instance.notify({modelId:(0,s.generateGuid)(),dataSchemaName:this.dataSchema.name,type:O.MQ.Update,payload:{primaryAttributesValues:null,changedAttributes:Object.keys(o)}})})}_getCanSuccessfullyExecuteOperationResult(){return(0,M.of)({result:!0})}_fillLookupValues(o,c,_){Object.entries(_).forEach(([C,y])=>{(c[C]||[]).forEach(I=>{o[I]={value:C,displayValue:y}})})}_fillSchemaParameterValueNameMap(o,c,_,C){const y=C;let E=o[c];E||(E={},o[c]=E);let I=E[y];I||(I=[],E[y]=I),I.push(_)}_fillSchemaNamePrimaryValuesMap(o,c,_){const C=_;let y=o[c];y||(y=[],o[c]=y),y.push(C)}_isLookupValue(o){return!!o?.value}_shouldFillSchemaLookupValueMaps(o,c){return o&&c&&c.referenceSchemaName&&!this._isLookupValue(o)}_load(o,c){const _={},C=this._schemaParametersStore.values,y=c.attributes,E={},I={};for(const S of o){const b=C[S],j=y.find(f=>f.name===S);if(this._shouldFillSchemaLookupValueMaps(b,j)){this._fillSchemaNamePrimaryValuesMap(I,j.referenceSchemaName,b),this._fillSchemaParameterValueNameMap(E,j.referenceSchemaName,S,b);continue}_[S]=b??null}return Object.keys(I).length===0?(0,M.of)([_]):this._lookupDataLoadService.load(I).pipe((0,M.map)(S=>{for(const[b,j]of Object.entries(S)){const f=E[b];this._fillLookupValues(_,f,j)}return[_]}))}_getValuesForStore(o){const c={};return Object.entries(o).forEach(([_,C])=>{const y=this.initialConfig.parameters[_];if(!y)return;(0,m.getDataValueTypeByName)(y.dataValueTypeName)===s.DataValueType.Lookup?c[_]=C?.value:c[_]=C}),c}innerLoad(o,c,_){return this.getSchema().pipe((0,M.switchMap)(C=>this._load(o,C)))}innerSave(o,c){const _=this._getValuesForStore(c);return this._schemaParametersStore.setValues(_),(0,M.of)({success:!0,rowsAffected:1})}innerInsert(o){const c=this._getValuesForStore(o);return this._schemaParametersStore.setValues(c),(0,M.of)({success:!0,rowsAffected:1,primaryAttributes:[]})}innerDelete(o){return(0,M.of)({success:!0,rowsAffected:1})}innerGetSchema(){const o=[],c=this.initialConfig.parameters;return c&&Object.entries(c).forEach(([_,C])=>{const y=new h.w({name:_,caption:C.caption,dataValueType:(0,m.getDataValueTypeByName)(C.dataValueTypeName),attributeType:s.DataSchemaAttributeType.OwnAttribute,path:_,isRequired:!!C.isRequired,referenceSchemaName:C.referenceSchemaName,isMasked:!1,isFormatValidated:!0});y.addDefaultValidators(),o.push(y)}),(0,M.of)(new T.I({name:this.initialConfig.schemaName,type:s.DataSchemaType.ClientUnit,attributes:o}))}innerGetLookupDataSchema(o){return(0,M.of)(null)}innerGetDefaultValues(){return(0,M.of)({})}innerCanEdit(o){return this._getCanSuccessfullyExecuteOperationResult()}innerCanDelete(o){return this._getCanSuccessfullyExecuteOperationResult()}innerCanCreate(o){return this._getCanSuccessfullyExecuteOperationResult()}}},77325:($,W,a)=>{a.d(W,{DI:()=>s,tq:()=>u,Y7:()=>v,Mp:()=>M,Ts:()=>O,SP:()=>F,mj:()=>x.m});class s{convert(o){const{name:c,path:_,caption:C,dataValueType:y}=o||{};return{name:c,path:_||c,caption:C,dataValueType:y}}}var m=a(59131);class M extends s{convert(o){const{aggregationConfig:c}=o||{};return{...super.convert(o),type:"aggregation",aggregationConfig:{filter:c?.filter,aggregationFunction:c?.aggregationFunction,sortByColumn:c?.sortByColumn,sortByDirection:c?.sortByDirection}}}static{this.\u0275fac=(()=>{let o;return function(_){return(o||(o=m.\u0275\u0275getInheritedFactory(M)))(_||M)}})()}static{this.\u0275prov=m.\u0275\u0275defineInjectable({token:M,factory:M.\u0275fac,providedIn:"root"})}}class O extends s{convert(o){return{...super.convert(o),type:"default"}}static{this.\u0275fac=(()=>{let o;return function(_){return(o||(o=m.\u0275\u0275getInheritedFactory(O)))(_||O)}})()}static{this.\u0275prov=m.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac,providedIn:"root"})}}class F extends s{convert(o){const{functionConfig:c}=o||{};return{...super.convert(o),type:"function",functionConfig:c}}static{this.\u0275fac=(()=>{let o;return function(_){return(o||(o=m.\u0275\u0275getInheritedFactory(F)))(_||F)}})()}static{this.\u0275prov=m.\u0275\u0275defineInjectable({token:F,factory:F.\u0275fac,providedIn:"root"})}}var x=a(54665),P=a(21018),T=a(62278),h=a(37015);class u{constructor(o){this._intentStatuses=h.d4,this._intentModes=h.$E,this._columnLookupValuesService=o.get(P.ColumnLookupValuesService)}convertToDataSourceModel(o){return(0,T.combineLatest)([this._columnLookupValuesService.getColumnLookupValues(h.ww),this._columnLookupValuesService.getColumnLookupValues(h.vx),(0,h.L9)()]).pipe((0,T.map)(([c,_,C])=>{const y=this._intentStatuses.get(o.Status),E=c.find(b=>b.value===y),I=this._intentModes.get(o.Mode)??this._intentModes.get(h.aA.Chat),N=_.find(b=>b.value===I),S=C.find(b=>b.displayValue===o.Type);return{Id:o.UId,Code:o.Code,Description:o.Description,Prompt:o.Prompt,Type:S,Name:o.Title,Status:E,PackageUId:o.PackageUId,Mode:N}}))}convertToModel(o){const c={};return Object.entries(o).forEach(([_,C])=>{_==="Name"&&(_="Title"),_==="Id"&&(_="UId"),_==="Status"&&(C=[...this._intentStatuses].filter(([,y])=>y===o.Status.value).map(([y])=>y).shift()),_==="Mode"&&(C=[...this._intentModes].filter(([,y])=>y===o.Mode.value).map(([y])=>y).shift()),_==="Type"&&(C=Object.values(h.d1).filter(y=>y.value===o.Type.value).map(y=>y.displayValue).shift()),c[_]=C}),c}static{this.\u0275fac=function(c){return new(c||u)(m.\u0275\u0275inject(m.Injector))}}static{this.\u0275prov=m.\u0275\u0275defineInjectable({token:u,factory:u.\u0275fac,providedIn:"root"})}}class v{convertToDataSourceModel(o){return(0,T.of)({Id:o.UId,Intent:o.Intent,Code:o.Code,Name:o.Name,Description:o.Description,SourceCollection:o.SourceCollection,DataValueTypeUId:o.DataValueTypeUId})}convertToModel(o){const c={};return Object.entries(o).forEach(([_,C])=>{_==="Id"&&(_="UId"),c[_]=C}),c}static{this.\u0275fac=function(c){return new(c||v)}}static{this.\u0275prov=m.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}},54665:($,W,a)=>{a.d(W,{m:()=>v});var s=a(38495),m=a.n(s),M=a(35266),O=a.n(M),F=a(36486),x=a.n(F),P=a(59131),T=a.n(P);const h="PrimaryValue",u="DisplayValue";class v{constructor(o){this._queryExecutor=o}_getInFilter(o){const c=new s.MacrosFunctionExpression({macrosType:s.QueryMacrosType.PrimaryColumn});return new s.InFilter(s.ComparisonType.Equal,c,o.map(_=>new s.ParameterExpression({value:_})))}_getEsq(o,c){const _=new s.EntitySchemaQuery(o);_.addMacrosFunctionColumn(s.QueryMacrosType.PrimaryColumn,h),_.addMacrosFunctionColumn(s.QueryMacrosType.PrimaryDisplayColumn,u);const C=this._getInFilter(c);return _.filters.add(C),_}_getSchemaLookupData(o,c){const _={};for(let C=0;C<c.length;C++){const y=c[C],[E,I]=o[C];_[E]={};for(const N of I){const S=y.find(b=>b[h]===N);_[E][N]=S?S[u]:null}}return _}load(o){const c=Object.entries(o),_=c.map(([C,y])=>this._getEsq(C,y));return this._queryExecutor.executeBatchSelectQuery(_).pipe((0,F.map)(C=>this._getSchemaLookupData(c,C)))}static{this.\u0275fac=function(c){return new(c||v)(P.\u0275\u0275inject(M.QueryExecutor))}}static{this.\u0275prov=P.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}},81680:($,W,a)=>{a.d(W,{L:()=>M});var s=a(59131),m=a.n(s);const M=new s.InjectionToken("A factory of data schema to data source attribute converter")},25060:($,W,a)=>{a.d(W,{m:()=>M});var s=a(59131),m=a.n(s);const M=new s.InjectionToken("A factory of entity schema column appender")},24285:($,W,a)=>{a.d(W,{b:()=>m});var s=a(28930);class m extends s.dY{constructor(){super(...arguments),this.type="crt.WebServiceDataSource"}innerLoad(O,F,x){throw new Error("Method not implemented.")}innerSave(O,F){throw new Error("Method not implemented.")}innerInsert(O){throw new Error("Method not implemented.")}innerDelete(O){throw new Error("Method not implemented.")}innerGetSchema(){throw new Error("Method not implemented.")}innerGetLookupDataSchema(O){throw new Error("Method not implemented.")}innerGetDefaultValues(){throw new Error("Method not implemented.")}innerCanDelete(O){throw new Error("Method not implemented.")}innerCanEdit(O){throw new Error("Method not implemented.")}innerCanCreate(O){throw new Error("Method not implemented.")}}},11848:($,W,a)=>{a.d(W,{DF:()=>s,MQ:()=>m,iL:()=>M,F1:()=>P.F,MJ:()=>O,I4:()=>x,HQ:()=>F});var s;(function(T){T[T.None=0]="None",T[T.Count=1]="Count",T[T.Sum=2]="Sum",T[T.Avg=3]="Avg",T[T.Min=4]="Min",T[T.Max=5]="Max",T[T.TopOne=6]="TopOne"})(s||(s={}));var m;(function(T){T.Create="create",T.Update="update",T.Delete="delete"})(m||(m={}));var M;(function(T){T.Begin="begin",T.End="end"})(M||(M={}));var O;(function(T){T.AllSections="BaseGridSectionTemplate",T.AllCards="BasePageTemplate",T.AllMiniCards="BaseMiniPageTemplate",T.AllLookupSelectionWindows="BaseLookupPageTemplate"})(O||(O={}));var F;(function(T){T.Paused="Paused",T.Active="Active"})(F||(F={}));var x;(function(T){T.DebouncingBusinessRules="DebouncingBusinessRules",T.RunningBusinessRules="RunningBusinessRules",T.ProcessingAttributeChangeRequest="ProcessingAttributeChangeRequest",T.AttributeLoading="AttributeLoading"})(x||(x={}));var P=a(41821)},41821:($,W,a)=>{a.d(W,{F:()=>s});var s;(function(m){m.ForTheSelectedPage="ForTheSelectedPage",m.RegardlessOfThePage="RegardlessOfThePage",m.ForTheSelectedRecords="ForTheSelectedRecords"})(s||(s={}))},82757:($,W,a)=>{a.d(W,{v:()=>m,p:()=>M});var s=a(59131);class m{static{this.\u0275fac=function(x){return new(x||m)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:m,factory:m.\u0275fac})}}const M=new s.InjectionToken("A factory of expression interpreter")},42745:($,W,a)=>{a.d(W,{LZ:()=>x,q:()=>T,a:()=>v,Bg:()=>u,n8:()=>i,Cw:()=>R,T7:()=>f,U8:()=>j,Fj:()=>b,XW:()=>g,qD:()=>l,jE:()=>y,c7:()=>I,Xd:()=>E,$9:()=>C,iW:()=>_,gK:()=>L,_:()=>S,JO:()=>N,Qu:()=>c,V5:()=>t,S5:()=>e});var s=a(73308),m=a(5960),M=a(59131),O=a(38495),F=a(47096);let x=class extends O.BaseRequestHandler{constructor(p){super(),this._ngZone=p}_validateRequest(p){const{$context:D,collectionAttributeName:n}=p;if(!D)throw new Error('The "$context" request property is not specified.');if(!n)throw new Error('The "collectionAttributeName" request property is not specified.');const d=D._attributeConfigs[n];if(!(("viewModelConfig"in d||"viewModelName"in d)&&d.isCollection))throw new Error(`There is no view model collection for the specified "${n}" attribute.`)}_canCancelPrimaryDataChanges(p,D){var n=this;return(0,s.A)(function*(){if(!D)return!0;const d=yield n._getPrimaryAttributeValue(p);return D.includes(d)})()}_getPrimaryAttributeValue(p){return(0,s.A)(function*(){const D=yield p.getPrimaryModelName(),n=yield p.getPrimaryDataSchema(),d=p.getViewModelAttributePath(D,n.primaryAttributeName);return p[d]})()}_resetFormApiModel(p){this._ngZone.run((0,s.A)(function*(){const D=yield p.getPrimaryModelName();p.getBoundDataSourceAttributeControls(D)?.forEach(d=>{(0,F.og)(d)})}))}_cancelPrimaryDataChanges(p){var D=this;return(0,s.A)(function*(){try{const n={type:"crt.CancelPrimaryDataChangesRequest",$context:p};return yield D.handlerChain.process(n)}catch(n){return[{success:!1,errorInfo:n?.message}]}})()}handle(p){var D=this;return(0,s.A)(function*(){D._validateRequest(p);const{$context:n,collectionAttributeName:d,primaryAttributeValues:V}=p??{},w=yield n.attributes[d],B=w.getChangedItems(),U=[];for(const K of B)(yield D._canCancelPrimaryDataChanges(K,V))&&U.push(D._cancelPrimaryDataChanges(K));for(const K of w)B.includes(K)||D._resetFormApiModel(K);return(yield Promise.all(U)).flat()})()}};x=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.CancelCollectionPrimaryDataHandler",requestType:"crt.CancelCollectionPrimaryDataChangesRequest"}),(0,m.__metadata)("design:paramtypes",[M.NgZone])],x);var P=a(21018);let T=class extends O.BaseRequestHandler{_validateRequest(p){const{$context:D}=p;if(!D)throw new Error('The "$context" request property is not specified.')}_cancelCurrentDataChanges(p){var D=this;return(0,s.A)(function*(){const n=p.getPrimaryModelMode();if(n===P.ModelMode.Create){const d=yield p.getPrimaryModelName();return p.getModelByName(d).getDataSource().scope===O.DataSourceScope.ViewElement&&p.markPrimaryModelFor(P.ModelMode.Delete),Promise.resolve({success:!0})}return n===P.ModelMode.Delete&&p.markPrimaryModelFor(P.ModelMode.Update),(yield p.IsChanged)?D._reloadCurrentDataChanges(p):Promise.resolve({success:!0})})()}_reloadCurrentDataChanges(p){var D=this;return(0,s.A)(function*(){try{return yield D._loadPrimaryData(p),yield D._onSuccessCancelPrimaryData(p),{success:!0}}catch(n){const d=n?.message;return D._onFailCancelPrimaryData(p,d),{success:!1,errorInfo:d}}})()}_loadPrimaryData(p){var D=this;return(0,s.A)(function*(){const n=yield p.getPrimaryModelName(),d=yield p.getPrimaryDataSchema(),V=p.getViewModelAttributePath(n,d.primaryAttributeName);yield D.handlerChain.process({type:"crt.LoadDataRequest",$context:p,dataSourceName:n,parameters:[{type:O.ModelParameterType.PrimaryColumnValue,value:V}]})})()}_onFailCancelPrimaryData(p,D){p.formApiModel.setErrors({cancel:{message:D}})}_onSuccessCancelPrimaryData(p){return(0,s.A)(function*(){const D=yield p.getPrimaryModelName();p.getBoundDataSourceAttributeControls(D)?.forEach(d=>{(0,F.og)(d)})})()}_cancelNestedDataChanges(p){var D=this;return(0,s.A)(function*(){const n=[],d=Object.entries(p._attributeConfigs);for(const[w,B]of d)if(!(!("viewModelConfig"in B)&&!("viewModelName"in B)))if(B.isCollection)n.push(D._cancelPrimaryDataSafely(()=>D._cancelCollectionPrimaryDataChanges(p,w)));else{const U=yield p[w];n.push(D._cancelPrimaryDataSafely(()=>D._cancelPrimaryDataChanges(U)))}return(yield Promise.all(n)).flat()})()}_cancelPrimaryDataChanges(p){var D=this;return(0,s.A)(function*(){const n={type:"crt.CancelPrimaryDataChangesRequest",$context:p};return yield D.handlerChain.process(n)})()}_cancelCollectionPrimaryDataChanges(p,D){var n=this;return(0,s.A)(function*(){const d={type:"crt.CancelCollectionPrimaryDataChangesRequest",$context:p,collectionAttributeName:D};return yield n.handlerChain.process(d)})()}_cancelPrimaryDataSafely(p){return p().catch(D=>[{success:!1,errorInfo:D?.message}])}handle(p){var D=this;return(0,s.A)(function*(){D._validateRequest(p);const n=p.$context,d=yield D._cancelNestedDataChanges(n);return[yield D._cancelCurrentDataChanges(n),...d]})()}};T=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.CancelPrimaryDataChangesHandler",requestType:"crt.CancelPrimaryDataChangesRequest"})],T);var h=a(62278);let u=class extends O.BaseRequest{constructor(){super(...arguments),this.type="crt.ChangeViewModelAttributeValueRequest"}};u=(0,m.__decorate)([(0,O.CrtRequest)({type:"crt.ChangeViewModelAttributeValueRequest"})],u);let v=class extends O.BaseRequestHandler{handle(p){return(0,s.A)(function*(){const{$context:D,attributeName:n,attributeValue:d}=p||{};if(!D||!n)return;const V=D;return yield(0,h.lastValueFrom)(V.setValue({[n]:d}),{defaultValue:null}),d})()}};v=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.ChangeViewModelAttributeValueHandler",requestType:"crt.ChangeViewModelAttributeValueRequest"})],v);let L=class extends O.BaseRequestHandler{_validateRequest(p){const{$context:D,collectionAttributeName:n}=p;if(!D)throw new Error('The "$context" request property is not specified.');if(!n)throw new Error('The "collectionAttributeName" request property is not specified.');const d=D._attributeConfigs[n];if(!(("viewModelConfig"in d||"viewModelName"in d)&&d.isCollection))throw new Error(`There is no view model collection for the specified "${n}" attribute.`)}_canSavePrimaryData(p,D){var n=this;return(0,s.A)(function*(){if(!D)return!0;const d=yield n._getPrimaryAttributeValue(p);return D.includes(d)})()}_getPrimaryAttributeValue(p){return(0,s.A)(function*(){const D=yield p.getPrimaryModelName(),n=yield p.getPrimaryDataSchema(),d=p.getViewModelAttributePath(D,n.primaryAttributeName);return p[d]})()}_savePrimaryData(p){var D=this;return(0,s.A)(function*(){try{const n={type:"crt.SavePrimaryDataRequest",$context:p};return yield D.handlerChain.process(n)}catch(n){return[{success:!1,rowsAffected:0,errorInfo:n?.message}]}})()}handle(p){var D=this;return(0,s.A)(function*(){D._validateRequest(p);const{$context:n,collectionAttributeName:d,primaryAttributeValues:V}=p??{},B=n.attributes[d].getChangedItems(),U=[];for(const k of B)(yield D._canSavePrimaryData(k,V))&&U.push(yield D._savePrimaryData(k));return U.flat()})()}};L=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.SaveCollectionPrimaryDataHandler",requestType:"crt.SaveCollectionPrimaryDataRequest"})],L);var o=a(97502);let c=class extends O.BaseRequestHandler{constructor(p){super(),this._baseViewModelProcessValidationResultService=p}_validateRequest(p){const{$context:D}=p;if(!D)throw new Error('The "$context" request property is not specified.')}_saveModel(p,D){var n=this;return(0,s.A)(function*(){const d=p.dataSchemas[D],V=p.getViewModelAttributePath(D,d.primaryAttributeName);try{const w=yield n._canSaveData(p,D,V);if(!w.result)return n._createFailedSaveResult(w.message);const B=yield n._saveData(p,D,V);return B.success&&n._onSuccessSaveRootData(p,D,B),B}catch(w){const B=w?.message;return n._createFailedSaveResult(B)}})()}_validateRootModel(p,D){var n=this;return(0,s.A)(function*(){if(!(yield p.isValid(D))){const V=yield p.validate(D),w=yield n._baseViewModelProcessValidationResultService.getValidationErrorMessage(p,V);return n._createFailedSaveResult(w)}return null})()}_getModels(p){return(0,s.A)(function*(){const D=yield p.getPrimaryModelName();let n=(0,F.$9)(p);return n=n.filter(d=>p.getModelMode(d)!==P.ModelMode.Init),D&&!n.includes(D)&&n.unshift(D),n})()}_saveRootData(p){var D=this;return(0,s.A)(function*(){const n=[],d=yield D._getModels(p);for(const w of d){let B=yield D._validateRootModel(p,w);B||(B=yield D._saveModel(p,w)),n.push(B)}const V=n.filter(w=>!w.success).map(w=>w.errorInfo);return V.length&&D._onFailSaveRootData(p,V.join(", ")),n})()}_canSaveData(p,D,n){return(0,s.A)(function*(){const V={primaryColumnValue:yield p[n]};return p.canSave(D,V)})()}_saveData(p,D,n){var d=this;return(0,s.A)(function*(){const V={type:"crt.SaveDataRequest",$context:p,parameters:[{type:O.ModelParameterType.PrimaryColumnValue,value:n}],dataSourceName:D};return yield d.handlerChain.process(V)})()}_onFailSaveRootData(p,D){p.formApiModel.setErrors({save:{message:D}})}_updateAttributesOnSaveResult(p,D,n){if(n?.primaryAttributes?.length)for(const d of n.primaryAttributes)for(const[V,w]of Object.entries(d)){const B=p.getViewModelAttributePath(D,V);p[B]=w}}_onSuccessSaveRootData(p,D,n){this._updateAttributesOnSaveResult(p,D,n),p.getBoundDataSourceAttributeControls(D)?.forEach(V=>{(0,F.og)(V)})}_saveNestedData(p,D){var n=this;return(0,s.A)(function*(){const d=[],V=Object.entries(p._attributeConfigs);for(const[B,U]of V)if(!(!("viewModelConfig"in U)&&!("viewModelName"in U)))if(U.isCollection)d.push(n._saveDataSafely(()=>n._saveInnerViewModelCollection(p,B,D)));else{const k=yield p[B];d.push(n._saveDataSafely(()=>n._saveInnerViewModel(k)))}return(yield Promise.all(d)).flat()})()}_saveInnerViewModel(p){var D=this;return(0,s.A)(function*(){const n={type:"crt.SavePrimaryDataRequest",$context:p};return yield D.handlerChain.process(n)})()}_saveInnerViewModelCollection(p,D,n){var d=this;return(0,s.A)(function*(){const V={type:"crt.SaveCollectionPrimaryDataRequest",$context:p,collectionAttributeName:D,scopes:n};return yield d.handlerChain.process(V)})()}_saveDataSafely(p){return p().catch(D=>[this._createFailedSaveResult(D?.message)])}_createFailedSaveResult(p){return{success:!1,rowsAffected:0,errorInfo:p}}handle(p){var D=this;return(0,s.A)(function*(){D._validateRequest(p);const n=p.$context,d=yield D._saveRootData(n);if(d.some(w=>!w.success))return d;const V=yield D._saveNestedData(n,p.scopes);return[...d,...V]})()}};c=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.SavePrimaryDataHandler",requestType:"crt.SavePrimaryDataRequest"}),(0,m.__metadata)("design:paramtypes",[o.i])],c);let _=class extends O.BaseRequest{};_=(0,m.__decorate)([(0,O.CrtRequest)({type:"crt.LoadLookupListRequest"})],_);let C=class extends O.BaseRequestHandler{handle(p){const D={control:p.valueAttributeName,items:p.itemsAttributeName},n=p.filterValue??null,d=[{type:O.ModelParameterType.PrimaryDisplayValueFilter,value:"@requestPayload.lookupFilterValue"},...p.parameters||[]],V={...p.payload,lookupFilterValue:n};return p.$context.loadLookupList(D,d,V),Promise.resolve()}};C=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.LoadLookupListHandler",requestType:"crt.LoadLookupListRequest"})],C);let y=class extends O.BaseRequestHandler{_isDynamicDS(p){const D=p.config||{};return!!(D.dataSourceConfig&&D.attributeName)}_loadDynamicDS(p){const D=p.$context,n=p.config;return(0,h.lastValueFrom)(D.load(n),{defaultValue:null})}_load(p){if(!p.dataSourceName)return;const D=p.$context;let n=p.parameters;n=this._addPrimaryDisplayValueFilterIfNeed(p,n);const d=p.config;return(0,h.lastValueFrom)(D.load(p.dataSourceName,n,d),{defaultValue:null})}_addPrimaryDisplayValueFilterIfNeed(p,D){return p.primaryDisplayFilterValue?(D=D||[],[...D,{type:O.ModelParameterType.PrimaryDisplayValueFilter,value:p.primaryDisplayFilterValue}]):D}handle(p){if(!p.$context)throw new Error("Property '$context' should be specified");return this._isDynamicDS(p)?this._loadDynamicDS(p):this._load(p)}};y=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.LoadDataSourceHandler",requestType:"crt.LoadDataRequest"})],y);let E=class extends O.DataRequest{};E=(0,m.__decorate)([(0,O.CrtRequest)({type:"crt.LoadDefaultValuesRequest"})],E);let I=class extends O.BaseRequestHandler{handle(p){const D=p.$context;return(0,h.lastValueFrom)(D.loadDefaultValues(p.dataSourceName),{defaultValue:null})}};I=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.LoadDefaultValuesHandler",requestType:"crt.LoadDefaultValuesRequest"})],I);let N=class extends O.DataRequest{};N=(0,m.__decorate)([(0,O.CrtRequest)({type:"crt.SaveDataRequest"})],N);let S=class extends O.BaseRequestHandler{handle(p){const D=p.$context,{dataSourceName:n,options:d,parameters:V}=p,w=D.save(n,V,d);return(0,h.lastValueFrom)(w,{defaultValue:null})}};S=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.SaveDataHandler",requestType:"crt.SaveDataRequest"})],S);let b=class extends O.DataRequest{};b=(0,m.__decorate)([(0,O.CrtRequest)({type:"crt.DeleteDataRequest"})],b);let j=class extends O.BaseRequestHandler{handle(p){const D=p.$context;return(0,h.lastValueFrom)(D.delete(p.dataSourceName,p.parameters,p.config),{defaultValue:null})}};j=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.DeleteDataHandler",requestType:"crt.DeleteDataRequest"})],j);let f=class extends O.DataRequest{};f=(0,m.__decorate)([(0,O.CrtRequest)({type:"crt.CopyDataRequest"})],f);let R=class extends O.BaseRequestHandler{handle(p){const D=p.$context,{dataSourceName:n,recordId:d,copiedValues:V}=p;return(0,h.lastValueFrom)(D.copy(n,d,V),{defaultValue:null})}};R=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.CopyDataHandler",requestType:"crt.CopyDataRequest"})],R);let e=class extends O.DataRequest{};e=(0,m.__decorate)([(0,O.CrtRequest)({type:"crt.SortDataRequest"})],e);let t=class extends O.BaseRequestHandler{handle(p){const D=p.$context;return(0,h.lastValueFrom)(D.setSorting(p.dataSourceName,p.config),{defaultValue:null})}};t=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.SortDataHandler",requestType:"crt.SortDataRequest"})],t);let i=class extends O.BaseRequestHandler{handle(p){var D=this;return(0,s.A)(function*(){const n=p.$context,d=n._injectionContext;n._injectionContext?.id&&D.handlerChain.clearContextedHandlersCache(d.id),yield D.next?.handle(p)})()}};i=(0,m.__decorate)([(0,O.CrtRequestHandler)({requestType:"crt.HandleViewModelDestroyRequest",type:"crt.ClearContextedHandlersCacheHandler"})],i);var r=a(493);let l=class extends O.DataRequest{};l=(0,m.__decorate)([(0,O.CrtRequest)({type:"crt.GetDataSourceLoadFiltersRequest"})],l);let g=class extends O.BaseRequestHandler{constructor(p){super(),this._entitySchemaQueryBuilder=p}handle(p){var D=this;return(0,s.A)(function*(){const n=p.$context;if(!n)throw new Error("Property '$context' should be specified");const d=p.dataSourceName;if(!d)throw new Error("Property 'dataSourceName' should be specified");const V=n.dataSchemas[d];if(!V)throw new Error(`Schema for data source with name ${d} not found`);const w=yield n.getDataSourceLoadParameters(d);return w.parameters.some(B=>B.type===O.ModelParameterType.Never)?null:(0,h.lastValueFrom)(D._entitySchemaQueryBuilder.build(V,[],w.parameters).pipe((0,h.map)(B=>B.getMetadata().filters)))})()}};g=(0,m.__decorate)([(0,O.CrtRequestHandler)({type:"crt.GetDataSourceLoadFiltersHandler",requestType:"crt.GetDataSourceLoadFiltersRequest"}),(0,m.__metadata)("design:paramtypes",[r.O])],g)},68678:($,W,a)=>{a.d(W,{C_:()=>O,Fj:()=>M,iB:()=>F});var s=a(59131),m=a.n(s);const M=new s.InjectionToken("SCOPE_NAME"),O=new s.InjectionToken("VIEW_EVENT_ZONE_NAME"),F=new s.InjectionToken("INJECTION_CONTEXT")},71777:($,W,a)=>{a.d(W,{X:()=>T,d:()=>P});var s=a(62278),m=a.n(s),M=a(36486),O=a.n(M),F=a(59131),x=a.n(F);class P{selectData(){return null}static{this.\u0275fac=function(v){return new(v||P)}}static{this.\u0275prov=F.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac,providedIn:"root"})}}class T extends P{constructor(){super(...arguments),this._elon={FirstName:"Elon",Account:{Name:"SpaceX",Ships:[{Id:"Falcon 9"},{Id:"Falcon Heavy"}],Employee:{Name:"Mask",Age:49}},Employees:["Elon"]}}selectData(){return(0,s.of)(this._elon).pipe((0,M.delay)(50))}static{this.\u0275fac=(()=>{let u;return function(L){return(u||(u=F.\u0275\u0275getInheritedFactory(T)))(L||T)}})()}static{this.\u0275prov=F.\u0275\u0275defineInjectable({token:T,factory:T.\u0275fac,providedIn:"root"})}}},65576:($,W,a)=>{a.d(W,{n:()=>s});var s;(function(m){m.ChangeAttributeValue="change-attribute-value",m.ModelDataLoaded="model-data-loaded-event",m.BeforeModelLoad="before-model-load",m.LoadDefaultValues="load-default-values",m.StartLoadModelAttributes="start-load-model-attributes",m.FinishLoadModelAttributes="finish-load-model-attributes",m.ViewEvent="view-event"})(s||(s={}))},28114:($,W,a)=>{a.d(W,{n:()=>y});var s=a(5960),m=a.n(s),M=a(59131),O=a.n(M),F=a(38495),x=a.n(F),P=a(96590),T=a.n(P),h=a(21018),u=a.n(h),v=a(62278),L=a.n(v),o=a(36486),c=a.n(o),_=a(57117),C=a(80246);let y=class ce{constructor(I,N,S,b){this.dataSourceFactory=I,this.entitySchemaRepository=N,this._featureValues=S,this._injector=b}_createModel(I=null,N=!1,S){const b=new C.K(S||this._injector,I);return b.disableSync=N,b.init()}_validateModelConfig(I){if(I.primaryDataSourceName&&!I.dataSources[I.primaryDataSourceName])throw new Error(`Data source "${I.primaryDataSourceName}" cannot be primary data source. Data source "${I.primaryDataSourceName}" not found in model config.`);if(I.primaryDataSourceName&&I.dataSources[I.primaryDataSourceName]?.scope===F.DataSourceScope.ViewElement)throw new Error(`Data source "${I.primaryDataSourceName}" with scope "viewElement" cannot be primary. Only data sources with scope "page" can be primary`)}_getEntitySchemesRequest(I){return I.map(([,N])=>N).filter(N=>N.type==="crt.EntityDataSource").map(N=>N.config).filter(N=>!!N.entitySchemaName).map(N=>{let S=[];return N.attributes&&(S=Object.entries(N.attributes).filter(([,b])=>b.type===F.DataSchemaAttributeType.ForwardReferenceAttribute).map(([,b])=>b.path)),{name:N.entitySchemaName,loadLookupColumns:!0,forwardReferencePaths:S}})}_generateFromConfig(I,N){let S,b;const j=N?.get(h.MeasurePerformanceService,null,{optional:!0});return j?(S=Object.entries(I?.dataSources||{}).filter(([f,R])=>R.type?!0:(console.warn(`Data source ${f} without type not supported.`),!1)),S.length===0?(0,v.of)([]):(this._validateModelConfig(I),b=S.map(([f,R])=>this.generateOne(R,f,N)),this.preInitializeDataSources(S).pipe(j.measure$("modelGenerator.generateFromConfig"),(0,v.switchMap)(()=>(0,v.forkJoin)(b))))):(S=Object.entries(I?.dataSources||{}).filter(([f,R])=>R.type?!0:(console.warn(`Data source ${f} without type not supported.`),!1)),S.length===0?(0,v.of)([]):(this._validateModelConfig(I),b=S.map(([f,R])=>this.generateOne(R,f,N)),this.preInitializeDataSources(S).pipe((0,v.switchMap)(()=>(0,v.forkJoin)(b)))))}preInitializeDataSources(I){if(this._featureValues["DataSource-DontUseOneRequestForEntitySchemes"])return(0,v.of)(null);const N=this._getEntitySchemesRequest(I);return this.entitySchemaRepository.getSchemes(N).pipe((0,o.catchError)(S=>(0,v.of)([])),(0,o.map)(S=>null))}generate(I,N){return this._generateFromConfig(I,N)}generateOne(I,N,S){const b=S?.get(h.MeasurePerformanceService,null,{optional:!0});return b?this.dataSourceFactory.create(N,I,S).pipe(b.measure$(`modelGenerator.generateOne.${N}`),(0,o.mergeMap)(j=>this._createModel(j,I.disableSync,S))):this.dataSourceFactory.create(N,I,S).pipe((0,o.mergeMap)(j=>this._createModel(j,I.disableSync,S)))}static{this.\u0275fac=function(N){return new(N||ce)(M.\u0275\u0275inject(_.LZ),M.\u0275\u0275inject(h.EntitySchemaRepository),M.\u0275\u0275inject(h.FEATURE_VALUES),M.\u0275\u0275inject(M.Injector))}}static{this.\u0275prov=M.\u0275\u0275defineInjectable({token:ce,factory:ce.\u0275fac})}};y=(0,s.__decorate)([(0,P.CrtHandlerChainAdapter)({requestType:"crt.ModelGenerator"}),(0,s.__metadata)("design:paramtypes",[_.LZ,h.EntitySchemaRepository,h.FeatureValues,M.Injector])],y)},81116:($,W,a)=>{a.d(W,{R:()=>_});var s=a(73308),m=a(38495),M=a.n(m),O=a(21018),F=a.n(O),x=a(78240),P=a.n(x),T=a(28399),h=a.n(T),u=a(62278),v=a.n(u),L=a(57117),o=a(59131),c=a.n(o);class _{constructor(y,E,I){this._sysSettingsService=y,this._dataSchemaRepository=E,this._featureValues=I,this._searchComparisonTypeSysSettingCode="StringColumnSearchComparisonType"}_getParameterValue(y,E,I){if(typeof E=="string"){if(E.startsWith("@requestPayload")){const N=E.replace("@requestPayload.","");return(0,T.get)(I,N)}if(E.startsWith("$"))return y.attributes[E.substring(1)];if(y.attributes[E])return y.attributes[E]}return E}_applyFilterMacros(y,E){let I=null;switch(typeof E){case"object":I=JSON.stringify((0,x.classToPlain)(E));break;case"string":I=E;break;default:return E}const N=/##ViewModelMacro\.\$([^#]+)##/g;let S=!1;return[...I.matchAll(N)].forEach(b=>{const j=b[1],f=(0,T.get)(y.attributes,j);let R=f?.toString();typeof f=="object"&&(S=!0,R=JSON.stringify(f)),I=I.replace(b[0],R)}),typeof E=="object"||S?JSON.parse(I):I}_createPrimaryDisplayColumnValueFilter(y){var E=this;return(0,s.A)(function*(){const I=E._searchComparisonTypeSysSettingCode,S=(yield E._sysSettingsService.getByCode(I))?.value===1?m.ComparisonType.Contain:m.ComparisonType.Start_with;return{type:m.ModelParameterType.PrimaryDisplayValueFilter,value:y,comparisonType:S}})()}_createColumnValueFilter(y,E,I){const N=E;return Promise.resolve({type:m.ModelParameterType.ColumnValue,value:{attributePath:N.attributePath,attributeValue:this._getParameterValue(y,N.attributeValue,I)}})}_getDataSourceFilteringParameters(y,E){const N=y._dataSourcesInfos.get(E).getFilteringConfig();return y._checkFilteringAttributes(E,N),N.length===0?Promise.resolve([]):Promise.all(N.map(S=>y[S.name])).then(S=>S.map(b=>({type:m.ModelParameterType.Filter,value:b})))}_getPrimaryAttributeName(y,E){var I=this;return(0,s.A)(function*(){if(!E)return null;let N=Object.values(y.dataSchemas).find(S=>S.name===E);return N||(N=yield(0,u.lastValueFrom)(I._dataSchemaRepository.get(E))),N?.primaryAttributeName})()}_getParameterRelationsConfigs(y){return y.relationsConfigs||[]}_createRelationParameter(y,E){const I={...y},N=this._getParameterRelationsConfigs(I);return I.relationsConfigs=[{dataSchemaName:E.dataSchemaName,attributePath:E.attributePath,relationPath:E.relationPath},...N],I}_validateAllowedRelations(y,E,I){const S=I?.relationPath?.split(".")?.shift(),b=y.dataSchemas[E],j=b?.findAttributeByName(S);if(b&&j&&b.primaryAttributeName!==S&&j.dataValueType!==m.DataValueType.Lookup&&!this._featureValues.DataSourceAllowRelationsByNonLookupColumn){const f="Filtration of data sources by page data is currently supported by lookup and primaryAttribute fields only",R=new Error(`${f}, please see the console for more details`);throw R.stack=`${f} , data source name: ${E}, relation config: ${JSON.stringify(I)}`,R}}_createRelationParameterWithAttributeValue(y,E,I,N){var S=this;return(0,s.A)(function*(){const b={...I},j=S._getParameterRelationsConfigs(b),f=y.dataSchemas[E],R=N.relationPath.split("."),e=R.shift(),t=f.findAttributeByName(e);if(f.primaryAttributeName!==e&&t.dataValueType!==m.DataValueType.Lookup&&S._featureValues.DataSourceAllowRelationsByNonLookupColumn)return b.type=m.ModelParameterType.ColumnValue,b.value={attributePath:N.attributePath,attributeValue:N.value},b.relationsConfigs=j,b;const i={dataSchemaName:N.dataSchemaName,attributePath:N.attributePath,relationPath:N.relationPath};b.value=N.value,b.type=m.ModelParameterType.PrimaryColumnValue,f.primaryAttributeName!==e&&(i.dataSchemaName=t.referenceSchemaName);const r=f.type!==m.DataSchemaType.Entity?i.dataSchemaName:N.dataSchemaName;return i.relationPath=R.length===0?yield S._getPrimaryAttributeName(y,r):R.join("."),b.relationsConfigs=[i,...j],b})()}_convertToRelationParameters(y,E,I,N){var S=this;return(0,s.A)(function*(){const b=[];S._validateAllowedRelations(y,E,N);for(const j of I){const f=N.useAttributeValue?yield S._createRelationParameterWithAttributeValue(y,E,j,N):S._createRelationParameter(j,N);b.push(f)}return b})()}_getRelationParameters(y,E){const I=y._modelDependencies[E]||[];if(I.length===0)return Promise.resolve([]);const N=I.map(S=>{const b=S.relationPath.split("."),j=b.shift(),f=y.dataSchemas[j],R={dataSchemaName:f.name,attributePath:S.attributePath,relationPath:b.join(".")},e=b.shift(),i=y._dataSourcesInfos.get(j).getMappedAttributeNames(e)?.[0]??null,r=y.getModelMode(j),l=y.getIsDirty(i)||r===O.ModelMode.Create||r===O.ModelMode.Copy||f.type!==m.DataSchemaType.Entity;if(i&&l){R.useAttributeValue=!0;const g=y.attributes[i];R.value=g?.value?g.value:g}return{relatedModelName:j,relationConfig:R}}).map(({relatedModelName:S,relationConfig:b})=>this._getModelLoadParameters(y,S,null,null,!0,!1).then(j=>this._convertToRelationParameters(y,S,j,b)));return Promise.all(N).then(S=>S.flat())}_getPagingConfigRowCount(y,E){return typeof E=="string"?(0,T.isNil)(y.attributes[E])?0:y.attributes[E]:E}_getPagingConfigRowsOffset(y,E,I,N){const S=y._dataSourcesInfos.get(N).collectionViewModelAttributeName,b=y.attributes[S]?.length??0;if(typeof E=="number")throw new Error("Rows offset parameter cannot be set to number");return!E&&I===m.DataSourceLoadType.LoadNext?b:!E&&I===m.DataSourceLoadType.Reload?0:(y.attributes[E]=(0,T.isNil)(y.attributes[E])?0:y.attributes[E],I===m.DataSourceLoadType.Reload?y.attributes[E]:y.attributes[E]+b)}_getModelPagingConfig(y,E,I,N){return E?Promise.resolve({rowCount:this._getPagingConfigRowCount(y,E.rowCount),rowsOffset:this._getPagingConfigRowsOffset(y,E.rowsOffset,I,N)}):Promise.resolve(null)}_getModelSortingConfig(y,E){const I=E?.attributeName;return!I||!y.attributes[I]?Promise.resolve(null):Promise.all(y.attributes[I].map(function(){var N=(0,s.A)(function*(S){return{columnName:yield S.columnName,direction:yield S.direction}});return function(S){return N.apply(this,arguments)}}())).then(N=>({columns:N}))}_updateLastEventLoadParameters(y,E,I,N){I&&I.length!==0?y._lastEventLoadParameters.set(E,I):N!==!0&&y._lastEventLoadParameters.set(E,[{type:m.ModelParameterType.Empty,value:""}])}_getModelLoadParameters(y,E,I,N,S,b){const j=this.getModelParameters(y,I,N).then(f=>(b!==!0&&this._updateLastEventLoadParameters(y,E,f,S),S!==!0?f:y._lastEventLoadParameters.get(E)||[{type:m.ModelParameterType.Never,value:""}]));return Promise.all([j,this._getDataSourceFilteringParameters(y,E),this._getRelationParameters(y,E)]).then(([f,R,e])=>[...f,...R,...e])}getModelParameters(y,E,I){if(I?.parameters&&(E=[...E,...I.parameters]),!E||E.length===0)return Promise.resolve([]);const N=E.map(S=>{switch(S.type){case m.ModelParameterType.PrimaryColumnValue:return Promise.resolve({type:S.type,value:this._getParameterValue(y,S.value,I)});case m.ModelParameterType.Filter:return Promise.resolve({type:S.type,value:this._applyFilterMacros(y,S.value)});case m.ModelParameterType.PrimaryDisplayValueFilter:return this._createPrimaryDisplayColumnValueFilter(this._getParameterValue(y,S.value,I));case m.ModelParameterType.ColumnValue:return this._createColumnValueFilter(y,S.value,I)}});return Promise.all(N)}getModelLoadParameters(y,E,I,N=m.DataSourceLoadType.Load,S,b,j){const f=E.name,R=N===m.DataSourceLoadType.Load?null:E.getPagingConfig(),e=E.getSortingConfig();return Promise.all([this._getModelLoadParameters(y,f,I,S,b,j),this._getModelPagingConfig(y,R,N,f),this._getModelSortingConfig(y,e)])}static{this.\u0275fac=function(E){return new(E||_)(o.\u0275\u0275inject(m.SysSettingsService),o.\u0275\u0275inject(L.J_),o.\u0275\u0275inject(O.FEATURE_VALUES))}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac,providedIn:"root"})}}},59910:($,W,a)=>{a.d(W,{g:()=>te});var s=a(5960),m=a(40297),M=a(56711),O=a(38495),F=a(96590),x=a(20442),P=a(21018),T=a(8206),h=a(57117),u=a(42745),v=a(68678),L=a(71777),o=a(28114),c=a(41756),_=a(77430),C=a(39560),y=a(99499),E=a(66882);const re={"hr-HR":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Molimo odaberite vrijednost iz popisa","SelectionWindowMessage":"Molimo odaberite vrijednost iz popisa ili pretra\u017Eite koriste\u0107i prozor za pretra\u017Eivanje"},"Required":{"Message":"Unesite vrijednost"},"MaxLength":{"Message":"Prema\u0161ena maksimalna duljina teksta ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimalna duljina teksta nije dosegnuta ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Neispravan format datuma i vremena"},"DatePickerSyntax":{"Message":"Neispravan format datuma"},"TimePickerSyntax":{"Message":"Neispravan format vremena"},"RegExp":{"Message":"Neispravan format vrijednosti"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kod mora zapo\u010Deti prefiksom {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"Unesite barem jedan znak."},"SchemaNameAllowedSymbols":{"Message":"Koristite simbole: a-z, A-Z, 0-9, donja crta ili crtica. Samo slova mogu biti prva."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Stupac uklonjen","ValidationErrorMessageSingleErrorField":"Polje: {0}. Gre\u0161ka: {1}","ValidationErrorMessageSeveralErrorFields":"Polja: {0}. Gre\u0161ka: {1}","RefreshModelDataConflict":"Creatio ima nove podatke za trenutnu stranicu. Kako biste ih vidjeli, spremite ili poni\u0161tite svoje promjene i osvje\u017Eite stranicu.","WarningModelsWithCircularDependencies":"Neki modeli imaju cikli\u010Dke ovisnosti i nisu u\u010Ditani","LoadingModelErrorMessage":"Do\u0161lo je do gre\u0161ke tijekom izvr\u0161avanja upita"}}'),"hu-HU":JSON.parse('{"Validators":{"Autocomplete":{"Message":"K\xE9rj\xFCk, v\xE1lassza ki az \xE9rt\xE9ket a list\xE1b\xF3l","SelectionWindowMessage":"K\xE9rj\xFCk, v\xE1lasszon \xE9rt\xE9ket a list\xE1b\xF3l, vagy keressen a keres\u0151ablak seg\xEDts\xE9g\xE9vel"},"Required":{"Message":"Adj meg egy \xE9rt\xE9ket"},"MaxLength":{"Message":"A maxim\xE1lis sz\xF6veghossz t\xFAll\xE9pve ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Nem \xE9rte el a minim\xE1lis sz\xF6veghosszt ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\xC9rv\xE9nytelen d\xE1tum- \xE9s id\u0151form\xE1tum"},"DatePickerSyntax":{"Message":"\xC9rv\xE9nytelen d\xE1tumform\xE1tum"},"TimePickerSyntax":{"Message":"\xC9rv\xE9nytelen id\u0151form\xE1tum"},"RegExp":{"Message":"\xC9rv\xE9nytelen \xE9rt\xE9kform\xE1tum"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Oszlop elt\xE1vol\xEDtva","ValidationErrorMessageSingleErrorField":"Mez\u0151: {0}. Hiba: {1}","ValidationErrorMessageSeveralErrorFields":"Mez\u0151k: {0}. Hiba: {1}","RefreshModelDataConflict":"A Creatio \xFAj adatokkal rendelkezik az aktu\xE1lis oldalhoz. A megtekint\xE9s\xE9hez mentse vagy vonja vissza a m\xF3dos\xEDt\xE1sokat, \xE9s friss\xEDtse az oldalt.","WarningModelsWithCircularDependencies":"Egyes modellek k\xF6rk\xF6r\xF6s f\xFCgg\u0151s\xE9ggel rendelkeznek, \xE9s nincsenek bet\xF6ltve","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"zh-CN":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u8BF7\u4ECE\u5217\u8868\u4E2D\u9009\u62E9\u503C","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"\u8F93\u5165\u503C"},"MaxLength":{"Message":"\u8D85\u8FC7\u6587\u672C\u957F\u5EA6\u9650\u5236({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u672A\u8FBE\u6587\u672C\u6700\u5C0F\u9650\u5236({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u65E5\u671F\u548C\u65F6\u95F4\u683C\u5F0F\u65E0\u6548"},"DatePickerSyntax":{"Message":"\u65E5\u671F\u683C\u5F0F\u65E0\u6548"},"TimePickerSyntax":{"Message":"\u65F6\u95F4\u683C\u5F0F\u65E0\u6548"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u5217\u5DF2\u79FB\u9664","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio \u5F53\u524D\u9875\u9762\u6570\u636E\u5DF2\u66F4\u6539\u3002\u8BF7\u4FDD\u5B58\u6216\u53D6\u6D88\u540E\uFF0C\u518D\u5237\u65B0\u672C\u9875\u9762\u4EE5\u67E5\u770B","WarningModelsWithCircularDependencies":"\u6709\u4E9B\u6A21\u578B\u6709\u5FAA\u73AF\u4F9D\u8D56\u5173\u7CFB\u5E76\u4E14\u6CA1\u6709\u88AB\u52A0\u8F7D","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"uk-UA":JSON.parse('{"BaseViewModel":{"RefreshModelDataConflict":"Creatio \u043C\u0430\u0454 \u043D\u043E\u0432\u0456 \u0434\u0430\u043D\u0456 \u0434\u043B\u044F \u043F\u043E\u0442\u043E\u0447\u043D\u043E\u0457 \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438. \u0429\u043E\u0431 \u043F\u0435\u0440\u0435\u0433\u043B\u044F\u043D\u0443\u0442\u0438 \u0457\u0457, \u0437\u0431\u0435\u0440\u0435\u0436\u0456\u0442\u044C \u0430\u0431\u043E \u0441\u043A\u0430\u0441\u0443\u0439\u0442\u0435 \u0432\u0430\u0448\u0456 \u0437\u043C\u0456\u043D\u0438 \u0456 \u043E\u043D\u043E\u0432\u0456\u0442\u044C \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0443.","WarningModelsWithCircularDependencies":"\u0414\u0435\u044F\u043A\u0456 \u043C\u043E\u0434\u0435\u043B\u0456 \u043C\u0430\u044E\u0442\u044C \u0446\u0438\u043A\u043B\u0456\u0447\u043D\u0456 \u0437\u0430\u043B\u0435\u0436\u043D\u043E\u0441\u0442\u0456 \u0456 \u043D\u0435 \u0431\u0443\u043B\u0438 \u0437\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u0456","DataSourceAttributeRemoved":"\u041A\u043E\u043B\u043E\u043D\u043A\u0443 \u0432\u0438\u0434\u0430\u043B\u0435\u043D\u043E","ValidationErrorMessageSingleErrorField":"\u041F\u043E\u043B\u0435: {0}. \u041F\u043E\u043C\u0438\u043B\u043A\u0430: {1}","ValidationErrorMessageSeveralErrorFields":"\u041F\u043E\u043B\u044F: {0}. \u041F\u043E\u043C\u0438\u043B\u043A\u0430: {1}","LoadingModelErrorMessage":"\u0421\u0442\u0430\u043B\u0430\u0441\u044F \u043F\u043E\u043C\u0438\u043B\u043A\u0430 \u043F\u0456\u0434 \u0447\u0430\u0441 \u0432\u0438\u043A\u043E\u043D\u0430\u043D\u043D\u044F \u0437\u0430\u043F\u0438\u0442\u0443"},"Validators":{"Autocomplete":{"Message":"\u0411\u0443\u0434\u044C \u043B\u0430\u0441\u043A\u0430, \u043E\u0431\u0435\u0440\u0456\u0442\u044C \u0437\u043D\u0430\u0447\u0435\u043D\u043D\u044F \u0437\u0456 \u0441\u043F\u0438\u0441\u043A\u0443","SelectionWindowMessage":"\u0411\u0443\u0434\u044C \u043B\u0430\u0441\u043A\u0430, \u0432\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u0437\u043D\u0430\u0447\u0435\u043D\u043D\u044F \u0437\u0456 \u0441\u043F\u0438\u0441\u043A\u0443 \u0430\u0431\u043E \u0441\u043A\u043E\u0440\u0438\u0441\u0442\u0430\u0439\u0442\u0435\u0441\u044F \u043F\u043E\u0448\u0443\u043A\u043E\u043C \u0437\u0430 \u0434\u043E\u043F\u043E\u043C\u043E\u0433\u043E\u044E \u0432\u0456\u043A\u043D\u0430 \u0434\u043E\u0432\u0456\u0434\u043D\u0438\u043A\u0430"},"Required":{"Message":"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u0437\u043D\u0430\u0447\u0435\u043D\u043D\u044F"},"MaxLength":{"Message":"\u041F\u0435\u0440\u0435\u0432\u0438\u0449\u0435\u043D\u043E \u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u0443 \u0434\u043E\u0432\u0436\u0438\u043D\u0443 \u0442\u0435\u043A\u0441\u0442\u0443 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u041D\u0435 \u0434\u043E\u0441\u044F\u0433\u043D\u0443\u0442\u043E \u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u043E\u0457 \u0434\u043E\u0432\u0436\u0438\u043D\u0438 \u0442\u0435\u043A\u0441\u0442\u0443 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0434\u0430\u0442\u0438 \u0456 \u0447\u0430\u0441\u0443"},"DatePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0434\u0430\u0442\u0438"},"TimePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0447\u0430\u0441\u0443"},"RegExp":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0437\u043D\u0430\u0447\u0435\u043D\u043D\u044F"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u041A\u043E\u0434 \u043C\u0430\u0454 \u043F\u043E\u0447\u0438\u043D\u0430\u0442\u0438\u0441\u044F \u0437 \u043F\u0440\u0435\u0444\u0456\u043A\u0441\u0443 {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043F\u0440\u0438\u043D\u0430\u0439\u043C\u043D\u0456 \u043E\u0434\u0438\u043D \u0441\u0438\u043C\u0432\u043E\u043B."},"SchemaNameAllowedSymbols":{"Message":"\u0412\u0438\u043A\u043E\u0440\u0438\u0441\u0442\u043E\u0432\u0443\u0439\u0442\u0435 \u0441\u0438\u043C\u0432\u043E\u043B\u0438: a-z, A-Z, 0-9, \u043F\u0456\u0434\u043A\u0440\u0435\u0441\u043B\u0435\u043D\u043D\u044F \u0430\u0431\u043E \u0442\u0438\u0440\u0435. \u0421\u043F\u043E\u0447\u0430\u0442\u043A\u0443 \u043C\u043E\u0436\u0443\u0442\u044C \u0431\u0443\u0442\u0438 \u043B\u0438\u0448\u0435 \u043B\u0456\u0442\u0435\u0440\u0438."}}}'),"sq-AL":JSON.parse('{"Validators":{"Autocomplete":{"Message":"T\xEB lutem p\xEBrzgjidh vler\xEBn nga lista","SelectionWindowMessage":"T\xEB lutem p\xEBrzgjidh vler\xEB nga lista ose k\xEBrko duke p\xEBrdorur dritaren e k\xEBrkimit"},"Required":{"Message":"Vendos vler\xEBn"},"MaxLength":{"Message":"\xCBsht\xEB tejkaluar gjat\xEBsia maksimale e tekstit ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Gjat\xEBsia minimale e tekstit nuk \xEBsht\xEB arritur ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Format i pavlefsh\xEBm i dat\xEBs dhe or\xEBs"},"DatePickerSyntax":{"Message":"Format i pavlefsh\xEBm i dat\xEBs"},"TimePickerSyntax":{"Message":"Format i pavlefsh\xEBm i or\xEBs"},"RegExp":{"Message":"Formati i vler\xEBs i pavlefsh\xEBm"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kodi duhet t\xEB filloj\xEB me prefiksin {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"Vendos t\xEB pakt\xEBn nj\xEB simbol m\xEB shum\xEB."},"SchemaNameAllowedSymbols":{"Message":"P\xEBrdor simbolet: a-z, A-Z, 0-9, n\xEBnvij\xEBzim ose vij\xEBzim. Vet\xEBm shkronja mund t\xEB vendoset n\xEB fillim."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Kolonat u hoq\xEBn","ValidationErrorMessageSingleErrorField":"Fusha: {0}. Gabim: {1}","ValidationErrorMessageSeveralErrorFields":"Fushat: {0}. Gabim: {1}","RefreshModelDataConflict":"Creatio ka t\xEB dh\xEBna t\xEB reja p\xEBr faqen aktuale. P\xEBr t\xEB pare, ruajtur apo anuluar ndryshimet e tua dhe p\xEBr t\xEB rifreskuar faqen.","WarningModelsWithCircularDependencies":"Disa modele kan\xEB var\xEBsi ciklike dhe nuk jan\xEB ngarkuar","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"en-GB":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list"},"Required":{"Message":"Enter a value"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}"}}'),"bg-BG":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u041C\u043E\u043B\u044F, \u0438\u0437\u0431\u0435\u0440\u0438 \u0441\u0442\u043E\u0439\u043D\u043E\u0441\u0442 \u043E\u0442 \u0441\u043F\u0438\u0441\u044A\u043A\u0430","SelectionWindowMessage":"\u041C\u043E\u043B\u044F, \u0438\u0437\u0431\u0435\u0440\u0438 \u0441\u0442\u043E\u0439\u043D\u043E\u0441\u0442 \u043E\u0442 \u0441\u043F\u0438\u0441\u044A\u043A\u0430 \u0438\u043B\u0438 \u043F\u043E\u0442\u044A\u0440\u0441\u0438 \u0441 \u043F\u043E\u043C\u043E\u0449\u0442\u0430 \u043D\u0430 \u043F\u0440\u043E\u0437\u043E\u0440\u0435\u0446\u0430 \u0437\u0430 \u0441\u043F\u0440\u0430\u0432\u043A\u0430"},"Required":{"Message":"\u0412\u044A\u0432\u0435\u0434\u0438 \u0441\u0442\u043E\u0439\u043D\u043E\u0441\u0442"},"MaxLength":{"Message":"\u041F\u0440\u0435\u0432\u0438\u0448\u0435\u043D\u0430 \u0435 \u043C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u043D\u0430\u0442\u0430 \u0434\u044A\u043B\u0436\u0438\u043D\u0430 \u043D\u0430 \u0442\u0435\u043A\u0441\u0442\u0430 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u043D\u0430\u0442\u0430 \u0434\u044A\u043B\u0436\u0438\u043D\u0430 \u043D\u0430 \u0442\u0435\u043A\u0441\u0442\u0430 \u043D\u0435 \u0435 \u0434\u043E\u0441\u0442\u0438\u0433\u043D\u0430\u0442\u0430 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0444\u043E\u0440\u043C\u0430\u0442 \u0437\u0430 \u0434\u0430\u0442\u0430 \u0438 \u0447\u0430\u0441"},"DatePickerSyntax":{"Message":"\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0444\u043E\u0440\u043C\u0430\u0442 \u043D\u0430 \u0434\u0430\u0442\u0430\u0442\u0430"},"TimePickerSyntax":{"Message":"\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0444\u043E\u0440\u043C\u0430\u0442 \u043D\u0430 \u0447\u0430\u0441\u0430"},"RegExp":{"Message":"\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0444\u043E\u0440\u043C\u0430\u0442 \u043D\u0430 \u0441\u0442\u043E\u0439\u043D\u043E\u0441\u0442\u0442\u0430"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u041A\u043E\u0434\u044A\u0442 \u0442\u0440\u044F\u0431\u0432\u0430 \u0434\u0430 \u0437\u0430\u043F\u043E\u0447\u0432\u0430 \u0441 \u043F\u0440\u0435\u0444\u0438\u043A\u0441\u0430 {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"\u0412\u044A\u0432\u0435\u0434\u0438 \u043F\u043E\u043D\u0435 \u043E\u0449\u0435 \u0435\u0434\u0438\u043D \u0441\u0438\u043C\u0432\u043E\u043B."},"SchemaNameAllowedSymbols":{"Message":"\u0418\u0437\u043F\u043E\u043B\u0437\u0432\u0430\u0439 \u0441\u0438\u043C\u0432\u043E\u043B\u0438: a-z, A-Z, 0-9, \u0434\u043E\u043B\u043D\u0430 \u0447\u0435\u0440\u0442\u0430 \u0438\u043B\u0438 \u0442\u0438\u0440\u0435. \u041F\u044A\u0440\u0432\u0438 \u043C\u043E\u0433\u0430\u0442 \u0434\u0430 \u0431\u044A\u0434\u0430\u0442 \u0441\u0430\u043C\u043E \u0431\u0443\u043A\u0432\u0438."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u041A\u043E\u043B\u043E\u043D\u0430\u0442\u0430 \u0435 \u043F\u0440\u0435\u043C\u0430\u0445\u043D\u0430\u0442\u0430","ValidationErrorMessageSingleErrorField":"\u041F\u043E\u043B\u0435: {0}. \u0413\u0440\u0435\u0448\u043A\u0430: {1}","ValidationErrorMessageSeveralErrorFields":"\u041F\u043E\u043B\u0435\u0442\u0430: {0}. \u0413\u0440\u0435\u0448\u043A\u0430: {1}","RefreshModelDataConflict":"Creatio \u0438\u043C\u0430 \u043D\u043E\u0432\u0438 \u0434\u0430\u043D\u043D\u0438 \u0437\u0430 \u0442\u0435\u043A\u0443\u0449\u0430\u0442\u0430 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0430. \u0417\u0430 \u0434\u0430 \u0433\u043E \u0432\u0438\u0434\u0438\u0448, \u0437\u0430\u043F\u0430\u0437\u0438 \u0438\u043B\u0438 \u0430\u043D\u0443\u043B\u0438\u0440\u0430\u0439 \u043F\u0440\u043E\u043C\u0435\u043D\u0438\u0442\u0435 \u0441\u0438 \u0438 \u043E\u043F\u0440\u0435\u0441\u043D\u0438 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0430\u0442\u0430.","WarningModelsWithCircularDependencies":"\u041D\u044F\u043A\u043E\u0438 \u043C\u043E\u0434\u0435\u043B\u0438 \u0438\u043C\u0430\u0442 \u043A\u0440\u044A\u0433\u043E\u0432\u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043C\u043E\u0441\u0442\u0438 \u0438 \u043D\u0435 \u0441\u0430 \u0437\u0430\u0440\u0435\u0434\u0435\u043D\u0438","LoadingModelErrorMessage":"\u0412\u044A\u0437\u043D\u0438\u043A\u043D\u0430 \u0433\u0440\u0435\u0448\u043A\u0430 \u043F\u043E \u0432\u0440\u0435\u043C\u0435 \u043D\u0430 \u0438\u0437\u043F\u044A\u043B\u043D\u0435\u043D\u0438\u0435 \u043D\u0430 \u0437\u0430\u044F\u0432\u043A\u0430\u0442\u0430"}}'),"zh-TW":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u8ACB\u5F9E\u6E05\u55AE\u4E2D\u9078\u64C7\u503C","SelectionWindowMessage":"\u8ACB\u5F9E\u5217\u8868\u4E2D\u9078\u64C7\u503C\u6216\u4F7F\u7528\u67E5\u8A62\u503C\u8996\u7A97\u9032\u884C\u641C\u7D22\u3002"},"Required":{"Message":"\u8F93\u5165\u503C"},"MaxLength":{"Message":"\u8D85\u8FC7\u6587\u672C\u957F\u5EA6\u9650\u5236({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u672A\u8FBE\u6587\u672C\u6700\u5C0F\u9650\u5236({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u65E5\u671F\u548C\u65F6\u95F4\u683C\u5F0F\u65E0\u6548"},"DatePickerSyntax":{"Message":"\u65E5\u671F\u683C\u5F0F\u65E0\u6548"},"TimePickerSyntax":{"Message":"\u65F6\u95F4\u683C\u5F0F\u65E0\u6548"},"RegExp":{"Message":"\u7121\u6548\u503C\u683C\u5F0F"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u4EE3\u78BC\u5FC5\u9808\u4EE5{{schemaNamePrefix}} \u524D\u7DB4\u958B\u59CB","OnlySchemaNamePrefixMessage":"\u6700\u5C11\u8F38\u51651\u500B\u7B26\u865F"},"SchemaNameAllowedSymbols":{"Message":"\u4F7F\u7528\u7B26\u865F\uFF1Aa-z\u3001A-Z\u30010-9\u3001\u5E95\u7DDA\u6216\u7834\u6298\u865F\u3002\u9996\u5B57\u7B26\u50C5\u53EF\u70BA\u5B57\u6BCD\u3002"}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u5217\u5DF2\u79FB\u9664","ValidationErrorMessageSingleErrorField":"\u6B04\u4F4D: {0}. \u932F\u8AA4: {1}","ValidationErrorMessageSeveralErrorFields":"\u6B04\u4F4D: {0}. \u932F\u8AA4: {1}","RefreshModelDataConflict":"Creatio \u5F53\u524D\u9875\u9762\u6570\u636E\u5DF2\u66F4\u6539\u3002\u8BF7\u4FDD\u5B58\u6216\u53D6\u6D88\u540E\uFF0C\u518D\u5237\u65B0\u672C\u9875\u9762\u4EE5\u67E5\u770B","WarningModelsWithCircularDependencies":"\u6709\u4E9B\u6A21\u578B\u6709\u5FAA\u73AF\u4F9D\u8D56\u5173\u7CFB\u5E76\u4E14\u6CA1\u6709\u88AB\u52A0\u8F7D","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"no-NO":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Vennligst velg verdi fra listen"},"Required":{"Message":"Angi en verdi"},"MaxLength":{"Message":"Maksimal tekstlengde er overskredet ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minste tekstlengde ikke n\xE5dd ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Ugyldig dato og klokkeslett format"},"DatePickerSyntax":{"Message":"Ugyldig datoformat"},"TimePickerSyntax":{"Message":"Ugyldig tidsformat"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Kolonne fjernet","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}"}}'),"ko-KR":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\uBAA9\uB85D\uC5D0\uC11C \uAC12\uC744 \uC120\uD0DD\uD558\uC2ED\uC2DC\uC624.","SelectionWindowMessage":"\uBAA9\uB85D\uC5D0\uC11C \uAC12\uC744 \uC120\uD0DD\uD558\uAC70\uB098 \uC870\uD68C \uCC3D\uC744 \uC0AC\uC6A9\uD558\uC5EC \uAC80\uC0C9\uD558\uC2ED\uC2DC\uC624"},"Required":{"Message":"\uAC12\uC744 \uC785\uB825\uD569\uB2C8\uB2E4"},"MaxLength":{"Message":"\uCD5C\uB300 \uD14D\uC2A4\uD2B8 \uAE38\uC774 \uCD08\uACFC({actualLength}/{maxLength})"},"MinLength":{"Message":"\uCD5C\uC18C \uD14D\uC2A4\uD2B8 \uAE38\uC774({{actualLength}/{{minLength}})\uC5D0 \uB3C4\uB2EC\uD558\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4."},"DatetimePickerSyntax":{"Message":"\uC798\uBABB\uB41C \uB0A0\uC9DC \uBC0F \uC2DC\uAC04 \uD615\uC2DD"},"DatePickerSyntax":{"Message":"\uC798\uBABB\uB41C \uB0A0\uC9DC \uD615\uC2DD"},"TimePickerSyntax":{"Message":"\uC798\uBABB\uB41C \uC2DC\uAC04 \uD615\uC2DD"},"RegExp":{"Message":"\uC798\uBABB\uB41C \uAC12 \uD615\uC2DD"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\uC5F4 \uC81C\uAC70","ValidationErrorMessageSingleErrorField":"\uD544\uB4DC: {0}. \uC624\uB958: {1}","ValidationErrorMessageSeveralErrorFields":"\uD544\uB4DC: {0}. \uC624\uB958: {1}","RefreshModelDataConflict":"Creatio\uC5D0\uB294 \uD604\uC7AC \uD398\uC774\uC9C0\uC5D0 \uB300\uD55C \uC0C8 \uB370\uC774\uD130\uAC00 \uC788\uC2B5\uB2C8\uB2E4. \uC774 \uB370\uC774\uD130\uB97C \uBCF4\uB824\uBA74 \uBCC0\uACBD \uC0AC\uD56D\uC744 \uC800\uC7A5\uD558\uAC70\uB098 \uCDE8\uC18C\uD558\uACE0 \uD398\uC774\uC9C0\uB97C \uC0C8\uB85C \uACE0\uCE69\uB2C8\uB2E4.","WarningModelsWithCircularDependencies":"\uC77C\uBD80 \uBAA8\uB378\uC5D0 \uC6D0\uD615 \uC885\uC18D\uC131\uC774 \uC788\uC5B4 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"ja-JP":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u30EA\u30B9\u30C8\u304B\u3089\u9805\u76EE\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044","SelectionWindowMessage":"\u30EA\u30B9\u30C8\u304B\u3089\u5024\u3092\u9078\u629E\u3059\u308B\u304B\u3001\u691C\u7D22\u7A93\u3088\u308A\u691C\u7D22\u3057\u3066\u304F\u3060\u3055\u3044"},"Required":{"Message":"\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044"},"MaxLength":{"Message":"\u6700\u5927\u6587\u5B57\u6570\u3092\u8D85\u3048\u307E\u3057\u305F ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u6700\u5C0F\u6587\u5B57\u6570\u306B\u9054\u3057\u3066\u3044\u307E\u305B\u3093 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u65E5\u4ED8\u3068\u6642\u523B\u306E\u5F62\u5F0F\u304C\u6B63\u3057\u304F\u3042\u308A\u307E\u305B\u3093"},"DatePickerSyntax":{"Message":"\u7121\u52B9\u306A\u65E5\u4ED8\u30D5\u30A9\u30FC\u30DE\u30C3\u30C8"},"TimePickerSyntax":{"Message":"\u7121\u52B9\u306A\u6642\u9593\u5F62\u5F0F\u3067\u3059"},"RegExp":{"Message":"\u5024\u306E\u5F62\u5F0F\u304C\u7121\u52B9\u3067\u3059"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u5217\u304C\u524A\u9664\u3055\u308C\u307E\u3057\u305F","ValidationErrorMessageSingleErrorField":"\u30D5\u30A3\u30FC\u30EB\u30C9: {0}. \u30A8\u30E9\u30FC: {1}","ValidationErrorMessageSeveralErrorFields":"\u30D5\u30A3\u30FC\u30EB\u30C9: {0}. \u30A8\u30E9\u30FC: {1}","RefreshModelDataConflict":"Creatio\u306B\u306F\u73FE\u5728\u306E\u30DA\u30FC\u30B8\u306B\u65B0\u3057\u3044\u30C7\u30FC\u30BF\u304C\u3042\u308A\u307E\u3059\u3002 \u5909\u66F4\u3092\u8868\u793A\u3059\u308B\u306B\u306F\u3001\u4FDD\u5B58\u307E\u305F\u306F\u30AD\u30E3\u30F3\u30BB\u30EB\u3057\u3066\u30DA\u30FC\u30B8\u3092\u66F4\u65B0\u3057\u3066\u304F\u3060\u3055\u3044\u3002","WarningModelsWithCircularDependencies":"\u4E00\u90E8\u306E\u30E2\u30C7\u30EB\u306B\u306F\u5FAA\u74B0\u4F9D\u5B58\u95A2\u4FC2\u304C\u3042\u308A\u3001\u8AAD\u307F\u8FBC\u307E\u308C\u3066\u3044\u307E\u305B\u3093","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"fr-CA":JSON.parse(`{"Validators":{"Autocomplete":{"Message":"Merci de s\xE9lectionner la valeur dans la liste"},"Required":{"Message":"Saisir une valeur"},"MaxLength":{"Message":"Longueur maximale du texte d\xE9pass\xE9e ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Longueur de texte minimale non atteinte ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Format de date et d'heure non valide"},"DatePickerSyntax":{"Message":"Format de date invalide"},"TimePickerSyntax":{"Message":"Format d'heure non valide"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed"}}`),zh:JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list"},"Required":{"Message":"Enter a value"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed"}}'),"vi-VN":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Vui l\xF2ng ch\u1ECDn gi\xE1 tr\u1ECB t\u1EEB danh s\xE1ch","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Nh\u1EADp m\u1ED9t gi\xE1 tr\u1ECB"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"tr-TR":JSON.parse('{"Validators":{"Autocomplete":{"Message":"L\xFCtfen listeden de\u011Fer se\xE7in","SelectionWindowMessage":"L\xFCtfen listeden de\u011Fer se\xE7in veya arama penceresini kullanarak aray\u0131n"},"Required":{"Message":"De\u011Fer girin"},"MaxLength":{"Message":"Maksimum metin uzunlu\u011Fu a\u015F\u0131ld\u0131 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum metin uzunlu\u011Funa ula\u015F\u0131lamad\u0131 ({{ActuAlghength}}/{{MinLength}})"},"DatetimePickerSyntax":{"Message":"Ge\xE7ersiz Tarih ve Saat Bi\xE7imi"},"DatePickerSyntax":{"Message":"Ge\xE7ersiz tarih bi\xE7imi"},"TimePickerSyntax":{"Message":"Ge\xE7ersiz Zaman Bi\xE7imi"},"RegExp":{"Message":"Ge\xE7ersiz de\u011Fer bi\xE7imi"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kod {{schemanameprefix}} \xF6neki ile ba\u015Flamal\u0131d\u0131r.","OnlySchemaNamePrefixMessage":"En az bir sembol daha girin."},"SchemaNameAllowedSymbols":{"Message":"Sembolleri kullan\u0131n: A-Z, A-Z, 0-9, alt \xE7izgi veya \xE7izgi.\u0130lk \xF6nce sadece harfler olabilir."}},"BaseViewModel":{"DataSourceAttributeRemoved":"S\xFCtun kald\u0131r\u0131ld\u0131","ValidationErrorMessageSingleErrorField":"Alan: {0}.Hata: {1}","ValidationErrorMessageSeveralErrorFields":"Alanlar: {0}.Hata: {1}","RefreshModelDataConflict":"Creatio, ge\xE7erli sayfa i\xE7in yeni verilere sahiptir.G\xF6r\xFCnt\xFClemek i\xE7in de\u011Fi\u015Fikliklerinizi kaydedin veya iptal edin ve sayfay\u0131 yenileyin.","WarningModelsWithCircularDependencies":"Baz\u0131 modellerin dairesel ba\u011F\u0131ml\u0131l\u0131klar\u0131 vard\u0131r ve y\xFCklenmemi\u015Ftir","LoadingModelErrorMessage":"Sorgu y\xFCr\xFCtme s\u0131ras\u0131nda hata olu\u015Ftu"}}'),"th-TH":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"\u0E1B\u0E49\u0E2D\u0E19\u0E04\u0E48\u0E32"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"sv-SE":JSON.parse('{"Validators":{"Autocomplete":{"Message":"V\xE4nligen v\xE4lj v\xE4rde ur listan","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Ange ett v\xE4rde"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"ro-RO":JSON.parse('{"Validators":{"Autocomplete":{"Message":"V\u0103 rug\u0103m s\u0103 selecta\u021Bi valoarea din list\u0103","SelectionWindowMessage":"V\u0103 rug\u0103m s\u0103 selecta\u0163i valoarea din list\u0103 sau s\u0103 c\u0103uta\u0163i folosind fereastra lookup-ului"},"Required":{"Message":"Introdu o valoare"},"MaxLength":{"Message":"Lungimea maxim\u0103 a textului a fost dep\u0103\u0219it\u0103 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Lungimea minim\u0103 a textului nu a fost atins\u0103 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Format dat\u0103 \u0219i or\u0103 invalid"},"DatePickerSyntax":{"Message":"Format dat\u0103 invalid"},"TimePickerSyntax":{"Message":"Format orar invalid"},"RegExp":{"Message":"Format valoare invalid"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Codul trebuie s\u0103 \xEEnceap\u0103 cu {{schemaNamePrefix}}  prefix.","OnlySchemaNamePrefixMessage":"Introduce\u021Bi cel pu\u021Bin \xEEnc\u0103 un simbol."},"SchemaNameAllowedSymbols":{"Message":"Folosi\u021Bi simbolurile: a-z, A-Z, 0-9, underscore sau dash. Doar litere pot fi primul."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Coloan\u0103 eliminat\u0103","ValidationErrorMessageSingleErrorField":"C\xE2mp: {0}. Eroare: {1}","ValidationErrorMessageSeveralErrorFields":"C\xE2mpuri: {0}. Eroare: {1}","RefreshModelDataConflict":"Creatio are date noi pentru pagina curent\u0103. Pentru a o vizualiza, salva\u021Bi sau anula\u021Bi modific\u0103rile \u0219i re\xEEmprosp\u0103ta\u021Bi pagina.","WarningModelsWithCircularDependencies":"Unele modele au dependen\u021Be circulare \u0219i nu au fost \xEEnc\u0103rcate","LoadingModelErrorMessage":"A ap\u0103rut o eroare \xEEn timpul execut\u0103rii interog\u0103rii"}}'),"pt-PT":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Selecione um valor da lista","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Insira um valor"},"MaxLength":{"Message":"Limite m\xE1ximo de texto excedido ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Limite m\xEDnimo de texto n\xE3o alcan\xE7ado ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Formado de data e hora inv\xE1lido"},"DatePickerSyntax":{"Message":"Formato de data inv\xE1lido"},"TimePickerSyntax":{"Message":"Formato de hora inv\xE1lido"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Coluna removida","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"pt-BR":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Favor, selecionar um valor da lista","SelectionWindowMessage":"Selecionar o valor na lista ou pesquisar utilizando a janela de pesquisas"},"Required":{"Message":"Inserir um valor"},"MaxLength":{"Message":"Comprimento m\xE1ximo de texto excedido ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Comprimento m\xEDnimo do texto n\xE3o atingido ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Formato de data e hora inv\xE1lido"},"DatePickerSyntax":{"Message":"Formato de data inv\xE1lido"},"TimePickerSyntax":{"Message":"Formato de hora inv\xE1lido"},"RegExp":{"Message":"Formato de valor inv\xE1lido"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"O c\xF3digo deve come\xE7ar com o prefixo \\"{{schemaNamePrefix}}\\"","OnlySchemaNamePrefixMessage":"Inserir ao menos mais um s\xEDmbolo."},"SchemaNameAllowedSymbols":{"Message":"Usar os s\xEDmbolos: a-z, A-Z, 0-9, sublinhados ou tra\xE7os. Apenas letras podem vir primeiramente."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Coluna removida","ValidationErrorMessageSingleErrorField":"Campo: {0}. Erro: {1}","ValidationErrorMessageSeveralErrorFields":"Campos: {0}. Erro: {1}","RefreshModelDataConflict":"Creatio tem novos dados para a p\xE1gina atual. Para visualiz\xE1-los, salvar ou cancelar as suas altera\xE7\xF5es e atualizar a p\xE1gina.","WarningModelsWithCircularDependencies":"Alguns modelos t\xEAm depend\xEAncias circulares e n\xE3o foram carregadas","LoadingModelErrorMessage":"Ocorreu um erro durante a execu\xE7\xE3o da query"}}'),"pl-PL":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Wybierz warto\u015B\u0107 z listy","SelectionWindowMessage":"Prosz\u0119 wybra\u0107 warto\u015B\u0107 z listy lub wyszuka\u0107 za pomoc\u0105 okna wyszukiwania"},"Required":{"Message":"Wpisz warto\u015B\u0107"},"MaxLength":{"Message":"Przekroczono maksymaln\u0105 d\u0142ugo\u015B\u0107 tekstu ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimalna d\u0142ugo\u015B\u0107 tekstu nie zosta\u0142a osi\u0105gni\u0119ta ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Nieprawid\u0142owy format daty i godziny"},"DatePickerSyntax":{"Message":"Nieprawid\u0142owy format daty"},"TimePickerSyntax":{"Message":"Nieprawid\u0142owy format czasu"},"RegExp":{"Message":"Nieprawid\u0142owy format warto\u015Bci"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kod musi zaczyna\u0107 si\u0119 od prefiksu \\"{{schemaNamePrefix}}\\"","OnlySchemaNamePrefixMessage":"Wprowad\u017A co najmniej jeden dodatkowy symbol."},"SchemaNameAllowedSymbols":{"Message":"U\u017Cyj symboli: a-z, A-Z, 0-9, podkre\u015Blenie lub my\u015Blnik. Tylko litery mog\u0105 by\u0107 pierwsze."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Kolumna usuni\u0119ta","ValidationErrorMessageSingleErrorField":"Pola: {0}. B\u0142\u0105d: {1}","ValidationErrorMessageSeveralErrorFields":"Pola: {0}. B\u0142\u0105d: {1}","RefreshModelDataConflict":"Creatio ma nowe dane dla bie\u017C\u0105cej strony. Aby je wy\u015Bwietli\u0107, zapisz lub anuluj zmiany i od\u015Bwie\u017C stron\u0119.","WarningModelsWithCircularDependencies":"Niekt\xF3re modele maj\u0105 cykliczne zale\u017Cno\u015Bci i nie zosta\u0142y za\u0142adowane","LoadingModelErrorMessage":"Wyst\u0105pi\u0142 b\u0142\u0105d podczas wykonywania zapytania"}}'),no:JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list"},"Required":{"Message":"Enter a value"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed"}}'),"nl-NL":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Selecteer een waarde uit de lijst","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Voer een waarde in"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"lv-LV":JSON.parse('{"Validators":{"Autocomplete":{"Message":"L\u016Bdzu, izv\u0113lieties v\u0113rt\u012Bbu no saraksta","SelectionWindowMessage":"L\u016Bdzu, izv\u0113lieties v\u0113rt\u012Bbu no saraksta vai mekl\u0113jiet, izmantojot logu"},"Required":{"Message":"Ievadiet v\u0113rt\u012Bbu"},"MaxLength":{"Message":"P\u0101rsniegts maksim\u0101lais teksta garums ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minim\u0101lais teksta garums nav sasniegts ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Neder\u012Bgs datuma un laika form\u0101ts"},"DatePickerSyntax":{"Message":"Neder\u012Bgs datu form\u0101ts"},"TimePickerSyntax":{"Message":"Neder\u012Bgs laika form\u0101ts"},"RegExp":{"Message":"Neder\u012Bgs v\u0113rt\u012Bbu form\u0101ts"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kodam j\u0101s\u0101kas ar \\"{{schemaNamePrefix}}\\" prefiksu.","OnlySchemaNamePrefixMessage":"Ievadiet vismaz vienu simbolu."},"SchemaNameAllowedSymbols":{"Message":"Izmantojiet simbolus: a-z, A-Z, 0-9, pasv\u012Btrojums vai domuz\u012Bme. Tikai burti var b\u016Bt pirmie."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Kolonna no\u0146emta","ValidationErrorMessageSingleErrorField":"Lauka: {0}. K\u013C\u016Bda: {1}","ValidationErrorMessageSeveralErrorFields":"Lauki: {0}. K\u013C\u016Bda: {1}","RefreshModelDataConflict":"Creatio ir jauni dati pa\u0161reiz\u0113jai lapai. Lai tos apskat\u012Btu, saglab\u0101jiet vai atceliet savas izmai\u0146as un atjaunojiet lapu.","WarningModelsWithCircularDependencies":"Da\u017Eiem mode\u013Ciem ir apa\u013Cas atkar\u012Bbas un tie nav iel\u0101d\u0113ti","LoadingModelErrorMessage":"K\u013C\u016Bda notika vaic\u0101juma izpildes laik\u0101"}}'),"kk-KZ":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list"},"Required":{"Message":"Enter a value"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}"}}'),"it-IT":JSON.parse(`{"Validators":{"Autocomplete":{"Message":"Seleziona il valore dalla lista","SelectionWindowMessage":"Seleziona il valore dalla lista o cercalo usando la finestra di lookup"},"Required":{"Message":"Inserisci un valore"},"MaxLength":{"Message":"Lunghezza massima del testo superata ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Lunghezza minima del testo non raggiunta ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Formato data e ora non valido"},"DatePickerSyntax":{"Message":"Formato data non valido"},"TimePickerSyntax":{"Message":"Formato orario non valido"},"RegExp":{"Message":"Formato valore non valido"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Il codice deve iniziare con il prefisso {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"Inserisci almeno un altro simbolo."},"SchemaNameAllowedSymbols":{"Message":"Usa i simboli: a-z, A-Z, 0-9, trattino basso o trattino. Solo le lettere possono essere le prime."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Colonna rimossa","ValidationErrorMessageSingleErrorField":"Campo: {0}. Errore: {1}","ValidationErrorMessageSeveralErrorFields":"Campi: {0}. Errore: {1}","RefreshModelDataConflict":"Creatio ha nuovi dati per la pagina corrente. Per visualizzarli, salva o annulla le modifiche e aggiorna la pagina.","WarningModelsWithCircularDependencies":"Alcuni modelli hanno dipendenze circolari e non sono stati caricati","LoadingModelErrorMessage":"Errore durante l'esecuzione della query"}}`),"id-ID":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Silakan pilih nilai dari daftar","SelectionWindowMessage":"Pilih nilai dari daftar atau cari menggunakan jendela pencarian"},"Required":{"Message":"Masukkan nilai"},"MaxLength":{"Message":"Panjang teks maksimum terlampaui ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Panjang teks minimum tidak tercapai ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Format tanggal dan waktu tidak valid"},"DatePickerSyntax":{"Message":"Format tanggal tidak valid"},"TimePickerSyntax":{"Message":"Format waktu tidak valid"},"RegExp":{"Message":"Format nilai tidak valid"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Kode harus dimulai dengan awalan {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"Masukkan minimal satu simbol lagi."},"SchemaNameAllowedSymbols":{"Message":"Gunakan simbol: a-z, A-Z, 0-9, garis bawah atau tanda hubung. Hanya huruf yang bisa menjadi yang pertama."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Kolom dihapus","ValidationErrorMessageSingleErrorField":"Bidang {0}. Kesalahan: {1}","ValidationErrorMessageSeveralErrorFields":"Bidang {0}. Kesalahan: {1}","RefreshModelDataConflict":"Creatio memiliki data baru untuk halaman saat ini. Untuk melihatnya, simpan atau batalkan perubahan Anda dan perbarui halaman.","WarningModelsWithCircularDependencies":"Beberapa model memiliki referensi melingkar dan belum dimuat","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"he-IL":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u05D0\u05E0\u05D0 \u05D1\u05D7\u05E8 \u05E2\u05E8\u05DA \u05DE\u05D4\u05E8\u05E9\u05D9\u05DE\u05D4","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"\u05D4\u05D6\u05DF \u05E2\u05E8\u05DA"},"MaxLength":{"Message":"\u05D7\u05E8\u05D9\u05D2\u05D4 \u05DE\u05D0\u05D5\u05E8\u05DA \u05D4\u05D8\u05E7\u05E1\u05D8 \u05D4\u05DE\u05E8\u05D1\u05D9 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u05DC\u05D0 \u05D4\u05D5\u05E9\u05D2 \u05D0\u05D5\u05E8\u05DA \u05D4\u05D8\u05E7\u05E1\u05D8 \u05D4\u05DE\u05D9\u05E0\u05D9\u05DE\u05DC\u05D9 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u05E4\u05D5\u05E8\u05DE\u05D8 \u05EA\u05D0\u05E8\u05D9\u05DA \u05D5\u05E9\u05E2\u05D4 \u05DC\u05D0 \u05D7\u05D5\u05E7\u05D9"},"DatePickerSyntax":{"Message":"\u05E4\u05D5\u05E8\u05DE\u05D8 \u05EA\u05D0\u05E8\u05D9\u05DA \u05DC\u05D0 \u05E0\u05DB\u05D5\u05DF"},"TimePickerSyntax":{"Message":"\u05E4\u05D5\u05E8\u05DE\u05D8 \u05D6\u05DE\u05DF \u05DC\u05D0 \u05D7\u05D5\u05E7\u05D9"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u05D4\u05E7\u05D5\u05D3 \u05D7\u05D9\u05D9\u05D1 \u05DC\u05D4\u05EA\u05D7\u05D9\u05DC \u05E2\u05DD \u05D4\u05E7\u05D9\u05D3\u05D5\u05DE\u05EA {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"\u05D4\u05D6\u05DF \u05DC\u05E4\u05D7\u05D5\u05EA \u05EA\u05D5 \u05E0\u05D5\u05E1\u05E3 \u05D0\u05D7\u05D3."},"SchemaNameAllowedSymbols":{"Message":"\u05D4\u05E9\u05EA\u05DE\u05E9 \u05D1\u05E1\u05DE\u05DC\u05D9\u05DD: a-z, A-Z, 0-9, \u05E7\u05D5 \u05EA\u05D7\u05EA\u05D9 \u05D0\u05D5 \u05DE\u05E7\u05E3. \u05E8\u05E7 \u05D0\u05D5\u05EA\u05D9\u05D5\u05EA \u05D9\u05DB\u05D5\u05DC\u05D5\u05EA \u05DC\u05D4\u05D9\u05D5\u05EA \u05E8\u05D0\u05E9\u05D5\u05E0\u05D5\u05EA."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u05D4\u05E2\u05DE\u05D5\u05D3\u05D4 \u05D4\u05D5\u05E1\u05E8\u05D4","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"\u05D0\u05D9\u05E8\u05E2\u05D4 \u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05DE\u05D4\u05DC\u05DA \u05D1\u05D9\u05E6\u05D5\u05E2 \u05D4\u05E9\u05D0\u05D9\u05DC\u05EA\u05D4"}}'),"fr-FR":JSON.parse(`{"Validators":{"Autocomplete":{"Message":"Merci de s\xE9lectionner la valeur dans la liste","SelectionWindowMessage":"Merci de s\xE9lectionner une valeur dans la liste ou rechercher \xE0 l'aide de la fen\xEAtre de recherche"},"Required":{"Message":"Saisir une valeur"},"MaxLength":{"Message":"Longueur maximale du texte d\xE9pass\xE9e ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Longueur de texte minimale non atteinte ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Format de date et d'heure non valide"},"DatePickerSyntax":{"Message":"Format de date invalide"},"TimePickerSyntax":{"Message":"Format d'heure non valide"},"RegExp":{"Message":"Format de valeur invalide"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Le code doit commencer par le pr\xE9fixe \\"{{schemaNamePrefix}}\\"","OnlySchemaNamePrefixMessage":"Entrez au moins un symbole de plus."},"SchemaNameAllowedSymbols":{"Message":"Utilisez des symboles : a-z, A-Z, 0-9, tiret bas ou tiret. Seules les lettres peuvent \xEAtre en premier."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Colonne supprim\xE9e","ValidationErrorMessageSingleErrorField":"Champ: {0}. Erreur: {1}","ValidationErrorMessageSeveralErrorFields":"Champs : {0}. Erreur: {1}","RefreshModelDataConflict":"Creatio a de nouvelles donn\xE9es pour la page en cours. Pour les visualiser, enregistrez ou annulez vos modifications et actualisez la page.","WarningModelsWithCircularDependencies":"Certains mod\xE8les disposent de d\xE9pendances circulaires et n'ont pas \xE9t\xE9 charg\xE9s","LoadingModelErrorMessage":"Une erreur s'est produite lors de l'ex\xE9cution de la requ\xEAte"}}`),"fa-IR":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list"},"Required":{"Message":"\u06CC\u06A9 \u0645\u0642\u062F\u0627\u0631 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}"}}'),"es-ES":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Seleccione un valor de la lista","SelectionWindowMessage":"Por favor, seleccione el valor de la lista o busque usando la ventana de b\xFAsqueda"},"Required":{"Message":"Ingrese valor"},"MaxLength":{"Message":"Se super\xF3 la longitud m\xE1xima del texto ({{actualLength}} / {{maxLength}})"},"MinLength":{"Message":"No se alcanz\xF3 la longitud m\xEDnima del texto ({{actualLength}} / {{minLength}})"},"DatetimePickerSyntax":{"Message":"Formato de fecha y hora inv\xE1lido"},"DatePickerSyntax":{"Message":"Formato de fecha inv\xE1lido"},"TimePickerSyntax":{"Message":"Formato de hora inv\xE1lido"},"RegExp":{"Message":"Formato de valor inv\xE1lido"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"El c\xF3digo debe comenzar con el prefijo \\"{{schemaNamePrefix}}\\".","OnlySchemaNamePrefixMessage":"Ingrese al menos un s\xEDmbolo m\xE1s."},"SchemaNameAllowedSymbols":{"Message":"Use s\xEDmbolos: a-z, A-Z, 0-9, guion bajo o guion. Solo las letras pueden ser las primeras."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Columna eliminada","ValidationErrorMessageSingleErrorField":"Campo: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Campos: {0}. Error: {1}","RefreshModelDataConflict":"Creatio tiene nuevos datos para la p\xE1gina actual. Para verlo, guarde o cancele los cambios y actualice la p\xE1gina.","WarningModelsWithCircularDependencies":"Algunos modelos tienen dependencias circulares y no han sido cargados","LoadingModelErrorMessage":"Se produjo un error durante la ejecuci\xF3n de la consulta"}}'),"de-DE":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Bitte w\xE4hlen Sie einen Wert aus der Liste","SelectionWindowMessage":"Bitte w\xE4hlen Sie den Wert aus der Liste oder suchen Sie im Suchfenster"},"Required":{"Message":"Wert eingeben"},"MaxLength":{"Message":"Maximale Textl\xE4nge \xFCberschritten ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimale Textl\xE4nge nicht erreicht ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Ung\xFCltiges Datums- und Zeitformat"},"DatePickerSyntax":{"Message":"Ung\xFCltiges Datumsformat"},"TimePickerSyntax":{"Message":"Ung\xFCltiges Zeitformat"},"RegExp":{"Message":"Ung\xFCltiges Wertformat"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code muss mit dem {{schemaNamePrefix}} Pr\xE4fix beginnen.","OnlySchemaNamePrefixMessage":"Geben Sie mindestens ein weiteres Zeichen ein."},"SchemaNameAllowedSymbols":{"Message":"Symbole verwenden: a-z, A-Z, 0-9, Unterstrich oder Bindestrich. Das erste Zeichen muss ein Buchstabe sein."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Spalte entfernt","ValidationErrorMessageSingleErrorField":"Felder: {0}. Fehler: {1}","ValidationErrorMessageSeveralErrorFields":"Felder: {0}. Fehler: {1}","RefreshModelDataConflict":"Creatio hat neue Daten f\xFCr die aktuelle Seite. Um sie anzuzeigen, speichern oder l\xF6schen Sie Ihre \xC4nderungen und aktualisieren Sie die Seite.","WarningModelsWithCircularDependencies":"Einige Modelle haben zirkul\xE4re Abh\xE4ngigkeiten und wurden nicht geladen","LoadingModelErrorMessage":"Fehler bei der Ausf\xFChrung der Abfrage"}}'),"cs-CZ":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Vyberte pros\xEDm hodnotu ze seznamu","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Zadejte hodnotu"},"MaxLength":{"Message":"Byla p\u0159ekro\u010Dena maxim\xE1ln\xED d\xE9lka textu ({{Aktu\xE1ln\xEDD\xE9lka}}/{{Maxim\xE1ln\xEDD\xE9lka}})"},"MinLength":{"Message":"Nebyla dosa\u017Eena minim\xE1ln\xED d\xE9lka textu ({{Aktu\xE1ln\xEDD\xE9lka}}/{{Minim\xE1ln\xEDD\xE9lka}})"},"DatetimePickerSyntax":{"Message":"Neplatn\xFD form\xE1t data a \u010Dasu"},"DatePickerSyntax":{"Message":"Neplatn\xFD form\xE1t data"},"TimePickerSyntax":{"Message":"Neplatn\xFD form\xE1t \u010Dasu"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"ar-SA":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u0642\u064A\u0645\u0629 \u0645\u0646 \u0627\u0644\u0642\u0627\u0626\u0645\u0629","SelectionWindowMessage":"\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u0642\u064A\u0645\u0629 \u0645\u0646 \u0627\u0644\u0642\u0627\u0626\u0645\u0629 \u0623\u0648 \u0627\u0644\u0628\u062D\u062B \u0628\u0627\u0633\u062A\u062E\u062F\u0627\u0645 \u0646\u0627\u0641\u0630\u0629 \u0627\u0644\u0628\u062D\u062B"},"Required":{"Message":"\u0627\u062F\u062E\u0644 \u0642\u064A\u0645\u0629"},"MaxLength":{"Message":"\u062A\u062C\u0627\u0648\u0632 \u0627\u0644\u062D\u062F \u0627\u0644\u0623\u0642\u0635\u0649 \u0644\u0637\u0648\u0644 \u0627\u0644\u0646\u0635 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u0644\u0645 \u064A\u062A\u0645 \u0628\u0644\u0648\u063A \u0627\u0644\u062D\u062F \u0627\u0644\u0623\u062F\u0646\u0649 \u0644\u0637\u0648\u0644 \u0627\u0644\u0646\u0635 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u062A\u0646\u0633\u064A\u0642 \u0627\u0644\u062A\u0627\u0631\u064A\u062E \u0648\u0627\u0644\u0648\u0642\u062A \u063A\u064A\u0631 \u0635\u0627\u0644\u062D"},"DatePickerSyntax":{"Message":"\u062A\u0646\u0633\u064A\u0642 \u0627\u0644\u062A\u0627\u0631\u064A\u062E \u063A\u064A\u0631 \u0635\u0627\u0644\u062D"},"TimePickerSyntax":{"Message":"\u062A\u0646\u0633\u064A\u0642 \u0627\u0644\u0648\u0642\u062A \u063A\u064A\u0631 \u0635\u0627\u0644\u062D"},"RegExp":{"Message":"\u062A\u0646\u0633\u064A\u0642 \u0627\u0644\u0642\u064A\u0645\u0629 \u063A\u064A\u0631 \u0635\u0627\u0644\u062D"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u064A\u062C\u0628 \u0623\u0646 \u064A\u0628\u062F\u0623 \u0627\u0644\u0631\u0645\u0632 \u0628\u0628\u0627\u062F\u0626\u0629 {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"\u0623\u062F\u062E\u0644 \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644 \u0631\u0645\u0632 \u0625\u0636\u0627\u0641\u064A \u0648\u0627\u062D\u062F."},"SchemaNameAllowedSymbols":{"Message":"\u0627\u0633\u062A\u062E\u062F\u0645 \u0627\u0644\u0631\u0645\u0648\u0632: a-z\u060C \u0623\u0648 A-Z \u0623\u0648 0-9 (_) \u0623\u0648 (-). \u0648\u064A\u0645\u0643\u0646 \u0641\u0642\u0637 \u0644\u0644\u062D\u0631\u0648\u0641 \u0623\u0646 \u062A\u0643\u0648\u0646 \u0623\u0648\u0644\u064B\u0627."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u0639\u0645\u0648\u062F","ValidationErrorMessageSingleErrorField":"\u0627\u0644\u062D\u0642\u0644: {0}. \u0627\u0644\u062E\u0637\u0623: {1}","ValidationErrorMessageSeveralErrorFields":"\u0627\u0644\u062D\u0642\u0648\u0644: {0}. \u0627\u0644\u062E\u0637\u0623: {1}","RefreshModelDataConflict":"\u0644\u062F\u0649 Creatio \u0628\u064A\u0627\u0646\u0627\u062A \u062C\u062F\u064A\u062F\u0629 \u0644\u0644\u0635\u0641\u062D\u0629 \u0627\u0644\u062D\u0627\u0644\u064A\u0629. \u0644\u0639\u0631\u0636\u0647\u0627\u060C \u064A\u062C\u0628 \u062D\u0641\u0638 \u0623\u0648 \u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u062A\u063A\u064A\u064A\u0631\u0627\u062A \u0627\u0644\u062E\u0627\u0635\u0629 \u0628\u0643 \u0648\u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0635\u0641\u062D\u0629.","WarningModelsWithCircularDependencies":"\u0628\u0639\u0636 \u0627\u0644\u0646\u0645\u0627\u0630\u062C \u0644\u0647\u0627 \u062A\u0628\u0639\u064A\u0627\u062A \u062F\u0627\u0626\u0631\u064A\u0629 \u0648\u0644\u0645 \u064A\u062A\u0645 \u062A\u062D\u0645\u064A\u0644\u0647\u0627","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"en-US":JSON.parse('{"Validators":{"Autocomplete":{"Message":"Please select value from the list","SelectionWindowMessage":"Please select value from the list or search using the lookup window"},"Required":{"Message":"Enter a value"},"MaxLength":{"Message":"Maximum text length exceeded ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"Minimum text length not reached ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"Invalid date and time format"},"DatePickerSyntax":{"Message":"Invalid date format"},"TimePickerSyntax":{"Message":"Invalid time format"},"RegExp":{"Message":"Invalid value format"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"Code must start with the {{schemaNamePrefix}} prefix.","OnlySchemaNamePrefixMessage":"Enter at least one more symbol."},"SchemaNameAllowedSymbols":{"Message":"Use symbols: a-z, A-Z, 0-9, underscore or dash. Only letters can be first."}},"BaseViewModel":{"DataSourceAttributeRemoved":"Column removed","ValidationErrorMessageSingleErrorField":"Field: {0}. Error: {1}","ValidationErrorMessageSeveralErrorFields":"Fields: {0}. Error: {1}","RefreshModelDataConflict":"Creatio has new data for the current page. To view it, save or cancel your changes and refresh the page.","WarningModelsWithCircularDependencies":"Some models have circular dependencies and have not been loaded","LoadingModelErrorMessage":"Error occurred during the query execution"}}'),"ru-RU":JSON.parse('{"Validators":{"Autocomplete":{"Message":"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 \u0438\u0437 \u0441\u043F\u0438\u0441\u043A\u0430","SelectionWindowMessage":"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 \u0438\u0437 \u0441\u043F\u0438\u0441\u043A\u0430 \u0438\u043B\u0438 \u043E\u043A\u043D\u0430 \u0432\u044B\u0431\u043E\u0440\u0430"},"Required":{"Message":"\u041D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0443\u043A\u0430\u0437\u0430\u0442\u044C \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435"},"MaxLength":{"Message":"\u041F\u0440\u0435\u0432\u044B\u0448\u0435\u043D\u0430 \u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u0430\u044F \u0434\u043B\u0438\u043D\u0430 \u0442\u0435\u043A\u0441\u0442\u0430 ({{actualLength}}/{{maxLength}})"},"MinLength":{"Message":"\u041D\u0435 \u0434\u043E\u0441\u0442\u0438\u0433\u043D\u0443\u0442\u0430 \u0434\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u0430\u044F \u0434\u043B\u0438\u043D\u0430 \u0442\u0435\u043A\u0441\u0442\u0430 ({{actualLength}}/{{minLength}})"},"DatetimePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0434\u0430\u0442\u044B \u0438 \u0432\u0440\u0435\u043C\u0435\u043D\u0438"},"DatePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0434\u0430\u0442\u044B"},"TimePickerSyntax":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0432\u0440\u0435\u043C\u0435\u043D\u0438"},"RegExp":{"Message":"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F"},"SchemaNamePrefix":{"NoSchemaNamePrefixMessage":"\u041A\u043E\u0434 \u0434\u043E\u043B\u0436\u0435\u043D \u043D\u0430\u0447\u0438\u043D\u0430\u0442\u044C\u0441\u044F \u0441 \u043F\u0440\u0435\u0444\u0438\u043A\u0441\u0430 {{schemaNamePrefix}}.","OnlySchemaNamePrefixMessage":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0445\u043E\u0442\u044F \u0431\u044B \u0435\u0449\u0435 \u043E\u0434\u0438\u043D \u0441\u0438\u043C\u0432\u043E\u043B."},"SchemaNameAllowedSymbols":{"Message":"\u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 a-z, A-Z, 0-9, \u043D\u0438\u0436\u043D\u0435\u0435 \u043F\u043E\u0434\u0447\u0435\u0440\u043A\u0438\u0432\u0430\u043D\u0438\u0435 \u0438\u043B\u0438 \u0442\u0438\u0440\u0435. \u0422\u043E\u043B\u044C\u043A\u043E \u0431\u0443\u043A\u0432\u044B \u043C\u043E\u0433\u0443\u0442 \u0431\u044B\u0442\u044C \u043F\u0435\u0440\u0432\u044B\u043C\u0438."}},"BaseViewModel":{"DataSourceAttributeRemoved":"\u041A\u043E\u043B\u043E\u043D\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0430","ValidationErrorMessageSingleErrorField":"\u041F\u043E\u043B\u0435: {0}. \u041E\u0448\u0438\u0431\u043A\u0430: {1}","ValidationErrorMessageSeveralErrorFields":"\u041F\u043E\u043B\u044F: {0}. \u041E\u0448\u0438\u0431\u043A\u0430: {1}","RefreshModelDataConflict":"\u0412 \u0441\u0438\u0441\u0442\u0435\u043C\u0435 \u0435\u0441\u0442\u044C \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435 \u0434\u043B\u044F \u0442\u0435\u043A\u0443\u0449\u0435\u0439 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u044B. \u0427\u0442\u043E\u0431\u044B \u0438\u0445 \u043E\u0442\u043E\u0431\u0440\u0430\u0437\u0438\u0442\u044C. \u0441\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u0435 \u0438\u043B\u0438 \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u0435 \u0432\u043D\u0435\u0441\u0435\u043D\u043D\u044B\u0435 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0438 \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443.","WarningModelsWithCircularDependencies":"\u041D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u043C\u043E\u0434\u0435\u043B\u0438 \u0438\u043C\u0435\u044E\u0442 \u0446\u0438\u043A\u043B\u0438\u0447\u0435\u0441\u043A\u0438\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043C\u043E\u0441\u0442\u0438 \u0438 \u043D\u0435 \u0431\u044B\u043B\u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u044B","LoadingModelErrorMessage":"\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0438 \u0437\u0430\u043F\u0440\u043E\u0441\u0430"}}')};var ae=a(59131);let te=class qe{static{this.\u0275fac=function(se){return new(se||qe)}}static{this.\u0275mod=ae.\u0275\u0275defineNgModule({type:qe})}static{this.\u0275inj=ae.\u0275\u0275defineInjector({providers:[h.LZ,h._h,o.n,C.ff,O.FeatureService,{provide:C.dX,useClass:y.C},{provide:E.k,useClass:E.e},{provide:L.d,useClass:L.X},P.USER_INFO_PROVIDER,h.J_,P.ResourceFinderService,C.e3,{provide:c.LL,useClass:C.Z$},{provide:v.C_,useValue:P.DefaultZones.Root},{provide:P.CRT_NAVIGATION_LOCK_TOKEN,useValue:P.CrtNoopNavigationLock.instance},_.b,C.iQ,h.DC,h.yf],imports:[m.CommonModule,M.ReactiveFormsModule,C.qG,F.CrtLibTranslateModule.forRoot({i18n:re}),x.BusinessRulesModule,T.ExpressionEngineModule]})}};te=(0,s.__decorate)([(0,O.CrtModule)({includes:[T.ExpressionEngineModule],requestHandlers:[u.LZ,u.q,u.$9,u.jE,u.c7,u._,u.gK,u.Qu,u.U8,u.Cw,u.V5,u.XW],validators:[c.j8,c.zX,c.tU,c.VZ,c.xh,c.Qu,c.YS,c.X9,c.Kz]})],te),function(){(typeof ngJitMode>"u"||ngJitMode)&&ae.\u0275\u0275setNgModuleScope(te,{imports:[m.CommonModule,M.ReactiveFormsModule,C.qG,F.CrtLibTranslateModule,x.BusinessRulesModule,T.ExpressionEngineModule]})}()},80246:($,W,a)=>{a.d(W,{K:()=>b});var s=a(5960),m=a.n(s),M=a(38495),O=a.n(M),F=a(96590),x=a.n(F),P=a(21018),T=a.n(P),h=a(28399),u=a.n(h),v=a(62278),L=a.n(v),o=a(36486),c=a.n(o),_=a(98594),C=a(11848),y=a(49159),E=a(46416),I=a(86036);const N={[P.ModelMode.Init]:[P.ModelMode.Create,P.ModelMode.Copy,P.ModelMode.Update,P.ModelMode.Delete],[P.ModelMode.Copy]:[P.ModelMode.Delete,P.ModelMode.Update],[P.ModelMode.Create]:[P.ModelMode.Copy,P.ModelMode.Delete,P.ModelMode.Update],[P.ModelMode.Delete]:[P.ModelMode.Copy,P.ModelMode.Create,P.ModelMode.Update,P.ModelMode.Init],[P.ModelMode.Update]:[P.ModelMode.Delete],[P.ModelMode.Unknown]:[]};function S(j){const f={success:!1,rowsAffected:0,errorInfo:""};return typeof j=="string"?Object.assign(f,{errorInfo:j}):j instanceof Error?Object.assign(f,{errorInfo:j.message}):Object.assign(f,typeof j=="object"?j:{errorInfo:j})}class b{get _children(){return this._children$.value}static get instance(){return this._instance||(this._instance=new b(null,null)),this._instance}static create(f){return(0,v.from)(this.instance._create({type:"crt.EntityDataSource",config:{entitySchemaName:f}},""))}get name(){return this.dataSource?this.dataSource.dataSourceName:""}get mode(){return this._isCollectionModel?P.ModelMode.Unknown:this._mode}get _modeChanges$(){return this._modeChanges.asObservable()}set _isCollection(f){this._isCollectionModel=f,this._isCollectionModel&&(this._mode=P.ModelMode.Unknown)}get isLoaded(){return this._isLoaded}get event$(){return y.q.instance.event$.pipe((0,o.filter)(()=>this._isInitialized),(0,o.filter)(()=>!this._isCollectionItemModel),(0,o.filter)(({dataSchemaName:f})=>f===this._dataSchemaName),(0,o.tap)(({type:f,modelId:R,payload:e})=>this._updateLoadedData(f,R,e)),(0,o.filter)(({modelId:f})=>f!==this._id&&!this._isChild(f)),(0,o.map)(f=>({event:f,ownPrimaryAttributesValues:f.payload?.primaryAttributesValues?.filter(R=>{const e=I.H.serializeRecordPrimaryAttributesValues(R);return this._loadedData.has(e)})})),(0,o.filter)(({event:f,ownPrimaryAttributesValues:R})=>f.type===C.MQ.Update||f.type===C.MQ.Delete?!R||R.length!==0:!0),(0,o.map)(({event:f,ownPrimaryAttributesValues:R})=>({event:f,primaryAttributesValues:f.type===C.MQ.Create?f.payload.primaryAttributesValues:R})),(0,o.map)(({event:f,primaryAttributesValues:R})=>({modelId:f.modelId,dataSchemaName:f.dataSchemaName,type:f.type,payload:{...f.payload,primaryAttributesValues:R}})),(0,o.takeUntil)(this._destroyed$))}get dataSchemaName(){return this._dataSchemaName}get allowSync(){return!this._disableSync}get disableSync(){return this._disableSync}set disableSync(f){this._disableSync=f}get isLoading(){return this._isLoading}get hasErrors(){return this.dataSource?this.dataSource.hasErrors:!0}get hasCriticalErrors(){return this.dataSource?this.dataSource.hasCriticalErrors:!0}get affectedAttributes(){return this.dataSource?this.dataSource.affectedAttributes:[]}get isAggregate(){return this.dataSource?this.dataSource.isAggregate:!1}get isCollectionItemModel(){return this._isCollectionItemModel}get isInitialized(){return this._isInitialized}constructor(f,R){this._injector=f,this.dataSource=R,this._lookupDataSourceName="lookupDataSource",this._id=(0,M.generateGuid)(),this._modeChanges=new v.Subject,this._destroyed$=new v.Subject,this._children$=new v.BehaviorSubject([]),this._childrenDirty$=new v.BehaviorSubject(!1),this._childrenModes$=new v.BehaviorSubject([]),this._isCollectionModel=!1,this._isCollectionItemModel=!1,this._mode=P.ModelMode.Init,this._isInitialized=!1,this._isLoaded=!1,this._dirtyAttributes=new Set,this._newLoadingRequestArrived=new v.Subject,this._attributesMap=[],this._selfDirty$=new v.BehaviorSubject(!1),this._isLoading=!1,this._destroyed=!1,this._dirty$=(0,v.combineLatest)([this._selfDirty$,this._childrenDirty$,this._childrenModes$]).pipe((0,o.map)(([e,t,i])=>e||t||i.includes(P.ModelMode.Copy)||i.includes(P.ModelMode.Create)),(0,o.distinctUntilChanged)()),this._loadedData=new Set,this._injector&&(this._dataSourceFactory=this._injector.get(_.L),this._lifecycleHookNotificationService=this._injector.get(E.bg,null,{optional:!0}),this._measurePerformanceService=this._injector.get(P.MeasurePerformanceService,null,{optional:!0}))}_isChild(f){return this._children.some(R=>R?._id===f)}_subscribeChildrenModeChanges(){this._children$.pipe((0,o.map)(f=>f.map(R=>(0,v.merge)((0,v.of)(R.mode),R._modeChanges$))),(0,o.switchMap)(f=>f?.length?(0,v.combineLatest)(f):(0,v.of)([])),(0,o.tap)(f=>this._childrenModes$.next(f)),(0,o.takeUntil)(this._destroyed$)).subscribe()}_subscribeChildrenDirtyChanges(){this._children$.pipe((0,o.map)(f=>f.map(R=>R._dirty$)),(0,o.switchMap)(f=>f?.length?(0,v.combineLatest)(f):(0,v.of)([])),(0,o.map)(f=>f.some(R=>R)),(0,o.tap)(f=>this._childrenDirty$.next(f)),(0,o.takeUntil)(this._destroyed$)).subscribe()}_updateLoadedData(f,R,e){this._isCollectionModel&&f===C.MQ.Create&&this._isChild(R)&&e.primaryAttributesValues.forEach(t=>{const i=I.H.serializeRecordPrimaryAttributesValues(t);this._loadedData.add(i)})}_setMode(f){if(this._mode===f)return;if(!N[this._mode]?.includes(f))throw Error(`Unable to mark model with '${this._mode}' mode for '${f}'.`);const e=this._mode;this._mode=f,f===P.ModelMode.Delete&&this._selfDirty$.next(e!==P.ModelMode.Create)}_markForNotCollection(f){this._isCollectionModel||this.markFor(f)}_registerPrimaryAttributeValues(f){f.forEach(R=>{this._loadedData.add(I.H.serializeRecordPrimaryAttributesValues(R))})}_getDependentAttributesNames(f){return this._attributesMap.filter(R=>f.includes(R.name)).filter(R=>R.dependentAttributes.length!==0).map(R=>R.dependentAttributes).flat()}_getDefaultLoadAttributes(){return this.getSchema().pipe((0,o.map)(f=>f.getPrimaryLoadAttributes()))}_checkAttributesInDataSchema(f){return this.getSchema().pipe((0,o.tap)(R=>{const e=f.filter(t=>R.findAttributeByName(t)==null);if(e.length>0)throw new Error(`data has unknown attributes names: ${e.join(", ")}`)}))}_createDataSource(f,R,e=null){const t=e??R.dataSourceConfig;return this._dataSourceFactory.create(f,t)}_notifyEventByParameters(f,R){return this.getSchema().pipe((0,o.map)(e=>I.H.getPrimaryAttributeValuesFromParameters(e,f)),(0,o.mergeMap)(e=>this._notifyDataChange(e,R)))}_notifyDataChange(f,R){return this.getSchema().pipe((0,o.map)(e=>I.H.getModelPrimaryAttributeValues(e,f)),(0,o.tap)(e=>{y.q.instance.notify({modelId:this._id,dataSchemaName:this._dataSchemaName,type:R,payload:{primaryAttributesValues:e}})}),(0,o.map)(()=>null))}_mapSaveResult(f,R,e){return this.getSchema().pipe((0,o.map)(t=>({result:f,actionType:C.MQ.Update,data:I.H.getPrimaryAttributeValues(t,R,e)})))}_mapInsertResult(f){return{data:f.primaryAttributes??[],result:f,actionType:C.MQ.Create}}_getLoadAttributes(f){if(f&&f.length!==0){let R=null;if(f.every(t=>(0,h.isString)(t)))return R=this._getDependentAttributesNames(f),(0,v.of)([...f,...R]);{const t=f.map(i=>i.name);return R=this._getDependentAttributesNames(t),this.getSchema().pipe((0,o.map)(i=>(R=R.map(r=>i.findAttributeByName(r)).map(r=>({name:r.name,path:r.path,caption:r.caption,dataValueType:r.dataValueType,aggregationConfig:r.aggregationConfig})),[...f,...R])))}}return this._getDefaultLoadAttributes()}_getChangedAttributesValues(f){return this._persistedState?Object.entries({...this._persistedState,...f}).filter(([R])=>this._dirtyAttributes.has(R)).reduce((R,[e,t])=>Object.assign(R,{[e]:t}),{}):f}_load(f,R,e,t=P.ModelMode.Update){const i={attributes:f,parameters:R,options:e,mode:t},r=(0,h.cloneDeep)(this._lastRequestPayload),l=(0,h.isEqual)((0,h.omit)(i,"options.loadType"),(0,h.omit)(r,"options.loadType"));return this._loadingRequest&&l?this._loadingRequest:(this._lastRequestPayload&&!l&&(this._newLoadingRequestArrived.next(null),this._newLoadingRequestArrived=new v.Subject),this._lastRequestPayload=i,this._loadingRequest=this._getLoadAttributes(f).pipe((0,F.switchMapWithout)(()=>this._onBeforeLoad(i,r)),(0,o.switchMap)(g=>this.dataSource.load(g,R,e)),(0,o.takeUntil)(this._newLoadingRequestArrived),(0,o.tap)(()=>this._markForNotCollection(t)),(0,F.mergeMapWith)(()=>this.getSchema()),(0,o.tap)(([g,A])=>{this._registerPrimaryAttributeValues(I.H.getModelPrimaryAttributeValues(A,g))}),(0,o.tap)(()=>this._persistedState={}),(0,o.map)(([g,A])=>I.H.processImageData(A,g,f)),(0,o.tap)(()=>this._isLoaded=!0),(0,F.switchMapWithout)(()=>this._onAfterLoad(i,r)),(0,o.catchError)(g=>(this._isLoaded=!1,(0,v.throwError)(()=>g))),(0,o.tap)(()=>{this._markAsPristine(),this._loadingRequest=null}),(0,o.share)()),this._loadingRequest)}_updateAttributesDependencies(){this._attributesMap.forEach(R=>R.dependentAttributes=[]),this._attributesMap.filter(R=>R.attributeType!==M.DataSchemaAttributeType.OwnAttribute).forEach(R=>{const e=R.path.split(".");if(e.length===1)return;const t=e.shift(),i=this._attributesMap.find(r=>r.path===t);i?.dependentAttributes.push(R.name)})}_buildAttributesMap(f){const R=f.attributes??[];this._attributesMap=R.map(e=>({name:e.name,path:e.path,attributeType:e.attributeType,dependentAttributes:[],isSchemaAttribute:!0})),this._updateAttributesDependencies()}_loadDependentDataForCreate(f){return this.getSchema().pipe((0,o.map)(R=>R.attributes.filter(e=>e.dataValueType===M.DataValueType.Lookup).filter(e=>e.name in f).map(e=>e.name)),(0,o.switchMap)(R=>{if(R.length===0)return(0,v.of)([]);const e=R.map(t=>this.reloadDependentData(t,f[t]));return(0,v.forkJoin)(e)}),(0,o.map)(R=>{let e={};return R.forEach(t=>{e={...e,...t[0]||{}}}),{...e,...f}}))}_getDependentAttributesInfo(f){return this.getSchema().pipe((0,o.map)(R=>f.map(e=>{const t=R.findAttributeByName(e),i=t?.path??e,r=t?.name??e,l=t?.aggregationConfig??null,g=t?.dataValueType??null,A=t?.attributeType??null,p=i.split(".");p.shift();const D=p.length===1?p[0]:r;let n;return A===M.DataSchemaAttributeType.AggregationAttribute?n=M.DataSchemaAttributeType.AggregationAttribute:n=p.length===1?M.DataSchemaAttributeType.OwnAttribute:M.DataSchemaAttributeType.ForwardReferenceAttribute,{alias:D,attributeName:r,config:{path:p.join("."),aggregationConfig:l,dataValueType:g,type:n},type:n}})))}_markAsPristine(){this._selfDirty$.next(!1)}_onBeforeLoad(f,R){return this._lifecycleHookNotificationService?.onBeforeLoad?(0,v.from)(this._lifecycleHookNotificationService.onBeforeLoad({model:this,payload:{attributes:f?.attributes,options:f?.options,parameters:f?.parameters},previousPayload:{attributes:R?.attributes,options:R?.options,parameters:R?.parameters}})).pipe((0,o.map)(e=>{if(e===!1)throw Error('Loading is disallowed by a "OnBeforeLoad" model lifecycle event')})):(0,v.of)(void 0)}_onAfterLoad(f,R){return this._lifecycleHookNotificationService?.onAfterLoad?(0,v.from)(this._lifecycleHookNotificationService.onAfterLoad({model:this,payload:{attributes:f?.attributes,options:f?.options,parameters:f?.parameters},previousPayload:{attributes:R?.attributes,options:R?.options,parameters:R?.parameters}})):(0,v.of)(void 0)}_onBeforeInsert(f){return this._lifecycleHookNotificationService?.onBeforeInsert?this.getSchema().pipe((0,o.map)(R=>I.H.getModelPrimaryAttributeValues(R,[f])),(0,o.map)(R=>R.pop()),(0,o.switchMap)(R=>this._lifecycleHookNotificationService.onBeforeInsert({model:this,payload:{data:f,primaryAttributesValues:R}})),(0,o.map)(R=>{if(R===!1)throw Error('Inserting is disallowed by a "OnBeforeInsert" model lifecycle event')})):(0,v.of)(void 0)}_innerInsert(f){return this.dataSource.insert(f).pipe((0,o.map)(R=>this._mapInsertResult(R)),(0,o.tap)(()=>this._persistedState={}),(0,o.tap)(()=>this._markAsPristine()),(0,o.tap)(()=>this._markForNotCollection(P.ModelMode.Update)),(0,F.mergeMapWithout)(({data:R,actionType:e})=>this._notifyDataChange(R,e)),(0,o.map)(({result:R})=>R))}_onAfterInsert(f){return this._lifecycleHookNotificationService?.onAfterInsert?(0,v.from)(this._lifecycleHookNotificationService.onAfterInsert({model:this,payload:{data:f}})):(0,v.of)(void 0)}_onBeforeUpdate(f,R){return this._lifecycleHookNotificationService?.onBeforeUpdate?(0,v.from)(this._lifecycleHookNotificationService.onBeforeUpdate({model:this,payload:{data:f,parameters:R}})).pipe((0,o.map)(e=>{if(e===!1)throw Error('Updating is disallowed by a "OnBeforeUpdate" model lifecycle event')})):(0,v.of)(void 0)}_innerUpdate(f,R){return this.dataSource.save(R,f).pipe((0,o.mergeMap)(e=>this._mapSaveResult(e,f,R)),(0,F.mergeMapWithout)(()=>this._notifyEventByParameters(R,C.MQ.Update)),(0,o.map)(({result:e})=>e),(0,o.tap)(()=>this.setLoadedState()))}_onAfterUpdate(f,R){return this._lifecycleHookNotificationService?.onAfterUpdate?(0,v.from)(this._lifecycleHookNotificationService.onAfterUpdate({model:this,payload:{data:f,parameters:R}})):(0,v.of)(void 0)}_onBeforeDelete(f){return this._lifecycleHookNotificationService?.onBeforeDelete?(0,v.from)(this._lifecycleHookNotificationService.onBeforeDelete({model:this,payload:{parameters:f}})).pipe((0,o.map)(R=>{if(R===!1)throw Error('Deleting is disallowed by a "OnBeforeDelete" model lifecycle event')})):(0,v.of)(void 0)}_innerDelete(f){return this.dataSource.delete(f).pipe((0,o.tap)(()=>this._markAsPristine()),(0,o.tap)(()=>this._markForNotCollection(P.ModelMode.Init)),(0,F.mergeMapWithout)(()=>this._notifyEventByParameters(f,C.MQ.Delete)))}_onAfterDelete(f){return this._lifecycleHookNotificationService?.onAfterDelete?(0,v.from)(this._lifecycleHookNotificationService.onAfterDelete({model:this,payload:{parameters:f}})):(0,v.of)(void 0)}init(){return this.getSchema().pipe((0,o.tap)(f=>this._dataSchemaName=f.name),(0,o.tap)(f=>this._buildAttributesMap(f)),(0,o.map)(()=>this),(0,o.tap)(()=>this._isInitialized=!this.hasCriticalErrors),(0,o.tap)(()=>{this._subscribeChildrenModeChanges(),this._subscribeChildrenDirtyChanges()}),(0,o.take)(1))}getSchema(){if(!this.dataSource)return(0,v.of)(null);if(this.hasCriticalErrors)return(0,v.of)(this.dataSource.getEmptySchema());const f=this.dataSource.getSchema();return this._measurePerformanceService?f.pipe(this._measurePerformanceService.measure$(`model.getSchema.${this.name}`)):f}getDataSource(){return this.dataSource}load(f){if(this._destroyed)return(0,v.of)([]);this._isLoading=!0;const R=f?.attributes,e=f?.parameters||[],t=I.H.getDataSourceLoadOptions(f?.options);return this._load(R,e,t).pipe((0,o.tap)(()=>this._isLoading=!1),(0,o.catchError)(i=>(this._isLoading=!1,(0,v.throwError)(()=>i))))}updateDependentAttributes(f){this._attributesMap=this._attributesMap.filter(t=>t.isSchemaAttribute);const R=this._attributesMap.map(t=>t.name),e=f.filter(t=>!R.includes(t.path)).map(t=>({name:t.path,path:t.path,attributeType:t.type??M.DataSchemaAttributeType.ForwardReferenceAttribute,dependentAttributes:[],isSchemaAttribute:!1}));this._attributesMap.push(...e),this._updateAttributesDependencies()}canReloadDependentData(f){return this._getDependentAttributesNames([f]).length!==0}getDependentAttributesNames(f){return this._getDependentAttributesNames([f])}reloadDependentData(f,R){const e=this._getDependentAttributesNames([f]);if(e.length===0)return(0,v.of)([]);if(R==null)return(0,v.of)([Object.fromEntries(e.map(r=>[r,null]))]);const t=[{type:M.ModelParameterType.PrimaryColumnValue,value:R}],i=new Map;return(0,v.forkJoin)([this._getDependentAttributesInfo(e),this.dataSource.getLookupDataSchema(f)]).pipe((0,o.switchMap)(([r,l])=>{const g=r.filter(p=>p.type!==M.DataSchemaAttributeType.OwnAttribute).map(p=>[p.alias,p.config]),A={type:l.dataSourceConfig.type,config:{...l.dataSourceConfig.config,attributes:Object.fromEntries(g)}};return r.forEach(p=>{i.set(p.alias,p.attributeName)}),this._createDataSource(`${this.name}_reloadData`,l,A)}),(0,o.switchMap)(r=>r.load([...i.keys()],t,{throttled:!0})),(0,o.map)(r=>r.map(l=>{const g={};return i.forEach((A,p)=>{g[A]=l[p]}),g})))}create(f={}){return this._isLoading=!0,this.getSchema().pipe((0,o.map)(R=>I.H.getOwnColumnsValues(R,f)),(0,o.switchMap)(R=>(0,v.forkJoin)([(0,v.of)(R),this.dataSource.getDefaultValues()])),(0,o.tap)(()=>this._markForNotCollection(P.ModelMode.Create)),(0,o.map)(([R,e])=>(this._persistedState={...e,...R},this._persistedState)),(0,o.switchMap)(R=>this._loadDependentDataForCreate(R)),(0,o.tap)(()=>this._isLoading=!1))}copy(f,R={}){return this._isLoading=!0,this.getSchema().pipe((0,o.map)(e=>({schema:e,attributes:e.attributes.filter(t=>t.attributeType===M.DataSchemaAttributeType.OwnAttribute&&t.isValueCloneable).map(t=>t.name),parameters:typeof f=="string"?[{type:M.ModelParameterType.PrimaryColumnValue,value:f}]:e.getPrimaryAttributesNames().filter(t=>f[t]).map(t=>({type:M.ModelParameterType.PrimaryColumnValue,value:{[t]:f[t]}}))})),(0,o.mergeMap)(({schema:e,attributes:t,parameters:i})=>this._load(t,i,{},P.ModelMode.Copy).pipe((0,o.tap)(()=>{this._isLoaded=!1}),(0,o.tap)(r=>{if(r.length>1)throw new Error("More than one record loaded for copy");if(r.length===0)throw new Error("No records loaded for copy")}),(0,o.map)(r=>I.H.removeNotRequestedData(t,{...r[0]})),(0,o.map)(r=>{e.getPrimaryAttributesNames().forEach(g=>delete r[g]);const l=I.H.getOwnColumnsValues(e,R);return{...r,...l}}),(0,o.switchMap)(r=>this.dataSource.getDefaultValues().pipe((0,o.map)(l=>({...l,...r})))),(0,o.tap)(r=>{this._persistedState={...r}}),(0,o.switchMap)(r=>this._loadDependentDataForCreate(r)),(0,o.tap)(()=>{this._isLoaded=!0,this._isLoading=!1}),(0,o.catchError)(r=>(this._isLoading=!1,this._markForNotCollection(P.ModelMode.Update),(0,v.throwError)(()=>new Error(r)))))))}insert(f){return this.getSchema().pipe((0,o.map)(e=>({dataSchema:e,data:{...this._persistedState??{},...f}})),(0,o.map)(({data:e,dataSchema:t})=>I.H.getOwnColumnsValues(t,e))).pipe((0,F.switchMapWithout)(e=>this._onBeforeInsert(e)),(0,F.switchMapWith)(e=>this._innerInsert(e)),(0,F.switchMapWithout)(([e])=>this._onAfterInsert(e)),(0,o.map)(([,e])=>e),(0,o.catchError)(e=>(0,v.of)(S(e))))}update(f,R){return this.getSchema().pipe((0,o.map)(t=>I.H.getOwnColumnsValues(t,f)),(0,o.map)(t=>this._getChangedAttributesValues(t))).pipe((0,F.switchMapWithout)(t=>this._onBeforeUpdate(t,R)),(0,F.switchMapWith)(t=>this._innerUpdate(t,R)),(0,F.switchMapWithout)(([t])=>this._onAfterUpdate(t,R)),(0,o.map)(([,t])=>t),(0,o.catchError)(t=>(0,v.of)(S(t))))}insertOrUpdate(f,R){return this._mode===P.ModelMode.Update?this.update(f,R):this.insert(f)}delete(f){return this._onBeforeDelete(f).pipe((0,o.switchMap)(()=>this._innerDelete(f)),(0,F.switchMapWithout)(()=>this._onAfterDelete(f)),(0,o.catchError)(R=>(0,v.of)(S(R))))}setValue(f){const R=Object.keys(f);return this._checkAttributesInDataSchema(R).pipe((0,o.tap)(()=>{R.length>0&&(this._dirtyAttributes=new Set([...this._dirtyAttributes,...R]),this._persistedState={...this._persistedState??{},...f})}),(0,o.map)(()=>null))}_getPersistedState(){return{...this._persistedState??{}}}markFor(f){this.mode!==f&&(this._setMode(f),this._modeChanges.next(f))}loadLookupList(f,R,e={}){if(!this.dataSource)throw Error("DataSource is null");return this.dataSource.getLookupDataSchema(f).pipe((0,o.switchMap)(t=>{const i=t.getPrimaryLoadAttributes();return this._createDataSource(this._lookupDataSourceName,t).pipe((0,o.switchMap)(r=>r.load(i,R,e)),(0,o.map)(r=>({primaryAttributeName:t.primaryAttributeName,primaryDisplayAttributeName:t.primaryDisplayAttributeName,data:r})))}))}canDelete(f){return(0,v.lastValueFrom)(this.dataSource.canDelete(f),{defaultValue:null})}canSave(f){switch(this._mode){case P.ModelMode.Init:return Promise.resolve({result:!1});case P.ModelMode.Create:case P.ModelMode.Copy:return(0,v.lastValueFrom)(this.dataSource.canCreate(f),{defaultValue:null});case P.ModelMode.Update:return(0,v.lastValueFrom)(this.dataSource.canEdit(f),{defaultValue:null});case P.ModelMode.Delete:return this.canDelete(f);default:throw Error(`Unable to verify the possibility of operation executing: the '${this._mode}' is not supported.`)}}attributeChanged(f,R){R||this._selfDirty$.next(!0),this._dirtyAttributes.add(f)}setLoadedState(){this._dirtyAttributes=new Set,this._markAsPristine()}createCollectionItemModel(f){const R=new b(this._injector,this.dataSource);return R._isCollectionItemModel=!0,R._isLoaded=!0,R._isInitialized=!0,R._persistedState={},R._dataSchemaName=this._dataSchemaName,R._attributesMap=this._attributesMap,f!=null&&(R._setMode(f),R._selfDirty$.next(!1)),this._children.push(R),R}childrenChange(){this._children$.next(this._children)}removeChild(f){const R=f?._id,e=this._children.findIndex(t=>t?._id===R);e!==-1&&this._children.splice(e,1)}_getAsyncResult(f){return(0,v.firstValueFrom)(f)}getLastError(){return this.dataSource?this.dataSource.getLastError():new Error("DataSource is null")}destroy(){this._isInitialized=!1,this._destroyed$.next(),this._destroyed$.complete(),this._selfDirty$.complete(),this._children$.complete(),this._childrenDirty$.complete(),this._childrenModes$.complete(),this._destroyed=!0}}(0,s.__decorate)([(0,M.ImplementUsingHandlerChain)({requestType:"crt.ModelGenerator",methodName:"generateOne"}),(0,s.__metadata)("design:type",Function)],b.prototype,"_create",void 0)},10161:($,W,a)=>{a.d(W,{L:()=>s});class s{constructor(M){this.injector=M}}},94655:($,W,a)=>{a.d(W,{_:()=>h});var s=a(5960),m=a.n(s),M=a(59131),O=a.n(M),F=a(38495),x=a.n(F),P=a(79772),T=a.n(P);let h=class extends F.BaseValidator{constructor(v){super(),this.injector=v}defaultValidationError(v){const L=this.injector?.get(P.TranslateService),o=v??{},c=L?.instant(this.i18nMessageKey,o);return{message:v?.message||c||""}}};h=(0,s.__decorate)([(0,F.CrtValidator)(),(0,s.__metadata)("design:paramtypes",[M.Injector])],h)},60824:($,W,a)=>{a.d(W,{i:()=>s});const s="calculated"},41756:($,W,a)=>{a.d(W,{LL:()=>v.L,_J:()=>L._,CI:()=>y,fq:()=>O,Ez:()=>T,UW:()=>P,n3:()=>M,SY:()=>h,sq:()=>C,OU:()=>I,I_:()=>S,j8:()=>N,DM:()=>b,zG:()=>j,tU:()=>e,zX:()=>f,xh:()=>i,VZ:()=>t,Qu:()=>r,YS:()=>l,Kz:()=>p,X9:()=>A,bs:()=>u});var s=a(59131),m=a(28399);class M{constructor(n,d,V=!1){this.name=n,this._value=d,this._locked=V,this._isValueInitialized=!1,this._pendingValue=void 0,this._onChanged=new s.EventEmitter,this._hasInitialValue=!1,d!=null&&(this._isValueInitialized=!0,this._hasInitialValue=!0,this._initialValue=d)}get onChanged(){return this._onChanged}get value(){return this.getValue()}set value(n){this.setValue(n)}get initialValue(){return this._initialValue}set initialValue(n){this.setInitialValue(n)}get hasInitialValue(){return this._hasInitialValue}get isLocked(){return this._locked}emitValueChanged(n){this.onChanged.emit(n)}areValuesEqual(n,d){return(0,m.isEqual)(n,d)}getValue(){return this._value}setValue(n,d=!1){if(this._locked||(this._isValueInitialized=!0,this._pendingValue=n,this.areValuesEqual(this._value,n)))return;const V=(0,m.cloneDeep)(this._value);this._value=(0,m.cloneDeep)(n),!d&&this.emitValueChanged({name:this.name,value:n,oldValue:V})}resetValue(){this.hasInitialValue&&this.setValue(this.initialValue)}setInitialValue(n){this._hasInitialValue=!0,this._initialValue=n,this._isValueInitialized||this.setValue(n,!0)}setPending(n){const d=typeof this._pendingValue>"u"?this.value:this._pendingValue;this.value=n,this._pendingValue=d}resetPending(){this.value=this._pendingValue,this._pendingValue=void 0}}class O extends M{constructor(n,d,V,w,B=!1){super(n,d,B),this._validatorTypeResolver=V,this._injectionContext=w,this._onValidatorChanged=new s.EventEmitter}get onValidatorChanged(){return this._onValidatorChanged}_createValidatorInfo(){return{name:this.validatorTypeName,instance:this._validatorTypeResolver.getValidator(this.validatorTypeName,{injectionContext:this._injectionContext}),disabled:!0}}emitValueChanged(n){super.emitValueChanged(n),this.hasValidator&&this.updateValidator(n)&&this._onValidatorChanged.emit()}get hasValidator(){return!1}updateValidator(n){return!1}setValidatorInfo(n,d=!1){this.validatorInfo=n}initializeValidator(n,d=!1){if(!this.hasValidator||this._validatorTypeResolver==null)return[...n];let V=n.find(B=>B.name===this.validatorTypeName),w=!1;return V==null&&(V=this._createValidatorInfo(),w=!0),this.setValidatorInfo(V,d),w?[...n,V]:[...n]}}var F=a(5960),x=a(38495);class P{static{this._properties=new Map}static _get(n){if(!n)return O;if(this._properties.has(n))return this._properties.get(n);throw new Error(`CrtControlProperty with type ${n} doesn't registered`)}static register(n,d){this._properties.set(n,d)}static create(n){const d=this._get(n.typeName);return new d(n.name,n.value,n.validatorTypeResolver,n.injectionContext,n.locked===!0)}}function T(D){return function(n){(0,x.checkTypeNameFormat)(D.name,"PropertyName"),P.register(D.name,n)}}let h=class extends O{constructor(){super(...arguments),this.validatorTypeName="crt.Required"}get hasValidator(){return!0}updateValidator(n){return this.validatorInfo&&(this.validatorInfo.disabled=!n.value),!0}setValidatorInfo(n,d=!1){super.setValidatorInfo(n,d),this.initialValue=!n.disabled,this.setValue(!n.disabled,d)}};h=(0,F.__decorate)([T({name:"crt.Required"})],h);class u{}var v=a(10161),L=a(94655),o=a(56711),c=a(62278),_=a(36486);const C="DataValueType";class y extends M{get propertiesConfig(){return[{name:"visible",defaultValue:!0},{name:"displayColor"},{name:"required",typeName:"crt.Required",defaultValue:!1}]}get formControl(){return this._formControl||(this._formControl=new o.FormControl(this.value),this._subscribeOnFormControl(this._formControl)),this._formControl}set formControl(n){this._formControl=n,this._subscribeOnFormControl(this._formControl)}get properties(){return this._properties}get onPropertyChanged(){return this._onPropertyChanged}get visible(){return this.getPropertyByName("visible").getValue()}set visible(n){const d=this.getPropertyByName("visible");d.value=n}get required(){return this.getPropertyByName("required").getValue()}set required(n){const d=this.getPropertyByName("required");d.value=n}get displayColor(){return this.getPropertyByName("displayColor").getValue()}set displayColor(n){const d=this.getPropertyByName("displayColor");d.value=n}get isDirty(){return this.formControl.dirty}constructor(n=null,d=null,V=!1,w="",B=[],U,k,K,H){super(w,n),this.validationState=d,this.disabled=V,this._subscription=new c.Subscription,this._onPropertyChanged=new s.EventEmitter,this._crtControlStateAdapter=U,this._validatorTypeResolver=k,this._injectionContext=H,this._initProperties(B),this._subscribeOnPropertiesEvents(),this._initializeValidators(K??[],!0)}static create(n){return new y(n.value,null,!1,n.name,n.propertiesConfig??[],n.crtControlStateAdapter,n.validatorTypeResolver,n.validatorInfo,n.injectionContext)}_subscribeOnFormControl(n){this._formControlSubscription?.unsubscribe(),this._formControlSubscription=n.valueChanges.pipe((0,_.startWith)(n.value),(0,_.distinctUntilChanged)((d,V)=>this.areValuesEqual(d,V))).subscribe(d=>{this.setValue(d)})}_initProperties(n){const d=[...this.propertiesConfig,...n];this._properties=new Map,d.forEach(V=>{const w=P.create({typeName:V.typeName,name:V.name,value:V.defaultValue,locked:V.locked===!0,validatorTypeResolver:this._validatorTypeResolver,injectionContext:this._injectionContext});this._properties.set(V.name,w)})}_subscribeOnPropertyEvents(n){this._subscription.add(n.onChanged.subscribe(({name:d,value:V,oldValue:w})=>{this.onPropertyChanged.emit({name:d,value:V,oldValue:w})})),this._subscription.add(n.onValidatorChanged.subscribe(()=>{this._refreshValidators()}))}_subscribeOnPropertiesEvents(){this.properties.forEach(n=>{this._subscribeOnPropertyEvents(n)})}_initializeValidators(n,d=!1){this._validatorInfo=n,this._properties.forEach(V=>{this._validatorInfo=V.initializeValidator(this._validatorInfo,d)}),this._refreshValidators()}_getEnabledValidatorFns(n=!1){return this._validatorInfo.filter(d=>!d.disabled&&d.instance.isAsync===n).map(d=>this._crtControlStateAdapter.transform(d))??[]}_refreshValidators(){const n=this._getEnabledValidatorFns();this.formControl.setValidators(n);const d=this._getEnabledValidatorFns(!0);this.formControl.setAsyncValidators(d),this.formControl.updateValueAndValidity()}_updateValidator(n,d=!1){const V=this._validatorInfo.find(w=>w.name===n);if(!V)throw new Error(`Validator ${n} does not exist on ${this.name} attribute.`);V.disabled!==d&&(V.disabled=d,this._refreshValidators())}setValue(n,d){const V=this.formControl;this.areValuesEqual(n,V.value)||(V.dirty||V.markAsDirty(),V.setValue(n,{onlySelf:!!d})),super.setValue(n,d)}findPropertyByName(n){return this.properties.has(n)?this.properties.get(n):null}enableValidator(n){this._updateValidator(n,!1)}disableValidator(n){this._updateValidator(n,!0)}change(n){this.setValue(n)}getPropertyByName(n,d=!1){let V=this.findPropertyByName(n);return!V&&d&&(V=new O(n,null,this._validatorTypeResolver,this._injectionContext),this._properties.set(n,V),this._subscribeOnPropertyEvents(V)),V}hasPropertyValue(n){return!!this.getPropertyByName(n)}getPropertyValue(n){const d=this.getPropertyByName(n);return d?d.getValue():null}setPropertyValue(n,d,V=!1){this.getPropertyByName(n,!0).setValue(d,V)}setPropertyInitialValue(n,d){this.getPropertyByName(n,!0).setInitialValue(d)}getPropertyInitialValue(n){return this.getPropertyByName(n)?.initialValue}getValue(){return this._formControl?this._formControl.value:super.getValue()}destroy(){this._formControlSubscription?.unsubscribe(),this._subscription.unsubscribe()}getInvariabilityPropertyName(){const n=this.getPropertyValue(x.ViewElementProperty.Readonly),d=this.getPropertyValue(x.ViewElementProperty.Disabled);return n??d}toggle(n){const d=this.getInvariabilityPropertyName(),V=this.getPropertyByName(d);V&&(n?V.resetPending():V.setPending(!0))}}var E=a(21018);class I{get attributesMap(){return this._attributesMap}get mappedViewModelAttributes(){return this._mappedViewModelAttributes}get isCollection(){return this._isCollection}get collectionViewModelAttributeName(){return this._collectionViewModelAttributeName}constructor(n){this._attributesMap=new Map,this._mappedViewModelAttributes=new Set,this.attributes=[],this.includePrimaryAttributes=!0,this.name=n}static _getDataSourceInfo(n,d){if(!n.has(d)){const V=new I(d);return n.set(d,V),V}return n.get(d)}static _extractViewModelAttributeMapInfo(n){const d=n.split(".");return{dataSourceName:d.shift(),dataSourceAttributePath:d.join(".")}}static _getByDefaultAttribute(n,d,V,w=""){const B=d.modelConfig;if(!B||!B.path)return;const U=this._extractViewModelAttributeMapInfo(B.path);if(!U.dataSourceAttributePath){this._getByViewModelCollectionAttribute(n,d,V);return}if(w&&w!==U.dataSourceName)throw new Error(`Attribute '${n}' mapped on a few DataSources`);const k=this._getDataSourceInfo(V,U.dataSourceName),K=B.aggregationConfig?.aggregationFunction?(0,E.removeSpecialSymbols)(U.dataSourceAttributePath):U.dataSourceAttributePath;k.attributes.push({path:K,type:B.type,functionConfig:B.functionConfig,aggregationConfig:B.aggregationConfig}),k._mappedViewModelAttributes.add(n),k._attributesMap.set(n,U.dataSourceAttributePath)}static _getByInlineViewModelAttribute(n,d,V,w=""){const B=d.viewModelConfig||{};Object.entries(B.attributes||{}).forEach(([U,k])=>{const K=`${n}.${U}`;this._processViewModelAttribute(K,k,V,w)})}static _getByViewModelCollectionAttribute(n,d,V){const w=d.modelConfig;if(!w||!w.path)return;const U=this._extractViewModelAttributeMapInfo(w.path).dataSourceName,k=this._getDataSourceInfo(V,U);k._isCollection=!0,k._collectionViewModelAttributeName=n,k._pagingConfig=w.pagingConfig,k._sortingConfig=w.sortingConfig,k._filteringConfig=w.filterAttributes,k.includePrimaryAttributes=w.includePrimaryAttributes===void 0?!0:w.includePrimaryAttributes;const K=d?.viewModelConfig;Object.entries(K?.attributes||{}).forEach(([H,G])=>{this._processViewModelAttribute(`${n}.${H}`,G,V,U)})}static _processViewModelAttribute(n,d,V,w=""){"viewModelConfig"in d||"viewModelName"in d?d.isCollection?this._getByViewModelCollectionAttribute(n,d,V):this._getByInlineViewModelAttribute(n,d,V,w):"from"in d||this._getByDefaultAttribute(n,d,V,w)}static getFromViewModelConfig(n,d=[]){const V=new Map;return Object.entries(n?.attributes||{}).forEach(([w,B])=>{this._processViewModelAttribute(w,B,V)}),d.filter(w=>!V.has(w.name)).forEach(({name:w})=>{const B=new I(w);V.set(w,B)}),V}static getLookupListDataSourceInfo(n,d){const V=new I("");return V._isCollection=!0,V._collectionViewModelAttributeName=n,Object.entries(d).forEach(([w,B])=>{V.attributes.push({path:B}),V._mappedViewModelAttributes.add(w),V._attributesMap.set(w,B)}),V}_getRowModelDto(n){const d=n.length>0?n[0]:{},V={};return Object.entries(d).forEach(([w,B])=>{this.getMappedAttributeNames(w).forEach(k=>{const K=k.split(".");this.isCollection&&K.length>1&&K.shift(),(0,m.set)(V,K.join("."),B)})}),V}_getCollectionModelDto(n){const d=this._collectionViewModelAttributeName,V=n.map(w=>this._getRowModelDto([w]));return{[d]:V}}getMappedAttributes(){return Array.from(this._mappedViewModelAttributes.values())}getMappedAttributeNames(n){return Array.from(this._attributesMap.entries()).filter(([,d])=>d===n).map(([d])=>d)}getDataSourceAttributePath(n){return this._attributesMap.has(n)?this._attributesMap.get(n):""}getIsMapOnCollection(n){return this._isCollection&&this._collectionViewModelAttributeName===n}getPagingConfig(){return this._pagingConfig}getSortingConfig(){return this._sortingConfig}getFilteringConfig(){return this._filteringConfig||[]}getModelDto(n){return this._isCollection?this._getCollectionModelDto(n):this._getRowModelDto(n)}addNewAttribute(n,d,V){const w=new Map;w.set(this.name,this),I._getByDefaultAttribute(n,d,w,V)}getIsDataSourceAttributePathExists(n){return this.attributes.find(d=>d.path===n)!==void 0}}let N=class extends L._{constructor(){super(...arguments),this.i18nMessageKey="Validators.Required.Message",this.async=!1}validateLczValue(n){return n?!!n.find(d=>d.value&&d.value.trim()):!1}validate(n,d){const V=n.value;return(typeof V=="string"?!!(n&&n.value?.trim()):this.validateLczValue(V))?null:{required:this.defaultValidationError(d)}}};N=(0,F.__decorate)([(0,x.CrtValidator)({type:"crt.EmptyOrWhiteSpace"})],N);let S=class extends N{constructor(n,d){super(n),this.injector=n,this._userInfo=d}validateLczValue(n){return n?!!n.find(d=>d.cultureName===this._userInfo.cultureInfo.sysCultureName&&d.value&&d.value.trim()):!1}};S=(0,F.__decorate)([(0,x.CrtValidator)({type:"crt.EmptyOrWhiteLczSpace"}),(0,F.__metadata)("design:paramtypes",[s.Injector,E.UserInfo])],S);var b;(function(D){D.Attachments="efbf3a0d-d780-465a-8e4b-8c0765197cfb"})(b||(b={}));class j extends y{constructor(n){super(n.value,n.errors,n.disabled),this.formControl=n}}let f=class extends L._{constructor(){super(...arguments),this.i18nMessageKey="Validators.Max.Message",this.async=!1}validate(n,d){const w=o.Validators.max(d.max)(n);return w?{max:this.defaultValidationError({...d,...w.max})}:null}};f=(0,F.__decorate)([(0,x.CrtValidator)({type:"crt.Max"})],f);var R=a(47096);let e=class extends L._{constructor(){super(...arguments),this.i18nMessageKey="Validators.MaxLength.Message",this.async=!1}_maxLengthValidator(n,d){return R.Tb.hasValidLength(n)&&n.length>d.maxLength?{maxlength:this.defaultValidationError({...d,requiredLength:d.maxLength,actualLength:n.length})}:null}validate(n,d){const V=R.Tb.getControlValueAndTrimIfNeeded(n,d);return this._maxLengthValidator(V,d)}};e=(0,F.__decorate)([(0,x.CrtValidator)({type:"crt.MaxLength"})],e);let t=class extends L._{constructor(){super(...arguments),this.i18nMessageKey="Validators.Min.Message",this.async=!1}validate(n,d){const w=o.Validators.min(d.min)(n);return w?{min:this.defaultValidationError({...d,...w.min})}:null}};t=(0,F.__decorate)([(0,x.CrtValidator)({type:"crt.Min"})],t);let i=class extends L._{constructor(){super(...arguments),this.i18nMessageKey="Validators.MinLength.Message",this.async=!1}_minLengthValidator(n,d){return R.Tb.isEmptyInputValue(n)||!R.Tb.hasValidLength(n)?null:n.length<d.minLength?{minlength:this.defaultValidationError({...d,requiredLength:d.minLength,actualLength:n.length})}:null}validate(n,d){const V=R.Tb.getControlValueAndTrimIfNeeded(n,d);return this._minLengthValidator(V,d)}};i=(0,F.__decorate)([(0,x.CrtValidator)({type:"crt.MinLength"})],i);let r=class extends L._{constructor(){super(...arguments),this.i18nMessageKey="Validators.RegExp.Message",this.async=!1}validate(n,d){typeof d.regex=="string"&&(d.regex=new RegExp(d.regex));const V=d.regex.test(n.value);return this.i18nMessageKey=d.message||this.i18nMessageKey,V?null:{[d.errorCode]:this.defaultValidationError({...d})}}};r=(0,F.__decorate)([(0,x.CrtValidator)({type:"crt.RegExp"})],r);let l=class extends L._{constructor(){super(...arguments),this.i18nMessageKey="Validators.Required.Message",this.async=!1}_requiredValidator(n,d){return R.Tb.isEmptyInputValue(n)?{required:this.defaultValidationError(d)}:null}validate(n,d){const V=R.Tb.getControlValueAndTrimIfNeeded(n,d);return this._requiredValidator(V,d)}};l=(0,F.__decorate)([(0,x.CrtValidator)({type:"crt.Required"})],l);var g=a(73308);let A=class extends L._{constructor(n){super(n),this.injector=n,this._messageKey="Validators.SchemaNamePrefix.",this.async=!0,this._sysSettingsService=n.get(x.SysSettingsService)}_getSchemaNamePrefix(){var n=this;return(0,g.A)(function*(){return(yield n._sysSettingsService.getByCode("SchemaNamePrefix")).value})()}validate(n,d){var V=this;return(0,g.A)(function*(){if((0,m.isObject)(n.value))return null;const w=R.Tb.getControlValueAndTrimIfNeeded(n,{trimValue:!0}),B=yield V._getSchemaNamePrefix();if(B){const U=!w?.startsWith(B);if(U||w===B)return V.i18nMessageKey=U?V._messageKey+"NoSchemaNamePrefixMessage":V._messageKey+"OnlySchemaNamePrefixMessage",{namePrefixError:V.defaultValidationError({...d,schemaNamePrefix:B})}}return null})()}};A=(0,F.__decorate)([(0,x.CrtValidator)({type:"crt.SchemaNamePrefix"}),(0,F.__metadata)("design:paramtypes",[s.Injector])],A);let p=class extends r{constructor(){super(...arguments),this._params={regex:/^[a-zA-Z]+[a-zA-Z0-9-_]*$/,errorCode:"allowedSymbolsErrorCode"},this.i18nMessageKey="Validators.SchemaNameAllowedSymbols.Message",this.async=!1}validate(n){return super.validate(n,this._params)}};p=(0,F.__decorate)([(0,x.CrtValidator)({type:"crt.SchemaNameAllowedSymbols"})],p)},77430:($,W,a)=>{a.d(W,{b:()=>T});var s=a(38495),m=a(96590),M=a(60824),O=a(13669),F=a(55642),x=a(32149),P=a(40155);const T=m.FactoryProvider.create({token:P.x,mappings:[{predicate:s.DataValueType.Lookup,injectable:x.Z},{predicate:M.i,injectable:O.jB}],default:{injectable:F.K}})},4481:($,W,a)=>{a.d(W,{rq:()=>M,Nw:()=>D,N_:()=>x,Mf:()=>T,Fw:()=>u,KM:()=>p,JQ:()=>A,Hw:()=>J,WO:()=>X,$d:()=>F,if:()=>O,Rr:()=>v,TZ:()=>h,Zw:()=>L,RM:()=>o,IH:()=>c,Xb:()=>_,ly:()=>C,pN:()=>E,Fq:()=>I,cJ:()=>G,g6:()=>N,nf:()=>n,MD:()=>S,Hz:()=>b,vB:()=>j,Fv:()=>d,nN:()=>R,c1:()=>f,d_:()=>e,Xr:()=>t,d:()=>i,qn:()=>r,_:()=>l,iP:()=>g,UI:()=>V,Ve:()=>H,Tt:()=>B,k7:()=>U,Ux:()=>K,_j:()=>w,Gw:()=>oe,Q_:()=>re,BI:()=>ae,SD:()=>te,Ts:()=>de,Vu:()=>le,y9:()=>se,H3:()=>he,QY:()=>z,vz:()=>Z,Si:()=>ee,kU:()=>Y,S:()=>Q,h_:()=>ie,Lp:()=>ne,gM:()=>y,Y9:()=>ke,qK:()=>pe,oN:()=>me,p7:()=>ge,e7:()=>We,Zq:()=>_e,jy:()=>fe,nm:()=>ye,n$:()=>Me,ks:()=>Se,Ol:()=>ve,Cm:()=>Ee,SH:()=>Ae,gJ:()=>Ce,mR:()=>De,NX:()=>Pe,J1:()=>be,G9:()=>ue,eJ:()=>Re,RF:()=>Ve,vo:()=>Ie,mi:()=>Te,Yh:()=>Oe,Ze:()=>xe,Mg:()=>Ne,c9:()=>Le,_G:()=>Be,sE:()=>k,ev:()=>Fe,nS:()=>je,ap:()=>we,gf:()=>Ue});var s=a(5960),m=a(38495);let M=class extends m.BaseRequest{};M=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.AddCommunicationOptionsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.Add\u0421ommunicationOptionsRequest",propertiesPanelComponentTypeName:"crt.AddCommunicationOptionsRequestPropertiesPanel",position:740})],M);class O extends m.BaseRequest{}class F extends O{}let x=class extends F{};x=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.AddRecordsInStaticFoldersRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.AddRecordsInStaticFoldersRequest",propertiesPanelComponentTypeName:"crt.AddRecordsInStaticFoldersRequestPropertiesPanel",position:706,compatibleAPIs:{[m.PlatformAPIs.Selection]:!0}})],x);class P extends m.BaseRequest{}let T=class extends P{};T=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.AddTagsInRecordRequest"})],T);class h extends O{}let u=class extends h{};u=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.AddTagsInRecordsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.AddTagsInRecordsRequest",propertiesPanelComponentTypeName:"crt.AddTagsInRecordsRequestPropertiesPanel",position:703,compatibleAPIs:{[m.PlatformAPIs.Selection]:!0}})],u);class v extends m.BaseRequest{}let L=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.CancelCollectionPrimaryDataChangesRequest"}};L=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.CancelCollectionPrimaryDataChangesRequest"})],L);let o=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.CancelPrimaryDataChangesRequest"}};o=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.CancelPrimaryDataChangesRequest"})],o);let c=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.CancelRecordChangesRequest"}};c=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.CancelRecordChangesRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.CancelRecordChangesRequest",position:500})],c);let _=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.CancelRecordsChangesRequest"}};_=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.CancelRecordsChangesRequest"})],_);let C=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.ClosePageRequest"}};C=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.ClosePageRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.ClosePageRequest",position:600})],C);let y=class extends m.DataRequest{};y=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.LoadDataRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.LoadDataRequest",propertiesPanelComponentTypeName:"crt.LoadDataRequestPropertiesPanel",position:500})],y);let E=class extends y{};E=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.ComboboxLoadDataRequest"})],E);let I=class extends m.BaseRequest{};I=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.ContinueInOtherPageRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.ContinueInOtherPageRequest",position:1e3})],I);let N=class extends m.BaseRequest{};N=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.CopilotActionRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.CopilotActionRequest",propertiesPanelComponentTypeName:"crt.CopilotActionRequestPropertiesPanelComponent",position:3001})],N);let S=class extends m.BaseRequest{};S=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.CreateCollectionItemsRequest"})],S);let b=class extends m.BaseRequest{};b=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.CreateRecordRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.CreateRecordRequest",propertiesPanelComponentTypeName:"crt.CreateRecordRequestPropertiesPanel",position:200})],b);let j=class extends m.BaseRequest{};j=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.DeleteClientUnitSchemaRequest"})],j);let f=class extends m.BaseRequest{};f=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.DeleteRecordRequest"})],f);let R=class extends f{};R=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.DeleteOldTagRecordRequest"})],R);let e=class extends m.BaseRequest{};e=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.DeleteRecordsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.DeleteRecordsRequest",propertiesPanelComponentTypeName:"crt.DeleteRecordsRequestPropertiesPanel",position:701,compatibleAPIs:{[m.PlatformAPIs.Selection]:!0}})],e);let t=class extends P{};t=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.DeleteTagInRecordRequest"})],t);let i=class extends m.BaseRequest{};i=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.DetailChangedRequest"})],i);let r=class extends m.BaseRequest{};r=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.EmailLinkClickRequest"})],r);let l=class extends m.BaseRequest{};l=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.ExportChartDataGridToExcelRequest"})],l);let g=class extends m.BaseRequest{};g=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.ExportDataGridToExcelRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.ExportDataGridToExcelRequest",propertiesPanelComponentTypeName:"crt.ExportDataGridToExcelRequestPropertiesPanel",position:800,compatibleAPIs:{[m.PlatformAPIs.Selection]:!0}})],g);class A extends m.BaseRequest{}class p extends A{}let D=class extends p{};D=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.AddFolderDataRequest"})],D);let n=class extends p{};n=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.CopyFolderDataRequest"})],n);let d=class extends A{};d=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.DeleteFolderDataRequest"})],d);let V=class extends A{};V=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.FolderTreeActiveFolderChangedRequest"})],V);let w=class extends A{};w=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.FolderTreeVisibleRequest"})],w);let B=class extends A{};B=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.FolderTreeMoveRequest"})],B);let U=class extends A{};U=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.FolderTreeRenameRequest"})],U);let k=class extends A{};k=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.ToggleFolderFavoriteRequest"})],k);let K=class extends A{};K=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.FolderTreeUpdateFiltersRequest"})],K);let H=class extends A{};H=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.FolderTreeExpandedItemsRequest"})],H);let G=class extends D{};G=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.ConvertToStaticFolderRequest"})],G);let J=class extends m.BaseRequest{};J=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.BaseImageListItemClickRequest"})],J);let z=class extends m.BaseRequest{constructor($e,Ke){super(),this.event=$e,this.$context=Ke,this.type="crt.HandleKeyboardHotkeysRequest"}};z=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleKeyboardHotkeysRequest"}),(0,s.__metadata)("design:paramtypes",[KeyboardEvent,Object])],z);let Z=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.HandleModelEventRequest"}};Z=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleModelEventRequest"})],Z);let ee=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.HandleViewModelDestroyRequest"}};ee=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleViewModelDestroyRequest"})],ee);let Y=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.HandleViewModelInitRequest"}};Y=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleViewModelInitRequest"})],Y);let Q=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.HandleViewModelPauseRequest"}};Q=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleViewModelPauseRequest"})],Q);let ie=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.HandleViewModelResumeRequest"}};ie=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleViewModelResumeRequest"})],ie);let ne=class extends m.BaseRequest{};ne=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.ImportDataRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.ImportDataRequest",propertiesPanelComponentTypeName:"crt.ImportDataRequestPropertiesPanel",position:750})],ne);class X extends m.BaseRequest{}let oe=class extends X{constructor(){super(...arguments),this.type="crt.HandleAfterModelDeleteRequest"}};oe=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleAfterModelDeleteRequest"})],oe);let re=class extends X{constructor(){super(...arguments),this.type="crt.HandleAfterModelInsertRequest"}};re=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleAfterModelInsertRequest"})],re);let ae=class extends X{constructor(){super(...arguments),this.type="crt.HandleAfterModelLoadRequest"}};ae=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleAfterModelLoadRequest"})],ae);let te=class extends X{constructor(){super(...arguments),this.type="crt.HandleAfterModelUpdateRequest"}};te=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleAfterModelUpdateRequest"})],te);let de=class extends X{constructor(){super(...arguments),this.type="crt.HandleBeforeModelDeleteRequest"}};de=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleBeforeModelDeleteRequest"})],de);let le=class extends X{constructor(){super(...arguments),this.type="crt.HandleBeforeModelInsertRequest"}};le=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleBeforeModelInsertRequest"})],le);let se=class extends X{constructor(){super(...arguments),this.type="crt.HandleBeforeModelLoadRequest"}};se=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleBeforeModelLoadRequest"})],se);let he=class extends X{constructor(){super(...arguments),this.type="crt.HandleBeforeModelUpdateRequest"}};he=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.HandleBeforeModelUpdateRequest"})],he);let me=class extends m.BaseRequest{};me=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.MoveSelectedItemsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.MoveSelectedItemsRequest",propertiesPanelComponentTypeName:"crt.MoveSelectedItemsRequestPropertiesPanel",position:1e3,compatibleAPIs:{[m.PlatformAPIs.Selection]:!0}})],me);var pe;(function(q){q.Root="root",q.Item="item",q.Const="const"})(pe||(pe={}));class ke{}let ge=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.NotificationRequest"}};ge=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.NotificationRequest"})],ge);let _e=class extends m.BaseRequest{};_e=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.OpenDuplicatesPageRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.OpenDuplicatesPageRequest",propertiesPanelComponentTypeName:"crt.OpenDuplicatesPageRequestPropertiesPanel",position:360})],_e);let fe=class extends m.BaseRequest{};fe=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.OpenOldTagMiniPageRequest"})],fe);let ye=class extends m.BaseRequest{};ye=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.OpenPageRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.OpenPageRequest",propertiesPanelComponentTypeName:"crt.OpenPageRequestPropertiesPanel",position:350})],ye);let Me=class extends m.BaseRequest{};Me=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.OpenPositionedPageRequest"})],Me);let Se=class extends m.BaseRequest{};Se=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.PhoneLinkClickRequest"})],Se);let ve=class extends m.BaseRequest{};ve=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.PrintablesRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.PrintablesRequest",propertiesPanelComponentTypeName:"crt.PrintablesRequestPropertiesPanel",position:3e3,compatibleAPIs:{[m.PlatformAPIs.Selection]:!0}})],ve);let Ee=class extends m.BaseRequest{};Ee=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.RemoveCollectionItemsRequest"})],Ee);let Ae=class extends F{};Ae=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.RemoveRecordsInStaticFoldersRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.RemoveRecordsInStaticFoldersRequest",propertiesPanelComponentTypeName:"crt.RemoveRecordsInStaticFoldersRequestPropertiesPanel",position:705,compatibleAPIs:{[m.PlatformAPIs.Selection]:!0}})],Ae);let Ce=class extends h{};Ce=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.RemoveTagsInRecordsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.RemoveTagsInRecordsRequest",propertiesPanelComponentTypeName:"crt.RemoveTagsInRecordsRequestPropertiesPanel",position:704,compatibleAPIs:{[m.PlatformAPIs.Selection]:!0}})],Ce);let De=class extends m.BaseRequest{};De=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.RunBusinessProcessRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.RunBusinessProcessRequest",propertiesPanelComponentTypeName:"crt.RunBusinessProcessRequestPropertiesPanel",position:700,compatibleAPIs:{[m.PlatformAPIs.Selection]:!0}})],De);let Pe=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.SaveCollectionPrimaryDataRequest"}};Pe=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.SaveCollectionPrimaryDataRequest"})],Pe);let be=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.SavePrimaryDataRequest"}};be=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.SavePrimaryDataRequest"})],be);let ue=class extends m.BaseRequest{};ue=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.SaveRecordRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.SaveRecordRequest",propertiesPanelComponentTypeName:"crt.SaveRecordRequestPropertiesPanel",position:400})],ue);let Re=class extends ue{};Re=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.SaveRecordWithErrorRequest"})],Re);let Ve=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.SaveRecordsRequest"}};Ve=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.SaveRecordsRequest"})],Ve);let Ie=class extends v{};Ie=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.SearchFilterColumnsGroupsRequest"})],Ie);let Te=class extends v{};Te=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.SearchFilterRequest"})],Te);let Oe=class extends m.BaseRequest{constructor(){super(...arguments),this.multiple=!0,this.displayErrors=!1}};Oe=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.SelectFileRequest"})],Oe);let xe=class extends m.BaseRequest{};xe=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.SelectLookupPageRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.SelectLookupPageRequest",propertiesPanelComponentTypeName:"crt.SelectLookupPageRequestPropertiesPanel",scopes:["BaseLookupPageTemplate"],position:2e3})],xe);let Ne=class extends m.BaseRequest{};Ne=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.SetRecordRightsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.SetRecordRightsRequest",propertiesPanelComponentTypeName:"crt.SetRecordRightsRequestPropertiesPanel",position:800})],Ne);let Le=class extends m.BaseRequest{constructor(){super(...arguments),this.type="crt.SetTopRecordRequest"}};Le=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.SetTopRecordRequest"})],Le);let Be=class extends m.BaseRequest{};Be=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.ShowRelationshipsRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.ShowRelationshipsRequest",propertiesPanelComponentTypeName:"crt.ShowRelationshipsRequestPropertiesPanel",position:900})],Be);let Fe=class extends m.BaseRequest{};Fe=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.UpdateRecordRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.UpdateRecordRequest",propertiesPanelComponentTypeName:"crt.UpdateRecordRequestPropertiesPanel",position:300})],Fe);let je=class extends m.BaseRequest{};je=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.UploadFileRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.UploadFileRequest",propertiesPanelComponentTypeName:"crt.UploadFileRequestPropertiesPanel",position:702})],je);let we=class extends m.BaseRequest{constructor(){super(...arguments),this.awaitResponse=!1}};we=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.UploadImageRequest"})],we);let Ue=class extends m.BaseRequest{};Ue=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.WorkplaceNavigationPanelCloseRequest"})],Ue);let We=class extends m.BaseRequest{};We=(0,s.__decorate)([(0,m.CrtRequest)({type:"crt.OpenChangeLogRequest",title:"InterfaceDesigner.PropertiesPages.ViewElementEventPropertiesPanel.Requests.OpenChangeLogRequest",propertiesPanelComponentTypeName:"crt.OpenChangeLogRequestPropertiesPanel",position:370})],We)},13669:($,W,a)=>{a.d(W,{r:()=>F,CJ:()=>y,A:()=>_,a5:()=>C,UO:()=>S,Iu:()=>i,lg:()=>I,vV:()=>N,Fv:()=>P,Qj:()=>c,qG:()=>D,jB:()=>p,od:()=>t,wZ:()=>R,gd:()=>e});var s=a(62278),m=a(36486),M=a(65576);function O(n,d){if(!n||!d)return s.EMPTY;const V=d.events$.pipe((0,m.filter)(w=>w.type===M.n.ChangeAttributeValue),(0,m.filter)(w=>w.payload.attributeName===n),(0,m.switchMap)(()=>d[n]));return new s.Observable(w=>(n in d?(0,s.merge)((0,s.from)(d[n]),V):V).subscribe(w))}class F{}var x=a(59131);class P extends F{getChanges(d,V,w){const B=d.map(U=>O(U,w));return(0,s.combineLatest)(B)}static{this.\u0275fac=(()=>{let d;return function(w){return(d||(d=x.\u0275\u0275getInheritedFactory(P)))(w||P)}})()}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac})}}var T=a(96590),h=a(82757);class u{constructor(d){this._converterExpressionInterpreter=d?.create("converter")}_getConverterFn(d,V,w){if(!d||!this._converterExpressionInterpreter)return(0,s.of)(w);const B={viewModel$:(0,s.of)(V),parent:null};return this._converterExpressionInterpreter.evaluate(d,B)}evaluate(d){const{args:V,expression:w,context:B,defaultEvaluationFn:U}=d;return this._getConverterFn(w,B,U).pipe((0,m.switchMap)(k=>{const K=k(V);return K instanceof Promise?K:Promise.resolve(K)}))}static{this.\u0275fac=function(V){return new(V||u)(x.\u0275\u0275inject(h.p,8))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:u,factory:u.\u0275fac})}}var v=a(38495);function L(n,d){if(!n||!d)return s.EMPTY;const V=new s.ReplaySubject(1),w=v.HandlerChainService.instance.subscribe(B=>{B.type===n&&V.next(B)},d);return d._subscriptions.add(w),V}const o=100;class c extends F{constructor(d){super(),this._converterEvaluator=d}_accumulateRequests(d,V,w){const B=new s.BehaviorSubject([]),U=this._accumulateRequestsCombinations(d,B,V,w).subscribe();return new s.Observable(k=>(B.complete(),U.unsubscribe(),this._findAcceptableRequestsCombination(B.value,V,w).pipe((0,m.switchMap)(K=>K?(0,s.merge)((0,s.of)(K),d):d)).subscribe(k)))}_accumulateRequestsCombinations(d,V,w,B){return d.pipe((0,m.map)(U=>[U,...V.value]),(0,m.switchMap)(U=>U.length<o?(0,s.of)(U):this._findAcceptableRequestsCombination(U,w,B).pipe((0,m.map)(k=>k?[k]:[]))),(0,m.tap)(U=>V.next(U)),(0,m.map)(()=>{}))}_findAcceptableRequestsCombination(d,V,w){if(!d.length)return(0,s.of)(null);const{from:B,filter:U}=V;return(0,s.from)(d).pipe((0,T.concatMapWith)(k=>this._converterEvaluator.evaluate({args:Array.isArray(B)?k:k[0],context:w,expression:U})),(0,m.first)(([,k])=>!!k,[null]),(0,m.map)(([k])=>k))}getChanges(d,V,w){const B=d.map(k=>L(k,w)),U=(0,s.combineLatest)(B);return V.filter?this._accumulateRequests(U,V,w):U}static{this.\u0275fac=function(V){return new(V||c)(x.\u0275\u0275inject(u))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:c,factory:c.\u0275fac})}}const _=new x.InjectionToken("Represents a factory of calculated attribute source changes providers"),C=T.FactoryProvider.create({token:_,mappings:[{predicate:n=>n.every(d=>v.RequestRegistryService.requestsRegistrationInfos.has(d)),injectable:c}],default:{injectable:P}});class y{}class E extends y{constructor(d){super(),this._converterEvaluator=d}getTrigger(d,V){return this.getTriggerInternal(d,V).pipe((0,T.concatMapWith)(w=>this._converterEvaluator.evaluate({args:w,expression:d?.filter,context:V,defaultEvaluationFn:()=>!0})),(0,m.filter)(([,w])=>!!w),(0,m.map)(()=>{}))}}class I extends E{constructor(d){super(d)}getTriggerInternal(d,V){return O(d?.attribute,V)}static{this.\u0275fac=function(V){return new(V||I)(x.\u0275\u0275inject(u))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:I,factory:I.\u0275fac})}}class N extends E{constructor(d){super(d)}getTriggerInternal(d,V){return new s.Observable(w=>L(d?.request,V).subscribe(w))}static{this.\u0275fac=function(V){return new(V||N)(x.\u0275\u0275inject(u))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:N,factory:N.\u0275fac})}}const S=new x.InjectionToken("Represents a factory of calculated attribute trigger providers");function b(n){let d=[];return typeof n=="string"&&(d=[n]),Array.isArray(n)&&(d=n),d.map(V=>typeof V=="string"&&V?.trim()).filter(Boolean)}function j(n){return(n??[]).filter(d=>e(d)||R(d))}function f(n){const d=n.map(B=>v.RequestRegistryService.requestsRegistrationInfos.has(B)),V=d.includes(!0),w=d.includes(!1);return V&&w}function R(n){return!!n&&"attribute"in n&&!!n.attribute}function e(n){return!!n&&"request"in n&&!!n.request}function t(n){const d=b(n.from),V=j(n.triggers),{from:w,filter:B,converter:U,change:k,triggersOptions:K}=n;return d.length===0&&V.length===0?(console.error(`Both 'from' and 'triggers' properties of calculated attribute cannot be empty: ${JSON.stringify(n)}.`),null):d.length===0&&!U?(console.error(`Converter is required in a calculated attribute if there are 'triggers' and no 'from': ${JSON.stringify(n)}.`),null):f(d)?(console.error(`Simultaneous specification of attributes and request in the "from" property of calculated attribute is not supported: ${JSON.stringify(n)}.`),null):(d.length===0&&B&&console.warn(`Filter is skipped in a calculated attribute if there are 'triggers' and no 'from': ${JSON.stringify(n)}.`),{from:d,originalFrom:w,filter:d.length?B:void 0,converter:U,triggers:V,triggersOptions:{debounce:K?.debounce??0},change:k})}const i=T.FactoryProvider.create({token:S,mappings:[{predicate:R,injectable:I},{predicate:e,injectable:N}]});var r=a(21018),l=a(28399);const g=n=>!0,A=n=>n;class p{constructor(d,V,w,B){this._converterEvaluator=d,this._attributeSourcesChangesProviderFactory=V,this._attributeTriggerProviderFactory=w,this._measurePerformanceService=B}_createCalculateAttributeValueFn(d,V){const{viewModel:w,attribute:B,generateOptions:U}=d,{originalFrom:k,filter:K,converter:H}=V,G=Array.isArray(k);return J=>J.pipe((0,m.map)(z=>G?z:z?.[0]),(0,T.concatMapWith)(z=>this._converterEvaluator.evaluate({args:z,expression:K,context:w,defaultEvaluationFn:g})),(0,m.filter)(([,z])=>!!z),(0,m.concatMap)(([z])=>this._converterEvaluator.evaluate({args:z,expression:H,context:w,defaultEvaluationFn:A})),(0,m.map)(z=>{const Z=w.attributes[B];return[(0,l.cloneDeep)(z),(0,l.cloneDeep)(Z)]}),(0,m.filter)(([z,Z])=>!(0,l.isEqual)(z,Z)),(0,m.tap)(([z,Z])=>{w.attributes[B]=z,U?.onChangeAttributeValue(B,z,Z)}),(0,m.map)(([z])=>z))}_createGetAttributeValueFn(d){const{viewModel:V,attributeName:w,attributeConfig:B,calculateAttributeFn:U}=d;let k;const K=this._getAttributeSourcesStream(B,V);return()=>{const H=w in V.attributes;return k?H?(0,s.of)(V.attributes[w]):k:(k=U(K).pipe((0,m.shareReplay)({bufferSize:1,refCount:!0})),V._subscriptions.add(k.subscribe()),k)}}_getAttributeSourcesStream(d,V){const w=this._getAttributeTriggers(d,V),B=this._getAttributeSourcesChanges(d,V);if(!w)return B;const U=d.triggersOptions.debounce;return B?(0,s.merge)(w.pipe((0,m.debounceTime)(U)),B).pipe((0,m.withLatestFrom)(B),(0,m.map)(([,k])=>k)):w.pipe((0,m.startWith)(void 0),(0,m.debounceTime)(U))}_getAttributeTriggers(d,V){const{triggers:w}=d,B=w.map(U=>this._attributeTriggerProviderFactory.create(U)?.getTrigger(U,V)).filter(Boolean);return B.length===0?null:(0,s.merge)(...B)}_getAttributeSourcesChanges(d,V){const{from:w}=d;return w.length===0?null:this._attributeSourcesChangesProviderFactory.create(w).getChanges(w,d,V)}_defineCalculatedAttribute(d,V,w){Object.defineProperty(w,d,{get:()=>(0,s.firstValueFrom)(V(),{defaultValue:null}),configurable:!0})}defineAttribute(d){this._measurePerformanceService.measure(`CalculatedAttributeCreator.defineAttribute.${d.attribute}`,()=>{const{viewModel:V,attribute:w,attributeConfig:B}=d,U=t(B);if(U===null)return;const k=this._createCalculateAttributeValueFn(d,U),K=this._createGetAttributeValueFn({attributeName:w,attributeConfig:U,calculateAttributeFn:k,viewModel:V});this._defineCalculatedAttribute(w,K,V)})}static{this.\u0275fac=function(V){return new(V||p)(x.\u0275\u0275inject(u),x.\u0275\u0275inject(_),x.\u0275\u0275inject(S),x.\u0275\u0275inject(r.MeasurePerformanceService))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:p,factory:p.\u0275fac,providedIn:"root"})}}class D{static{this.\u0275fac=function(V){return new(V||D)}}static{this.\u0275mod=x.\u0275\u0275defineNgModule({type:D})}static{this.\u0275inj=x.\u0275\u0275defineInjector({providers:[p,u,I,N,P,c,C,i]})}}},55642:($,W,a)=>{a.d(W,{K:()=>x});var s=a(59131),m=a.n(s),M=a(21018),O=a.n(M),F=a(47096);class x{constructor(T,h){this.ngZone=T,this.measurePerformanceService=h}innerDefineAttribute(T,h){this.measurePerformanceService.measure(`DefaultAttributeCreator.defineAttribute.${T.attribute}`,()=>{const u=T.viewModel,v=u.attributes,L=T.attribute,o=T.attributeConfig,c=T.control,_=y=>{v[L]=y,this.ngZone.run(()=>{const E=u._viewModelAttributeChangeEventOptions?.getAsSilent();c.setValue(y,E),h?.call(this,y)})},C=()=>c.value;F.iR.defineAsyncAttribute(u,L,o,C,_)})}defineAttribute(T){this.innerDefineAttribute(T)}static{this.\u0275fac=function(h){return new(h||x)(s.\u0275\u0275inject(s.NgZone),s.\u0275\u0275inject(M.MeasurePerformanceService))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:x,factory:x.\u0275fac,providedIn:"root"})}}},32149:($,W,a)=>{a.d(W,{Z:()=>x});var s=a(59131),m=a.n(s),M=a(21018),O=a.n(M),F=a(55642);class x extends F.K{constructor(T,h){super(T,h)}defineAttribute(T){this.innerDefineAttribute(T,h=>{T?.viewModel?.setAttributePropertyValue(T?.attribute,"displayColor",h?.primaryColorValue)})}static{this.\u0275fac=function(h){return new(h||x)(s.\u0275\u0275inject(s.NgZone),s.\u0275\u0275inject(M.MeasurePerformanceService))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:x,factory:x.\u0275fac,providedIn:"root"})}}},94660:($,W,a)=>{a.d(W,{d:()=>O});var s=a(59131),m=a.n(s),M=a(66882);class O{constructor(x){this.injector=x,this.initDependencies()}initDependencies(){this.repository=this.injector.get(M.k),this.ngZone=this.injector.get(s.NgZone)}static{this.\u0275fac=function(P){return new(P||O)(s.\u0275\u0275inject(s.Injector))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac})}}},97502:($,W,a)=>{a.d(W,{i:()=>u});var s=a(73308),m=a(79772),M=a.n(m),O=a(21018),F=a.n(O),x=a(29957),P=a.n(x),T=a(59131),h=a.n(T);class u{constructor(L){this._translateService=L}_getAttributesCaptions(L,o){const c=o.map(_=>{const C=L._attributeConfigs[_];return C&&C.caption?Promise.resolve(C.caption):L[O.SchemaResourcesSuffix][O.TypeResources.string][_].then(y=>y||_)});return Promise.all(c)}_getFirstValidationError(L){const o=Object.entries(L??{});if(o.length===0)return null;const c=o[0][1];return Object.entries(c)[0]}getValidationErrorMessage(L,o){var c=this;return(0,s.A)(function*(){const _=c._getFirstValidationError(o);if(!_)return"";const C=_[0],y=_[1].message,I=Object.entries(o).filter(([b,j])=>Object.keys(j).includes(C)).map(([b,j])=>b),N=(yield c._getAttributesCaptions(L,I)).map(b=>`"${b}"`),S=I.length===1?c._translateService.instant("BaseViewModel.ValidationErrorMessageSingleErrorField"):c._translateService.instant("BaseViewModel.ValidationErrorMessageSeveralErrorFields");return x.String.format(S,N.join(", "),y)})()}static{this.\u0275fac=function(o){return new(o||u)(T.\u0275\u0275inject(m.TranslateService))}}static{this.\u0275prov=T.\u0275\u0275defineInjectable({token:u,factory:u.\u0275fac})}}},18046:($,W,a)=>{a.d(W,{f:()=>M});var s=a(59131),m=a.n(s);class M{transform(F){return function(x){const{instance:P,params:T}=F,h={value:x.value};return P.validate(h,T)}}static{this.\u0275fac=function(x){return new(x||M)}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:M,factory:M.\u0275fac,providedIn:"root"})}}},97082:($,W,a)=>{a.d(W,{f:()=>s.f});var s=a(18046)},39560:($,W,a)=>{a.d(W,{r:()=>s.r,CJ:()=>s.CJ,bg:()=>F.bg,vB:()=>_.v,dX:()=>C.d,iQ:()=>y.i,A:()=>s.A,a5:()=>s.a5,UO:()=>s.UO,Iu:()=>s.Iu,lg:()=>s.lg,vV:()=>s.vV,Fv:()=>s.Fv,Qj:()=>s.Qj,qG:()=>s.qG,jB:()=>s.jB,zH:()=>F.zH,ff:()=>O.f,Ky:()=>m.K,Im:()=>c,II:()=>F.II,Zr:()=>M.Z,No:()=>d,q_:()=>A.q,m1:()=>n,OY:()=>N,vx:()=>I,BF:()=>V.B,e3:()=>b,sK:()=>u,AC:()=>v,Z$:()=>h,dr:()=>g,od:()=>s.od,wZ:()=>s.wZ,gd:()=>s.gd,Ox:()=>R});var s=a(13669),m=a(55642),M=a(32149),O=a(97082),F=a(46416),x=a(59131),P=a(38495),T=a(10161);class h extends T.L{constructor(B){super(B)}getValidator(B,U){const k=P.ValidatorRegistry.items.get(B);if(!k)throw new Error(`Validator '${B}' was not registered`);if(k.lazy&&!k.instantiate)throw new Error(`Lazy module with ${B} validator is not loaded`);return k.instantiate(U?.injectionContext)}static{this.\u0275fac=function(U){return new(U||h)(x.\u0275\u0275inject(x.Injector))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:h,factory:h.\u0275fac})}}class u{constructor(B){this.injector=B,this._schemaValidators=new Map}register(B,U){if((0,P.checkTypeNameFormat)(B.type,"ValidatorTypeName"),(0,P.checkCrtTypeNamePascalCase)(B.type),this._schemaValidators.has(B.type))throw new Error(`Error when register ${B.type} type. Element with this type has already exist`);this._schemaValidators.set(B.type,{instanceType:U,instanceConfig:B})}clearSchemaValidators(){this._schemaValidators.clear()}has(B){return this._schemaValidators.has(B)}get(B,U){const K=this._schemaValidators.get(B)?.instanceType;if(!K)throw new Error(`Validator '${B}' was not registered`);return new K(this.injector)}static{this.\u0275fac=function(U){return new(U||u)(x.\u0275\u0275inject(x.Injector))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:u,factory:u.\u0275fac})}}class v extends h{constructor(B,U){super(U),this._schemaValidatorRegistry=B}getValidator(B,U){return this._schemaValidatorRegistry.has(B)?this._schemaValidatorRegistry.get(B,U?.validationParameters):super.getValidator(B,U)}static{this.\u0275fac=function(U){return new(U||v)(x.\u0275\u0275inject(u),x.\u0275\u0275inject(x.Injector))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac})}}var L=a(94655);class o extends L._{constructor(){super(...arguments),this.async=!1}validate(B){return null}}class c extends h{constructor(B){super(B)}getValidator(B,U){try{return super.getValidator(B,U)}catch{return new o(this.injector)}}static{this.\u0275fac=function(U){return new(U||c)(x.\u0275\u0275inject(x.Injector))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:c,factory:c.\u0275fac})}}var _=a(19808),C=a(94660),y=a(97502),E=a(62278);class I{constructor(B){this._injector=B,this._subscription=new E.Subscription,this._handlerRegisterMap=new Map;for(const[,U]of P.InternalRequestHandlerRegistry.requestHandlersMap)this._registerHandler(U);this._subscription.add(P.InternalRequestHandlerRegistry.onAddRequestHandler((U,k)=>{this._registerHandler(k)})),this._subscription.add(P.InternalRequestHandlerRegistry.onRemoveRequestHandler((U,k)=>{this._removeHandler(k)}))}_registerHandler(B){const{type:U,scopes:k,requestType:K,createHandler:H,lazy:G,lazyModuleRef:J,source:z}=B.instanceConfig;this._handlerRegisterMap.has(U)?P.HandlerChainService.instance.update({type:U,createHandler:H}):this._handlerRegisterMap.set(U,P.HandlerChainService.instance.register({type:U,requestType:K,scopes:[...k??[]],source:z,createHandler:H,lazy:G,lazyModuleRef:J}))}_removeHandler(B){const{type:U}=B.instanceConfig;this._handlerRegisterMap.get(U)()}ngOnDestroy(){this._subscription.unsubscribe(),this._handlerRegisterMap.forEach(B=>{B()})}static{this.\u0275fac=function(U){return new(U||I)(x.\u0275\u0275inject(x.Injector))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:I,factory:I.\u0275fac,providedIn:"root"})}}const N={provide:x.APP_INITIALIZER,useFactory:()=>()=>{},deps:[I],multi:!0};var S=a(41756);class b{create(B){const{validator:U,...k}=B,K=k.params.map(({name:H})=>H);return class extends S._J{constructor(H){super(H),this.async=k.async}_getMessageFromParams(H){return{[k.type]:{message:H.message}}}_setParamsProxy(H){return new Proxy(H,{get(G,J){if(K.includes(J))return G[J];throw new Error(`Property ${J} is not defined in validator params config`)}})}_toPromise(H){let G;return H instanceof Promise?G=H:H instanceof E.Observable?G=(0,E.lastValueFrom)(H,{defaultValue:null}):G=Promise.resolve(H),G}validate(H,G){let J=G;G&&(J=this._setParamsProxy(G));const Z=U(J)(H,J);return this.isAsync?this._toPromise(Z).then(ee=>ee&&J?.message?this._getMessageFromParams(J):ee):J?.message&&Z?this._getMessageFromParams(J):Z}}}}var j=a(21018),f=a(98594);const R={get:w=>{if(w===f.L)return{create:()=>(0,E.of)(null)};if(w===j.MeasurePerformanceService)return{measure:(B,U)=>U(),measureCallback:(B,U)=>U(),measure$:B=>U=>U}}};var e=a(31725),t=a(28399),i=a(36486),r=a(28114),l=a(47096);class g{constructor(B,U){this._modelGenerator=B,this._measurePerformanceService=U}_getSchemaDiff(B,U){const k=(0,e.diff)(B?.viewModelConfig??{},U?.viewModelConfig??{}),K=(0,e.diff)(B?.modelConfig??{},U?.modelConfig??{}),H=(0,e.diff)(B?.resources??{},U?.resources??{});return{changedAttributesDiff:k,changedModelDiff:K,changedResourcesDiff:H}}diff(B,U,k){return this._measurePerformanceService.measure("ViewModelDiffPatch.diff",()=>{const{changedAttributesDiff:K,changedModelDiff:H,changedResourcesDiff:G}=this._getSchemaDiff(B,U);if((0,t.isEmpty)(K)&&(0,t.isEmpty)(H))return(0,E.of)({actualViewModelConfig:U?.viewModelConfig,resources:G});K.attributes=K.attributes||{},H.dataSources=H.dataSources||{};let J=Object.keys(K.attributes);const z=Object.keys(H.dataSources),Z=Object.keys(U.viewModelConfig?.attributes??{}).filter(Y=>{const Q=U.viewModelConfig.attributes[Y]??{};if((0,l.o7)(Q))return z.includes(Q.modelConfig?.path)||J.includes(Q.modelConfig?.sortingConfig?.attributeName)});J=(0,t.uniq)([...J,...Z]);const ee=J.map(Y=>{const Q=U.viewModelConfig.attributes[Y]??{};if((0,l.o7)(Q))return Q?.modelConfig?.path?.split(".")[0]}).filter(Boolean);return this._modelGenerator.generate(U.modelConfig,k).pipe(this._measurePerformanceService.measure$("ViewModelDiffPatch.diff.modelGenerate"),(0,i.map)(Y=>({actualViewModelConfig:U?.viewModelConfig,attributes:{changed:J},resources:G,models:{changed:Y.filter(Q=>ee.includes(Q.name))}})))})}static{this.\u0275fac=function(U){return new(U||g)(x.\u0275\u0275inject(r.n),x.\u0275\u0275inject(j.MeasurePerformanceService))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:g,factory:g.\u0275fac})}}var A=a(49159),p=a(11848);const D="LiveEditingNotifier";class n{constructor(B){this._messageChannelService=B,this._subscribeEntityChanged()}get liveEditingEvent$(){return this._messageChannelService.messageEvent$.pipe((0,i.filter)(B=>B.header.sender===D),(0,i.map)(B=>{const U=B.body;return{entitySchemaName:U.EntitySchemaName,columnNames:U.ColumnNames,primaryColumnValue:U.PrimaryColumnValue,eventType:this._getLiveEditingEventType(U.EventType),primaryColumnName:U.PrimaryColumnName,connectedLiveSchemaColumns:U.ConnectedLiveSchemaColumns}}))}_subscribeEntityChanged(){this.liveEditingEvent$.subscribe(B=>{this._notifyModel(B)})}_notifyModel(B){A.q.instance.notify({modelId:(0,P.generateGuid)(),dataSchemaName:B.entitySchemaName,type:B.eventType,payload:{primaryAttributesValues:[[{name:B.primaryColumnName,value:B.primaryColumnValue}]],changedAttributes:B.columnNames}})}_getLiveEditingEventType(B){switch(B){case 0:return p.MQ.Create;case 1:return p.MQ.Update;case 2:return p.MQ.Delete;default:break}}static{this.\u0275fac=function(U){return new(U||n)(x.\u0275\u0275inject(j.MessageChannelService))}}static{this.\u0275prov=x.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}const d={provide:x.APP_INITIALIZER,useFactory:()=>()=>{},deps:[n],multi:!0};var V=a(10763)},49159:($,W,a)=>{a.d(W,{q:()=>O});var s=a(62278),m=a.n(s);const M=window;class O{constructor(){this._event$=new s.Subject}static get instance(){return M.__modelEventNotificationService||(M.__modelEventNotificationService=new O),M.__modelEventNotificationService}get event$(){return this._event$.asObservable()}notify(x){this._event$.next(x)}}},46416:($,W,a)=>{a.d(W,{bg:()=>s,zH:()=>x,II:()=>F});class s{}var m=a(73308),M=a(38495),O=a(59131);class F extends s{processRequest(T,h){return(0,m.A)(function*(){const{model:u,payload:v}=h??{},L={...T,model:u&&M.Model[M._from](u),payload:v};return yield M.HandlerChainService.instance.process(L)})()}onBeforeLoad(T){return this.processRequest({type:"crt.HandleBeforeModelLoadRequest",previousPayload:T?.previousPayload},T)}onAfterLoad(T){var h=this;return(0,m.A)(function*(){yield h.processRequest({type:"crt.HandleAfterModelLoadRequest",previousPayload:T?.previousPayload},T)})()}onBeforeInsert(T){return this.processRequest({type:"crt.HandleBeforeModelInsertRequest"},T)}onAfterInsert(T){var h=this;return(0,m.A)(function*(){yield h.processRequest({type:"crt.HandleAfterModelInsertRequest"},T)})()}onBeforeUpdate(T){return this.processRequest({type:"crt.HandleBeforeModelUpdateRequest"},T)}onAfterUpdate(T){var h=this;return(0,m.A)(function*(){yield h.processRequest({type:"crt.HandleAfterModelUpdateRequest"},T)})()}onBeforeDelete(T){return this.processRequest({type:"crt.HandleBeforeModelDeleteRequest"},T)}onAfterDelete(T){var h=this;return(0,m.A)(function*(){yield h.processRequest({type:"crt.HandleAfterModelDeleteRequest"},T)})()}static{this.\u0275fac=(()=>{let T;return function(u){return(T||(T=O.\u0275\u0275getInheritedFactory(F)))(u||F)}})()}static{this.\u0275prov=O.\u0275\u0275defineInjectable({token:F,factory:F.\u0275fac,providedIn:"root"})}}class x extends F{processRequest(T,h){return super.processRequest({...T,$context:this._context?.deref()},h)}setContext(T){this._context=new WeakRef(T)}static{this.\u0275fac=(()=>{let T;return function(u){return(T||(T=O.\u0275\u0275getInheritedFactory(x)))(u||x)}})()}static{this.\u0275prov=O.\u0275\u0275defineInjectable({token:x,factory:x.\u0275fac})}}},10763:($,W,a)=>{a.d(W,{B:()=>P});var s=a(28399),m=a.n(s),M=a(62278),O=a.n(M),F=a(59131),x=a.n(F);class P{constructor(){this.changedValues$=new M.Subject,this._valuesStore={}}setValues(h){if(h){const u={};Object.entries(h).forEach(([v,L])=>{const o=this._valuesStore[v]!==L;this._valuesStore[v]=(0,s.cloneDeep)(L),o&&(u[v]=this._valuesStore[v])}),(0,s.isEmpty)(u)||this.changedValues$.next(u)}}get values(){return this._valuesStore}static{this.\u0275fac=function(u){return new(u||P)}}static{this.\u0275prov=F.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac})}}},19808:($,W,a)=>{a.d(W,{v:()=>O});var s=a(47096),m=a(59131);const M=a(85088);class O{sort(x,P){const T=[];let h=[];Object.entries(x||{}).forEach(([v,L])=>{if((0,s.tC)(L)){let o=L.from;o=Array.isArray(o)?o:[o];const c=o.map(_=>[v,_]);h=h.concat(c)}else T.push(v)});const u=M(h).reverse();return[...T,...u].filter(Boolean).filter((v,L,o)=>o.indexOf(v)===L).map(v=>{const L=u.includes(v)?x[v]??P[v]:x[v];return[v,L]})}static{this.\u0275fac=function(P){return new(P||O)}}static{this.\u0275prov=m.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac,providedIn:"root"})}}},40155:($,W,a)=>{a.d(W,{x:()=>M});var s=a(59131),m=a.n(s);const M=new s.InjectionToken("View model attribute creator factory")},30662:($,W,a)=>{a.d(W,{x:()=>s.x});var s=a(40155)},47096:($,W,a)=>{a.d(W,{H2:()=>y.H,Tb:()=>C,iR:()=>c.iR,SC:()=>E,A1:()=>s,Jt:()=>L,OP:()=>T,NI:()=>u,$9:()=>c.$9,Rz:()=>c.Rz,tC:()=>_.isCalculatedAttributeConfig,MT:()=>M,o7:()=>_.isModelAttributeConfig,aW:()=>N,CB:()=>c.CB,og:()=>P,SH:()=>x,OL:()=>h});function s(S,b="value"){return S.map(j=>({displayValue:j.caption,value:j[b],uId:j.uId}))}var m=a(38495);function M(S){const b=S?.config;if(!b)return!1;const j=b;if(!!(j.dataSourceConfig&&j.attributeName))return!0;const R=b;return R.loadType===m.DataSourceLoadType.Load||R.loadType===m.DataSourceLoadType.Reload}var O=a(56711),F=a(36486);function x(S){Object.values(S.controls||{}).forEach(b=>{b instanceof O.FormGroup||b instanceof O.FormArray?x(b):b.updateValueAndValidity({onlySelf:!0})})}function P(S){S?.markAsPristine(),S?.markAsUntouched(),S?.updateValueAndValidity()}function T(S){return Object.values(S?.errors||{}).map(b=>b?.message).filter(Boolean)}function h(S){return S.statusChanges.pipe((0,F.startWith)(S.status),(0,F.first)(()=>S.status.toLowerCase()!=="pending"),(0,F.map)(()=>{}))}function u(S,b){const j=S.getBoundDataSchema(b),f=S.getBoundDataSourceName(b),R=j?.attributes.find(e=>S.getViewModelAttributePath(f,e.name)===b);return Promise.resolve({...R,referenceSchemaName:R?.referenceSchemaName??j?.name})}var v=a(73308);function L(S,b){return o.apply(this,arguments)}function o(){return o=(0,v.A)(function*(S,b){const j=typeof b=="string"?b.split("."):b;let f=j.shift(),R=S;for(;f;)R=yield R[f],f=j.shift();return R}),o.apply(this,arguments)}var c=a(3928),_=a(21018);class C{static _trimValueIfNeeded(b,j){return j?.trimValue&&!C.isEmptyInputValue(b)&&(0,_.isString)(b)?b.trim():b}static isEmptyInputValue(b){return b==null||(typeof b=="string"||Array.isArray(b))&&b.length===0}static hasValidLength(b){return b!=null&&typeof b.length=="number"}static getControlValueAndTrimIfNeeded(b,j){return C._trimValueIfNeeded(b.value,j)}}var y=a(86036);function E(S,b,j,f){return S=[...S||[]],b.forEach(R=>{const t=R.getDataSource()?.dataSourceName,i=f?.[t];(0,c.CB)(R)&&i?.type!==_.DataSourceLoadingType.OnInit&&(S.find(l=>(l.name||j)===t)||S.push({name:t,action:m.ModelInPageAction.Add}))}),S}var I=a(41821);function N(S){return S===I.F.ForTheSelectedPage||S===I.F.ForTheSelectedRecords}},86036:($,W,a)=>{a.d(W,{H:()=>P});var s=a(38495),m=a.n(s),M=a(21018),O=a.n(M),F=a(28399),x=a.n(F);class P{static _setImageLookupTypeUrl(h,u){const v=h[u],L=v?.value;L&&(v.url=(0,M.getImageFullUrlById)(L))}static _setBlobTypeUrl(h,u,v){const L=u[v];if(L){const o=u.Id;u[v]={value:L,url:(0,M.getImageFullUrlById)(o,h,v)}}}static _addImageUrl(h,u,v){u.forEach(L=>{switch(L.dataValueType){case s.DataValueType.IMAGELOOKUP:{this._setImageLookupTypeUrl(v,L.name);break}case s.DataValueType.Image:{this._setBlobTypeUrl(h,v,L.name);break}default:break}})}static serializeRecordPrimaryAttributesValues(h){return h.map(u=>`${u.name}:${u.value}`).join(";")}static getModelPrimaryAttributeValues(h,u){const v=h.getPrimaryAttributesNames();return u.map(L=>v.map(o=>({name:o,value:L[o]})))}static getOwnColumnsValues(h,u){const v=u??{};if(h.attributes.length){const L=h.attributes.filter(o=>o.attributeType===s.DataSchemaAttributeType.OwnAttribute).map(o=>o.name).filter(o=>!(0,F.isUndefined)(v[o])).map(o=>[o,v[o]]);return Object.fromEntries(L)}else return v}static getPrimaryAttributeValuesFromParameters(h,u){const v=u.filter(L=>L.type===s.ModelParameterType.PrimaryColumnValue);return v.length?v.map(L=>({[h.primaryAttributeName]:L.value})):[]}static getPrimaryAttributeValuesFromData(h,u){const v=h.getPrimaryAttributesNames();return v.length?v.filter(L=>u[L]).map(L=>({[L]:u[L]})):[]}static getPrimaryAttributeValues(h,u,v){const L=this.getPrimaryAttributeValuesFromData(h,u);return L.length?L:this.getPrimaryAttributeValuesFromParameters(h,v)}static getDataSourceLoadOptions(h){const u={loadType:h?.loadType||s.DataSourceLoadType.Load};return h?.pagingConfig&&(u.pagingConfig=h.pagingConfig),h?.sortingConfig&&(u.sortingConfig=h.sortingConfig),h?.isDistinct&&(u.isDistinct=h.isDistinct),u}static getImageAttributes(h,u){const v=[];return(u||[]).forEach(L=>{const o=h.findAttributeByName(L);o?.isImage&&v.push(o)}),v}static processImageData(h,u,v){const L=P.getImageAttributes(h,v);return L.length>0&&u.forEach(o=>this._addImageUrl(h.name,L,o)),u}static removeNotRequestedData(h,u){return Object.keys(u).forEach(v=>{h.includes(v)||delete u[v]}),u}static getLoadRequestSignature(h,u,v,L){return JSON.stringify(h)+JSON.stringify(u)+JSON.stringify(v)+JSON.stringify(L)}}},3928:($,W,a)=>{a.d(W,{$9:()=>L,CB:()=>v,Rz:()=>u,iR:()=>o});var s=a(38495),m=a.n(s),M=a(21018),O=a.n(M),F=a(62278),x=a.n(F),P=a(36486),T=a.n(P),h=a(37015);function u(c){for(;c?.parent;)c=c.parent;return c}function v(c){return c.getDataSource()?.scope===s.DataSourceScope.Page}function L(c){const _=[];return c?._modelsMap.forEach((C,y)=>{v(C)&&_.push(y)}),_}class o{static{this._dataCache=new WeakMap}static _getDataSourceColumns(_){const C={};let y=!1;for(const[E,I]of Object.entries(_.dataSourceConfig.config.attributes)){const N=I.path;C[(0,M.removeSpecialSymbols)(E)]=N,N==="Id"&&(y=!0)}return!y&&_.includePrimaryAttributes!==!1&&(C.Id="Id"),C}static _createAttributesConfigMap(_,C,y,E,I){const N={},S=this.getAttributeDataSourceOldName(_,E);for(const[b]of Object.entries(C)){const j=I.config?.useOriginalAttributesName?`${b}`:`${S}_${b}`,f=I.config.attributes[b],R={path:`${y}.${b}`,type:f?.type,functionConfig:f?.functionConfig,aggregationConfig:f?.aggregationConfig};N[j]={modelConfig:R}}return N}static _createAttributePagingConfig(_){return _.pagingConfig||{rowCount:30}}static _createAttributeSortingConfig(_){return _.sortingConfig||{attributeName:_.attributeName+"Sorting"}}static _createAttributeFiltersConfig(_){return _.filtersConfig?.map(C=>{const y={...C};return delete y.value,y})||[]}static _getDataSourceNameForDynamicModel(_,C){return _.getBoundDataSourceNameByAttributePath(C)||this._getAttributeDataSourceDefaultName(C)}static _getDynamicDataSourceNamePrefix(){return`${h.wY}_`}static _isDynamicDataSourceName(_){return _.startsWith(this._getDynamicDataSourceNamePrefix())}static _getAttributeDataSourceDefaultName(_){return`${_}${h.kr}`}static _getLoadData(_,C,y,E){let I;return this._dataCache.has(_)?I=this._dataCache.get(_):(I=C.load(y,[]).pipe((0,P.share)(),(0,P.tap)(()=>this._dataCache.delete(_))),this._dataCache.set(_,I)),(0,F.lastValueFrom)(I.pipe((0,F.map)(()=>E())),{defaultValue:null})}static createAttributeConfig(_,C,y){const E=y.attributeName,I=y.dataSourceConfig,N=this._getDataSourceColumns(y),S=this._createAttributesConfigMap(_,N,C,E,I),b=this._createAttributePagingConfig(y),j=this._createAttributeSortingConfig(y),f=this._createAttributeFiltersConfig(y);return{isCollection:!0,modelConfig:{path:C,pagingConfig:b,sortingConfig:j,filterAttributes:f},viewModelConfig:{attributes:S}}}static getAttributeDataSourceOldName(_,C){let y=this._getDataSourceNameForDynamicModel(_,C);return(!y||this._isDynamicDataSourceName(y))&&(y=this._getAttributeDataSourceDefaultName(C)),y}static createDynamicDataSourceNameFromAttributeName(_,C){const y=this._getDynamicDataSourceNamePrefix(),E=this._getDataSourceNameForDynamicModel(_,C);return this._isDynamicDataSourceName(E)?E:`${y}${E}`}static defineAsyncAttribute(_,C,y,E,I){const N=y.modelConfig?.path?.split(".")[0],S=_.getModelByName(N),b="isLookup"in y&&y.isLookup,j="isCollection"in y&&y.isCollection;Object.defineProperty(_,C,{get:()=>S&&j&&!b&&!S?.isLoaded?this._getLoadData(S,_,N,E):Promise.resolve(E()),set:I,configurable:!0})}}},29721:($,W,a)=>{a.d(W,{v:()=>x});var s=a(59131),m=a.n(s),M=a(21018),O=a.n(M),F=a(38128);class x{static{this._skippedProperties=["schedule","then"]}constructor(T){this._appInfo=T,this.viewModelConstructor=F.o}static useClass(T,h){return new class extends x{constructor(){super(...arguments),this.viewModelConstructor=T}}(h)}_createProxy(T){return new Proxy(T,{get(h,u){return!(typeof u=="string")||u in h||x._skippedProperties.includes(u)||console.debug(`Attribute ${u} not found.`),h[u]}})}create(T,h,u,v,L,o,c,_){const C=new this.viewModelConstructor(T,h,u,v,L,o,c,_);return this._appInfo?.isDebugEnabled?this._createProxy(C):C}static{this.\u0275fac=function(h){return new(h||x)(s.\u0275\u0275inject(M.ApplicationInfo,8))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:x,factory:x.\u0275fac,providedIn:"root"})}}},99499:($,W,a)=>{a.d(W,{C:()=>C});var s=a(59131),m=a.n(s),M=a(38495),O=a.n(M),F=a(21018),x=a.n(F),P=a(62278),T=a.n(P),h=a(36486),u=a.n(h),v=a(11848),L=a(65576),o=a(4481),c=a(39560),_=a(29721);class C extends c.dX{constructor(){super(...arguments),this._lifecycleHooksRequests={init:o.kU,resume:o.h_,pause:o.S,destroy:o.Si},this.handlerChain=M.HandlerChainService.instance}_processRequest(E,I,N){return this.ngZone.runOutsideAngular(()=>this.sendRequest({...E,scopes:N,$context:I}))}_processViewModelAttributeChanges(E,I){E.events$.pipe((0,h.filter)(N=>N.type===L.n.ChangeAttributeValue&&!N.payload?.preventAttributeChangeRequest)).subscribe({next:N=>{const S=`${v.I4.ProcessingAttributeChangeRequest}-${(0,M.generateGuid)()}`;E._onAsyncTaskStarted(S),this._processRequest(new M.HandleViewModelAttributeChangeRequest(N.payload),E,I).then(()=>E._onAsyncTaskFinished(S))}})}initDependencies(){super.initDependencies(),this.viewModelFactory=this.injector.get(_.v)}generateLifecycleHooks(E,I){Object.entries(this._lifecycleHooksRequests).forEach(([N,S])=>{E[N]=new Proxy(E[N],{apply:(b,j,f)=>{const R=b.apply(j,f);if(!(R instanceof P.Observable))throw new Error(`Method ${N} should return Observable`);return R.pipe((0,h.switchMap)(e=>(0,P.from)(this._processRequest(new S,E,I.scopes)).pipe((0,P.map)(()=>e))))}})})}_generateFromConfig(E,I){const N=I||this.injector,{viewModelConfig:S,modelConfig:b,resources:j,models:f,scopes:R,modelInitConfigs:e,modelConfig:{primaryDataSourceName:t}={},parentViewModel:i,businessRulesActive:r}=E,l=this.viewModelFactory.create(this,N,this._trimEmptyAttributes(S),j,null,R,e,i);return this.generateLifecycleHooks(l,E),this._processViewModelAttributeChanges(l,R),l.init(f,{modelDependencies:b?.dependencies,primaryModelName:t,modelsLoadingConfig:b?.loadingConfig,businessRulesActive:r})}_trimEmptyAttributes(E){const I=E?.attributes??{};return Object.keys(I).forEach(N=>{I[N]||delete I[N]}),{...E,attributes:I}}_generateFromString(E,I){return this.repository.resolveModelConfig(E.viewModelConfig).pipe((0,h.switchMap)(N=>this._generateFromConfig({...E,viewModelConfig:N},I)))}sendRequest(E){return this.handlerChain.process(E)}generate(E,I){const N=I?.get(F.MeasurePerformanceService);return typeof E.viewModelConfig=="string"?N?this._generateFromString(E,I).pipe(N.measure$("viewModelGenerator.generateFromString")):this._generateFromString(E,I):N?this._generateFromConfig(E,I).pipe(N.measure$("viewModelGenerator.generateFromConfig")):this._generateFromConfig(E,I)}static{this.\u0275fac=(()=>{let E;return function(N){return(E||(E=s.\u0275\u0275getInheritedFactory(C)))(N||C)}})()}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:C,factory:C.\u0275fac,providedIn:"root"})}}},66882:($,W,a)=>{a.d(W,{e:()=>T,k:()=>P});var s=a(62278),m=a.n(s),M=a(36486),O=a.n(M),F=a(59131),x=a.n(F);class P{resolveModelConfig(u){return null}static{this.\u0275fac=function(v){return new(v||P)}}static{this.\u0275prov=F.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac,providedIn:"root"})}}class T{constructor(){this.account={attributes:{Name:{},Ships:{isCollection:!0,viewModelConfig:"ship"},Employee:{viewModelConfig:"employee"}}},this.ship={attributes:{Id:{}}},this.employee={attributes:{Name:{},Age:{}}}}resolveModelConfig(u){return(0,s.of)(this[u]).pipe((0,M.delay)(50))}static{this.\u0275fac=function(v){return new(v||T)}}static{this.\u0275prov=F.\u0275\u0275defineInjectable({token:T,factory:T.\u0275fac,providedIn:"root"})}}}}]);
