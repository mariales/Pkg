(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[99384],{99384:(N,B,j)=>{j.r(B),j.d(B,{RelationshipBuilder:()=>d.sA,RelationshipContextPad:()=>d.PW,RelationshipData:()=>d.b8,RelationshipDiagramComponent:()=>d.Xg,RelationshipDiagramFeatures:()=>d.Vf,RelationshipDiagramModeling:()=>d.Z9,RelationshipDiagramModule:()=>d.oR,RelationshipDiagramUtils:()=>d.zX,RelationshipDrawConnection:()=>d.Rw,RelationshipDrawConnectionFeature:()=>d.pC,RelationshipDrawHorizontalConnection:()=>d.RG,RelationshipDrawIndirectConnection:()=>d.NN,RelationshipElementType:()=>d.Hv,RelationshipGroupHighlight:()=>d.yd,RelationshipItemOutline:()=>d.ml,RelationshipLayouter:()=>d.k2,RelationshipLoader:()=>d._g,RelationshipOutline:()=>d.vm,RelationshipOutlineFactory:()=>d.Lk,RelationshipRenderer:()=>d.O_,RelationshipRendererStyles:()=>d.ax,RelationshipRenderingGroup:()=>d.gV,RelationshipRenderingItem:()=>d.QI,RelationshipRenderingShapeFactory:()=>d.cd,RelationshipRules:()=>d.ab,RelationshipSelection:()=>d.nq,RelationshipSizeUtils:()=>d.zs,RelationshipToggleHandler:()=>d.By,RelationshipToggleTools:()=>d.Y0,isHorizontalConnection:()=>d.fN,isIndirectConnection:()=>d.t3,isVerticalConnection:()=>d.DE});var x=j(54538),C=j.n(x),r={};for(const A in x)A!=="default"&&(r[A]=()=>x[A]);j.d(B,r);var d=j(81027)},81027:(N,B,j)=>{j.d(B,{sA:()=>M,PW:()=>Q,b8:()=>qe,Xg:()=>P,Vf:()=>Ae,Z9:()=>K,oR:()=>Y,zX:()=>f,Rw:()=>ie,pC:()=>ge,RG:()=>Re,NN:()=>Se,Hv:()=>x,yd:()=>q,ml:()=>xe,k2:()=>ee,_g:()=>te,vm:()=>X,Lk:()=>G,O_:()=>me,ax:()=>Ee,gV:()=>H,QI:()=>Z,cd:()=>oe,ab:()=>F,nq:()=>_e,zs:()=>E,By:()=>se,Y0:()=>U,fN:()=>Oe,t3:()=>ke,DE:()=>ze});var x;(function(h){h.relationshipItem="relationship-item",h.relationshipContainer="relationship-container",h.connection="connection",h.parentConnection="parent-connection",h.indirectConnection="indirect-connection"})(x||(x={}));var C=j(54538),r=j(5960),d=j(12478),A=j(15534);class f extends A.DiagramUtils{static isFlowNode(e){return[x.relationshipContainer,x.relationshipItem].includes(e?.type)}static isRelationshipContainer(e){return e?.type===x.relationshipContainer}static isRootItem(e){return f.isRelationshipContainer(e)||e?.single===!0}static isRelationshipItem(e){return e?.type===x.relationshipItem}static isIndirectConnection(e){return e?.type===x.indirectConnection}static isHorizontalConnection(e){return e?.type===x.connection&&e.position===0}isFlow(e){const t=[x.connection,x.indirectConnection];return super.isFlow(e)||t.includes(e?.type)}isConnection(e){const t=[x.connection,x.indirectConnection];return super.isConnection(e)||t.includes(e?.type)}}let re=class extends C.BaseElementTools{constructor(e,t){super(e),this.context=e,this.config=t}hasAddItemsMenu(e){return f.isFlowNode(e)}hasConnectConfig(e){return f.isFlowNode(e)}hasDeleteAction(e){return this.context.rules.canDelete(e)}getAddItemsConfig(e){return{add:{action:{click:(t,n)=>{const i=this.getPopupMenuPosition(t,n);this.popupMenu.open(n,"add",i)}},...this.elementToolsConfig.tools.add}}}};re=(0,r.__decorate)([(0,r.__param)(1,(0,C.Inject)("config")),(0,r.__metadata)("design:paramtypes",[Object,Object])],re);let ae=class extends d.ElementToolsFactory{constructor(e,t){super(e),this.context=e,this.config=t}getElementToolsFeature(e){return A.DiagramUtils.isLabel(e)?new d.LabelTools(this.context):new re(this.context,this.config)}};ae=(0,r.__decorate)([(0,r.__param)(1,(0,d.Inject)("config")),(0,r.__metadata)("design:paramtypes",[Object,Object])],ae);var y=j(96590);let O=class extends d.DiagramElementRegistry{constructor(e,t){super(e),this.injector=e,this.utils=t}getChildren(e){return this.getAllElements().filter(t=>t.parent?.id===e.id)}getFlowNodes(){return this.getAllElements().filter(f.isFlowNode)}getContainers(){return this.getAllElements().filter(f.isRelationshipContainer)}getFlows(){return this.getAllElements().filter(e=>this.utils.isFlow(e))}getElementFlows(e){return this.getAllElements().filter(t=>this.utils.isFlow(t)).filter(t=>t.source.id===e.id||t.target.id===e.id)}};O=(0,r.__decorate)([(0,r.__param)(0,(0,y.Inject)("injector")),(0,r.__param)(1,(0,y.Inject)("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,f])],O);let E=class{constructor(e,t,n){this.elements=e,this.registry=t,this.localStorage=n}static{this.canMove=!1}static getSpacing(e){switch(e){case x.relationshipItem:return{x:100,y:70};case x.relationshipContainer:return{x:70,y:100};case"scroll":return{x:50,y:50};default:return{x:10,y:8}}}setExpandedContainersIds(e){e.length>0?this.localStorage.set("expanded-containers",e.join(",")):this.localStorage.remove("expanded-containers")}getExpandedContainersIds(){return(this.localStorage.get("expanded-containers")||"").split(",")}getElementSize(e){const t=this.elements.getConfig(e);return e.collapsed===!1?{width:e.expandedWidth||t.width,height:e.expandedHeight||t.height*2}:{width:t.width,height:t.height}}saveContainersState(){const e=this.registry.getContainers().filter(t=>t.collapsed===!1).map(t=>t.id);this.setExpandedContainersIds(e)}loadContainersState(e){const t=this.getExpandedContainersIds().filter(n=>e.elements[n]?.hasChildren);t.map(n=>e.elements[n]).forEach(n=>n.collapsed=!1),this.setExpandedContainersIds(t)}};E=(0,r.__decorate)([(0,r.__param)(0,(0,y.Inject)("elements")),(0,r.__param)(1,(0,y.Inject)("elementRegistry")),(0,r.__param)(2,(0,y.Inject)("localStorage")),(0,r.__metadata)("design:paramtypes",[d.DiagramElements,O,d.DiagramLocalStorage])],E);let F=class extends d.BaseDiagramRules{constructor(e,t,n,i){super(e,t),this.eventBus=e,this.utils=n,this.elementRegistry=i}getCountConnection(e,t,n){return this.elementRegistry.filter(o=>o!==n&&(o.source===e&&o.target===t||o.source===t&&o.target===e)).length}canRead(e){return e.canRead!==!1}canConnect(e,t){let n=super.canConnect(e,t);return n&&(n=(!e||this.canRead(e))&&(!t||this.canRead(t))),n}canConnectionCreate(e){const t=e.source,n=e.target,i=e.connection;return super.canConnectionCreate(e)&&t!==n&&t.parent!==n&&t!==n.parent&&!this.utils.isConnection(t)&&!this.utils.isConnection(n)&&this.getCountConnection(t,n,i)<2}canReconnectEnd(e){const t=super.canReconnectEnd(e),{hover:n,connection:i}=e,o=i.source,s=n||e.target;return t&&this.canConnectionCreate({source:o,target:s,connection:i})}canReconnectStart(e){const t=super.canReconnectStart(e),{hover:n,connection:i}=e,o=n||e.source,s=i.target;return t&&this.canConnectionCreate({source:o,target:s,connection:i})}canShowPalette(){return!1}canElementMove(e){return E.canMove}canElementCopy(e){return!1}canElementPaste(e){return!1}canElementUpdateType(e){return!1}canLabelEdit(){return!1}canShowConnectionOutline(){return!1}canConnectionSegmentMove(){return!1}canElementsDelete(e){let t=super.canElementsDelete(e);const n=e.elements;return t=t&&n.every(i=>this.canDelete(i)),t?t=this.eventBus.fire("elements.removing",{elements:n}):this.eventBus.fire("elements.noAccessMessage",{elements:n}),t}canDelete(e){const t=this.canEdit(e);if(!t)return!1;if(this.utils.isFlow(e))return t;if(!this.elementRegistry.getElementFlows(e).every(o=>this.canEdit(o)))return!1;if(f.isRelationshipContainer(e))return this.elementRegistry.getChildren(e).every(a=>this.canEdit(a));if(f.isRelationshipItem(e)){const o=e;return o.single?!0:this.canRead(o.parent)}return!0}canEdit(e){if(f.isRoot(e))return!1;if(this.utils.isFlow(e)){const n=e;return this.canConnect(n.source,n.target)}return this.canRead(e)}};F=(0,r.__decorate)([(0,r.__param)(0,(0,y.Inject)("eventBus")),(0,r.__param)(1,(0,y.Inject)("config")),(0,r.__param)(2,(0,y.Inject)("diagramUtils")),(0,r.__param)(3,(0,y.Inject)("elementRegistry")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object])],F);let de=class extends d.ElementTools{constructor(e,t,n,i,o,s,a,l,c,p,u,g){super(e,t,n,i,o,s,a,l,c,p),this.elements=c,this.elementToolsConfig=p,this.registry=u,this.rules=g,this.config=l;const m=this.config.localizableStrings,b={modeling:n,localizableStrings:m,contextPad:t,canvas:a,popupMenu:s,elementFactory:i,create:o,connect:e,elements:c,elementToolsConfig:p,registry:u,rules:g};this.initializeElementToolsFactory(b)}initializeElementToolsFactory(e){this.toolsFactory=new ae(e,this.config)}};de=(0,r.__decorate)([(0,r.__param)(0,(0,d.Inject)("connect")),(0,r.__param)(1,(0,d.Inject)("contextPad")),(0,r.__param)(2,(0,d.Inject)("modeling")),(0,r.__param)(3,(0,d.Inject)("elementFactory")),(0,r.__param)(4,(0,d.Inject)("create")),(0,r.__param)(5,(0,d.Inject)("popupMenu")),(0,r.__param)(6,(0,d.Inject)("canvas")),(0,r.__param)(7,(0,d.Inject)("config")),(0,r.__param)(8,(0,d.Inject)("elements")),(0,r.__param)(9,(0,d.Inject)("elementToolsConfig")),(0,r.__param)(10,(0,d.Inject)("elementRegistry")),(0,r.__param)(11,(0,d.Inject)("diagramRules")),(0,r.__metadata)("design:paramtypes",[Object,Object,d.DiagramModeling,Object,Object,Object,Object,Object,d.DiagramElements,Object,Object,F])],de);let J=class extends C.CommonElementToolsConfig{constructor(e,t){super(e,t),this.elements=e,this.config=t,this.innerTools=this.getInnerTools()}getInnerTools(){return{...this.config?.customElementToolsConfig?.innerTools||{}}}};J=(0,r.__decorate)([(0,r.__param)(0,(0,C.Inject)("elements")),(0,r.__param)(1,(0,C.Inject)("config")),(0,r.__metadata)("design:paramtypes",[C.DiagramElements,Object])],J);var v=j(87004);class xe extends d.DiagramShapeOutline{getCreateOutlineConfig(){const e=super.getCreateOutlineConfig();return Object.assign(e,{x:10,y:10,width:100,height:100,rx:8,ry:8})}updateOutline(e,t){const n=this.config.offset;(0,v.CF)(e,{x:-n,y:-n,rx:8,ry:8,width:t.width+n*2,height:t.height+n*2})}}let G=class extends d.OutlineFactory{constructor(e,t,n,i){super(e,t,n,i),this.styles=e,this.rules=t,this.elements=n,this.diagramUtils=i,this.flowNodeConfig=this.getFlowNodeConfig(),this.flowConfig=this.getFlowConfig()}getFlowConfig(){const e=this.getConfig();return e.outlineStyle.stroke="#b033d3",e}getFlowNodeConfig(){const e=this.getConfig();return e.offset=1.5,e.outlineStyle.strokeDasharray="none",e.outlineStyle.strokeWidth="3px",e}getOutline(e){switch(!0){case f.isFlowNode(e):return new xe(this.flowNodeConfig);case this.diagramUtils.isFlow(e):return new d.DiagramConnectionOutline(this.flowConfig);default:return super.getOutline(e)}}};G=(0,r.__decorate)([(0,r.__param)(0,(0,d.Inject)("styles")),(0,r.__param)(1,(0,d.Inject)("rules")),(0,r.__param)(2,(0,d.Inject)("elements")),(0,r.__param)(3,(0,d.Inject)("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,d.DiagramElements,d.DiagramUtils])],G);var V=j(19187),S=j(52965),be;let H=class extends d.RenderingBaseShape{constructor(e,t,n,i,o){super(e,t,n,i),this.elements=e,this.styles=t,this.diagramText=n,this.eventBus=i,this.canvas=o,this._groupsOverflowAmount=3,this._commentIconBase64="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgdmlld0JveD0iMCAwIDEwIDEwIj48ZGVmcz48c3R5bGU+LmEsLmJ7ZmlsbDpub25lO30uYXtzdHJva2U6I2ZmZjtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMjkgMC4wMjkpIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjQ3MSAwLjQ3MSkiPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTQxMy4yNSwzODAuNzM1aC0ydjJsLTMtMmgtNHYtNmg5WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDIyLjI1IC0zNzQuNzM1KSIvPjwvZz48L2c+PHJlY3QgY2xhc3M9ImIiIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIvPjwvc3ZnPg=="}_createAdditionalGroupsIcon(e,t,n){const i=(0,v.vt)("rect",{stroke:"gray","stroke-width":1,fill:"#ffffff",height:18,width:18,x:e.x-20,y:e.y,rx:10,ry:10});(0,v.BC)(t,i);const o=`+${n.length-this._groupsOverflowAmount}`,s={box:{height:18,width:18},style:{fill:"#60779F !important"},className:"show-all-group-caption"},a=this.createText(t,o,s);return(0,S.pd)(a,e.x-20,e.y,0),a}_getAdditionalGroupsHtml(e){let t='<div class="additional-groups">';for(const n of e){let i="",o="",s="";n.itemComment&&(i=" has-comment",o=`<div class="additional-group-comment">${n.itemComment}</div>`,s='<div class="comment-icon-gray"></div>'),t+=`
				<div class="additional-group-container">
					<div class="additional-group-container-header">
						<div class="circle" style="background-color:${n.color}"></div>
						<div class="additional-group-name${i}">${n.caption}</div>
						${s}
					</div>
					${o}
				</div>`}return t+="</div>"}_drawCommentIcon(e,t,n){const i=(0,v.vt)("rect",{fill:n.color,height:10,rx:5,ry:5,width:15,x:t.x,y:t.y});(0,v.BC)(e,i),(0,S.pd)(i,-5,0,0);const o=this._commentIconBase64,s=this.styles.style({height:10,width:10}),a=(0,v.vt)("image",s);a.setAttributeNS("http://www.w3.org/1999/xlink","href",o),a.setAttributeNS(null,"preserveAspectRatio","xMidYMid meet"),(0,v.BC)(e,a),(0,S.pd)(a,t.x,t.y,0)}_addCommentListener(e,t,n){e.addEventListener("click",()=>{const i=`<div class="group-item-comment">
							 	<h4 class="caption">
									<span class="circle" style="background-color:${n.color}"></span>
									${n.caption}
								</h4>
							 	<p class="item-comment">${n.itemComment}</p>
							 </div>`;this.eventBus.fire("popup.open",{parentContainer:t,html:i,width:278,options:{direction:"right"}})})}draw(e,t){const n=(0,v.vt)("g",{class:"group-container"});(0,v.BC)(e,n);const i=t.groups||[];if(i.length===0)return;const o=5,s=100,a=16,l=a/2,c={x:t.width,y:t.height-a/2},p=i.length,u=p>this._groupsOverflowAmount,g=(u?this._groupsOverflowAmount:p)-1;if(u){const m=this._createAdditionalGroupsIcon(c,n,i),b=this._getAdditionalGroupsHtml(i);m.addEventListener("click",()=>{const w=this.canvas.viewbox();this.eventBus.fire("popup.open",{parentContainer:m,html:b,width:Math.round(t.width*w.scale)})}),c.x-=o+15}for(let m=0;m<=g;m++){const b=i[m],_=b.itemComment?"group-item has-item-comment":"group-item",R=(0,v.vt)("g",{class:_});(0,v.BC)(n,R),c.x-=s+o;const D=(0,v.vt)("rect",{fill:b.color,height:a,rx:l,ry:l,width:s,x:c.x,y:c.y});(0,v.BC)(R,D);const I=b.caption,fe=b.itemComment?s-24:s-10,je={box:{height:a,width:fe},className:"group-caption"},Be=this.createText(R,I,je);if((0,S.pd)(Be,c.x+5,c.y,0),b.itemComment){const tt={x:c.x+s-17,y:c.y+4};this._drawCommentIcon(R,tt,b),this._addCommentListener(R,Be,b)}}return n}};H=(0,r.__decorate)([(0,r.__param)(0,(0,d.Inject)("elements")),(0,r.__param)(1,(0,d.Inject)("styles")),(0,r.__param)(2,(0,d.Inject)("diagramText")),(0,r.__param)(3,(0,d.Inject)("eventBus")),(0,r.__param)(4,(0,d.Inject)("canvas")),(0,r.__metadata)("design:paramtypes",[Object,typeof(be=typeof V.A<"u"&&V.A)=="function"?be:Object,d.DiagramTextUtils,Object,Object])],H);var ce=j(52687);let U=class{constructor(e,t,n){this.modeling=e,this.elements=t,this.elementToolsConfig=n,this.containerClassName="toggle-container",this.rectClassName="toggle-rect",this.imageClassName="toggle-image"}toggle(e){this.modeling.toggleCollapse(e)}onClick(e,t){t.stopPropagation(),this.toggle(e)}clear(e){const t=(0,ce.query)("."+this.containerClassName,e);t&&(0,ce.remove)(t)}draw(e,t){this.clear(e);const n=t.collapsed?8:24,i={height:30,width:30+n,class:this.containerClassName},o=(0,v.vt)("g",i);(0,v.BC)(e,o);const a=this.elements.getConfig(t).height-i.height;(0,S.pd)(o,t.width-i.width,a,0);const l={height:i.height,width:i.width,fill:"transparent",class:this.rectClassName},c=(0,v.vt)("rect",l);(0,v.BC)(o,c),ce.event.bind(o,"click",this.onClick.bind(this,t));const p={height:6,width:10,class:this.imageClassName},u=(0,v.vt)("image",p),g=this.elementToolsConfig.innerTools.toggle,m=t.collapsed?g?.expandImageUrl||j(65070):g?.collapseImageUrl||j(34035);u.setAttributeNS("http://www.w3.org/1999/xlink","href",m),(0,v.BC)(o,u);const b=i.width-p.width-n,w=i.height/2-p.height/2;(0,S.pd)(u,b,w,0)}};U=(0,r.__decorate)([(0,r.__param)(0,(0,y.Inject)("modeling")),(0,r.__param)(1,(0,y.Inject)("elements")),(0,r.__param)(2,(0,y.Inject)("elementToolsConfig")),(0,r.__metadata)("design:paramtypes",[Object,Object,J])],U);let X=class extends d.DiagramOutline{constructor(e,t,n,i,o){super(e,t),this.outlineFactory=t,this.diagramText=n,this.relationshipRenderingGroup=i,this.relationshipToggleTools=o}drawGroups(e,t){f.isRelationshipItem(t)&&t.canRead!==!1&&this.relationshipRenderingGroup.draw(e,t)}drawToggleTools(e,t){t.hasChildren?this.relationshipToggleTools.draw(e,t):this.relationshipToggleTools.clear(e)}onShapeAdded(e){super.onShapeAdded(e),this.drawGroups(e.gfx,e.element),this.drawToggleTools(e.gfx,e.element)}onShapeChanged(e){super.onShapeChanged(e),this.drawToggleTools(e.gfx,e.element)}};X=(0,r.__decorate)([(0,r.__param)(0,(0,d.Inject)("eventBus")),(0,r.__param)(1,(0,d.Inject)("outlineFactory")),(0,r.__param)(2,(0,d.Inject)("diagramText")),(0,r.__param)(3,(0,d.Inject)("relationshipRenderingGroup")),(0,r.__param)(4,(0,d.Inject)("relationshipToggleTools")),(0,r.__metadata)("design:paramtypes",[Object,G,d.DiagramTextUtils,H,U])],X);var ye=j(28399),Fe=j.n(ye);let le=class{constructor(e,t,n){this.config=e,this.modeling=t,this.popupMenu=n,this.popupMenu.registerProvider("add",this)}createHeaderEntry(e,t){const n=e.entitySchemaData;return{id:n.name,className:"add-item-button-tool",label:n.caption,action:()=>{this.modeling.addNewConnection({source:t,targetType:e.type}),this.popupMenu.close()}}}getPopupMenuEntries(e){return{}}getHeaderEntries(e){const t=[],n=[x.relationshipContainer,x.relationshipItem];return(0,ye.forOwn)(this.config.customDiagramElements,i=>{n.includes(i.type)&&t.push(this.createHeaderEntry(i,e))}),t}};le=(0,r.__decorate)([(0,r.__param)(0,(0,d.Inject)("config")),(0,r.__param)(1,(0,d.Inject)("modeling")),(0,r.__param)(2,(0,d.Inject)("popupMenu")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object])],le);let M=class{constructor(e,t,n,i,o,s){this.sizeUtils=e,this.diagramUtils=t,this.modeling=n,this.registry=i,this.canvas=o,this.eventBus=s}elementTreeExists(e,t){return e.some(n=>n.some(i=>i.id===t.id))}fillTreeLevel(e,t,n,i){const s=this.getElementChildren(t,n).filter(a=>!this.elementTreeExists(i,a));s.forEach(a=>{this.addTreeElement(e,a,i)}),s.forEach(a=>{this.fillTreeLevel(e+1,a,n,i)})}addTreeElement(e,t,n){t.level=e;const i=Math.abs(e),o=n[i]=n[i]||[];o.map(a=>a.id).includes(t.id)||o.push(t)}getDirectConnections(e){let t=[];return e.connections&&(t=Object.values(e.connections).filter(n=>n.type===x.connection&&n.position!==0)),t}getHorizontalConnections(e){let t=[];return e.connections&&(t=Object.values(e.connections).filter(n=>n.type===x.connection&&n.position===0)),t}getLevelWidth(e){if(!e?.length)return 0;const t=e[e.length-1];return t.x+this.getElementWidth(t)}getElementWidth(e){return this.sizeUtils.getElementSize(e).width}getElementHeight(e){return this.sizeUtils.getElementSize(e).height}getElementChildren(e,t){const n=this.getDirectConnections(t).filter(i=>i.source===e.id).map(i=>t.elements[i.target]);return Array.from(new Set(n))}getTreeWidth(e){let t=0;return e.forEach(n=>{const i=this.getLevelWidth(n);t<i&&(t=i)}),t}getTreeBottomY(e){const n=e[e.length-1][0];return n.y+this.getElementHeight(n)}fixTreePositionX(e,t){const n=this.getTreeWidth(t);t.forEach(i=>{const o=this.getLevelWidth(i),s=(n-o)/2;i.forEach(a=>{a.x+=s,Object.values(e.elements).filter(c=>String(c.parent)===a.id).forEach(c=>c.x+=s)})})}getContainerChildren(e,t){return Object.values(t.elements).filter(n=>String(n.parent)===e.id)}fillContainerTreePosition(e,t){const n=this.getContainerChildren(e,t);if(e.hasChildren=n.length>0,e.hasChildren){const i=E.getSpacing(x.relationshipContainer),o=i.x,s=i.y,a=this.buildTree(t,n);this.fillTreePosition(t,a,e.x+o,e.y+s);const l=this.getTreeWidth(a),c=this.getTreeBottomY(a);e.expandedWidth=l-e.x+o,e.expandedHeight=c-e.y+s,this.fixTreePositionX(t,a)}}fillTreePosition(e,t,n=0,i=0){const o=E.getSpacing(x.relationshipItem);let s=i;for(const a of t){let l=n,c=0;for(const g of a){g.x=l,g.y=s,this.fillContainerTreePosition(g,e),l+=this.getElementWidth(g)+o.x;const m=this.getElementHeight(g);c=Math.max(c,m)}const p=Object.values(e.elements).filter(f.isRootItem),u=this.getHorizontalElements(e,p);this.fixOnlyChildByParents(e,a,u),s+=c+o.y}}fixOnlyChildByParents(e,t,n){let i=0,o=0,s=!1;const a=Object.values(e.elements),l=this.getDirectConnections(e);do{for(const c of t){const p=l.filter(g=>g.target===c.id);if(p.length===1){const g=p[0];if(!n.includes(g.target)){const m=g.source,b=a.find(_=>_.id===m);if(!this.hasLevelIntercept(b.x,c,t)){const _=b.x||0;_!==c.x&&(this.changeElementX(c,_,e),o++)}}}}s=i!==o,i=o}while(o<t.length&&s)}changeElementX(e,t,n){const i=t-e.x;e.x=t,f.isRelationshipContainer(e)&&this.getContainerChildren(e,n).forEach(s=>s.x+=i)}hasLevelIntercept(e,t,n){const i=n.map(p=>({id:p.id,x:p.id===t.id?e:p.x,type:p.type,width:this.getElementWidth(p)}));if(i.find(p=>p.id!==t.id&&p.x===t.x))return!0;i.sort((p,u)=>p.x-u.x);const s=i.findIndex(p=>p.id===t.id),a=i[s-1],l=E.getSpacing(x.relationshipItem);if(a){const p=a.x+a.width+l.x;if(e<=p)return!0}const c=i[s+1];if(c){const p=i[s];if(p.x+p.width+l.x>=c.x)return!0}return!1}getHorizontalElements(e,t){const n=new Set;return this.getHorizontalConnections(e).forEach(o=>{n.add(o.source),n.add(o.target)}),Array.from(n).filter(o=>t.find(s=>s.id===o))}buildSubTree(e,t,n,i,o,s){this.addTreeElement(o,e.elements[t],i),n.push(t),this.getDirectConnections(e).filter(a=>(s<0?a.target:a.source)===t).map(a=>s<0?a.source:a.target).filter(a=>!n.includes(a)).forEach(a=>{this.buildSubTree(e,a,n,i,o+s,s)})}mergeTrees(e){const t=this.flat(e).map(a=>a.level),n=Math.min(...t),i=Math.max(...t),o=-n;e.forEach(a=>{a.forEach(l=>{l.forEach(c=>{c.levelFixed||(c.level+=o,c.levelFixed=!0)})})});const s=new Array(i-n+1).fill(0).map(()=>[]);return e.forEach(a=>{a.forEach(l=>{l.forEach(c=>{const p=c.level,u=s[p];u.every(g=>g.id!==c.id)&&u.push(c)})})}),s}flat(e){return e.flat(1/0)}addSingleItems(e,t,n){const i=this.flat(n).map(o=>o.id);t.filter(o=>!i.includes(o.id)).forEach(o=>{this.addTreeElement(0,o,n),this.fillTreeLevel(1,o,e,n)})}buildTree(e,t){let n=[];const i=this.getHorizontalElements(e,t);if(i.length>0){const o=[],s=[...i];i.forEach(a=>{let l=!1;const c=[];this.buildSubTree(e,a,s,c,0,-1);const p=this.flat(c);if(p.length>1){const m=Math.min(...p.map(b=>b.level));c.reverse(),c.forEach((b,w)=>{b.forEach(_=>_.level=m+w)}),o.push(c),l=!0}const u=[];this.buildSubTree(e,a,s,u,0,1),(this.flat(u).length>1||!l)&&o.push(u)}),n=this.mergeTrees(o),this.addSingleItems(e,t,n)}else{const o=this.getDirectConnections(e),s=t.filter(a=>o.every(l=>l.target!==a.id));for(const a of s)this.addTreeElement(0,a,n),this.fillTreeLevel(1,a,e,n)}return n}getElements(){const e={};return this.registry.getFlowNodes().forEach(n=>{const i=this.sizeUtils.getElementSize(n);e[n.id]={id:n.id,originalId:n.originalId,type:n.type,parent:n.parent?.id,collapsed:n.collapsed,single:n.single,canRead:n.canRead,...i}}),e}getConnections(){const e={};return this.registry.getFlows().forEach(n=>{const i=n.realTarget||n.target,o=n.realSource||n.source;e[n.id]={id:n.id,originalId:n.originalId,type:n.type,target:i.id,source:o.id,position:n.position}}),e}getDiagramData(){const e={};return e.elements=this.getElements(),e.connections=this.getConnections(),e}fixElementsPosition(e){this.registry.getFlowNodes().forEach(n=>{const i=e.elements[n.id],o={x:i.x-n.x,y:i.y-n.y};(o.x||o.y)&&this.modeling.moveShape(n,o)})}hideConnections(){this.registry.getFlows().forEach(t=>{t.hidden=!0})}updateAllConnections(e){const t=Object.values(e.connections),n=t.filter(o=>!f.isIndirectConnection(o));this.updateConnections(n);const i=t.filter(f.isIndirectConnection);this.updateConnections(i)}updateConnections(e){e.forEach(({id:t,source:n,target:i})=>{const o=this.registry.get(t);let s=this.registry.get(n),a=this.registry.get(i);[s,a]=this.modeling.updateConnectionInfo(o,o.parent,s,a),o.source=s,o.target=a,this.modeling.layoutConnection(o,{}),this.canvas.bringToFrontElement(o);const l=o.labels[0];if(l){const{id:c,caption:p}=l;this.modeling.removeShape(l),this.modeling.createDiagramLabel({id:c,value:{caption:p,parent:t}})}})}calculateElementsPosition(e){const t=Object.values(e.elements).filter(f.isRootItem),n=this.buildTree(e,t);this.fillTreePosition(e,n)}updateElements(){this.hideConnections();const e=this.getDiagramData();this.calculateElementsPosition(e),this.fixElementsPosition(e),this.updateAllConnections(e)}};M=(0,r.__decorate)([(0,r.__param)(0,(0,d.Inject)("relationshipSizeUtils")),(0,r.__param)(1,(0,d.Inject)("diagramUtils")),(0,r.__param)(2,(0,d.Inject)("modeling")),(0,r.__param)(3,(0,d.Inject)("elementRegistry")),(0,r.__param)(4,(0,d.Inject)("canvas")),(0,r.__param)(5,(0,d.Inject)("eventBus")),(0,r.__metadata)("design:paramtypes",[E,f,Object,O,Object,Object])],M);class Ge extends d.DiagramConnectionHighlight{constructor(){super(...arguments),this.highlightClassName="highlight"}get supportHighlight(){return!0}bringToFront(){}}let Q=class extends d.DiagramContextPad{constructor(e,t,n,i,o){super(e,t,n,i),this.eventBus=e,this.overlays=t,this.rules=n,this.canvas=i,this.utils=o,this.oneColumnMode=!0,this.elementDataActionAttributeName="data-action"}canOpen(e){return e.canRead===!1||this.utils.isFlow(e)&&(e.source.canRead===!1||e.target.canRead===!1)?!1:super.canOpen(e)}fixEntries(e){return e}addEntriesContainer(e){const t=super.addEntriesContainer(e);return this.sortContainersEntries(t)}sortContainersEntries(e){return this.getSortedContainersEntries(e).forEach(n=>{e.removeChild(n),e.appendChild(n)}),e}getSortedContainersEntries(e){const t=this.getEntriesOrder(),n=Array.from(e.children);return n.sort((i,o)=>{const s=i.getAttribute(this.elementDataActionAttributeName),a=o.getAttribute(this.elementDataActionAttributeName),l=t.get(s),c=t.get(a);return l>c?1:-1}),n}getEntriesOrder(){const e="add",t="connect",n="delete";return new Map([[e,0],[t,1],[n,2]])}};Q=(0,r.__decorate)([(0,r.__param)(0,(0,d.Inject)("eventBus")),(0,r.__param)(1,(0,d.Inject)("overlays")),(0,r.__param)(2,(0,d.Inject)("rules")),(0,r.__param)(3,(0,d.Inject)("canvas")),(0,r.__param)(4,(0,d.Inject)("diagramUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object])],Q);var He=j(10018);let K=class extends C.DiagramModeling{constructor(e,t,n,i,o,s,a,l,c,p){super(e,t,n,i,o,s,a,l,c),this.eventBus=e,this.elementFactory=t,this.commandStack=n,this.canvas=i,this.registry=o,this.diagramText=s,this.elements=a,this.rules=l,this.diagramUtils=c,this.sizeUtils=p,this.convertUtils=new C.ProcessConvertUtils(c)}getElementAttributes(e,t,n){const i=super.getElementAttributes(e,t,n),{subCaption:o,collapsed:s,groups:a,info:l,expandedWidth:c,expandedHeight:p,hidden:u,originalId:g,hasChildren:m,single:b,canRead:w,position:_}=t;return{...i,subCaption:o,collapsed:s,groups:a,info:l,expandedWidth:c,expandedHeight:p,hidden:u,originalId:g,hasChildren:m,single:b,canRead:w,position:_}}createDiagramElement(e,t){const n=t[e],i=t[n.parent];i&&i.collapsed&&(n.hidden=!0);const{width:o,height:s}=this.sizeUtils.getElementSize(n);n.width=o,n.height=s,super.createDiagramElement(e,t)}removeConnection(e,t={}){super.removeConnection(e);const n=this.getElement(e);this.eventBus.fire("diagram.connection.delete",{element:n},t)}createConnection(e,t,n,i,o,s){if(typeof n=="object"&&(s=o,o=i,i=n,n=void 0),i?.type!==x.parentConnection)return[e,t,o]=this.updateConnectionInfo(i,o,e,t),super.createConnection(e,t,n,i,o,s)}updateConnectionInfo(e,t,n,i){let o;switch(e.hidden=!1,e.type){case x.connection:[n,i].every(f.isRelationshipItem)&&(t=n.parent,t.collapsed&&(e.hidden=!0));break;case x.indirectConnection:if(e.realSource=n,e.realTarget=i,[n,i]=[n,i].map(s=>s.hidden?s.parent:s),o=e.hidden,n.id===i.id?(n=e.realSource,i=e.realTarget,e.hidden=!0):e.hidden=!1,e.hidden!==o&&e.label){const s=this.registry.getGraphics(e.label),a=e.hidden?"none":"block";(0,v.CF)(s,"display",a)}break;default:break}return[n,i,t]}addNewConnection(e){this.eventBus.fire("diagram.connection.adding",e)}getHandlers(){return super.getHandlers()}positionViewboxRelativeToElement(e){const t=this.canvas.viewbox(),n=(0,He.U7)(e),i={x:Math.round(n.x+n.width/2-t.outer.width/2),y:n.y-130,width:t.outer.width,height:t.outer.height};this.canvas.viewbox(i),this.canvas.zoom(t.scale)}};K=(0,r.__decorate)([(0,r.__param)(0,(0,C.Inject)("eventBus")),(0,r.__param)(1,(0,C.Inject)("elementFactory")),(0,r.__param)(2,(0,C.Inject)("commandStack")),(0,r.__param)(3,(0,C.Inject)("canvas")),(0,r.__param)(4,(0,C.Inject)("elementRegistry")),(0,r.__param)(5,(0,C.Inject)("diagramText")),(0,r.__param)(6,(0,C.Inject)("elements")),(0,r.__param)(7,(0,C.Inject)("rules")),(0,r.__param)(8,(0,C.Inject)("diagramUtils")),(0,r.__param)(9,(0,C.Inject)("relationshipSizeUtils")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,C.DiagramElements,Object,f,E])],K);var Ue=j(40969);let pe=class extends Ue.A{constructor(e,t,n){super(e,t),this.eventBus=e,this.registry=t,this.selection=n}updateContainments(){}update(e,t,n){super.update(e,t,n),t?.hidden&&this.selection.deselect(t)}};pe=(0,r.__decorate)([(0,r.__param)(0,(0,y.Inject)("eventBus")),(0,r.__param)(1,(0,y.Inject)("elementRegistry")),(0,r.__param)(2,(0,y.Inject)("selection")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object])],pe);var T=j(98218),ve=j(17521),We=j(34495),W=10;function L(h,e,t){return t||(t="round"),Math[t](h/e)*e}var Ze=1200,Ye=800;function k(h,e,t){var n=!t||t.active!==!1;this._eventBus=e;var i=this;e.on("diagram.init",Ye,function(){i.setActive(n)}),e.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],Ze,function(o){var s=o.originalEvent;if(!(!i.active||s&&(0,We.nM)(s))){var a=o.context,l=a.gridSnappingContext;l||(l=a.gridSnappingContext={}),["x","y"].forEach(function(c){var p={},u=Ve(o,c,h);u&&(p.offset=u);var g=Je(o,c);g&&(0,T.assign)(p,g),(0,ve.AC)(o,c)||i.snapEvent(o,c,p)})}})}k.prototype.snapEvent=function(h,e,t){var n=this.snapValue(h[e],t);(0,ve.CU)(h,e,n)},k.prototype.getGridSpacing=function(){return W},k.prototype.snapValue=function(h,e){var t=0;e&&e.offset&&(t=e.offset),h+=t,h=L(h,W);var n,i;return e&&e.min&&(n=e.min,(0,T.isNumber)(n)&&(n=L(n+t,W,"ceil"),h=Math.max(h,n))),e&&e.max&&(i=e.max,(0,T.isNumber)(i)&&(i=L(i+t,W,"floor"),h=Math.min(h,i))),h-=t,h},k.prototype.isActive=function(){return this.active},k.prototype.setActive=function(h){this.active=h,this._eventBus.fire("gridSnapping.toggle",{active:h})},k.prototype.toggleActive=function(){this.setActive(!this.active)},k.$inject=["elementRegistry","eventBus","config.gridSnapping"];function Je(h,e){var t=h.context,n=t.createConstraints,i=t.resizeConstraints||{},o=t.gridSnappingContext,s=o.snapConstraints;if(s&&s[e])return s[e];s||(s=o.snapConstraints={}),s[e]||(s[e]={});var a=t.direction;n&&($(e)?(s.x.min=n.left,s.x.max=n.right):(s.y.min=n.top,s.y.max=n.bottom));var l=i.min,c=i.max;return l&&($(e)?we(a)?s.x.max=l.left:s.x.min=l.right:Ce(a)?s.y.max=l.top:s.y.min=l.bottom),c&&($(e)?we(a)?s.x.min=c.left:s.x.max=c.right:Ce(a)?s.y.min=c.top:s.y.max=c.bottom),s[e]}function Ve(h,e,t){var n=h.context,i=h.shape,o=n.gridSnappingContext,s=o.snapLocation,a=o.snapOffset;return a&&(0,T.isNumber)(a[e])||(a||(a=o.snapOffset={}),(0,T.isNumber)(a[e])||(a[e]=0),!i)||(t.get(i.id)||($(e)?a[e]+=i[e]+i.width/2:a[e]+=i[e]+i.height/2),!s)||(e==="x"?/left/.test(s)?a[e]-=i.width/2:/right/.test(s)&&(a[e]+=i.width/2):/top/.test(s)?a[e]-=i.height/2:/bottom/.test(s)&&(a[e]+=i.height/2)),a[e]}function $(h){return h==="x"}function Ce(h){return h.indexOf("n")!==-1}function we(h){return h.indexOf("w")!==-1}let he=class extends k{constructor(e,t,n,i){super(e,t,i),this.elementRegistry=e,this.eventBus=t,this.sizeUtils=n,this.config=i}snapValue(e,t,n=W){let i=0;t&&t.offset&&(i=t.offset),e+=i,e=L(e,n);let o,s;return t&&t.min&&(o=t.min,(0,T.isNumber)(o)&&(o=L(o+i,n,"ceil"),e=Math.max(e,o))),t&&t.max&&(s=t.max,(0,T.isNumber)(s)&&(s=L(s+i,n,"floor"),e=Math.min(e,s))),e-=i,e}};he=(0,r.__decorate)([(0,r.__param)(0,(0,y.Inject)("elementRegistry")),(0,r.__param)(1,(0,y.Inject)("eventBus")),(0,r.__param)(2,(0,y.Inject)("relationshipSizeUtils")),(0,r.__param)(3,(0,y.Inject)("config")),(0,r.__metadata)("design:paramtypes",[Object,Object,E,Object])],he);let q=class{constructor(e,t,n){this.eventBus=e,this.canvas=t,this.elementRegistry=n,this.SHOW_GROUPS_CLASS="show-groups",this.FADE_ITEM_CLASS="fade-item",this.subscribeEvents()}subscribeEvents(){this.eventBus.on("selection.changed",this.onSelectionChanged.bind(this)),this.eventBus.on("relationshipGroup.highlight.changed",this.onGroupHighlightChanged.bind(this))}onGroupHighlightChanged(e){const t=e.id;this.clearHighlights(),t&&this.highlightItemsByGroupId(t)}onSelectionChanged(e){this.clearHighlights();const t=e.newSelection;if(t.length===1){const n=t[0];f.isRelationshipItem(n)&&n.groups?.length&&this.showGroupsByItem(n)}}removeMarkers(e){this.canvas.removeMarker(e,this.SHOW_GROUPS_CLASS),this.canvas.removeMarker(e,this.FADE_ITEM_CLASS)}showGroupsByItem(e){const t=e.groups,n=this.getAllItems(),i=this.getGroupIds(t);n.forEach(o=>{this.getGroupIds(o.groups).some(l=>i.includes(l))?this.showItemGroups(o):this.fadeItem(o)})}getAllItems(){return this.elementRegistry.filter(e=>f.isRelationshipItem(e))}getGroupIds(e){return e.map(t=>t.id)}showItemGroups(e){this.addMarker(e,this.SHOW_GROUPS_CLASS)}addMarker(e,t){this.canvas.addMarker(e,t)}fadeItem(e){this.addMarker(e,this.FADE_ITEM_CLASS)}clearHighlights(){this.getAllItems().forEach(e=>{this.removeMarkers(e)})}highlightItemsByGroupId(e){this.getAllItems().forEach(n=>{n.groups.some(o=>e===o.id)?this.showItemGroups(n):this.fadeItem(n)})}};q=(0,r.__decorate)([(0,r.__param)(0,(0,y.Inject)("eventBus")),(0,r.__param)(1,(0,y.Inject)("canvas")),(0,r.__param)(2,(0,y.Inject)("elementRegistry")),(0,r.__metadata)("design:paramtypes",[Object,Object,Object])],q);var Ie=j(74419);let ee=class extends d.Layouter{constructor(e,t,n,i,o){super(e,o),this.connectionDocking=e,this.elements=t,this.registry=n,this.sizeUtils=i,this.config=o}getRelationItemConnectPoint(e,t){const n=this.elements.getConfig(e),i=f.isIndirectConnection(t)||e.collapsed===!1,o=i?e.width:n.imageWidth,s=i?e.height:n.imageHeight;return{x:e.x+o/2,y:e.y+s/2}}getLines(e){const t=[];for(let n=0;n<e.length-1;n++){const i=e[n],o=e[n+1],s=i.x<=o.x&&i.y<=o.y?{first:{x:i.x,y:i.y},second:{x:o.x,y:o.y}}:{first:{x:o.x,y:o.y},second:{x:i.x,y:i.y}};t.push(s)}return t}intersect(e,t,n,i,o,s,a,l){const c=Math.max(e,o),p=Math.min(i,l),u=Math.min(n,a),g=Math.max(t,s),m=u-c,b=p-g;return m<=0||b<=0?0:m*b}intersectElements(e,t){const i=this.getLines(e);for(const o of i)for(const s of t){const{width:a,height:l}=this.elements.getConfig(s),c=o.first.x,p=o.first.y,u=o.second.x+.01,g=o.second.y+.01,m=s.x+2,b=s.y+2,w=s.x+a-2,_=s.y+l-2;if(this.intersect(c,p,u,g,m,b,w,_))return!0}return!1}samePoint(e,t){return e.x===t.x&&e.y===t.y}similarLines(e,t){const n=this.getLines(e);for(const i of t){const o=this.getLines(i.waypoints);if(JSON.stringify(n)===JSON.stringify(o)||(o.reverse(),JSON.stringify(n)===JSON.stringify(o)))return!0}return!1}intersectPoints(e,t){const n=this.getLines(e);for(const i of n)for(const o of t){const s=this.getLines(o.waypoints);for(const a of s)if(this.samePoint(i.first,a.first)||this.samePoint(i.first,a.second)||this.samePoint(i.second,a.first)||this.samePoint(i.second,a.second))return!0}return!1}buildWaypoints(e,t,n,i,o,s){const a=Ie.Z9(t,n,i,o,s),l=Object.assign(e);return l.waypoints=Ie.d7(a),this.connectionDocking.getCroppedWaypoints(l,t,n)}getLayouts(e=!1){return[...e?["v:v","h:h"]:["h:h","v:v"],"h:v","v:h","b:b","t:t","l:l","r:r","l:t","l:r","l:b","t:l","t:r","t:b","r:l","r:t","r:b","b:l","b:t","b:r"]}indirectConnectionLayouts(){return this.getLayouts()}horizontalConnectionLayouts(){return this.getLayouts()}directConnectionLayouts(){return this.getLayouts(!0)}buildSmartConnection(e,t,n,i,o,s,a,l){let c;const p=this.registry.getFlowNodes().filter(w=>w.hidden!==!0),u=this.registry.getFlows().filter(w=>w.hidden!==!0&&w.id!==e.id);let g=0;const m=[];s.preferredLayouts=[""],c=this.buildWaypoints(e,t,n,i,o,s),m.push({waypoints:c,weight:0});do{const w=a[g];s.preferredLayouts=[w],c=this.buildWaypoints(e,t,n,i,o,s);const _=this.intersectElements(c,p);let R=!1,D=!1;if(!_&&(R=this.similarLines(c,u),!R&&(!l||(D=this.intersectPoints(c,u),!D))))break;const I=+!_+ +!R+ +!D;m.push({waypoints:c,weight:I,layout:w}),g++}while(g<a.length);return g===a.length&&(m.length===1?c=m[0].waypoints:(m.sort((w,_)=>w.weight-_.weight),c=m.slice(-1)[0].waypoints)),c}buildConnection(e,t,n,i,o,s){return this.buildWaypoints(e,t,n,i,o,s)}layoutConnection(e,t={}){const n=t.source||e.source,i=t.target||e.target,o=n&&this.getRelationItemConnectPoint(n,e),s=i&&this.getRelationItemConnectPoint(i,e);let a,l=!0;switch(!0){case f.isIndirectConnection(e):a=this.indirectConnectionLayouts();break;case f.isHorizontalConnection(e):a=this.horizontalConnectionLayouts();break;default:l=!1,a=this.directConnectionLayouts();break}return this.buildSmartConnection(e,n,i,o,s,t,a,l)}};ee=(0,r.__decorate)([(0,r.__param)(0,(0,d.Inject)("connectionDocking")),(0,r.__param)(1,(0,d.Inject)("elements")),(0,r.__param)(2,(0,d.Inject)("elementRegistry")),(0,r.__param)(3,(0,d.Inject)("relationshipSizeUtils")),(0,r.__param)(4,(0,d.Inject)("config")),(0,r.__metadata)("design:paramtypes",[Object,d.DiagramElements,O,E,Object])],ee);var Xe=j(73308);let te=class extends d.DiagramLoader{constructor(e,t,n,i,o,s,a,l,c,p){super(e,t,n,i,p),this.elementRegistry=e,this.diagramModeling=t,this.elements=n,this.eventBus=i,this.sizeUtils=o,this.canvas=s,this.localStorage=a,this.zoomScroll=l,this.builder=c}fixData(e){e.elements=e.elements||{},e.connections=e.connections||{},e.labels=e.labels||{},e.groups=e.groups||{}}fixIds(e){["elements","connections","labels","groups"].forEach(t=>{let n=e[t]||{};n instanceof Array&&(n=e[t]=Fe().keyBy(n,"id")),Object.keys(n).forEach(i=>{n[i].id!==i&&(n[i].id=i)})})}fixConnectionsDefaults(e){Object.values(e.connections).forEach(t=>{t.type=t.type??x.connection,t.position=t.relationshipType?.position??-1})}formatUniqId(...e){return e.join("_")}fixParents(e){const{elements:t,connections:n,labels:i}=e,o=[],s=[],a=[],l=[];Object.values(n).forEach(I=>{const fe=t[I.source],je=t[I.target];switch(I.originalId=I.id,I.type){case x.connection:f.isRelationshipContainer(fe)||f.isRelationshipContainer(je)?o.push(I):s.push(I);break;case x.parentConnection:a.push(I);break;default:l.push(I)}});const c=this.fixItems(a,t),p=this.fixSingleItems(t,n),g=[...this.fixContainers(c,t),...c,...p],m=this.fixItemsConnections(s,c),b=this.fixItemsConnections(s,p),w=this.fixConnections(l,g),_=this.fixConnections(a,g),R=[...o,...m,...b,..._,...w];this.sortConnectionsOrder(R);const D=this.fixLabels(i,R);e.elements={},e.connections={},e.labels={},g.forEach(I=>e.elements[I.id]=I),R.forEach(I=>e.connections[I.id]=I),D.forEach(I=>e.labels[I.id]=I)}sortConnectionsOrder(e){e.sort((t,n)=>this.getConnectionOrder(t)-this.getConnectionOrder(n))}getConnectionOrder(e){let t;return f.isIndirectConnection(e)?t=3:f.isHorizontalConnection(e)?t=1:t=2,t}fixSingleItemIncludeIntoContainer(e,t){const n=Object.values(e).filter(f.isRelationshipItem),i=Object.values(t);return n.forEach(o=>{const a=i.filter(l=>o.id===l.target).every(l=>!(l.relationshipType?.includeIntoContainer??!0));o.single=a}),n.filter(o=>o.single)}fixContainers(e,t){const n=Object.values(t).filter(f.isRelationshipContainer);return n.forEach(i=>{i.originalId=i.id,i.hasChildren=e.some(o=>o.parent===i.id)}),n}fixItems(e,t){const n=[];return Array.from(new Set(e.map(o=>o.target))).forEach(o=>{e.filter(a=>a.target===o).forEach(({source:a})=>{const l=Object.assign({},t[o],{id:this.formatUniqId(o,a),originalId:o,parent:a});n.push(l)})}),n}fixSingleItems(e,t){return this.fixSingleItemIncludeIntoContainer(e,t),this.fixSingleItemOriginal(e)}fixSingleItemOriginal(e){const n=Object.values(e).filter(f.isRelationshipItem).filter(i=>i.single);return n.forEach(i=>{i.originalId=i.id}),n}fixItemsConnections(e,t){const n=[];return e.forEach(i=>{const{id:o,source:s,target:a,position:l}=i;t.filter(p=>p.originalId===s).forEach(p=>{const u=p.parent,g=t.find(m=>m.originalId===a&&m.parent===u);if(g){const m=Object.assign({},i,{id:this.formatUniqId(o,u),originalId:o,source:p.id,target:g.id,position:l});n.push(m)}})}),n}fixConnections(e,t){const n=[];return e.forEach(i=>{const{id:o,source:s,target:a,position:l}=i;t.filter(p=>p.originalId===s).forEach(p=>{t.filter(g=>g.originalId===a).forEach(g=>{const m=Object.assign({},i,{id:this.formatUniqId(o,p.id,g.id),originalId:o,source:p.id,target:g.id,position:l});n.push(m)})})}),n}fixLabels(e,t){const n=[];return Object.values(e).forEach(i=>{t.filter(s=>s.originalId===i.parent).forEach(s=>{const a=Object.assign({},i,{id:this.formatUniqId(i.id,s.id),originalId:i.id,parent:s.id});n.push(a)})}),n}mapGroupInfo(e){Object.values(e.elements).filter(t=>f.isRelationshipItem(t)).forEach(t=>{const i=(t.groups||[]).map(o=>{const s=typeof o=="object",a=s?o.id:o,l=s?o.comment:null;return{id:a,itemComment:l}});t.groups=i.map(o=>Object.assign({itemComment:o.itemComment},e.groups[o.id]))})}setContainersCollapsed(e){const t=Object.values(e.elements);t.filter(n=>f.isRelationshipContainer(n)).forEach(n=>{const i=t.filter(o=>o.parent===n.id);e.rootElementId&&i.some(o=>o.recordId===e.rootElementId)?n.collapsed=!1:n.collapsed=n.collapsed??!0})}getConnectionAttributes(e,t){return{...super.getConnectionAttributes(e,t),realSource:t.realSource,realTarget:t.realTarget,position:t.position}}load(e,t,n){var i=()=>super.load,o=this;return(0,Xe.A)(function*(){return o.fixData(e),o.fixIds(e),o.fixConnectionsDefaults(e),o.fixParents(e),o.mapGroupInfo(e),o.setContainersCollapsed(e),o.sizeUtils.loadContainersState(e),o.builder.calculateElementsPosition(e),i().call(o,e,t,n)})()}};te=(0,r.__decorate)([(0,r.__param)(0,(0,d.Inject)("elementRegistry")),(0,r.__param)(1,(0,d.Inject)("modeling")),(0,r.__param)(2,(0,d.Inject)("elements")),(0,r.__param)(3,(0,d.Inject)("eventBus")),(0,r.__param)(4,(0,d.Inject)("relationshipSizeUtils")),(0,r.__param)(5,(0,d.Inject)("canvas")),(0,r.__param)(6,(0,d.Inject)("localStorage")),(0,r.__param)(7,(0,d.Inject)("zoomScroll")),(0,r.__param)(8,(0,d.Inject)("builder")),(0,r.__metadata)("design:paramtypes",[Object,d.DiagramModeling,d.DiagramElements,Object,E,Object,d.DiagramLocalStorage,Object,M,y.LoggerService])],te);var Qe=j(6587);class _e extends Qe.A{}const Ee={Connection:{PathStrokeWidth:1,MarkerFillColor:"#4E7BD8",MarkerStrokeColor:"#4E7BD8",StrokeColor:"#4E7BD8"}},ne=Ee.Connection;class ie extends d.DrawConnection{updateDataItemMarker(e,t,n){const i=n.source,o=n.target;if(i&&o){const s=i.id+"_"+o.id,a=e.elementRegistry.getGraphics(n);(0,v.CF)(a,"data-item-marker",s)}}get endMarker(){const e=(0,v.vt)("path");return(0,v.CF)(e,{d:d.ConnectionProperties.Connection.MarkerShape,"fill-opacity":d.ConnectionProperties.Connection.MarkerfillOpacity,fill:ne.MarkerFillColor,stroke:ne.MarkerStrokeColor,strokeLinejoin:d.ConnectionProperties.Connection.StrokeLinejoin,strokeWidth:d.ConnectionProperties.Connection.StrokeWidth,class:d.ConnectionClasses.ConnectionEndMarker}),e}getConnectionAttributes(e){const t=super.getConnectionAttributes(e);return Object.assign(t,{stroke:ne.StrokeColor,strokeWidth:ne.PathStrokeWidth})}drawConnection(e,t,n){const i=super.drawConnection(e,t,n);return this.updateDataItemMarker(e,t,n),i}}class Re extends ie{startMarker(){return this.endMarker}}class Se extends ie{getConnectionAttributes(e){const t=super.getConnectionAttributes(e);return Object.assign(t,{strokeDasharray:"8 8"})}}class ge{drawConnection(e,t,n){}}(0,r.__decorate)([(0,d.featureImplementationExtension)(ze,ie),(0,d.featureImplementationExtension)(ke,Se),(0,d.featureImplementationExtension)(Oe,Re),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object,Object]),(0,r.__metadata)("design:returntype",Object)],ge.prototype,"drawConnection",null);function ke(h,e,t){return f.isIndirectConnection(t)}function ze(h,e,t){return Te(t)&&t.position!==0}function Oe(h,e,t){return Te(t)&&t.position===0}function Te(h){return h.type===x.connection}class me extends d.DiagramRenderer{drawConnection(e,t){return super.drawConnection(e,t)}}(0,r.__decorate)([(0,d.featureImplementation)(ge,d.FeatureExecutionOrder.instead),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object]),(0,r.__metadata)("design:returntype",void 0)],me.prototype,"drawConnection",null);var De;let Z=class extends d.RenderingBaseShape{constructor(e,t,n,i,o,s){super(e,t,n,s),this.elements=e,this.styles=t,this.diagramText=n,this.sizeUtils=i,this.elementRegistry=o,this.eventBus=s,this._borderRadius=8}drawItemBackground(e,t){const n=this.elements.getConfig(t),i=f.isRoot(t.parent)?n.fill:n.fillInParent,{width:o,height:s}=this.sizeUtils.getElementSize(t);this.drawRect(e,o,s,this._borderRadius,0,{fill:i,stroke:"none"})}drawImage(e,t){const n=this.elements.getConfig(t),i=this.styles.style({height:n.imageHeight,width:n.imageWidth,rx:this._borderRadius,ry:this._borderRadius}),o=(0,v.vt)("image",i),s=t.canRead===!1?n.largeImageNoAccess:t.largeImage||n.largeImage;return o.setAttributeNS("http://www.w3.org/1999/xlink","href",s),o.setAttributeNS(null,"type",n.type),o.setAttributeNS(null,"preserveAspectRatio","xMidYMid meet"),(0,v.BC)(e,o),o}drawImageBorder(e,t){const n=this.elements.getConfig(t),i=n.height,{imageWidth:o=i,imageHeight:s=i}=n;this.drawRect(e,o,s,this._borderRadius,0,{fill:"none",stroke:n.stroke})}drawText(e,t){const n=this.elements.getConfig(t),i=10,o=10,s=10,a=20,l=90,c=t.subCaption;if(c){const g={box:{height:a,width:n.width-n.imageWidth-o},className:"sub-caption"},m=this.createText(e,c,g);(0,S.pd)(m,n.imageWidth+i,s,0)}const p=t.canRead===!1?n.captionNoAccess:t.caption||"#"+t.id;if(p){const g={box:{height:a,width:n.width-n.imageWidth-o},className:"caption"},m=this.createText(e,p,g);(0,S.pd)(m,n.imageWidth+i,30,0)}const u=t.canRead===!1?"":t.info;if(u){const m=(t.collapsed&&t.expandedWidth?t.expandedWidth:t.width)-n.width+l,b=t.collapsed?l:m,w={box:{height:a,width:b},className:"info"},_=this.createText(e,u,w);(0,S.pd)(_,n.width-l-o,s,0)}}drawItemBorder(e,t){const n=this.elements.getConfig(t),{width:i,height:o}=this.sizeUtils.getElementSize(t);this.drawRect(e,i,o,this._borderRadius,0,{fill:"none",stroke:n.stroke})}updateDataItemMarker(e){const t=e.caption;if(t){const n=this.elementRegistry.getGraphics(e);(0,v.CF)(n,"data-item-marker",t)}}getLockImage(){return"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmEsLmJ7ZmlsbDpub25lO30uYntzdHJva2U6IzU0NjU3ZDtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9LmN7c3Ryb2tlOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiLz48cmVjdCBjbGFzcz0iYiIgd2lkdGg9IjExIiBoZWlnaHQ9IjkiIHJ4PSIyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyLjUgNS41KSIvPjxnIGNsYXNzPSJiIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3IDkpIj48cmVjdCBjbGFzcz0iYyIgd2lkdGg9IjIiIGhlaWdodD0iMiIvPjxyZWN0IGNsYXNzPSJhIiB4PSIwLjUiIHk9IjAuNSIgd2lkdGg9IjEiIGhlaWdodD0iMSIvPjwvZz48cGF0aCBjbGFzcz0iYiIgZD0iTS0yNzguNTgxLDM3OC4yNjR2LTIuNWExLjUsMS41LDAsMCwxLDEuNS0xLjVoMmExLjUsMS41LDAsMCwxLDEuNSwxLjV2Mi41IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyODQuMDgxIC0zNzIuNzY0KSIvPjwvc3ZnPg=="}drawLockImage(e,t){const s=this.elements.getConfig(t),a=this.styles.style({height:16,width:16,class:"lock-image"}),l=(0,v.vt)("image",a);l.setAttributeNS("http://www.w3.org/1999/xlink","href",this.getLockImage()),l.setAttributeNS(null,"type",s.type),l.setAttributeNS(null,"preserveAspectRatio","none"),(0,v.BC)(e,l);const c=s.width-16-26,p=s.height-16-13;(0,S.pd)(l,c,p,0)}draw(e,t){super.draw(e,t),this.drawItemBackground(e,t);const n=this.drawImage(e,t);return this.drawImageBorder(e,t),this.drawText(e,t),this.drawItemBorder(e,t),this.updateDataItemMarker(t),t.canRead===!1&&((e.parentElement||e.parentNode).classList.add("no-access"),this.drawLockImage(e,t)),n}};Z=(0,r.__decorate)([(0,r.__param)(0,(0,d.Inject)("elements")),(0,r.__param)(1,(0,d.Inject)("styles")),(0,r.__param)(2,(0,d.Inject)("diagramText")),(0,r.__param)(3,(0,d.Inject)("relationshipSizeUtils")),(0,r.__param)(4,(0,d.Inject)("elementRegistry")),(0,r.__param)(5,(0,d.Inject)("eventBus")),(0,r.__metadata)("design:paramtypes",[d.DiagramElements,typeof(De=typeof V.A<"u"&&V.A)=="function"?De:Object,Object,E,d.DiagramElementRegistry,Object])],Z);let oe=class extends d.RenderingShapeFactory{constructor(e,t,n){super(e,t),this.renderingLabel=e,this.renderingShape=t,this.relationshipRenderingItem=n}create(e){return f.isFlowNode({type:e})?this.relationshipRenderingItem:super.create(e)}};oe=(0,r.__decorate)([(0,r.__param)(0,(0,d.Inject)("renderingLabel")),(0,r.__param)(1,(0,d.Inject)("renderingShape")),(0,r.__param)(2,(0,d.Inject)("relationshipRenderingItem")),(0,r.__metadata)("design:paramtypes",[Object,Object,Z])],oe);var Ke=j(29086);let se=class extends Ke.A{constructor(e,t,n,i,o){super(e),this.eventBus=e,this.modeling=t,this.sizeUtils=n,this.builder=i,this.registry=o,this.subscribeEvents()}subscribeEvents(){this.postExecuted(["shape.toggleCollapse"],d.EventPriority.LOW,e=>{this.sizeUtils.saveContainersState();const t=e.context.shape;this.resizeContainer(t)})}resizeContainer(e){const{width:t,height:n}=this.sizeUtils.getElementSize(e),{x:i,y:o}=e,s={x:i,y:o,width:t,height:n};if(this.modeling.resizeShape(e,s,null,{autoResize:!0}),this.builder.updateElements(),e.collapsed){const a=this.registry.getGraphics(e);this.eventBus.fire("element.out",{gfx:a,element:e})}}};se=(0,r.__decorate)([(0,r.__param)(0,(0,y.Inject)("eventBus")),(0,r.__param)(1,(0,y.Inject)("modeling")),(0,r.__param)(2,(0,y.Inject)("relationshipSizeUtils")),(0,r.__param)(3,(0,y.Inject)("builder")),(0,r.__param)(4,(0,y.Inject)("elementRegistry")),(0,r.__metadata)("design:paramtypes",[Object,Object,E,M,O])],se);const ue={...C.DiagramFeatures,diagramRules:["type",F],renderingShapeFactory:["type",oe],relationshipRenderingItem:["type",Z],relationshipRenderingGroup:["type",H],outlineFactory:["type",G],layouter:["type",ee],outline:["type",X],selection:["type",_e],diagramRenderer:["type",me],diagramUtils:["type",f],modeling:["type",K],diagramLoader:["type",te],contextPadProvider:["type",de],relationshipGroupHighlight:["type",q],relationshipToggleTools:["type",U],relationshipToggleHandler:["type",se],relationshipSizeUtils:["type",E],elementToolsConfig:["type",J],builder:["type",M],addMenuProvider:["type",le],connectionHighlight:["type",Ge],contextPad:["type",Q],graphicsFactory:["type",pe],elementRegistry:["type",O],gridSnapping:["type",he]};ue.__depends__=[...C.DiagramFeatures.__depends__],ue.__init__=[...C.DiagramFeatures.__init__,"relationshipGroupHighlight","relationshipToggleHandler","relationshipSizeUtils","builder","addMenuProvider","gridSnapping"];const Ae=ue;var $e=j(22894);class qe extends $e.DiagramData{constructor(){super(...arguments),this.elements={},this.connections={},this.labels={},this.groups={}}}var z=j(59131),et=j(36486);class P extends d.DiagramComponent{constructor(e){super(e),this.initScroll=E.getSpacing("scroll")}ngOnInit(){this.loaded.pipe((0,et.first)()).subscribe(()=>{const e=this.diagramDataService.data;if(!e.rootElementId)return;const t=Object.values(e.elements).find(i=>i.recordId===e.rootElementId);this.get("modeling").positionViewboxRelativeToElement(t)})}static{this.\u0275fac=function(t){return new(t||P)(z.\u0275\u0275directiveInject(z.Injector))}}static{this.\u0275cmp=z.\u0275\u0275defineComponent({type:P,selectors:[["crt-relationship-diagram"]],features:[z.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["diagramContainer",""],[1,"diagram-container"]],template:function(t,n){t&1&&z.\u0275\u0275element(0,"div",1,0)},styles:[`body{--focus-outline-outer-color: var(--crt-palette-secondary-500);--focus-outline-inner-color: white}.diagram-container .relationship-container .djs-visual .foreign-text{margin-right:20px}.diagram-container .relationship-item .djs-visual .foreign-text{margin-right:10px}.diagram-container .relationship-item .djs-visual image,.diagram-container .relationship-container .djs-visual image{clip-path:inset(0% round 8px)}.diagram-container .relationship-item .djs-visual .foreign-text,.diagram-container .relationship-container .djs-visual .foreign-text{text-align:left;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.diagram-container .relationship-item .djs-visual .sub-caption .foreign-text,.diagram-container .relationship-container .djs-visual .sub-caption .foreign-text{color:#757575!important;font-family:var(--crt-caption-font-family);font-size:var(--crt-caption-font-size);line-height:var(--crt-caption-line-height);font-weight:var(--crt-caption-font-weight);letter-spacing:var(--crt-caption-letter-spacing);text-transform:var(--crt-caption-text-transform);-webkit-font-smoothing:antialiased}.diagram-container .relationship-item .djs-visual .caption .foreign-text,.diagram-container .relationship-container .djs-visual .caption .foreign-text{color:#004fd6!important;font-family:var(--crt-body-2-font-family);font-size:var(--crt-body-2-font-size);line-height:var(--crt-body-2-line-height);font-weight:var(--crt-body-2-font-weight);letter-spacing:var(--crt-body-2-letter-spacing);text-transform:var(--crt-body-2-text-transform);-webkit-font-smoothing:antialiased}.diagram-container .relationship-item .djs-visual .info .foreign-text-container .foreign-text,.diagram-container .relationship-container .djs-visual .info .foreign-text-container .foreign-text{color:#757575!important;font-size:10px;margin-right:0}.diagram-container .relationship-item.no-access .caption .foreign-text,.diagram-container .relationship-container.no-access .caption .foreign-text{color:#181818!important}.diagram-container .relationship-item.hover:not(.selected) .djs-outline,.diagram-container .relationship-container.hover:not(.selected) .djs-outline{stroke-width:1px!important}.diagram-container .relationship-item .lock-image,.diagram-container .relationship-container .lock-image{display:none}.diagram-container .relationship-item.hover .lock-image,.diagram-container .relationship-item.selected .lock-image,.diagram-container .relationship-container.hover .lock-image,.diagram-container .relationship-container.selected .lock-image{display:block}.diagram-container .relationship-item .group-caption .foreign-text-container .foreign-text,.diagram-container .relationship-container .group-caption .foreign-text-container .foreign-text{color:#fff!important;text-align:center;font-size:10px;height:100%;padding-top:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.diagram-container .relationship-item.show-groups .group-container,.diagram-container .relationship-container.show-groups .group-container{visibility:visible}.diagram-container .relationship-item.show-groups .group-container .group-item.has-item-comment,.diagram-container .relationship-container.show-groups .group-container .group-item.has-item-comment{cursor:pointer}.diagram-container .relationship-item.fade-item .djs-hit,.diagram-container .relationship-container.fade-item .djs-hit{fill:#ffffffa6!important}.diagram-container .relationship-item .djs-outline,.diagram-container .relationship-container .djs-outline{stroke:#006ce0!important}.diagram-container .relationship-item .group-container,.diagram-container .relationship-container .group-container{visibility:hidden}.diagram-container .relationship-item .toggle-container,.diagram-container .relationship-container .toggle-container,.diagram-container .relationship-item .show-all-group-caption,.diagram-container .relationship-container .show-all-group-caption{cursor:pointer}.diagram-container .relationship-item .show-all-group-caption .foreign-text-container .foreign-text,.diagram-container .relationship-container .show-all-group-caption .foreign-text-container .foreign-text{text-align:center;font-size:9px;height:100%;line-height:18px}.diagram-container .djs-bendpoints .djs-segment-dragger.horizontal .djs-hit,.diagram-container .djs-bendpoints .djs-segment-dragger.vertical .djs-hit{cursor:default}.diagram-container .djs-bendpoints .djs-segment-dragger.horizontal .djs-visual,.diagram-container .djs-bendpoints .djs-segment-dragger.vertical .djs-visual{visibility:hidden}.diagram-container .djs-diagram-popup{position:absolute;visibility:hidden;background:#fff 0% 0% no-repeat padding-box;box-shadow:0 3px 6px #00000029;border-radius:4px;opacity:.92;max-height:230px;overflow-y:auto;padding:8px}.diagram-container .additional-group-container:first-of-type{padding-top:0}.diagram-container .additional-group-container{font-size:11px;letter-spacing:0px;opacity:1;text-align:left;padding:4.5px 0;line-height:15px}.diagram-container .additional-group-container .additional-group-container-header{display:flex;align-items:center}.diagram-container .additional-group-container .additional-group-container-header .additional-group-name{color:#757575;padding-left:5px;text-align:left}.diagram-container .additional-group-container .additional-group-container-header .additional-group-name.has-comment{color:#006ce0}.diagram-container .additional-group-container .additional-group-container-header .comment-icon-gray{margin-left:4px;width:14px;height:14px;background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAALZJREFUOE9jZKAQMFKon4HaBvxnDA1dzYTPVatXh/5jYGD8D1OD4oL48rkHGf4zWeMz4D/D/yOLupIcsBqQUD7//4LORLzeQleDoniYGPD1HjcLLIBQQxwSQ9xKX/8ghxNqLJTN38PAwIAIYUaGgwwMDLMXdCauiCubd4CRgdGGgYHhwMKuRBessYAt+uLL5i1jYGTgYGRgDMQWQ0SlxISy+QH/GRmzF3YmuKJbQpQB+BLWwBsAAB0qUBHT9fFYAAAAAElFTkSuQmCC) 0% 0% no-repeat padding-box;opacity:1}.diagram-container .additional-group-container .additional-group-comment{padding-top:4px;font-size:13px;color:#181818}.diagram-container .group-item-comment{width:262px}.diagram-container .group-item-comment .circle{margin-right:5px}.diagram-container .group-item-comment .caption{color:#757575;margin:0;font-size:11px;font-weight:400}.diagram-container .group-item-comment .item-comment{margin-top:4px;margin-bottom:0;font-size:13px;line-height:15px;padding-right:8px}.diagram-container .circle{box-sizing:border-box;display:inline-block;border-radius:50%;height:8px;width:8px}.diagram-container .djs-popup.add .djs-popup-header{flex-direction:column;width:auto;border-bottom:none}.diagram-container .djs-popup.add .djs-popup-header .entry{margin-left:0}.diagram-container .djs-popup.add .djs-popup-header .entry.add-item-button-tool{width:100%}.diagram-container .djs-element.djs-connection.hover path.connection{stroke-width:2!important}.diagram-container .djs-element.djs-connection.selected path.connection{stroke-width:3!important}.diagram-container .djs-element.label>.djs-hit-all{pointer-events:none}.diagram-container .djs-connection~.djs-children .label .foreign-text{color:#54657d!important}.diagram-container .djs-connection.selected~.djs-children .label .foreign-text{color:#1186d8!important}.diagram-container .djs-element.djs-connection.highlight path.connection{stroke-width:2!important}
`,`.djs-outline{fill:none;visibility:hidden}.djs-element.hover .djs-outline,.djs-element.selected .djs-outline{visibility:visible;shape-rendering:crispEdges;stroke-dasharray:3,3}.djs-element.selected .djs-outline{stroke:#88f;stroke-width:1px}.djs-element.hover .djs-outline{stroke:#f88;stroke-width:1px}svg.drop-not-ok{background:#f9dee5!important}.djs-connection.connect-ok .djs-visual>:nth-child(1),.djs-connection.drop-ok .djs-visual>:nth-child(1){stroke:#90dd5f!important}.djs-connection.connect-not-ok .djs-visual>:nth-child(1),.djs-connection.drop-not-ok .djs-visual>:nth-child(1){stroke:#e56283!important}.drop-not-ok,.connect-not-ok{cursor:not-allowed}.djs-element.attach-ok .djs-visual>:nth-child(1){stroke-width:5px!important;stroke:#ff7400b3!important}.djs-frame.connect-not-ok .djs-visual>:nth-child(1),.djs-frame.drop-not-ok .djs-visual>:nth-child(1){stroke-width:3px!important;stroke:#e56283!important;fill:none!important}.djs-lasso-overlay{fill:#ff7400;fill-opacity:.1;stroke-dasharray:5 1 3 1;stroke:#ff7400;shape-rendering:crispEdges;pointer-events:none}.djs-resize-overlay{fill:none;stroke-dasharray:5 1 3 1;stroke:#ff7400;pointer-events:none}.djs-resizer-hit{fill:none;pointer-events:all}.djs-resizer-visual{fill:#fff;stroke-width:1px;stroke:#000;shape-rendering:crispEdges;stroke-opacity:.2}.djs-cursor-resize-ns,.djs-resizer-n,.djs-resizer-s{cursor:ns-resize}.djs-cursor-resize-ew,.djs-resizer-e,.djs-resizer-w{cursor:ew-resize}.djs-cursor-resize-nwse,.djs-resizer-nw,.djs-resizer-se{cursor:nwse-resize}.djs-cursor-resize-nesw,.djs-resizer-ne,.djs-resizer-sw{cursor:nesw-resize}.djs-shape.djs-resizing>.djs-outline{visibility:hidden!important}.djs-shape.djs-resizing>.djs-resizer{visibility:hidden}.djs-dragger>.djs-resizer{visibility:hidden}marker.djs-dragger circle,marker.djs-dragger path,marker.djs-dragger polygon,marker.djs-dragger polyline,marker.djs-dragger rect{fill:#ff7400!important;stroke:none!important}marker.djs-dragger text,marker.djs-dragger tspan{fill:none!important;stroke:#ff7400!important}.djs-dragging{opacity:.3}.djs-dragging,.djs-dragging>*{pointer-events:none!important}.djs-dragging .djs-context-pad,.djs-dragging .djs-outline{display:none!important}.djs-visual,.djs-outline{pointer-events:none}.djs-element.attach-ok .djs-hit{stroke-width:60px!important}.djs-element>.djs-hit-all{pointer-events:all}.djs-element>.djs-hit-stroke,.djs-element>.djs-hit-click-stroke{pointer-events:stroke}.djs-drag-active .djs-element>.djs-hit-click-stroke{pointer-events:all}.djs-connection .djs-visual{stroke-width:2px;fill:none}.djs-cursor-grab{cursor:grab}.djs-cursor-grabbing{cursor:grabbing}.djs-cursor-crosshair{cursor:crosshair}.djs-cursor-move{cursor:move}.djs-cursor-resize-ns{cursor:ns-resize}.djs-cursor-resize-ew{cursor:ew-resize}.djs-snap-line{stroke:#ffc342;stroke:#ffc34280;stroke-linecap:round;stroke-width:2px;pointer-events:none}.djs-crosshair{stroke:#555;stroke-linecap:round;stroke-width:1px;pointer-events:none;shape-rendering:crispEdges;stroke-dasharray:5,5}.djs-palette{position:absolute;left:20px;top:20px;box-sizing:border-box;width:48px}.djs-palette .separator{margin:0 5px;padding-top:5px;border:none;border-bottom:solid 1px #DDD;clear:both}.djs-palette .entry:before{vertical-align:text-bottom}.djs-palette .djs-palette-toggle{cursor:pointer}.djs-palette .entry,.djs-palette .djs-palette-toggle{color:#333;font-size:30px;text-align:center}.djs-palette .entry{float:left}.djs-palette .entry img{max-width:100%}.djs-palette .djs-palette-entries:after{content:"";display:table;clear:both}.djs-palette .djs-palette-toggle:hover{background:#666}.djs-palette .entry:hover{color:#ff7400}.djs-palette .highlighted-entry{color:#ff7400!important}.djs-palette .entry,.djs-palette .djs-palette-toggle{width:46px;height:46px;line-height:46px;cursor:default}.djs-palette.two-column.open{width:94px}.djs-palette:not(.open) .djs-palette-entries{display:none}.djs-palette:not(.open){overflow:hidden}.djs-palette.open .djs-palette-toggle{display:none}.djs-overlay-context-pad{width:72px}.djs-context-pad{position:absolute;display:none;pointer-events:none}.djs-context-pad .entry{width:22px;height:22px;text-align:center;display:inline-block;font-size:22px;margin:0 2px 2px 0;border-radius:3px;cursor:default;background-color:#fefefe;box-shadow:0 0 2px 1px #fefefe;pointer-events:all}.djs-context-pad .entry:before{vertical-align:top}.djs-context-pad .entry:hover{background:#fffcb0}.djs-context-pad.open{display:block}.djs-popup .entry{line-height:20px;white-space:nowrap;cursor:default}.djs-popup .entry:before{vertical-align:middle;font-size:20px}.djs-popup .entry>span{vertical-align:middle;font-size:14px}.djs-popup .entry:hover,.djs-popup .entry.active:hover{background:#fffcb0}.djs-popup .entry.disabled{background:inherit}.djs-popup .djs-popup-header .entry{display:inline-block;padding:2px 3px;border:solid 1px transparent;border-radius:3px}.djs-popup .djs-popup-header .entry.active{color:#ff7400;border:solid 1px rgb(255,116,0);background-color:#f6f6f6}.djs-popup-body .entry{padding:4px 10px 4px 5px}.djs-popup-body .entry>span{margin-left:5px}.djs-popup-body{background-color:#fefefe}.djs-popup-header{border-bottom:1px solid #DDD}.djs-popup-header .entry{margin:1px 1px 1px 3px}.djs-popup-header .entry:last-child{margin-right:3px}.djs-popup,.djs-palette{background:#fafafa;border:solid 1px #CCC;border-radius:2px}.djs-shape,.djs-connection{touch-action:none}.djs-segment-dragger,.djs-bendpoint{display:none}.djs-segment-dragger .djs-visual{fill:#ffff7933;stroke-width:1px;stroke-opacity:1;stroke:#ffff794d}.djs-bendpoint .djs-visual{fill:#ffff79cc;stroke-width:1px;stroke-opacity:.5;stroke:#000}.djs-segment-dragger:hover,.djs-bendpoints.hover .djs-segment-dragger,.djs-bendpoints.selected .djs-segment-dragger,.djs-bendpoint:hover,.djs-bendpoints.hover .djs-bendpoint,.djs-bendpoints.selected .djs-bendpoint{display:block}.djs-drag-active .djs-bendpoints *{display:none}.djs-bendpoints:not(.hover) .floating{display:none}.djs-segment-dragger:hover .djs-visual,.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint:hover .djs-visual,.djs-bendpoint.floating .djs-visual{fill:#ff0;stroke-opacity:.5;stroke:#000}.djs-bendpoint.floating .djs-hit{pointer-events:none}.djs-segment-dragger .djs-hit,.djs-bendpoint .djs-hit{pointer-events:all;fill:none}.djs-segment-dragger.horizontal .djs-hit{cursor:ns-resize}.djs-segment-dragger.vertical .djs-hit{cursor:ew-resize}.djs-segment-dragger.djs-dragging .djs-hit{pointer-events:none}.djs-updating,.djs-updating>*{pointer-events:none!important}.djs-updating .djs-context-pad,.djs-updating .djs-outline,.djs-updating .djs-bendpoint,.connect-ok .djs-bendpoint,.connect-not-ok .djs-bendpoint,.drop-ok .djs-bendpoint,.drop-not-ok .djs-bendpoint{display:none!important}.djs-segment-dragger.djs-dragging,.djs-bendpoint.djs-dragging{display:block;opacity:1}.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint.djs-dragging .djs-visual{fill:#ff0;stroke-opacity:.5}.djs-tooltip-error{font-size:11px;line-height:18px;text-align:left;padding:5px;opacity:.7}.djs-tooltip-error>*{width:160px;background:#fcecf0;color:#9e4c4c;padding:3px 7px;border-radius:5px;border-left:solid 5px rgb(174,73,73)}.djs-tooltip-error:hover{opacity:1}.djs-search-container{position:absolute;top:20px;left:0;right:0;margin-left:auto;margin-right:auto;width:25%;min-width:300px;max-width:400px;z-index:10;font-size:1.05em;opacity:.9;background:#fafafa;border:solid 1px #CCC;border-radius:2px}.djs-search-container:not(.open){display:none}.djs-search-input input{font-size:1.05em;width:100%;padding:6px 10px;border:1px solid #ccc}.djs-search-input input:focus{outline:none;border-color:#52b415}.djs-search-results{position:relative;overflow-y:auto;max-height:200px}.djs-search-results:hover{cursor:pointer}.djs-search-result{width:100%;padding:6px 10px;background:#fff;border-bottom:solid 1px #AAA;border-radius:1px}.djs-search-highlight{color:#000}.djs-search-result-primary{margin:0 0 10px}.djs-search-result-secondary{font-family:monospace;margin:0}.djs-search-result:hover{background:#fdffd6}.djs-search-result-selected{background:#fffcb0}.djs-search-result-selected:hover{background:#f7f388}.djs-search-overlay{background:#ff0;opacity:.3}.djs-element-hidden,.djs-element-hidden .djs-hit,.djs-element-hidden .djs-outline,.djs-label-hidden .djs-label{display:none!important}
`,`.diagram-container{position:relative;height:100%;width:100%;margin:0}.diagram-container svg{display:block}.djs-container{direction:ltr}.djs-tooltip{border-radius:4px;padding:8px;width:150px;opacity:.9;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);z-index:1010}.djs-palette{left:10px;top:10px;border-radius:4px;overflow:hidden;padding-top:6px;padding-bottom:6px}.djs-palette.open,.djs-palette.two-column.open{width:46px}.djs-palette .group{padding:0!important;width:100%}.djs-palette .entry{width:32px;height:32px;line-height:32px;margin-left:6px;cursor:pointer}.djs-palette .entry.active{border-radius:7px}.djs-palette .entry.create-menu:after{content:"";position:absolute;width:0;height:0;border-top:3px solid transparent;border-bottom:3px solid transparent;border-left:3px solid #006ce0;margin-top:13px;margin-left:-4px}.djs-context-pad.open{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;border-radius:4px;pointer-events:auto}.djs-context-pad.open .group{display:grid;grid-template-columns:auto auto;padding:3px}.djs-context-pad.open .group:not(:first-child){padding-left:0}.djs-context-pad.open.one-column-grid .group{grid-template-columns:auto}.djs-context-pad.open .entry{height:32px;width:32px;background:transparent;margin:0;box-shadow:none;border-radius:3px}.djs-context-pad.open .entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}.djs-context-pad.open .entry.noop-entry:hover{background:inherit!important}.djs-context-pad.open .entry img{padding:4px}.entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}@supports ((-webkit-backdrop-filter: none) or (backdrop-filter: none)){.djs-context-pad.open{-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);background:#ffffffc7}.djs-context-pad.open .entry{background:transparent}}.djs-context-pad{max-width:72px}.djs-element.djs-connection.djs-updating path,.djs-element.djs-connection.selected path,.djs-element.djs-connection.animated path{stroke:#1186d8!important}.djs-element.djs-connection.djs-updating path.connection-end-marker,.djs-element.djs-connection.selected path.connection-end-marker,.djs-element.djs-connection.animated path.connection-end-marker{fill:#1186d8!important}.djs-element.djs-connection.animated path.connection{stroke-width:3!important;stroke-dasharray:20,3;animation:dash 5s linear infinite}@keyframes dash{0%{stroke-dashoffset:115}}.djs-bendpoint .djs-visual{fill:#fff;stroke-width:1px;stroke:#1186d8}.djs-bendpoint.floating .djs-visual{display:none}.djs-bendpoints.hover .djs-visual{stroke:#8095b3}.djs-element.hover .djs-outline{stroke:#a7c6ff}.laneSet.hover .djs-visual,.lane.hover .djs-visual{opacity:initial}.djs-element.selected .djs-outline{stroke:#3168cc}.djs-segment-dragger .djs-visual{fill:transparent;stroke:transparent}.djs-snap-line{stroke-width:1px}.djs-popup{overflow-y:auto;overflow-x:hidden;max-height:calc(100% - 20px);opacity:0;transition:opacity .2s ease-out}.djs-popup .entry{display:flex;flex-direction:row-reverse;justify-content:flex-end;align-items:stretch;padding:5px 7px}.djs-popup .entry img{height:24px;width:24px}.djs-popup .djs-popup-header{display:flex;margin:0 9px}.djs-popup .djs-popup-header .entry.active{border:none}.djs-popup .djs-popup-header .entry:first-child{margin-left:0}.djs-popup .djs-popup-header .entry{height:34px;width:34px;padding:4px;margin:2px 1px 2px 4px}.djs-dragger .djs-visual rect{fill:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border){display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;pointer-events:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border) .djs-direct-editing-content{margin:0 auto;pointer-events:auto;text-align:center}.djs-direct-editing-content{-webkit-user-select:text!important;user-select:text!important;overflow:hidden;outline:none;resize:none}.djs-direct-editing-parent-no-border .djs-direct-editing-content{border:0}.djs-direct-editing-rotate-90{transform:rotate(-90deg);transition:transform .1s ease}.djs-direct-editing-rotate-90 .djs-direct-editing-content{border:none;transition:border .1s ease}.djs-direct-editing-rotate-0{transform:rotate(0)}.djs-text-hidden text{display:none}.djs-text-hidden foreignObject{display:none}.djs-direct-editing-resize-handle{display:none}.djs-shape.connect-ok.textAnnotation .djs-visual>:nth-child(1):not(path),.djs-shape.connect-not-ok.textAnnotation .djs-visual>:nth-child(1):not(path){fill:inherit!important}.djs-element.lane.hover:not(.selected) .djs-outline{stroke:none}.djs-element.laneSet.hover:not(.selected) .djs-outline{stroke:none}foreignObject.djs-label{overflow:visible}.foreign-text-container{display:flex;justify-content:center;height:100%}.laneSet .foreign-text-container,.lane .foreign-text-container{align-items:center}.eventSubProcessExpanded .foreign-text-container{height:initial;padding:5px}.foreign-text{text-align:center;box-sizing:border-box;outline:none;font-family:Open Sans,sans-serif;font-size:12px;font-weight:400;line-height:1.2;overflow-wrap:break-word;white-space:pre-line}.label .foreign-text{max-width:130px;-webkit-user-select:text;user-select:text}.textAnnotation .foreign-text{padding:12px;max-width:none;text-align:left;line-height:1.41667;word-wrap:break-word}.textAnnotation foreignObject{height:100%}.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}@supports (-webkit-line-clamp: 2){.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{vertical-align:center;overflow:hidden;text-overflow:ellipsis;white-space:initial;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}}.foreign-text-helper{max-width:128px;min-height:14.39px;width:-moz-fit-content;width:fit-content;margin:0 auto;overflow-wrap:break-word}.diagram-create-popup-menu{border-top:none!important}.diagram-create-popup-menu .entry{cursor:move}.djs-minimap{position:absolute;right:8px;bottom:11px;width:248px;height:33px;border-radius:4px;opacity:1;overflow:hidden;box-sizing:border-box;-webkit-user-select:none;user-select:none;transition:height .2s cubic-bezier(0,0,.2,1)}.djs-minimap .map-buttons{position:absolute;bottom:0;left:0;right:0;height:32px;display:flex;padding:0 5px;z-index:1}.djs-minimap .map-buttons .map-button{min-width:32px;height:32px;cursor:pointer;line-height:32px;font-size:16px;padding:0 8px;background-position:center;transition:background .8s}.djs-minimap .map-buttons .map-button:active{background-size:100%;transition:background 0s}.djs-minimap .map-buttons .map-button.preview-button{padding:0 12px 0 10px;margin:0 4px 0 0;min-width:40px}.djs-minimap .map-buttons .map-button.zoom-button{width:100%;height:100%;padding:0 16px 0 0;text-align:right}.djs-minimap .map-buttons .map-button.zoom-button:after{content:"";position:absolute;width:0;height:0;right:9px;top:16px}.djs-minimap .map{width:248px;height:148px;margin-bottom:32px;cursor:crosshair}.djs-minimap.open{transition:height .2s cubic-bezier(.18,.89,.32,1.28);height:180px}.djs-minimap.open .overlay{position:absolute;inset:0;pointer-events:none}.djs-minimap .viewport{fill:none;stroke:none}.djs-minimap .viewport-dom{position:absolute;border-radius:2px;box-sizing:border-box;cursor:move}.djs-minimap .cursor-crosshair{cursor:crosshair}.djs-minimap .cursor-move{cursor:move}.djs-popup.zoom{right:8px;bottom:47px;top:inherit!important;left:inherit!important}.djs-popup.zoom .entry{display:flex;flex-direction:row;justify-content:space-between;align-items:stretch}.djs-popup.zoom .entry.entry-separator{padding:0!important;margin:4px 10px!important}#canvas_svg_export{position:absolute;left:50px;top:50px;box-shadow:0 0 9px 2px #0000007a}#canvas_svg_export .close-button{position:absolute;right:8px;width:16px;height:16px;cursor:pointer}
`],encapsulation:2})}}var Me=j(40297),Le=j(27397),Pe=j(79772),Ne=j(59564);class Y{static{this.\u0275fac=function(t){return new(t||Y)}}static{this.\u0275mod=z.\u0275\u0275defineNgModule({type:Y})}static{this.\u0275inj=z.\u0275\u0275defineInjector({providers:[C.BaseDiagramEventService,{provide:C.DiagramFeaturesToken,useValue:Ae}],imports:[Me.CommonModule,C.DiagramModule,Pe.TranslateModule.forChild(),Ne.DialogModule,Le.RouterModule.forChild([])]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&z.\u0275\u0275setNgModuleScope(Y,{declarations:[P],imports:[Me.CommonModule,C.DiagramModule,Pe.TranslateModule,Ne.DialogModule,Le.RouterModule],exports:[P]})})()},34035:N=>{N.exports=`<svg width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
	<path fill-rule="evenodd" clip-rule="evenodd" d="M4.33435 0.278443C4.70198 -0.0928144 5.29802 -0.0928144 5.66565 0.278443L9.72428 4.37711C10.0919 4.74837 10.0919 5.3503 9.72428 5.72156C9.35665 6.09281 8.7606 6.09281 8.39297 5.72156L5 2.29511L1.60703 5.72156C1.2394 6.09281 0.643352 6.09281 0.275722 5.72156C-0.0919075 5.3503 -0.0919075 4.74837 0.275722 4.37711L4.33435 0.278443Z" fill="#0D2E4E"/>
</svg>
`},65070:N=>{N.exports=`<svg width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
	<path fill-rule="evenodd" clip-rule="evenodd" d="M0.275722 0.278443C0.643352 -0.0928144 1.2394 -0.0928144 1.60703 0.278443L5 3.70489L8.39297 0.278443C8.7606 -0.0928144 9.35665 -0.0928144 9.72428 0.278443C10.0919 0.6497 10.0919 1.25163 9.72428 1.62289L5.66565 5.72156C5.29802 6.09281 4.70198 6.09281 4.33435 5.72156L0.275722 1.62289C-0.0919075 1.25163 -0.0919075 0.6497 0.275722 0.278443Z" fill="#0D2E4E"/>
</svg>
`}}]);
