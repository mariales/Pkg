(self.webpackChunkapp_studio_enterprise_error_list_dialog=self.webpackChunkapp_studio_enterprise_error_list_dialog||[]).push([[8997,1378],{98997:(L,v,t)=>{t.r(v),t.d(v,{ErrorListDialogService:()=>s,RestValidationErrorHandler:()=>n,WorkspaceErrorsDialogModule:()=>l});var E=t(40297),p=t(59564),S=t(71252),o=t(38495),D=t(79772),y=t(33e3),m=t(50456),u=t(21018),f=t(36486),i=t(59131);class s{constructor(r,e,a,c){this._dialogService=r,this._translateService=e,this._academyHelpUrlService=a,this._domSanitizer=c,this._codeErrorDataSchema={columns:[new m.ErrorTypeIconColumnSchema({name:"errorTypeIcon",formatter:(g,d)=>d.warning?u.MessageType.Warning:u.MessageType.Error}),{name:"fileName",caption:this._translateService.instant("ErrorListDialogService.FileNameColumn"),valueType:o.DataValueType.Text},{name:"errorText",caption:this._translateService.instant("ErrorListDialogService.ErrorTextColumn"),valueType:o.DataValueType.Text},{name:"errorNumber",caption:this._translateService.instant("ErrorListDialogService.ErrorNumberColumn"),valueType:o.DataValueType.Text},{name:"line",caption:this._translateService.instant("ErrorListDialogService.LineColumn"),valueType:o.DataValueType.Text}]},this._codeValidationErrorDataSchema={columns:[{name:"source",caption:this._translateService.instant("ErrorListDialogService.SourceColumn"),valueType:o.DataValueType.Text},{name:"reference",caption:this._translateService.instant("ErrorListDialogService.ReferenceColumn"),valueType:o.DataValueType.Text},{name:"package",caption:this._translateService.instant("ErrorListDialogService.PackageColumn"),valueType:o.DataValueType.Text}]}}_getCompilationErrorsDialogData(r){return{title:this._translateService.instant("ErrorListDialogService.CodeErrorListDialogCaption"),dataSchema:this._codeErrorDataSchema,data:r,sortColumn:"fileName"}}_getValidationErrorsDialogData(r,e){return{title:this._translateService.instant("ErrorListDialogService.CodeValidationErrorListDialogCaption"),dataSchema:this._codeValidationErrorDataSchema,data:e,sortColumn:"source",additionalText:r,helpLinkUrl:this._getHelpLinkUrl()}}_getHelpLinkUrl(){return{url:this._domSanitizer.bypassSecurityTrustUrl(this._academyUrl),caption:this._translateService.instant("ErrorListDialogService.AcademyHelpUrlCaption")}}_getAcademyHelpUrl(){return this._academyHelpUrlService.getAcademyHelpUrl("PackageHierarchyLoops")}showCompilationErrors(r){return this._dialogService.open(m.TableDialogComponent,{data:this._getCompilationErrorsDialogData(r),panelClass:"compilation-error-dialog",disableClose:!0})}showValidationErrors(r,e,a=[]){return this._getAcademyHelpUrl().pipe((0,f.switchMap)(c=>(this._academyUrl=c,this._dialogService.open(m.TableDialogComponent,{data:this._getValidationErrorsDialogData(r,e),panelClass:["validation-error-dialog",...a],disableClose:!0}))))}static#e=this.\u0275fac=function(e){return new(e||s)(i.\u0275\u0275inject(p.DialogService),i.\u0275\u0275inject(D.TranslateService),i.\u0275\u0275inject(y.AcademyService),i.\u0275\u0275inject(S.DomSanitizer))};static#r=this.\u0275prov=i.\u0275\u0275defineInjectable({token:s,factory:s.\u0275fac})}var h=t(28399),T=t(62278);class n extends u.RestAccumulatingErrorHandler{constructor(r,e){super(),this._dialogService=r,this._errorListDialogService=e,this._subscription=new T.Subscription}_showValidationErrors(r,e){this._subscription.add(this._errorListDialogService.showValidationErrors(r,e).subscribe())}processAccumulatedResponse(r){const e=r;e.success=!0,delete e.errorInfo,delete e.validationErrors}canAccumulate(r){return r?.errorInfo?.errorCode==="AutoAddPackageDependenciesValidateException"}showAccumulatedErrors(){const r=(0,h.cloneDeep)(this.accumulatedErrorResponses),e=r.shift();if(r.forEach(a=>{const c=a,g=e.validationErrors??[],d=c.validationErrors,C=g.some(_=>d?.find(x=>(0,h.isEqual)(x,_)));!(0,h.isEmpty)(d)&&!C&&(e.validationErrors=[...g,...d])}),e){const a=e.errorInfo?.message;this._showValidationErrors(a,e.validationErrors)}}processSeparatedResponse(r){const{validationErrors:e,errorInfo:a}=r||{};e?.length>0?this._showValidationErrors(a.message,e):a&&a.message&&this.processErrorMessage(a.message)}processErrorMessage(r){this._dialogService.openInfoDialog(r)}ngOnDestroy(){this._subscription.unsubscribe()}static#e=this.\u0275fac=function(e){return new(e||n)(i.\u0275\u0275inject(p.DialogService),i.\u0275\u0275inject(s))};static#r=this.\u0275prov=i.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac})}class l{static#e=this.\u0275fac=function(e){return new(e||l)};static#r=this.\u0275mod=i.\u0275\u0275defineNgModule({type:l});static#t=this.\u0275inj=i.\u0275\u0275defineInjector({providers:[s,n],imports:[E.CommonModule,p.DialogModule]})}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(l,{imports:[E.CommonModule,p.DialogModule]})})()}}]);
