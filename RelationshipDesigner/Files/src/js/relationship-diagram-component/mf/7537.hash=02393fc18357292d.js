(self.webpackChunkapp_studio_enterprise_relationship_diagram=self.webpackChunkapp_studio_enterprise_relationship_diagram||[]).push([[7537,3308,927,8546,6165,2832,451,8070,5689,4260,1879,9918],{17537:(C,c,a)=>{a.r(c),a.d(c,{CommonDiagramElementFactory:()=>i.DS,CommonDiagramEventHandlerServerController:()=>i.e$,CommonDiagramEventService:()=>g.G,CommonDiagramLoader:()=>i.SH,CommonElementToolsConfig:()=>i.Pf});var i=a(34033),g=a(91078),l=a(12478),u=a.n(l),o={};for(const r in l)["default","CommonDiagramElementFactory","CommonDiagramEventHandlerServerController","CommonDiagramLoader","CommonElementToolsConfig","CommonDiagramEventService"].indexOf(r)<0&&(o[r]=()=>l[r]);a.d(c,o)},34033:(C,c,a)=>{a.d(c,{DS:()=>l,e$:()=>r,SH:()=>u,Pf:()=>d});var i=a(12478),g=a(96590);class l extends i.DiagramElementFactory{generateId(n){return g.IdGenerator.generateUUID()}}class u extends i.DiagramLoader{getConnectionAttributes(n,e){return{...super.getConnectionAttributes(n,e),itemName:e.itemName,order:this.elements.items.connection.order}}}var o=a(5960);let r=class extends i.CommonDiagramEventHandlerController{constructor(n,e,t,s,h,E){super(n,E),this.eventBus=n,this.graphicsFactory=e,this.elementRegistry=t,this.modeling=s,this.selection=h,this.diagramUtils=E}onItemNameChanged({id:n,name:e}){const t=this.elementRegistry.getGraphics(n),s=this.elementRegistry.get(n);s.itemName=e,this.graphicsFactory.update(this.diagramUtils.isConnection(s)?"connection":"shape",s,t)}onElementCaptionChanged({id:n,caption:e}){const t=this.elementRegistry.get(n);if(t){const s=t.caption,h=e&&e.trim();s!==h&&this.modeling.updateLabel(t,e)}}getPasteElementConfig(n){const e=this.getFlowElementConfigFromShape(n);return Object.assign(e,{sourceId:n.sourceId})}findElements(n){const e=[];return n.forEach(t=>{const s=this.elementRegistry.get(t);s&&e.push(s)}),e}getFlowElementConfigFromShape(n){return{itemName:n.itemName,id:n.id,caption:n.caption,parentId:n.parent.id,position:{x:n.rx,y:n.ry}}}addElement(n){const e=n.context,t=e.shape||e.element||e.connection;e.hints.isElementCopyPaste?this.service.pasteElement(this.getPasteElementConfig(t)):super.addElement(n)}subscribeServerDiagramChanges(){const n=this.service;this.eventBus.on([i.Handlers.elements.removing],e=>{const t=e.elements.map(s=>s.id);return n.removing(t)}),this.eventBus.on([i.Handlers.element.doubleClick],e=>{n.elementDoubleClick(e.element.itemName)}),this.eventBus.on(["diagram.item.selected"],e=>{const t=e.id,s=t&&this.elementRegistry.get(t);n.selectionChanged(s&&this.getFlowElementConfigFromShape(s))})}getShape(n){const e=super.getShape(n),t=n.context.shape||n.context.element;return e.type=t.userTaskType||t.type,e}subscribeServerChanges(){this.subscribeServerDiagramChanges();const n=this.service;return[n.elementIsValidChanged$.subscribe(e=>this.eventBus.fire(i.Handlers.element.validation,e)),n.elementNameChanged$.subscribe(({id:e,name:t})=>{this.onItemNameChanged({id:e,name:t})}),n.elementCaptionChanged$.subscribe(({id:e,caption:t})=>{this.onElementCaptionChanged({id:e,caption:t})}),n.elementRemoved$.subscribe(e=>{const t=this.findElements(e);this.modeling.removeElements(t,!0)}),n.elementUpdateType$.subscribe(({id:e,config:t})=>{const s=this.elementRegistry.get(e);this.diagramUtils.isConnection(s)||this.modeling.updateElementType({id:e,config:t,force:!0})}),n.elementSelected$.subscribe(({id:e})=>{const t=this.elementRegistry.get(e);t?this.selection.select(t,!1):this.selection.select([],!1)}),n.elementCenterViewBox$.subscribe(({id:e})=>{const t=this.elementRegistry.get(e);t&&this.modeling.centerViewbox(t)}),n.elementMarkersChanged$.subscribe(({id:e,markers:t})=>{const s=this.elementRegistry.get(e);this.modeling.updateElementMarkers(s,t)})]}};r=(0,o.__decorate)([(0,o.__param)(0,(0,i.Inject)("eventBus")),(0,o.__param)(1,(0,i.Inject)("graphicsFactory")),(0,o.__param)(2,(0,i.Inject)("elementRegistry")),(0,o.__param)(3,(0,i.Inject)("modeling")),(0,o.__param)(4,(0,i.Inject)("selection")),(0,o.__param)(5,(0,i.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],r);class d extends i.DiagramElementToolsConfig{getAddItems(){const n=this.config.customElementToolsConfig?this.config.customElementToolsConfig.addItems||[]:[];return[...super.getAddItems(),...n]}getTools(){const n=this.config.customElementToolsConfig?this.config.customElementToolsConfig.tools||[]:[];return{...super.getTools(),...n}}}},91078:(C,c,a)=>{a.d(c,{G:()=>m});var i=a(73308),g=a(12478),l=a(96590),u=a(28399),o=a(62278),r=a(36486),d=a(59131);class m extends g.BaseDiagramEventService{constructor(e){super(),this.customEventClient=e,this.changeBuffer=[],this.elementNameChanged$=this.customEventClient.subscribe("updateElementName"),this.elementCaptionChanged$=this.customEventClient.subscribe("elementCaptionChanged"),this.elementRemoved$=this.customEventClient.subscribe("elementRemoved"),this.removeCancelled$=this.customEventClient.subscribe("removeCancelled"),this.elementUpdateType$=this.customEventClient.subscribe("elementUpdateType"),this.elementIsValidChanged$=this.customEventClient.subscribe("setIsElementValid"),this.elementSelected$=this.customEventClient.subscribe("elementSelected"),this.elementCenterViewBox$=this.customEventClient.subscribe("elementCenterViewBox"),this.elementMarkersChanged$=this.customEventClient.subscribe("updateElementMarkers"),this.init()}init(){super.init(),this.customEventClient.subscribe("diagramDataLoaded").subscribe(e=>this.endLoading$.next(e))}bufferiseOps(e,t,s){this.changeBuffer.push({commandType:e,path:t,newValues:s})}commit(){var e=this;return(0,i.A)(function*(){if(e.changeBuffer.length){const t=u.cloneDeep(e.changeBuffer);e.changeBuffer=[],e.customEventClient.createOutboundChannel("diagramChanged").next(t)}})()}getDiagramConfig(){var e=this;return(0,i.A)(function*(){const t=(0,o.lastValueFrom)(e.customEventClient.subscribe("setDiagramConfig").pipe((0,r.first)()),{defaultValue:null});return e.customEventClient.createOutboundChannel("getDiagramConfig").next({}),t})()}diagramInitialized(){this.customEventClient.createOutboundChannel("diagramInitialized").next({})}removing(e){return this.customEventClient.createOutboundChannel("diagramElementRemoving").next(e),!1}updatingTypeValidate({id:e,config:t}){return this.customEventClient.createOutboundChannel("diagramElementValidateUpdatingType").next({id:e,config:t}),!1}typeUpdated(e){this.customEventClient.createOutboundChannel("diagramElementTypeUpdated").next(e)}selectionChanged(e){this.customEventClient.createOutboundChannel("diagramElementClick").next(e)}elementDoubleClick(e){this.customEventClient.createOutboundChannel("diagramElementDoubleClick").next(e)}pasteElement(e){this.customEventClient.createOutboundChannel("pasteDiagramElement").next(e)}canCopy(e){var t=this;return(0,i.A)(function*(){const s=(0,o.lastValueFrom)(t.customEventClient.subscribe("setCanCopy").pipe((0,r.first)()),{defaultValue:null});return t.customEventClient.createOutboundChannel("getCanCopy").next(e),s})()}static{this.\u0275fac=function(t){return new(t||m)(d.\u0275\u0275inject(l.CustomEventService))}}static{this.\u0275prov=d.\u0275\u0275defineInjectable({token:m,factory:m.\u0275fac})}}},73308:(C,c,a)=>{a.d(c,{A:()=>g});function i(l,u,o,r,d,m,n){try{var e=l[m](n),t=e.value}catch(s){o(s);return}e.done?u(t):Promise.resolve(t).then(r,d)}function g(l){return function(){var u=this,o=arguments;return new Promise(function(r,d){var m=l.apply(u,o);function n(t){i(m,r,d,n,e,"next",t)}function e(t){i(m,r,d,n,e,"throw",t)}n(void 0)})}}}}]);
