(self.webpackChunkapp_studio_enterprise_relationship_diagram=self.webpackChunkapp_studio_enterprise_relationship_diagram||[]).push([[8997,1378],{98997:(V,v,a)=>{a.r(v),a.d(v,{ErrorListDialogService:()=>s,RestValidationErrorHandler:()=>n,WorkspaceErrorsDialogModule:()=>l});var E=a(40297),p=a(59564),S=a(71252),o=a(38495),D=a(79772),y=a(33e3),m=a(50456),u=a(21018),f=a(36486),i=a(59131);class s{constructor(r,e,t,c){this._dialogService=r,this._translateService=e,this._academyHelpUrlService=t,this._domSanitizer=c,this._codeErrorDataSchema={columns:[new m.ErrorTypeIconColumnSchema({name:"errorTypeIcon",formatter:(g,d)=>d.warning?u.MessageType.Warning:u.MessageType.Error}),{name:"fileName",caption:this._translateService.instant("ErrorListDialogService.FileNameColumn"),valueType:o.DataValueType.Text},{name:"errorText",caption:this._translateService.instant("ErrorListDialogService.ErrorTextColumn"),valueType:o.DataValueType.Text},{name:"errorNumber",caption:this._translateService.instant("ErrorListDialogService.ErrorNumberColumn"),valueType:o.DataValueType.Text},{name:"line",caption:this._translateService.instant("ErrorListDialogService.LineColumn"),valueType:o.DataValueType.Text}]},this._codeValidationErrorDataSchema={columns:[{name:"source",caption:this._translateService.instant("ErrorListDialogService.SourceColumn"),valueType:o.DataValueType.Text},{name:"reference",caption:this._translateService.instant("ErrorListDialogService.ReferenceColumn"),valueType:o.DataValueType.Text},{name:"package",caption:this._translateService.instant("ErrorListDialogService.PackageColumn"),valueType:o.DataValueType.Text}]}}_getCompilationErrorsDialogData(r){return{title:this._translateService.instant("ErrorListDialogService.CodeErrorListDialogCaption"),dataSchema:this._codeErrorDataSchema,data:r,sortColumn:"fileName"}}_getValidationErrorsDialogData(r,e){return{title:this._translateService.instant("ErrorListDialogService.CodeValidationErrorListDialogCaption"),dataSchema:this._codeValidationErrorDataSchema,data:e,sortColumn:"source",additionalText:r,helpLinkUrl:this._getHelpLinkUrl()}}_getHelpLinkUrl(){return{url:this._domSanitizer.bypassSecurityTrustUrl(this._academyUrl),caption:this._translateService.instant("ErrorListDialogService.AcademyHelpUrlCaption")}}_getAcademyHelpUrl(){return this._academyHelpUrlService.getAcademyHelpUrl("PackageHierarchyLoops")}showCompilationErrors(r){return this._dialogService.open(m.TableDialogComponent,{data:this._getCompilationErrorsDialogData(r),panelClass:"compilation-error-dialog",disableClose:!0})}showValidationErrors(r,e,t=[]){return this._getAcademyHelpUrl().pipe((0,f.switchMap)(c=>(this._academyUrl=c,this._dialogService.open(m.TableDialogComponent,{data:this._getValidationErrorsDialogData(r,e),panelClass:["validation-error-dialog",...t],disableClose:!0}))))}static{this.\u0275fac=function(e){return new(e||s)(i.\u0275\u0275inject(p.DialogService),i.\u0275\u0275inject(D.TranslateService),i.\u0275\u0275inject(y.AcademyService),i.\u0275\u0275inject(S.DomSanitizer))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:s,factory:s.\u0275fac})}}var h=a(28399),T=a(62278);class n extends u.RestAccumulatingErrorHandler{constructor(r,e){super(),this._dialogService=r,this._errorListDialogService=e,this._subscription=new T.Subscription}_showValidationErrors(r,e){this._subscription.add(this._errorListDialogService.showValidationErrors(r,e).subscribe())}processAccumulatedResponse(r){const e=r;e.success=!0,delete e.errorInfo,delete e.validationErrors}canAccumulate(r){return r?.errorInfo?.errorCode==="AutoAddPackageDependenciesValidateException"}showAccumulatedErrors(){const r=(0,h.cloneDeep)(this.accumulatedErrorResponses),e=r.shift();if(r.forEach(t=>{const c=t,g=e.validationErrors??[],d=c.validationErrors,C=g.some(x=>d?.find(L=>(0,h.isEqual)(L,x)));!(0,h.isEmpty)(d)&&!C&&(e.validationErrors=[...g,...d])}),e){const t=e.errorInfo?.message;this._showValidationErrors(t,e.validationErrors)}}processSeparatedResponse(r){const{validationErrors:e,errorInfo:t}=r||{};e?.length>0?this._showValidationErrors(t.message,e):t&&t.message&&this.processErrorMessage(t.message)}processErrorMessage(r){this._dialogService.openInfoDialog(r)}ngOnDestroy(){this._subscription.unsubscribe()}static{this.\u0275fac=function(e){return new(e||n)(i.\u0275\u0275inject(p.DialogService),i.\u0275\u0275inject(s))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac})}}class l{static{this.\u0275fac=function(e){return new(e||l)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:l})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[s,n],imports:[E.CommonModule,p.DialogModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(l,{imports:[E.CommonModule,p.DialogModule]})})()}}]);
